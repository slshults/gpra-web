const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/index.es-DOG_e_aL.js","js/radix-vendor--xiUtzSD.js","js/rateLimitHandler-qD_g5psz.js","css/rateLimitHandler.css","js/dnd-vendor-CrjKgCyd.js"])))=>i.map(i=>d[i]);
var t0=Object.defineProperty;var r0=(t,r,e)=>r in t?t0(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e;var Sr=(t,r,e)=>r0(t,typeof r!="symbol"?r+"":r,e);import{r as U,j as n,O as Fc,P as mh,C as Oc,b as Dc,T as Rc,D as Bc,c as gh,u as xh,W as n0,d as s0,e as yh,f as a0,g as i0,R as Ui,h as o0,i as l0,k as c0,l as d0,m as bh,I as u0,n as h0,o as wh,V as f0,L as vh,p as Nh,q as p0,s as m0,S as _h,t as g0,v as x0,w as Uo,x as y0}from"./radix-vendor--xiUtzSD.js";import{c as yr,a as zr,A as b0,B as Be,L as Wn,I as Rr,b as Hr,C as Mc,d as on,e as _n,f as ln,g as cn,h as Fs,i as hs,j as fs,E as zo,k as qo,R as w0,l as v0}from"./rateLimitHandler-qD_g5psz.js";import{u as Nl,C as _l,a as Uc,b as Mi,D as cl,c as dl,S as ul,v as hl,d as fl,s as zc,K as qc,P as $c}from"./dnd-vendor-CrjKgCyd.js";let $l={},ea={user_id:null,subscription_tier:null,posthog_distinct_id:null};const N0=t=>{t&&t.authenticated?ea={user_id:t.user,subscription_tier:t.tier,posthog_distinct_id:t.posthog_distinct_id}:ea={user_id:null,subscription_tier:null,posthog_distinct_id:null}},Rd=(t,r={})=>{if(typeof window<"u"&&window.posthog){const e=r.previous_page;if(e&&$l[e]){const a=Date.now()-$l[e];window.posthog.capture("page_time_spent",{page_name:e,time_spent_ms:a,time_spent_seconds:Math.round(a/1e3),next_page:t})}$l[t]=Date.now(),window.posthog.capture("$pageview",{$current_url:`${window.location.origin}${window.location.pathname}#${t}`,$host:window.location.host,$pathname:window.location.pathname,$search:window.location.search,title:`Guitar Practice - ${t}`,page_name:t,spa_navigation:!0,viewport_width:window.innerWidth,viewport_height:window.innerHeight,screen_width:window.screen.width,screen_height:window.screen.height,...ea,...r})}},$o=(t,r,e={})=>{if(typeof window<"u"&&window.posthog){const s={started_timer:"practice_timer_started",marked_done:"practice_item_completed",timer_reset:"practice_timer_reset",timer_stopped:"practice_timer_stopped"}[t]||t;window.posthog.capture(s,{item_name:r,timer_started:t==="started_timer",timer_stopped:t==="timer_stopped",timer_reset:t==="timer_reset",...ea,...e}),fetch("/api/user/practice-events",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event_type:t,item_name:r,duration_seconds:e.duration_seconds,additional_data:e})}).catch(i=>console.error("Failed to log practice event:",i))}},Zs=(t,r,e={})=>{if(typeof window<"u"&&window.posthog){const a={added:"chord_chart_created",edited:"chord_chart_updated",deleted:"chord_chart_deleted",autocreated:"chord_charts_autocreated",copied:"chord_charts_copied",chord_chart_created:"chord_chart_created",chord_chart_updated:"chord_chart_updated",chord_chart_deleted:"chord_chart_deleted",autocreate_completed:"chord_charts_autocreated"};let s={};typeof r=="object"?s={...r,...e}:s={item_name:r,...e},window.posthog.capture(a[t]||t,{...ea,...s})}},fo=(t,r,e,a={})=>{if(typeof window<"u"&&window.posthog){const s=r==="routine"?`routine_${t}`:`practice_item_${t}`;window.posthog.capture(s,{[`${r}_name`]:e,operation_type:t,item_type:r,...ea,...a})}},yc=(t,r,e=null,a={})=>{if(typeof window<"u"&&window.posthog){const s={item_added:"routine_item_added",item_removed:"routine_item_removed",activated:"routine_activated"},i={routine_name:r,operation_type:t,...a};e&&(i.item_name=e),window.posthog.capture(s[t]||t,{...i,...ea})}},Wl=(t,r,e={})=>{if(typeof window<"u"&&window.posthog){const a={notes:"item_notes_updated",tuning:"item_tuning_updated",folder_path:"item_folder_path_updated"};window.posthog.capture(a[t]||`item_${t}_updated`,{item_name:r,update_type:t,...ea,...e})}},Bd=(t,r,e={})=>{typeof window<"u"&&window.posthog&&window.posthog.capture("songbook_folder_link_clicked",{item_name:t,songbook_folder_path:r,...ea,...e})},_0=(t,r={})=>{typeof window<"u"&&window.posthog&&(window.posthog.capture("practice_page_viewed",{active_routine_name:t,...ea,...r}),fetch("/api/user/practice-events",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event_type:"practice_page_visited",routine_name:t,additional_data:r})}).catch(e=>console.error("Failed to log practice event:",e)))},jh=U.createContext(void 0),j0=({children:t})=>{const r=()=>{const i=window.location.hash.slice(1).split("?")[0];return["Practice","Routines","Items","Account"].includes(i)?i:"Practice"},[e,a]=U.useState(r);U.useEffect(()=>{const i=setTimeout(()=>{Rd(e,{initial_page_load:!0,referrer:document.referrer})},100);return()=>clearTimeout(i)},[]);const s=(i,c=!0)=>{const o=e;a(i),Rd(i,{previous_page:o,navigation_type:c?"user_action":"browser_navigation",timestamp:new Date().toISOString()}),c&&window.history.pushState(null,"",`#${i}`)};return U.useEffect(()=>{const i=()=>{const c=r();s(c,!1)};return window.addEventListener("popstate",i),()=>{window.removeEventListener("popstate",i)}},[]),n.jsx(jh.Provider,{value:{activePage:e,setActivePage:s},children:t})},zi=()=>{const t=U.useContext(jh);if(t===void 0)throw new Error("useNavigation must be used within a NavigationProvider");return t},Rn=yr("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),S0=yr("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20",key:"t4utmx"}]]),k0=yr("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),Nn=yr("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),Kn=yr("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),us=yr("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),Hl=yr("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Sh=yr("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),Ks=yr("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),kh=yr("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]),Ah=yr("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),jl=yr("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]),A0=yr("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]),C0=yr("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),Ch=yr("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]),L0=yr("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]),po=yr("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),Md=yr("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),yo=yr("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Lh=yr("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]),E0=yr("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),P0=yr("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),T0=yr("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),pl=yr("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),Eh=yr("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),I0=yr("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),Ti=yr("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),F0=yr("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]),bc=yr("Wand",[["path",{d:"M15 4V2",key:"z1p9b7"}],["path",{d:"M15 16v-2",key:"px0unx"}],["path",{d:"M8 9h2",key:"1g203m"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M17.8 11.8 19 13",key:"yihg8r"}],["path",{d:"M15 9h0",key:"kg5t1u"}],["path",{d:"M17.8 6.2 19 5",key:"fd4us0"}],["path",{d:"m3 21 9-9",key:"1jfql5"}],["path",{d:"M12.2 6.2 11 5",key:"i3da3b"}]]),Gr=yr("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),O0=yr("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),Ph=()=>{if(typeof window>"u")return"unknown";const t=window.navigator.userAgent.toLowerCase();return t.includes("android")?"android":t.includes("iphone")||t.includes("ipad")||t.includes("ipod")?"ios":t.includes("mac")?"macos":t.includes("win")?"windows":t.includes("linux")?"linux":"unknown"},Th=()=>{const t=Ph();return["windows","macos","linux"].includes(t)},_i=()=>{if(typeof window>"u")return!1;const t=window.navigator.userAgent.toLowerCase(),r=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(t),e="ontouchstart"in window||navigator.maxTouchPoints>0,a=window.innerWidth<=768;return r||e&&a},D0=()=>{const t=Ph();return t==="windows"?"Windows Explorer":t==="macos"?"Finder":"File Manager"},R0=t=>{if(!t)return!1;const r=t.trim().toLowerCase();return r.startsWith("http://")||r.startsWith("https://")},gs=gh,B0=mh,Ih=U.forwardRef(({className:t,...r},e)=>n.jsx(Fc,{ref:e,className:zr("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r}));Ih.displayName=Fc.displayName;const Jn=U.forwardRef(({className:t,children:r,...e},a)=>n.jsxs(B0,{children:[n.jsx(Ih,{}),n.jsxs(Oc,{ref:a,className:zr("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...e,children:[r,n.jsxs(Dc,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[n.jsx(Gr,{className:"h-4 w-4"}),n.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Jn.displayName=Oc.displayName;const Zn=({className:t,...r})=>n.jsx("div",{className:zr("flex flex-col space-y-1.5 text-center sm:text-left",t),...r});Zn.displayName="DialogHeader";const wc=({className:t,...r})=>n.jsx("div",{className:zr("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...r});wc.displayName="DialogFooter";const Xn=U.forwardRef(({className:t,...r},e)=>n.jsx(Rc,{ref:e,className:zr("text-lg font-semibold leading-none tracking-tight",t),...r}));Xn.displayName=Rc.displayName;const xs=U.forwardRef(({className:t,...r},e)=>n.jsx(Bc,{ref:e,className:zr("text-sm text-muted-foreground",t),...r}));xs.displayName=Bc.displayName;const Ii=U.forwardRef(({className:t,...r},e)=>n.jsx("textarea",{className:zr("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",t),ref:e,...r}));Ii.displayName="Textarea";const Fh=({isOpen:t,onClose:r,limitType:e,currentTier:a,currentCount:s,limitAmount:i})=>{if(!t)return null;const c=()=>e==="routines"?`Your plan only includes ${i} routine${i!==1?"s":""}, you're at the max. Pick a button:`:`Your plan only includes ${i} item${i!==1?"s":""}, you're at the max. Pick a button:`,o=()=>{r(),window.location.hash="#Account",setTimeout(()=>{const d=document.getElementById("subscription-plans");if(d){const p=d.getBoundingClientRect().top+window.pageYOffset-100;window.scrollTo({top:p,behavior:"smooth"})}},100)};return n.jsx(gs,{open:t,onOpenChange:d=>!d&&r(),children:n.jsxs(Jn,{className:"sm:max-w-md",children:[n.jsxs(Zn,{children:[n.jsxs(Xn,{className:"flex items-center gap-2 text-xl",children:[n.jsx(b0,{className:"h-6 w-6 text-amber-500"}),"Oops!"]}),n.jsx(xs,{className:"text-left space-y-3 text-base mt-4",children:n.jsx("div",{className:"text-gray-700 dark:text-gray-300",children:c()})})]}),n.jsxs("div",{className:"flex gap-3 mt-6",children:[n.jsx(Be,{onClick:o,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded transition-colors",children:"Upgrade"}),n.jsx(Be,{onClick:r,className:"flex-1 bg-gray-300 hover:bg-gray-400 text-gray-800 font-semibold py-2 px-4 rounded transition-colors dark:bg-gray-600 dark:hover:bg-gray-700 dark:text-gray-200",children:"Nope"})]})]})})},Wc=t=>{if(!t)return"";const r=t.split(`
`),e=[];let a=!1;for(let s of r){let i=s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");const c=i.match(/^(#{1,6})\s+(.+)$/);if(c){const h=c[1].length,p=c[2],b={1:"text-2xl font-bold",2:"text-xl font-bold",3:"text-lg font-semibold",4:"text-base font-semibold",5:"text-sm font-semibold",6:"text-sm font-medium"};a&&(e.push("</ul>"),a=!1),e.push(`<h${h} class="${b[h]} mt-2 mb-1">${Wo(p)}</h${h}>`);continue}const o=i.match(/^[-*]\s+(.+)$/);if(o){a||(e.push('<ul class="list-disc list-inside ml-2">'),a=!0),e.push(`<li>${Wo(o[1])}</li>`);continue}const d=i.match(/^\d+\.\s+(.+)$/);if(d){a||(e.push('<ol class="list-decimal list-inside ml-2">'),a=!0),e.push(`<li>${Wo(d[1])}</li>`);continue}if(a&&(e.push(a==="ol"?"</ol>":"</ul>"),a=!1),i.trim()===""){e.push("<br />");continue}e.push(`<p>${Wo(i)}</p>`)}return a&&e.push("</ul>"),e.join("")},Wo=t=>{let r=t;return r=r.replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>"),r=r.replace(/__(.+?)__/g,"<strong>$1</strong>"),r=r.replace(/\*(.+?)\*/g,"<em>$1</em>"),r=r.replace(/_(.+?)_/g,"<em>$1</em>"),r=r.replace(/`(.+?)`/g,'<code class="bg-gray-700 px-1 rounded">$1</code>'),r=r.replace(/\[(.+?)\]\((.+?)\)/g,'<a href="$2" class="text-blue-400 underline" target="_blank" rel="noopener noreferrer">$1</a>'),r},M0=({open:t,onOpenChange:r,itemId:e,currentNote:a="",onNoteSave:s})=>{const[i,c]=U.useState(""),[o,d]=U.useState(null),[h,p]=U.useState(!1),[b,m]=U.useState(!1),u=U.useRef("");U.useEffect(()=>{t&&(c(a),u.current=a,d(null),p(!1),m(!1))},[t,a]);const w=()=>i!==u.current&&i.trim()!=="",x=()=>{w()?p(!0):r(!1)},_=async y=>{y&&y.preventDefault();try{const A=await fetch(`/api/items/${e}/notes`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({notes:i})});if(!A.ok)throw new Error("Failed to save note");const L=await A.json();u.current=i,s==null||s(i),p(!1),r(!1)}catch(A){d(A.message),console.error("Save error:",A)}};return n.jsxs(n.Fragment,{children:[n.jsx(gs,{open:t,onOpenChange:y=>{y?r(!0):x()},children:n.jsxs(Jn,{className:"max-w-2xl bg-gray-800",children:[n.jsxs(Zn,{children:[n.jsx(Xn,{children:"Edit note"}),n.jsx(xs,{children:"Add or edit your practice notes (markdown supported)"}),o&&n.jsx("div",{className:"mt-2 text-sm text-red-500",children:o})]}),n.jsxs("form",{onSubmit:_,className:"space-y-4",children:[n.jsxs("div",{className:"flex gap-2",children:[n.jsx(Be,{type:"button",variant:b?"outline":"default",size:"sm",onClick:()=>m(!1),children:"Edit"}),n.jsx(Be,{type:"button",variant:b?"default":"outline",size:"sm",onClick:()=>m(!0),children:"Preview"})]}),b?n.jsx("div",{className:"h-48 bg-gray-900 text-white p-3 rounded-md overflow-auto",dangerouslySetInnerHTML:{__html:Wc(i)}}):n.jsx(Ii,{value:i,onChange:y=>c(y.target.value),placeholder:"Enter your notes... (markdown supported)",className:"h-48 bg-gray-900 text-white",autoComplete:"off"}),n.jsxs("div",{className:"flex justify-end space-x-4",children:[n.jsx(Be,{type:"button",variant:"outline",onClick:x,children:"Cancel"}),n.jsx(Be,{type:"submit",variant:"outline",children:"Save note"})]})]})]})}),n.jsx(gs,{open:h,onOpenChange:p,children:n.jsxs(Jn,{className:"max-w-md bg-gray-800",children:[n.jsxs(Zn,{children:[n.jsx(Xn,{children:"Unsaved changes"}),n.jsx(xs,{children:"Are you sure you want to lose what you typed?"})]}),n.jsxs("div",{className:"flex justify-end space-x-3 mt-4",children:[n.jsx(Be,{variant:"outline",onClick:()=>p(!1),children:"Keep editing"}),n.jsx(Be,{variant:"outline",className:"text-red-400 hover:text-red-300",onClick:()=>{p(!1),r(!1)},children:"Lose it"}),n.jsx(Be,{variant:"default",onClick:_,children:"Save it"})]})]})})]})},U0=({open:t,onOpenChange:r,item:e=null,onItemChange:a})=>{const[s,i]=U.useState({C:"",D:"",E:5,F:"",G:"",H:"",I:""}),[c,o]=U.useState(null),[d,h]=U.useState(!1),[p,b]=U.useState(!1),[m,u]=U.useState(!1),[w,x]=U.useState({limitType:"items",currentTier:"free",currentCount:0,limitAmount:15});U.useEffect(()=>{t&&(e?e.D!==void 0||e.H!==void 0?(i({C:e.C||"",D:e.D||"",E:e.E||5,F:e.F||"",G:e.G||"",H:e.H||"",I:e.I||""}),o(null),h(!1),b(!1)):_(e.A):(i({C:"",D:"",E:5,F:"",G:"",H:"",I:""}),o(null),h(!1),b(!1)))},[t,e]);const _=async L=>{try{const E=await fetch(`/api/items/${L}`);if(!E.ok)throw new Error("Failed to fetch item details");const O=await E.json();i({C:O.C||"",D:O.D||"",E:O.E||5,F:O.F||"",G:O.G||"",H:O.H||"",I:O.I||""}),o(null),h(!1)}catch(E){o(`Failed to load item: ${E.message}`),console.error("Fetch item error:",E)}},y=(L,E)=>{i(O=>({...O,[L]:E})),h(!0)},A=async L=>{L.preventDefault();try{const{G:E,...O}=s,X="/api/items",K=e!=null&&e.A?`${X}/${e.A}`:X,H=await fetch(K,{method:e?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(O)});if(!H.ok){const S=await H.json().catch(()=>null);if(H.status===403&&(S==null?void 0:S.error)==="Item limit reached"){x({limitType:"items",currentTier:S.tier||"free",currentCount:S.current||0,limitAmount:S.limit||15}),u(!0);return}throw new Error((S==null?void 0:S.error)||"Failed to save item")}const P=await H.json(),Y=!(e!=null&&e.A),I=s.C||"Unnamed Item";if(Y)fo("created","item",I);else{fo("updated","item",I);const S=(e==null?void 0:e.D)||"",R=(e==null?void 0:e.H)||"",N=(e==null?void 0:e.I)||"";s.D&&s.D!==S&&Wl("notes",I),s.H&&s.H!==R&&Wl("tuning",I),s.I&&s.I!==N&&Wl("folder_path",I)}a==null||a(P),r(!1)}catch(E){o(E.message),console.error("Save error:",E)}};return n.jsxs(n.Fragment,{children:[n.jsx(gs,{open:t,onOpenChange:r,children:n.jsxs(Jn,{className:"max-w-2xl bg-gray-800",children:[n.jsxs(Zn,{children:[n.jsx(Xn,{children:e?`Edit item: ${e.C}`:"Create new item"}),c&&n.jsx("div",{className:"mt-2 text-sm text-red-500",role:"alert",children:c})]}),n.jsxs("form",{onSubmit:A,className:"space-y-6",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Wn,{htmlFor:"title",children:"Title"}),n.jsx(Rr,{id:"title",value:s.C,onChange:L=>y("C",L.target.value),placeholder:"Enter item title",required:!0,className:"bg-gray-900 text-white",autoComplete:"off"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Wn,{htmlFor:"duration",children:"Duration"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx(Rr,{id:"duration-minutes",type:"number",min:"0",max:"999",value:Math.floor(s.E),onChange:L=>{const E=parseInt(L.target.value)||0,O=s.E%1*60;y("E",E+O/60)},onInput:L=>{const E=parseInt(L.target.value)||0,O=s.E%1*60;y("E",E+O/60)},className:"bg-gray-900 text-white text-center",autoComplete:"off",placeholder:"0"}),n.jsx("div",{className:"text-xs text-gray-400 text-center mt-1",children:"minutes"})]}),n.jsx("span",{className:"text-xl text-gray-400",children:":"}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Rr,{id:"duration-seconds",type:"text",inputMode:"numeric",pattern:"[0-9]*",value:Math.round(s.E%1*60),onChange:L=>{const E=L.target.value.replace(/[^0-9]/g,""),O=Math.min(59,parseInt(E)||0),X=Math.floor(s.E);y("E",X+O/60)},className:"bg-gray-900 text-white text-center pr-6",autoComplete:"off",placeholder:"00"}),n.jsxs("div",{className:"absolute right-0 top-0 flex flex-col h-full border-l border-gray-700",children:[n.jsx("button",{type:"button",onClick:()=>{const L=Math.round(s.E%1*60),E=Math.min(59,L+15),O=Math.floor(s.E);y("E",O+E/60)},className:"flex-1 px-1 text-gray-400 hover:text-white hover:bg-gray-700 text-xs leading-none","aria-label":"Increase seconds by 15","data-ph-capture-attribute-button":"duration-seconds-up",children:"â–²"}),n.jsx("button",{type:"button",onClick:()=>{const L=Math.round(s.E%1*60),E=Math.max(0,L-15),O=Math.floor(s.E);y("E",O+E/60)},className:"flex-1 px-1 text-gray-400 hover:text-white hover:bg-gray-700 text-xs leading-none border-t border-gray-700","aria-label":"Decrease seconds by 15","data-ph-capture-attribute-button":"duration-seconds-down",children:"â–¼"})]})]}),n.jsx("div",{className:"text-xs text-gray-400 text-center mt-1",children:"seconds"})]})]}),n.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Total: ",Math.floor(s.E)," min ",Math.round(s.E%1*60)," sec"]})]}),Th()&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Wn,{htmlFor:"songbook",children:"Songbook folder or link"}),n.jsx(Rr,{id:"songbook",value:s.I,onChange:L=>y("I",L.target.value),placeholder:'e.g.: "C:\\Users\\...\\SongName" or "https://tabs.ultimate-guitar.com/..."',className:"bg-gray-900 font-mono"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Wn,{htmlFor:"tuning",children:"Tuning"}),n.jsx(Rr,{id:"tuning",value:s.H,onChange:L=>y("H",L.target.value),placeholder:"e.g. EADGBE",className:"bg-gray-900 text-white",autoComplete:"off"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs(Wn,{htmlFor:"notes",children:["Notes ",n.jsx("span",{className:"text-gray-500 font-normal",children:"(markdown supported)"})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(Be,{type:"button",variant:p?"outline":"default",size:"sm",onClick:()=>b(!1),"data-ph-capture-attribute-button":"notes-edit-mode",children:"Edit"}),n.jsx(Be,{type:"button",variant:p?"default":"outline",size:"sm",onClick:()=>b(!0),"data-ph-capture-attribute-button":"notes-preview-mode",children:"Preview"})]})]}),p?n.jsx("div",{className:"h-24 bg-gray-900 text-white p-3 rounded-md overflow-auto",dangerouslySetInnerHTML:{__html:Wc(s.D)}}):n.jsx(Ii,{id:"notes",value:s.D,onChange:L=>y("D",L.target.value),placeholder:"Enter any notes... (markdown supported)",className:"h-24 bg-gray-900 text-white",autoComplete:"off"})]}),n.jsxs("div",{className:"flex justify-end space-x-4",children:[n.jsx(Be,{type:"button",variant:"outline",onClick:()=>r(!1),className:"text-gray-300 hover:text-white","data-ph-capture-attribute-button":"item-editor-cancel",children:"Cancel"}),n.jsx(Be,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",disabled:!d,"data-ph-capture-attribute-button":"item-editor-save",children:"Save"})]})]})]})}),t&&n.jsx(Fh,{isOpen:m,onClose:()=>u(!1),limitType:w.limitType,currentTier:w.currentTier,currentCount:w.currentCount,limitAmount:w.limitAmount})]})},Oh=()=>{const[t,r]=U.useState([]),[e,a]=U.useState(!0),[s,i]=U.useState(null),[c,o]=U.useState(0),d=async()=>{try{const w=await fetch("/api/items");if(!w.ok)throw new Error("Failed to fetch items");const x=await w.json();r(x),i(null)}catch(w){i(w.message),console.error("Fetch error:",w)}finally{a(!1)}},h=async()=>{o(w=>w+1)},p=async w=>{try{if(!(await fetch(`/api/items/${w}`,{method:"DELETE"})).ok)throw new Error("Failed to delete item");r(_=>_.filter(y=>y.A!==w)),await h()}catch(x){throw i(x.message),console.error("Delete error:",x),x}},b=async w=>{try{const x=await fetch("/api/items",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(w)});if(!x.ok)throw new Error("Failed to add item");const _=await x.json();return r([...t,_]),_}catch(x){throw i(x.message),x}},m=async(w,x)=>{try{const _=await fetch(`/api/items/${w}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)});if(!_.ok)throw new Error("Failed to update item");const y=await _.json();return r(t.map(A=>A.A===w?y:A)),y}catch(_){throw i(_.message),_}},u=async w=>{try{const x=await fetch("/api/items/order",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(w)});if(!x.ok)throw new Error("Failed to update items");const _=await x.json();return r(_),await h(),_}catch(x){throw i(x.message),console.error("Update error:",x),x}};return U.useEffect(()=>{d()},[c]),{items:t,loading:e,error:s,addItem:b,updateItem:m,deleteItem:p,updateItems:u,refreshItems:h}},z0={strings:6,frets:5,fretSize:1.2,fingerSize:.75,sidePadding:.2,fontFamily:"Arial",width:128,height:176,color:"#ffffff",backgroundColor:"transparent",strokeColor:"#ffffff",textColor:"#ffffff",fretLabelColor:"#ffffff",fingerTextColor:"#000000",fingerTextSize:28},Gl=async(t,r={},e=3,a=null)=>{for(let s=0;s<e;s++)try{const i=await fetch(t,r);if(i.status===429){const c=Math.pow(2,s)*1e3,o=`Rate limited. Waiting ${c/1e3}s before retry ${s+1}/${e}`;a&&a(o),await new Promise(d=>setTimeout(d,c));continue}return i}catch(i){if(s===e-1)throw i;const c=Math.pow(2,s)*1e3,o=`Request failed. Waiting ${c/1e3}s before retry ${s+1}/${e}`;a&&a(o),await new Promise(d=>setTimeout(d,c))}throw new Error(`Failed after ${e} attempts`)},Dh=({itemId:t,onSave:r,onCancel:e,editingChordId:a=null,insertionContext:s=null,defaultTuning:i="EADGBE"})=>{const[c,o]=U.useState(""),[d,h]=U.useState(1),[p,b]=U.useState(5),[m,u]=U.useState(6),[w,x]=U.useState("dots");U.useEffect(()=>{G.current=w},[w]);const[_,y]=U.useState(i),[A,L]=U.useState(0),[E,O]=U.useState([]),[X,K]=U.useState([]);U.useEffect(()=>{},[X]);const[H,P]=U.useState(new Set),[Y,I]=U.useState(new Set),[S,R]=U.useState(!1),[N,re]=U.useState(!1),[ve,le]=U.useState(null),[oe,ie]=U.useState(!1),Ae=U.useRef(null),te=U.useRef(null),C=U.useRef(null),G=U.useRef(w),Z=U.useRef(null),Q=async V=>{if(!(!V.trim()||!t))try{R(!0);const $=await Gl(`/api/items/${t}/chord-charts`,{},3,1e3);if(!$.ok)return;const M=(await $.json()).filter(pe=>pe.title.toLowerCase()===V.toLowerCase());let ue;if(M.length===0)try{await new Promise(ce=>setTimeout(ce,1e3));const pe=await Gl(`/api/chord-charts/common/search?name=${encodeURIComponent(V)}`,{},3,1e3);if(pe.ok){const ce=await pe.json();ce.length>0&&(ue=ce[0])}}catch(pe){console.error("Error fetching common chords:",pe)}else M.length===1||M.sort((pe,ce)=>{const Le=parseInt(pe.order)||0,Ie=parseInt(ce.order)||0;return Le!==Ie?Le-Ie:(parseInt(pe.id)||0)-(parseInt(ce.id)||0)}),ue=M[0];if(ue){h(ue.startingFret||1),b(ue.numFrets||5),u(ue.numStrings||6),y(ue.tuning||i),L(ue.capo||0);const ce=(ue.fingers||[]).map(Ie=>{if(Array.isArray(Ie)){const[st,ot,yt]=Ie;return[st,ot,yt]}if(Ie&&typeof Ie=="object"&&"string"in Ie&&"fret"in Ie){const st=Ie.fingerNumber||Ie[2];return[Ie.string,Ie.fret,st]}const[Te,Ve,ht]=Array.isArray(Ie)?Ie:[Ie[0],Ie[1],Ie[2]];return[Te,Ve,ht]});O(ce);const Le=ue.barres||[];K(Le),P(new Set(ue.openStrings||[])),I(new Set(ue.mutedStrings||[])),ie(!1)}}catch($){console.error("Error during autofill:",$)}finally{R(!1)}};U.useEffect(()=>{a&&t?(async()=>{try{R(!0);const $=await Gl(`/api/items/${t}/chord-charts`);if($.ok){const M=(await $.json()).find(ue=>parseInt(ue.id)===parseInt(a));if(M){console.log("Loading chord for editing:",{id:M.id,title:M.title,hasLineBreakAfter:M.hasLineBreakAfter,editingChordId:a}),o(M.title||""),h(M.startingFret||1),b(M.numFrets||5),u(M.numStrings||6),y(M.tuning||i),L(M.capo||0);const pe=(M.fingers||[]).map(Ie=>{if(Array.isArray(Ie)){const[st,ot,yt]=Ie;return[st,ot,yt]}if(Ie&&typeof Ie=="object"&&"string"in Ie&&"fret"in Ie){const st=Ie.fingerNumber||Ie[2];return[Ie.string,Ie.fret,st]}const[Te,Ve,ht]=Array.isArray(Ie)?Ie:[Ie[0],Ie[1],Ie[2]];return[Te,Ve,ht]});O(pe);const ce=M.barres||[];K(ce),P(new Set(M.openStrings||[])),I(new Set(M.mutedStrings||[]));const Le=M.hasLineBreakAfter||!1;console.log("Setting addLineBreak to:",Le,"from hasLineBreakAfter:",M.hasLineBreakAfter),ie(Le)}}else console.error("Failed to fetch chord charts:",$.status)}catch($){console.error("Error loading chord for editing:",$)}finally{R(!1)}})():a||(o(""),h(1),b(5),u(6),y(i),L(0),O([]),K([]),P(new Set),I(new Set),re(!1),ie(!1))},[a,t,i]),U.useEffect(()=>{if(window.svguitar)fe();else{const V=document.createElement("script");V.src="/static/js/svguitar.es5.js",V.async=!0,V.onload=()=>{fe()},document.body.appendChild(V)}return()=>{we.current&&we.current.svg&&(we.current.svg.removeEventListener("click",we.current.clickHandler),we.current.svg.removeEventListener("mousedown",we.current.mousedownHandler))}},[]);const fe=()=>{try{Ae.current=new window.svguitar.SVGuitarChord("#editor-chart"),te.current=new window.svguitar.SVGuitarChord("#result-chart"),T(),Se()}catch(V){console.error("Error initializing charts:",V)}},we=U.useRef(null),Se=()=>{if(!C.current)return;const V=C.current.querySelector("svg");if(!V)return;we.current&&we.current.svg&&(we.current.svg.removeEventListener("click",we.current.clickHandler),we.current.svg.removeEventListener("mousedown",we.current.mousedownHandler));const $=M=>{if(M.detail>1)return M.preventDefault(),M.stopPropagation(),!1;M.preventDefault()},z=M=>{M.stopPropagation(),M.preventDefault(),Ce(M)};V.style.userSelect="none",V.style.webkitUserSelect="none",V.style.mozUserSelect="none",V.style.msUserSelect="none",V.addEventListener("mousedown",$),V.addEventListener("click",z),we.current={svg:V,clickHandler:z,mousedownHandler:$}},Ce=V=>{if(!V||!V.currentTarget){console.error("handleEditorClick called with invalid event");return}const $=G.current;if($!=="dots"&&$!=="fingers"&&$!=="barres")return;const z=V.currentTarget,M=z.getBoundingClientRect(),ue=V.clientX-M.left,pe=V.clientY-M.top,ce=z.viewBox.baseVal;if(!ce||ce.width===0||ce.height===0||M.width===0||M.height===0)return;const Le=ce.width/M.width,Ie=ce.height/M.height;if(!isFinite(Le)||!isFinite(Ie)){console.error("Invalid scale values:",{scaleX:Le,scaleY:Ie});return}const Te=ue*Le,Ve=pe*Ie,ht=ce.width,st=ce.height,ot=ht*.15,yt=st*.08,dt=ht-ot*2,Vt=st-yt*2;if(Te<ot||Te>ht-ot)return;const Lt=(Te-ot)/dt,zt=Math.floor(Lt*m);if(zt<0||zt>=m)return;const Et=m-zt;if(Ve<yt){Me(Et);return}if(Ve>st-yt)return;const wt=Ve-yt,Kt=wt/Vt,Nt=Math.ceil(Kt*p);console.log("Click debug:",{rawX:ue,rawY:pe,x:Te,y:Ve,svguitarString:Et,fretIndex:Nt,marginX:ot,marginY:yt,fretRatio:Kt,relativeY:wt,fretboardHeight:Vt}),!(Nt<1||Nt>p)&&($==="dots"?Re(Et,Nt):$==="fingers"?je(Et,Nt):$==="barres"&&Je(Et,Nt))},Re=(V,$)=>{P(z=>{const M=new Set(z);return M.delete(V),M}),I(z=>{const M=new Set(z);return M.delete(V),M}),O(z=>{const M=z.findIndex(ue=>{const[pe,ce]=ue;return pe===V&&ce===$});return M>=0?z.filter((pe,ce)=>ce!==M):[...z,[V,$,void 0]]})},Me=V=>{const $=H.has(V),z=Y.has(V);O(M=>M.filter(([ue])=>ue!==V)),!$&&!z?P(M=>new Set([...M,V])):$?(P(M=>{const ue=new Set(M);return ue.delete(V),ue}),I(M=>new Set([...M,V]))):z&&I(M=>{const ue=new Set(M);return ue.delete(V),ue})},Je=(V,$)=>{K(z=>{const M=z.findIndex(ue=>ue.fret===$);if(M>=0)return z.filter((pe,ce)=>ce!==M);{const ue={fromString:6,toString:1,fret:$,text:"1"};return[...z,ue]}})},je=(V,$)=>{E.findIndex(M=>{const[ue,pe]=M;return ue===V&&pe===$})===-1?(P(M=>{const ue=new Set(M);return ue.delete(V),ue}),I(M=>{const ue=new Set(M);return ue.delete(V),ue}),O(M=>[...M,[V,$,void 0]]),le([V,$])):le([V,$])},j=(V,$,z)=>{O(M=>M.map(ue=>{const[pe,ce,Le]=ue;return pe===V&&ce===$?[pe,ce,z]:ue.length===3?ue:[pe,ce,Le]}))},T=()=>{if(!Ae.current||!te.current)return;const V=document.querySelector("#editor-chart"),$=document.querySelector("#result-chart");if(!(!V||!$))try{const z={...z0,strings:m,frets:p,position:d,tuning:[]},pe={fingers:[...E.map(Ie=>{const[Te,Ve,ht]=Ie;return ht&&ht!=="undefined"?[Te,Ve,ht]:[Te,Ve]}),...Array.from(H).map(Ie=>[Ie,0]),...Array.from(Y).map(Ie=>[Ie,"x"])],barres:X},ce=JSON.stringify({chordData:pe,title:c});ce!==Z.current&&(Z.current=ce,Ae.current.configure(z).chord(pe).draw(),te.current.configure({...z,title:c}).chord(pe).draw()),setTimeout(()=>{const Ie=document.querySelector("#editor-chart svg"),Te=document.querySelector("#result-chart svg");Ie&&(Ie.style.width="100%",Ie.style.height="100%",Ie.style.maxWidth="128px",Ie.style.maxHeight="180px"),Te&&(Te.style.width="100%",Te.style.height="100%",Te.style.maxWidth="128px",Te.style.maxHeight="180px"),Se()},100)}catch(z){console.error("Error updating charts:",z)}};return U.useEffect(()=>{T()},[c,d,p,m,E,X,_,H,Y]),U.useEffect(()=>{const V=$=>{if(w!=="fingers"||!ve)return;const z=$.key;if(["1","2","3","4","5"].includes(z)){const[M,ue]=ve;j(M,ue,z),le(null),$.preventDefault()}else z==="Escape"&&(le(null),$.preventDefault())};if(w==="fingers")return document.addEventListener("keydown",V),()=>document.removeEventListener("keydown",V)},[w,ve]),n.jsx("div",{className:"bg-gray-800 rounded-lg p-4",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-blue-400 mb-1",children:"Chord name"}),n.jsxs("div",{className:"relative",children:[n.jsx(Rr,{value:c,onChange:V=>o(V.target.value),onBlur:()=>Q(c),onKeyDown:V=>{V.key==="Enter"&&!V.shiftKey&&(V.preventDefault(),Q(c))},placeholder:"Enter chord name (e.g. Am, C7) then hit 'Enter'",className:"bg-gray-900",disabled:S}),S&&n.jsxs("div",{className:"absolute right-2 top-2 text-yellow-400 text-xs",role:"status","aria-live":"polite",children:[n.jsx("span",{className:"sr-only",children:"Loading chord data"}),n.jsx("span",{"aria-hidden":"true",children:"Loading..."})]})]})]}),n.jsx("div",{className:"text-sm text-blue-400 hover:underline cursor-pointer",onClick:()=>re(!N),children:N?"Hide advanced settings...":"Show more settings..."}),N&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-white mb-1",children:"Tuning"}),n.jsx(Rr,{value:_,onChange:V=>y(V.target.value),placeholder:"EADGBE",className:"bg-gray-900"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-white mb-1",children:"Capo"}),n.jsx(Rr,{type:"number",min:"0",max:"12",value:A,onChange:V=>L(parseInt(V.target.value)||0),className:"bg-gray-900"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-white mb-1",children:"Starting fret"}),n.jsx(Rr,{type:"number",min:"1",max:"15",value:d,onChange:V=>h(parseInt(V.target.value)||1),className:"bg-gray-900"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-white mb-1",children:"Number of frets"}),n.jsx(Rr,{type:"number",min:"1",max:"10",value:p,onChange:V=>b(parseInt(V.target.value)||5),className:"bg-gray-900"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm text-white mb-1",children:"Number of strings"}),n.jsx(Rr,{type:"number",min:"4",max:"12",value:m,onChange:V=>u(parseInt(V.target.value)||6),className:"bg-gray-900"})]})]})]}),n.jsxs("div",{className:"flex gap-8 justify-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-lg text-white mb-2",children:"Editor"}),n.jsx("div",{className:"border border-gray-700 rounded-lg px-1 pt-1 pb-0",children:n.jsx("div",{className:"relative w-32 mx-auto flex items-center justify-center overflow-hidden select-none",style:{height:"184px"},children:n.jsx("div",{id:"editor-chart",ref:C,className:"cursor-pointer select-none"})})})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-lg text-white mb-2",children:"Result"}),n.jsx("div",{className:"border border-gray-700 rounded-lg px-1 pt-1 pb-0",children:n.jsx("div",{className:"relative w-32 mx-auto flex items-center justify-center overflow-hidden select-none",style:{height:"184px"},children:n.jsx("div",{id:"result-chart",className:"select-none"})})})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(Be,{variant:w==="dots"?"default":"outline",onClick:()=>x("dots"),className:`flex-1 ${w==="dots"?"bg-blue-700 hover:bg-blue-800 text-white":"bg-black hover:bg-gray-800 text-gray-300 border border-gray-600"}`,"data-ph-capture-attribute-button":"chord-editor-dots-mode",children:"Edit dots"}),n.jsx(Be,{variant:w==="fingers"?"default":"outline",onClick:()=>{x("fingers")},className:`flex-1 ${w==="fingers"?"!bg-blue-800 hover:!bg-blue-900 !text-white !border !border-blue-600":"!bg-black hover:!bg-gray-800 !text-gray-300 !border !border-gray-600"}`,"data-ph-capture-attribute-button":"chord-editor-fingers-mode",children:"Edit fingers"}),n.jsx(Be,{variant:w==="barres"?"default":"outline",onClick:()=>x("barres"),className:`flex-1 ${w==="barres"?"!bg-green-700 hover:!bg-green-800 !text-white !border !border-green-600":"!bg-black hover:!bg-gray-800 !text-gray-300 !border !border-gray-600"}`,"data-ph-capture-attribute-button":"chord-editor-barres-mode",children:"Edit barres"})]}),w==="dots"&&n.jsx("div",{className:"bg-gray-700 bg-opacity-50 border border-gray-600 rounded-lg p-3 text-sm text-gray-200",children:"Click on a string above the fret where you want to add a dot"}),w==="barres"&&n.jsx("div",{className:"bg-green-900 bg-opacity-50 border border-green-600 rounded-lg p-3 text-sm text-green-200",children:"Click on any fret to add/remove a full barre across all strings at that fret. Perfect for chords like F, B, F#m, etc."}),w==="fingers"&&n.jsxs("div",{className:"bg-blue-900 bg-opacity-50 border border-blue-600 rounded-lg p-3 text-sm text-blue-200",children:["Click on a finger position, then press 1-5 keys to assign finger numbers (5 = thumb). Press Escape to cancel selection.",ve&&n.jsxs("div",{className:"mt-2 text-yellow-300",children:["Selected position: String ",ve[0],", Fret ",ve[1]," - Press 1, 2, 3, 4, or 5"]})]}),n.jsxs("div",{className:"flex items-center space-x-2 bg-gray-700 rounded-lg p-3",children:[n.jsx("input",{type:"checkbox",id:"addLineBreak",checked:oe,onChange:V=>ie(V.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-900 border-gray-600 rounded focus:ring-blue-500 focus:ring-2"}),n.jsx("label",{htmlFor:"addLineBreak",className:"text-sm text-gray-300 cursor-pointer",children:"Line break after â†©ï¸"})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(Be,{onClick:()=>{const V={title:c,startingFret:d,numFrets:p,numStrings:m,tuning:_,capo:A,fingers:E,barres:X,openStrings:Array.from(H),mutedStrings:Array.from(Y),startOnNewLine:oe,editingChordId:a,insertionContext:s};console.log("Saving chord with line break data:",{title:c,addLineBreak:oe,startOnNewLine:oe,editingChordId:a}),r(V)},className:`flex-1 ${c.trim()?"bg-blue-600 hover:bg-blue-700 text-white":"bg-gray-600 text-gray-400 cursor-not-allowed"}`,disabled:!c.trim(),"data-ph-capture-attribute-button":a?"chord-editor-update":"chord-editor-save",children:a?"Update chord chart":"Add chord chart"}),e&&n.jsx(Be,{onClick:e,variant:"outline",className:"flex-1 border-gray-600 text-gray-300 hover:bg-gray-700","data-ph-capture-attribute-button":"chord-editor-cancel",children:"Cancel"})]})]})})},Hc="gpra_rate_limit_backoff",q0=15,$0=120,Rh=()=>{try{const t=localStorage.getItem(Hc);if(t){const r=JSON.parse(t);return Date.now()-r.timestamp>300*1e3?0:r.level||0}}catch(t){console.warn("Error reading backoff level:",t)}return 0},W0=()=>{try{const t=Rh(),r=Math.min(t+1,3);return localStorage.setItem(Hc,JSON.stringify({level:r,timestamp:Date.now()})),r}catch(t){return console.warn("Error saving backoff level:",t),0}},ri=()=>{try{localStorage.removeItem(Hc)}catch(t){console.warn("Error resetting backoff:",t)}},H0=t=>Math.min(q0*Math.pow(2,t),$0),Bh=({isOpen:t,onClose:r,error:e})=>{const[a,s]=U.useState(0),[i,c]=U.useState(!1),[o,d]=U.useState(null),h=u=>{const x=((u==null?void 0:u.message)||u||"").toLowerCase();return x.includes("529")||x.includes("overloaded")?{type:"overload",title:"API Temporarily Overloaded",message:"The AI servers are experiencing high traffic right now.",waitTime:30,icon:n.jsx(Hr,{className:"h-6 w-6 text-yellow-500 animate-spin"})}:x.includes("429")||x.includes("rate limit")?{type:"rate_limit",title:"Oops!",message:null,waitTime:null,icon:n.jsx(Hl,{className:"h-6 w-6 text-orange-500"})}:x.includes("500")||x.includes("502")||x.includes("503")?{type:"server_error",title:"Server Error",message:"The server is experiencing issues. Let's try again in a moment.",waitTime:45,icon:n.jsx(Rn,{className:"h-6 w-6 text-red-500"})}:x.includes("timeout")?{type:"timeout",title:"Request Timeout",message:"The analysis took too long. This might work better with smaller files.",waitTime:15,icon:n.jsx(Hl,{className:"h-6 w-6 text-blue-500"})}:{type:"generic",title:"Oops!",message:(u==null?void 0:u.message)||u||"An unexpected error occurred.",waitTime:10,icon:n.jsx(Rn,{className:"h-6 w-6 text-gray-500"})}};U.useEffect(()=>{if(t&&e){const u=h(e);let w=u.waitTime;if(u.type==="rate_limit"){const y=Rh();w=H0(y),W0()}const x={...u,waitTime:w};d(x),s(w),c(!1);const _=setInterval(()=>{s(y=>y<=1?(c(!0),clearInterval(_),0):y-1)},1e3);return()=>clearInterval(_)}},[t,e]);const p=u=>{if(u<60)return`${u}s`;const w=Math.floor(u/60),x=u%60;return`${w}m ${x}s`},b=()=>{c(!1),s(0),r()};return!t||!e||!o?null:(e==null?void 0:e.requiresApiKey)||!1?n.jsx(gs,{open:t,onOpenChange:u=>!u&&r(),children:n.jsxs(Jn,{className:"sm:max-w-md",children:[n.jsxs(Zn,{children:[n.jsxs(Xn,{className:"flex items-center gap-2",children:[n.jsx(A0,{className:"h-6 w-6 text-orange-500"}),"API Key Required"]}),n.jsxs(xs,{className:"text-left space-y-3",children:[n.jsx("p",{children:e.message}),n.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg",children:n.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:"Add your Anthropic API key in Account Settings to use the autocreate feature."})})]})]}),n.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[n.jsx(Be,{variant:"outline",onClick:r,children:"Cancel"}),n.jsx(Be,{onClick:()=>{r(),window.location.href="#Account"},className:"bg-orange-600 hover:bg-orange-700",children:"Go to Account Settings"})]})]})}):n.jsx(gs,{open:t,onOpenChange:u=>u||b(),children:n.jsxs(Jn,{className:"sm:max-w-md",children:[n.jsxs(Zn,{children:[n.jsxs(Xn,{className:"flex items-center gap-2",children:[o.icon,o.title]}),n.jsxs(xs,{className:"text-left space-y-3",children:[o.type==="rate_limit"?n.jsxs("p",{children:["We've hit Anthropic's rate limit"," ",n.jsx("a",{href:"/faq?expand=autocreate-limits",onClick:u=>{u.preventDefault(),u.stopPropagation(),window.open("/faq?expand=autocreate-limits","_blank")},className:"text-blue-500 hover:text-blue-400 underline",children:"(more info)"})]}):n.jsx("p",{children:o.message}),a>0?n.jsxs("div",{className:"bg-gray-100 dark:bg-gray-800 p-3 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[n.jsx(Hl,{className:"h-4 w-4 text-gray-500"}),n.jsxs("span",{children:["Please wait ",p(a)," before trying again"]})]}),n.jsx("div",{className:"w-full bg-gray-300 dark:bg-gray-600 rounded-full h-2 mt-2",children:n.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-1000",style:{width:`${(o.waitTime-a)/o.waitTime*100}%`}})})]}):n.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 p-3 rounded-lg",children:n.jsx("p",{className:"text-sm text-green-700 dark:text-green-300",children:"Ready to try again!"})})]})]}),n.jsx("div",{className:"flex justify-end gap-2 mt-4",children:n.jsx(Be,{onClick:b,disabled:!i,className:"min-w-20",children:i?"OK":`Wait ${p(a)}`})})]})})},vc=({isOpen:t,onClose:r,autocreateData:e})=>{if(!t||!e)return null;const{itemName:a,chordCount:s,contentType:i,uploadedFileNames:c,isVisionAnalysis:o=!1}=e,d=o||i==="chord_charts"||i==="auto-detected",h=()=>d?n.jsx(O0,{className:"h-6 w-6 text-yellow-500"}):n.jsx(Mc,{className:"h-6 w-6 text-green-500"}),p=()=>d?"ðŸŽ¸ Vision Analysis Complete!":"Chord charts created",b=()=>n.jsxs("div",{className:"space-y-1",children:[n.jsx("p",{className:"font-medium",children:"Success! Or close to it!"}),n.jsx("p",{children:"We did the best we could. You'll likely need to make a few corrections."}),n.jsx("p",{children:"Click the pencil icon on a chord chart to fix it."}),n.jsxs("p",{children:["Be sure to click the ",n.jsx("code",{className:"px-1 py-0.5 bg-gray-700 text-gray-300 rounded text-sm",children:'"Update chord chart"'})," button after edits"]})]}),m=()=>{const u=[],w={chord_charts:"Chord charts",chord_names:"Lyrics with chord names",tablature:"Guitar tablature",mixed:"Mixed content types","auto-detected":d?"Chord charts":"Mixed content",youtube_transcript:"YouTube transcript"};if(["YouTube transcript","Manual entry"].includes(c))u.push(c);else if(i&&w[i]&&u.push(w[i]),c){const y=c.split(", ").slice(0,3),A=c.split(", ").length-y.length;let L=y.join(", ");A>0&&(L+=` and ${A} more`),u.push(L)}return u};return n.jsx(gs,{open:t,onOpenChange:u=>!u&&r(),children:n.jsxs(Jn,{className:"sm:max-w-md",children:[n.jsxs(Zn,{children:[n.jsxs(Xn,{className:"flex items-center gap-2",children:[h(),p()]}),n.jsxs(xs,{className:"text-left space-y-1",children:[b(),n.jsxs("div",{className:"bg-gray-800 px-2 py-1 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-300 mb-1",children:[n.jsx(Ah,{className:"h-4 w-4"}),n.jsx("span",{children:"Details"})]}),n.jsx("ul",{className:"text-sm text-gray-400",children:m().map((u,w)=>n.jsxs("li",{className:"flex items-center gap-1",children:[n.jsx("span",{className:"w-1 h-1 bg-gray-400 rounded-full"}),u]},w))})]})]})]}),n.jsx("div",{className:"flex justify-end gap-2 -mt-2",children:n.jsx(Be,{onClick:r,variant:"outline",className:"min-w-20",children:"Show me"})})]})})};let ni=!1,Gc=0,ma=null;const Mh=3e4;let co=[],Ai=null;const G0=2e3,V0=10,Y0=()=>typeof window<"u"&&window.GPRA_DEBUG===!0,Ud=async()=>{if(co.length===0)return;const t=[...co];co=[],Ai=null;try{(await fetch("/api/debug/log",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:t.map(e=>`[${e.level}] ${e.message}`).join(`
`),level:"DEBUG",context:{batched:!0,count:t.length}})})).ok&&ni&&(ni=!1,Vc(),ma&&(clearInterval(ma),ma=null))}catch{ni||(ni=!0,Gc=Date.now(),X0(),Q0())}},bo=async(t,r="DEBUG",e={})=>{if(Y0()&&!(ni&&Date.now()-Gc<Mh)){if(co.push({message:t,level:r,context:e}),co.length>=V0){Ai&&(clearTimeout(Ai),Ai=null),Ud();return}Ai||(Ai=setTimeout(Ud,G0))}},K0=console.log,J0=console.error,Z0=console.warn;function X0(){Vc();const t=document.createElement("div");t.id="connection-status-modal",t.style.cssText=`
    position: fixed;
    top: 20px;
    right: 20px;
    background: #ef4444;
    color: white;
    padding: 16px 20px;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    z-index: 10000;
    max-width: 400px;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    font-size: 14px;
    line-height: 1.4;
  `,t.innerHTML=`
    <div style="font-weight: 600; margin-bottom: 8px;">Broken string</div>
    <div>...metaphorically speaking, anyway.<br><br>Something's wrong with the connection to the server. Could be your connection, could be a server problem, can't tell from here.<br><br>We'll try again in 30 seconds. Or you can try refreshing the page in a minute or two.<br><br>If the problem continues practice your favorite riff for awhile, or go touch grass, then come back later.</div>
  `,document.body.appendChild(t)}function Vc(){const t=document.getElementById("connection-status-modal");t&&t.remove()}function Q0(){ma||(ma=setInterval(async()=>{if(!ni){clearInterval(ma),ma=null;return}try{(await fetch("/api/debug/log",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:"reconnection-test",level:"DEBUG",context:{}})})).ok&&(ni=!1,Vc(),clearInterval(ma),ma=null)}catch{Gc=Date.now()}},Mh))}console.log=function(...t){K0.apply(console,t),bo(t.join(" "),"INFO",{}).catch(()=>{})};console.error=function(...t){J0.apply(console,t),bo(t.join(" "),"ERROR",{}).catch(()=>{})};console.warn=function(...t){Z0.apply(console,t),bo(t.join(" "),"WARNING",{}).catch(()=>{})};const Qr=(t,r)=>bo(t,"DEBUG",r),zd=(t,r)=>bo(t,"INFO",r);var em=Symbol("radix.slottable");function tm(t){const r=({children:e})=>n.jsx(n.Fragment,{children:e});return r.displayName=`${t}.Slottable`,r.__radixId=em,r}var Uh="AlertDialog",[rm]=a0(Uh,[yh]),ya=yh(),zh=t=>{const{__scopeAlertDialog:r,...e}=t,a=ya(r);return n.jsx(gh,{...a,...e,modal:!0})};zh.displayName=Uh;var nm="AlertDialogTrigger",sm=U.forwardRef((t,r)=>{const{__scopeAlertDialog:e,...a}=t,s=ya(e);return n.jsx(i0,{...s,...a,ref:r})});sm.displayName=nm;var am="AlertDialogPortal",qh=t=>{const{__scopeAlertDialog:r,...e}=t,a=ya(r);return n.jsx(mh,{...a,...e})};qh.displayName=am;var im="AlertDialogOverlay",$h=U.forwardRef((t,r)=>{const{__scopeAlertDialog:e,...a}=t,s=ya(e);return n.jsx(Fc,{...s,...a,ref:r})});$h.displayName=im;var Fi="AlertDialogContent",[om,lm]=rm(Fi),cm=tm("AlertDialogContent"),Wh=U.forwardRef((t,r)=>{const{__scopeAlertDialog:e,children:a,...s}=t,i=ya(e),c=U.useRef(null),o=xh(r,c),d=U.useRef(null);return n.jsx(n0,{contentName:Fi,titleName:Hh,docsSlug:"alert-dialog",children:n.jsx(om,{scope:e,cancelRef:d,children:n.jsxs(Oc,{role:"alertdialog",...i,...s,ref:o,onOpenAutoFocus:s0(s.onOpenAutoFocus,h=>{var p;h.preventDefault(),(p=d.current)==null||p.focus({preventScroll:!0})}),onPointerDownOutside:h=>h.preventDefault(),onInteractOutside:h=>h.preventDefault(),children:[n.jsx(cm,{children:a}),n.jsx(um,{contentRef:c})]})})})});Wh.displayName=Fi;var Hh="AlertDialogTitle",Gh=U.forwardRef((t,r)=>{const{__scopeAlertDialog:e,...a}=t,s=ya(e);return n.jsx(Rc,{...s,...a,ref:r})});Gh.displayName=Hh;var Vh="AlertDialogDescription",Yh=U.forwardRef((t,r)=>{const{__scopeAlertDialog:e,...a}=t,s=ya(e);return n.jsx(Bc,{...s,...a,ref:r})});Yh.displayName=Vh;var dm="AlertDialogAction",Kh=U.forwardRef((t,r)=>{const{__scopeAlertDialog:e,...a}=t,s=ya(e);return n.jsx(Dc,{...s,...a,ref:r})});Kh.displayName=dm;var Jh="AlertDialogCancel",Zh=U.forwardRef((t,r)=>{const{__scopeAlertDialog:e,...a}=t,{cancelRef:s}=lm(Jh,e),i=ya(e),c=xh(r,s);return n.jsx(Dc,{...i,...a,ref:c})});Zh.displayName=Jh;var um=({contentRef:t})=>{const r=`\`${Fi}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Fi}\` by passing a \`${Vh}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Fi}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return U.useEffect(()=>{var a;document.getElementById((a=t.current)==null?void 0:a.getAttribute("aria-describedby"))||console.warn(r)},[r,t]),null},hm=zh,fm=qh,Xh=$h,Qh=Wh,ef=Kh,tf=Zh,rf=Gh,nf=Yh;const Xs=hm,pm=fm,sf=U.forwardRef(({className:t,...r},e)=>n.jsx(Xh,{className:zr("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r,ref:e}));sf.displayName=Xh.displayName;const Os=U.forwardRef(({className:t,...r},e)=>n.jsxs(pm,{children:[n.jsx(sf,{}),n.jsx(Qh,{ref:e,className:zr("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r})]}));Os.displayName=Qh.displayName;const Ds=({className:t,...r})=>n.jsx("div",{className:zr("flex flex-col space-y-2 text-center sm:text-left",t),...r});Ds.displayName="AlertDialogHeader";const Rs=({className:t,...r})=>n.jsx("div",{className:zr("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...r});Rs.displayName="AlertDialogFooter";const Bs=U.forwardRef(({className:t,...r},e)=>n.jsx(rf,{ref:e,className:zr("text-lg font-semibold",t),...r}));Bs.displayName=rf.displayName;const Ms=U.forwardRef(({className:t,...r},e)=>n.jsx(nf,{ref:e,className:zr("text-sm text-muted-foreground",t),...r}));Ms.displayName=nf.displayName;const js=U.forwardRef(({className:t,...r},e)=>n.jsx(ef,{ref:e,className:zr("inline-flex h-10 items-center justify-center rounded-md bg-primary px-4 py-2 text-sm font-semibold text-primary-foreground ring-offset-background transition-colors hover:bg-primary/90 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",t),...r}));js.displayName=ef.displayName;const xa=U.forwardRef(({className:t,...r},e)=>n.jsx(tf,{ref:e,className:zr("mt-2 inline-flex h-10 items-center justify-center rounded-md border border-input bg-background px-4 py-2 text-sm font-semibold ring-offset-background transition-colors hover:bg-accent hover:text-accent-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 sm:mt-0",t),...r}));xa.displayName=tf.displayName;const mm=(t,r)=>{let e;return function(...s){const i=()=>{clearTimeout(e),t(...s)};clearTimeout(e),e=setTimeout(i,r)}},ml=t=>t.replace(/[''`"]/g,"'").replace(/[â€“â€”âˆ’]/g,"-").replace(/\s+/g," ").trim().toLowerCase(),qd=t=>t.replace(/\s*\([^)]*\)\s*/g,"").trim(),$d=(t,r,e)=>{const a=qd(t),s=ml(a);return console.log("DEBUG: findSimilarSongs - sourceTitle:",t,"-> baseName:",a,"-> normalized:",s),r.filter(i=>{if(i.B===e)return!1;const c=i.C||"",o=qd(c),d=ml(o);return s===d||s.length>3&&d.includes(s)||d.length>3&&s.includes(d)})},gm=U.memo(({chart:t,onEdit:r,onDelete:e,onInsertAfter:a})=>{const[s,i]=U.useState(!1),c=U.useRef(null),o=U.useRef(null);U.useEffect(()=>{const u=w=>{c.current&&!c.current.contains(w.target)&&i(!1)};if(s)return document.addEventListener("mousedown",u),()=>document.removeEventListener("mousedown",u)},[s]),U.useEffect(()=>{if(!o.current)return;(()=>{if(!(!window.svguitar||!o.current))try{const w=t.chordData||t;o.current.innerHTML="";const x=new window.svguitar.SVGuitarChord(o.current),_={strings:w.numStrings||6,frets:w.numFrets||5,position:w.startingFret||1,tuning:[],width:128,height:176,fretSize:1.2,fingerSize:.75,sidePadding:.2,fontFamily:"Arial",color:"#ffffff",backgroundColor:"transparent",strokeColor:"#ffffff",textColor:"#ffffff",fretLabelColor:"#ffffff",fingerTextColor:"#000000",fingerTextSize:28},L={fingers:[...(w.fingers||[]).map(E=>{const[O,X,K]=E;return K&&K!=="undefined"?[O,X,K]:[O,X]}),...(w.openStrings||[]).map(E=>[E,0]),...(w.mutedStrings||[]).map(E=>[E,"x"])],barres:w.barres||[]};x.configure(_).chord(L).draw(),setTimeout(()=>{var O;const E=(O=o.current)==null?void 0:O.querySelector("svg");E&&(E.style.width="100%",E.style.height="100%",E.style.maxWidth="128px",E.style.maxHeight="180px",E.style.position="relative",E.style.zIndex="1")},50)}catch(w){console.error("Error rendering memoized chord chart:",w)}})()},[t]);const d=u=>{u.preventDefault(),u.stopPropagation(),i(!1),r(t.id,{title:t.title,...t,sectionId:t.sectionId,sectionLabel:t.sectionLabel,sectionRepeatCount:t.sectionRepeatCount})},h=u=>{u.preventDefault(),u.stopPropagation(),i(!1),e(t.id)},p=u=>{u.preventDefault(),u.stopPropagation(),i(!1),a(t.id,{sectionId:t.sectionId,sectionLabel:t.sectionLabel,sectionRepeatCount:t.sectionRepeatCount})},b=u=>{u.preventDefault(),u.stopPropagation(),i(!1);const w={fingers:t.fingers||[],barres:t.barres||[],tuning:t.tuning||"EADGBE",capo:t.capo||0,startingFret:t.startingFret||1,numFrets:t.numFrets||5,numStrings:t.numStrings||6,openStrings:t.openStrings||[],mutedStrings:t.mutedStrings||[],sectionId:t.sectionId||"",sectionLabel:t.sectionLabel||"",sectionRepeatCount:t.sectionRepeatCount||"",hasLineBreakAfter:!t.hasLineBreakAfter};r(t.id,{title:t.title,chord_data:w,sectionId:t.sectionId,sectionLabel:t.sectionLabel,sectionRepeatCount:t.sectionRepeatCount})},m=u=>{u.preventDefault(),u.stopPropagation(),i(!s)};return n.jsxs("div",{className:"relative mx-auto",style:{maxWidth:"144px"},children:[n.jsxs("div",{className:"bg-gray-800 p-1 rounded-lg cursor-pointer relative group",onClick:m,style:{minWidth:"0",maxWidth:"100%",width:"100%",position:"relative"},children:[n.jsx("button",{className:"absolute top-1 right-1 bg-gray-700 text-gray-300 rounded-full w-6 h-6 flex items-center justify-center text-xs opacity-0 group-hover:opacity-100 transition-opacity z-10",onClick:m,"aria-label":"Chord chart menu","data-ph-capture-attribute-button":"chord-chart-menu",children:"â‹®"}),n.jsx("div",{className:"relative w-32 mx-auto flex items-center justify-center overflow-hidden",style:{height:"184px"},children:n.jsx("div",{ref:o,className:"w-full h-full"})}),n.jsx("div",{className:"text-center text-white text-sm font-semibold mt-2",children:t.title}),t.hasLineBreakAfter&&n.jsx("div",{className:"absolute -bottom-1 -right-1 bg-blue-500 text-white rounded-full w-4 h-4 flex items-center justify-center text-xs",children:"â†µ"})]}),s&&n.jsxs("div",{ref:c,className:"absolute top-8 right-0 bg-gray-700 border border-gray-600 rounded-lg shadow-lg z-20 min-w-48",children:[n.jsx("button",{onClick:d,className:"w-full text-left px-4 py-2 text-gray-200 hover:bg-gray-600 rounded-t-lg flex items-center","data-ph-capture-attribute-button":"modal-edit-chord",children:"âœï¸ Edit chord"}),n.jsx("button",{onClick:p,className:"w-full text-left px-4 py-2 text-gray-200 hover:bg-gray-600 flex items-center","data-ph-capture-attribute-button":"modal-insert-chord-after",children:"âž• Insert chord after"}),n.jsx("button",{onClick:b,className:"w-full text-left px-4 py-2 text-gray-200 hover:bg-gray-600 flex items-center","data-ph-capture-attribute-button":"modal-toggle-line-break",children:t.hasLineBreakAfter?"â†©ï¸ Remove line break":"â†µ Add line break after"}),n.jsx("button",{onClick:h,className:"w-full text-left px-4 py-2 text-red-400 hover:bg-gray-600 rounded-b-lg flex items-center","data-ph-capture-attribute-button":"modal-delete-chord",children:"ðŸ—‘ï¸ Delete chord"})]})]})});function af({isOpen:t,onClose:r,itemId:e,itemTitle:a}){var Kr;const{items:s}=Oh(),[i,c]=U.useState({}),[o,d]=U.useState({}),[h,p]=U.useState({}),[b,m]=U.useState(null),[u,w]=U.useState(null),[x,_]=U.useState({}),[y,A]=U.useState(new Set),[L,E]=U.useState(!1),[O,X]=U.useState(null),[K,H]=U.useState(""),[P,Y]=U.useState(new Set),[I,S]=U.useState(new Set),[R,N]=U.useState(!1),[re,ve]=U.useState(null),[le,oe]=U.useState({}),[ie,Ae]=U.useState({}),[te,C]=U.useState({}),[G,Z]=U.useState({}),[Q,fe]=U.useState({}),[we,Se]=U.useState({}),[Ce,Re]=U.useState({}),[Me,Je]=U.useState({}),je=["âœ¨ Claude is making magic happen","âœ¨ Claude is *still* making magic happen","Yeah, we all love instant gratification, but it'll still be quicker than you could do it from scratch","Are you familiar with the phrase 'A watched pot never boils'? It's kinda like that","Chill, I'm working on it.","You could be stretching or something while you wait, couldn't you?","The pyramids weren't built in a day... ","but hey, at least I'm not going to ask you for an email address to send the chord charts to.","Perfect chord charts take time to craft. These will take less time and they won't be perfect.","Yeah, I could show you a progress bar, but we both know it would just lie to you"],[j,T]=U.useState(0),[V,$]=U.useState([]),[z,M]=U.useState(!1),[ue,pe]=U.useState(null),[ce,Le]=U.useState(!1),[Ie,Te]=U.useState(null),[Ve,ht]=U.useState(!1),[st,ot]=U.useState(null),[yt,dt]=U.useState(!1),[Vt,mt]=U.useState(null),Lt=U.useCallback(xe=>xe===e?{C:a,B:e,E:5}:null,[e,a]);U.useEffect(()=>{if(!window.svguitar){const xe=document.createElement("script");xe.src="https://omnibrain.github.io/svguitar/js/svguitar.umd.js",xe.async=!0,document.body.appendChild(xe)}},[]),U.useEffect(()=>{t&&e&&zt(e)},[t,e]),U.useEffect(()=>{if(Object.values(ie).filter(at=>at==="processing").length===0){T(0),$([]);return}T(0);const We=Array.from({length:je.length-1},(at,tt)=>tt+1).sort(()=>Math.random()-.5);$(We);const Qe=setInterval(()=>{$(at=>{if(at.length===0){const rt=Array.from({length:je.length},(_t,$t)=>$t).sort(()=>Math.random()-.5),it=rt[0],At=rt.slice(1);return T(it),At}else{const tt=at[0],rt=at.slice(1);return T(tt),rt}})},1e4);return()=>clearInterval(Qe)},[ie,je]),U.useEffect(()=>{if(!L||P.size===0)return;const xe=new Set;P.forEach(ze=>{var at;const We=s==null?void 0:s.find(tt=>tt.A===ze),Qe=We==null?void 0:We.B;Qe&&((at=i[Qe])==null?void 0:at.length)>0&&xe.add(ze)}),S(xe)},[L,P,i,s]);const zt=async xe=>{try{const ze=await fetch(`/api/items/${xe}/chord-charts`);if(ze.ok){const We=await ze.json();c(at=>({...at,[xe]:We}));const Qe=Et(We);d(at=>({...at,[xe]:Qe}))}}catch(ze){console.error("Error loading chord charts:",ze)}},Et=xe=>{const ze=new Map;return xe.forEach(We=>{const Qe=We.sectionId||"default-section",at=We.sectionLabel||"Section",tt=We.sectionRepeatCount||"";ze.has(Qe)||ze.set(Qe,{id:Qe,label:at,repeatCount:tt,chords:[]}),ze.get(Qe).chords.push(We)}),Array.from(ze.values())},wt=xe=>{const ze=i[xe]||[];return Et(ze)},Kt=U.useMemo(()=>{if(!O||!s)return new Set;const xe=s.find(Qe=>Qe.B===O),ze=(xe==null?void 0:xe.C)||"",We=s.filter(Qe=>Qe.B!==O);return new Set($d(ze,We,O).map(Qe=>Qe.A))},[O,s]),Nt=U.useMemo(()=>s?s.filter(xe=>{if(xe.B===O)return!1;if(K.trim()){const ze=xe.C||"",We=ml(ze),Qe=ml(K);return Qe?We.includes(Qe):!0}return!0}).sort((xe,ze)=>{if(K.trim()){const rt=xe.C||"",it=ze.C||"";return rt.localeCompare(it)}const We=Kt.has(xe.A),Qe=Kt.has(ze.A);if(We&&!Qe)return-1;if(!We&&Qe)return 1;const at=xe.C||"",tt=ze.C||"";return at.localeCompare(tt)}):[],[s,O,K,Kt]),Ft=U.useMemo(()=>mm(async(xe,ze,We)=>{try{console.log("Debounced section update:",{itemId:xe,sectionId:ze,updates:We});const at=(i[xe]||[]).filter(rt=>(rt.sectionId||"default-section")===ze);if(at.length===0){console.warn("No charts found for section:",ze);return}console.log("Updating section charts:",at.length);const tt=at.map(async rt=>{const it={fingers:rt.fingers||[],barres:rt.barres||[],tuning:rt.tuning||"EADGBE",capo:rt.capo||0,startingFret:rt.startingFret||1,numFrets:rt.numFrets||5,numStrings:rt.numStrings||6,openStrings:rt.openStrings||[],mutedStrings:rt.mutedStrings||[],hasLineBreakAfter:rt.hasLineBreakAfter||!1,sectionId:ze,sectionLabel:We.label!==void 0?We.label:rt.sectionLabel||"Section",sectionRepeatCount:We.repeatCount!==void 0?We.repeatCount:rt.sectionRepeatCount||""},At=await fetch(`/api/chord-charts/${rt.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:rt.title,chord_data:it})});if(!At.ok)throw new Error(`Failed to update chart ${rt.id}: ${At.statusText}`);return At.json()});await Promise.all(tt),console.log("All section charts updated successfully")}catch(Qe){console.error("Error updating section:",Qe)}},500),[i]),ar=(xe,ze,We)=>{console.log("Local section update:",{itemId:xe,sectionId:ze,updates:We}),d(Qe=>{const tt=(Qe[xe]||[]).map(rt=>rt.id===ze?{...rt,...We}:rt);return{...Qe,[xe]:tt}}),Ft(xe,ze,We)},Ot=async(xe,ze)=>{if(!y.has(ze)){A(We=>new Set(We).add(ze));try{const We=i[xe]||[],at=We.filter(rt=>(rt.sectionId||"default-section")===ze).map(rt=>fetch(`/api/items/${xe}/chord-charts/${rt.id}`,{method:"DELETE"}));await Promise.all(at);const tt=We.filter(rt=>(rt.sectionId||"default-section")!==ze);c(rt=>({...rt,[xe]:tt})),d(rt=>({...rt,[xe]:Et(tt)}))}catch(We){console.error("Error deleting section:",We)}finally{A(We=>{const Qe=new Set(We);return Qe.delete(ze),Qe})}}},xt=xe=>{const ze=`section-${Date.now()}`,We={id:ze,label:"New Section",repeatCount:"",chords:[]};d(Qe=>({...Qe,[xe]:[...Qe[xe]||[],We]})),_({itemId:xe,scrollPosition:window.scrollY}),p(Qe=>({...Qe,[xe]:!0})),w({sectionId:ze,sectionLabel:"New Section",sectionRepeatCount:""})},Xt=(xe,ze,We)=>{m(ze),w(null),_({itemId:xe,chordId:ze,scrollPosition:window.scrollY}),p(Qe=>({...Qe,[xe]:!0})),setTimeout(()=>{const Qe=document.querySelector(`[data-editor-for-item="${xe}"]`);Qe&&Qe.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})},100)},er=async(xe,ze)=>{try{if((await fetch(`/api/items/${xe}/chord-charts/${ze}`,{method:"DELETE"})).ok){c(at=>({...at,[xe]:(at[xe]||[]).filter(tt=>tt.id!==ze)}));const Qe=(i[xe]||[]).filter(at=>at.id!==ze);d(at=>({...at,[xe]:Et(Qe)})),Zs("chord_chart_deleted",{itemId:xe})}}catch(We){console.error("Error deleting chord chart:",We)}},Or=(xe,ze,We)=>{m(null),w({afterChordId:ze,sectionId:We.sectionId,sectionLabel:We.sectionLabel,sectionRepeatCount:We.sectionRepeatCount}),_({itemId:xe,scrollPosition:window.scrollY}),p(Qe=>({...Qe,[xe]:!0}))},bn=async(xe,ze)=>{try{Qr("handleSaveChordChart called",{editingChordId:b,chartData:ze});const We=!!b;Qr("isUpdate check result",{isUpdate:We,editingChordId:b});let Qe={...ze};if(We){const it=(i[xe]||[]).find(At=>At.id===b);Qe.sectionId=it==null?void 0:it.sectionId,Qe.sectionLabel=it==null?void 0:it.sectionLabel,Qe.sectionRepeatCount=it==null?void 0:it.sectionRepeatCount,Qr("Updating chord, preserving section",{originalSection:{id:it==null?void 0:it.sectionId,label:it==null?void 0:it.sectionLabel,repeatCount:it==null?void 0:it.sectionRepeatCount}})}else{const it=o[xe]||[];let At;u?At={id:u.sectionId,label:u.sectionLabel,repeatCount:u.sectionRepeatCount}:it.length===0?At={id:"section-1",label:"Verse",repeatCount:""}:At=it[it.length-1],Qe.sectionId=At.id,Qe.sectionLabel=At.label,Qe.sectionRepeatCount=At.repeatCount}Qe.hasLineBreakAfter=ze.startOnNewLine||!1,Qr("Setting line break after chord",{title:Qe.title,hasLineBreakAfter:Qe.hasLineBreakAfter}),Qr("Chord data with section metadata",{chartDataWithSection:Qe});const at=We?`/api/chord-charts/${b}`:`/api/items/${xe}/chord-charts`,tt=We?"PUT":"POST";Qr(`${We?"Updating":"Creating"} chord chart`,{method:tt,url:at});const rt=await fetch(at,{method:tt,headers:{"Content-Type":"application/json"},body:JSON.stringify(Qe)});if(!rt.ok)throw new Error(`Failed to save chord chart: ${rt.statusText}`);if(We){const it=await rt.json();c(_t=>({..._t,[xe]:(_t[xe]||[]).map($t=>$t.id===b?it:$t)}));const At=(i[xe]||[]).map(_t=>_t.id===b?it:_t);d(_t=>({..._t,[xe]:Et(At)})),Zs("chord_chart_updated",{itemId:xe})}else{const it=await rt.json();c(_t=>({..._t,[xe]:[..._t[xe]||[],it]}));const At=[...i[xe]||[],it];d(_t=>({..._t,[xe]:Et(At)})),Zs("chord_chart_created",{itemId:xe})}p(it=>({...it,[xe]:!1})),m(null),w(null)}catch(We){console.error("Error saving chord chart:",We)}},fn=()=>{x.itemId&&x.chordId&&setTimeout(()=>{const xe=document.querySelector(`[data-chord-id="${x.chordId}"]`);xe?xe.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"}):x.scrollPosition!==void 0&&window.scrollTo({top:x.scrollPosition,behavior:"smooth"}),_({})},100)},Ut=xe=>{if((i[xe]||[]).length===0)return;const We=window.open("","_blank");We.document.write(`
      <html>
        <head>
          <title>Chord Charts - ${a||xe}</title>
          <style>
            body { font-family: Arial, sans-serif; margin: 20px; }
            h1 { text-align: center; margin-bottom: 30px; }
            .section { margin-bottom: 40px; }
            .section-header { font-size: 18px; font-weight: bold; margin-bottom: 15px; }
            .chord-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 20px; margin-bottom: 20px; }
            .chord-item { text-align: center; }
            .chord-svg { margin-bottom: 5px; }
            .chord-title { font-weight: bold; }
            @media print { body { margin: 0; } }
          </style>
        </head>
        <body>
          <h2>Chord Charts - ${a||xe}</h2>
          ${wt(xe).map(Qe=>`
            <div class="section">
              <div class="section-header">${Qe.label} ${Qe.repeatCount}</div>
              <div class="chord-grid">
                ${Qe.chords.map(at=>`
                  <div class="chord-item">
                    <div class="chord-svg">${at.svg_content||""}</div>
                    <div class="chord-title">${at.title}</div>
                  </div>
                `).join("")}
              </div>
            </div>
          `).join("")}
        </body>
      </html>
    `),We.document.close(),We.print()},pn=(xe,ze)=>{if(!xe||xe.trim().length===0)return Se(rt=>({...rt,[ze]:null})),!0;const We=xe.trim();return/^[A-Za-z0-9#bâ™­â™¯/\s,\n\r-]+$/.test(We)?We.split(/[\n\r]+/).some(rt=>{const it=rt.trim();return it.length===0?!1:/^[A-Za-z]+$/.test(it)?!0:it.split(/[,\s]+/).filter($t=>$t.trim().length>0).every($t=>/^[A-Ga-g][A-Za-z0-9#bâ™­â™¯/]*$/.test($t))})?(Se(rt=>({...rt,[ze]:null})),!0):(Se(rt=>({...rt,[ze]:'Please enter chord names separated by commas, spaces, or section names (e.g., "C, G, Am, F" or "D A G D" or "Intro")'})),!1):(Se(rt=>({...rt,[ze]:"Only chord names (A-G), numbers, #, b, â™­, â™¯, /, commas, spaces, and section names are allowed"})),!1)},wn=(xe,ze)=>{if(!(!ze||ze.length===0)){if(ze.length>5){alert("Maximum 5 files allowed. Please select fewer files.");return}C(We=>({...We,[xe]:Array.from(ze)}))}},Vr=async xe=>{var at,tt;const ze=te[xe]||[],We=(at=G[xe])==null?void 0:at.trim(),Qe=(tt=Q[xe])==null?void 0:tt.trim();if(console.log(`[AUTOCREATE] handleProcessFiles called for item ${xe}, files:`,ze.length,"youtubeUrl:",We,"manualChords:",Qe),We){await gr(xe,We);return}if(Qe)if(pn(Qe,xe)){await qr(xe,Qe);return}else return;if(ze.length===0){alert("Please add at least one file, YouTube URL, or manual chord input before processing.");return}await Cr(xe,ze)},qr=async(xe,ze)=>{console.log(`[AUTOCREATE] Processing manual chord input for item ${xe}:`,ze),Ae(We=>({...We,[xe]:"processing"}));try{const We=new AbortController;Je(Yt=>({...Yt,[xe]:We}));const Qe=new Blob([ze],{type:"text/plain"}),at=new File([Qe],"manual-input.txt",{type:"text/plain"}),tt=new FormData;tt.append("file0",at),tt.append("itemId",xe),tt.append("userChoice","chord_names"),console.log("[AUTOCREATE] Sending manual input to autocreate endpoint");const rt=await fetch("/api/autocreate-chord-charts",{method:"POST",body:tt,signal:We.signal});if(!rt.ok){let Yt=`Failed to process manual input: ${rt.statusText}`;try{const gt=await rt.json();if(gt.error&&(Yt=gt.error),gt.requires_api_key){Ae(Wt=>{const ir={...Wt};return delete ir[xe],ir}),pe({message:Yt,requiresApiKey:!0}),M(!0);return}}catch(gt){console.warn("Could not parse error response:",gt)}throw new Error(Yt)}const it=await rt.json();console.log("[AUTOCREATE] Manual input processed successfully:",it);const _t=await(await fetch(`/api/items/${xe}/chord-charts`)).json();c(Yt=>({...Yt,[xe]:_t})),d(Yt=>({...Yt,[xe]:Et(_t)})),fe(Yt=>({...Yt,[xe]:""})),ri(),Ae(Yt=>({...Yt,[xe]:"complete"}));const $t=Lt(xe);Te({itemName:($t==null?void 0:$t.C)||`Item ${xe}`,chordCount:_t.length,contentType:"chord_names",uploadedFileNames:"Manual entry",isVisionAnalysis:!1}),Le(!0),Je(Yt=>{const gt={...Yt};return delete gt[xe],gt}),setTimeout(()=>{Ae(Yt=>({...Yt,[xe]:null})),oe(Yt=>({...Yt,[xe]:!1}))},2e3)}catch(We){console.error("Error processing manual chord input:",We),Ae(Qe=>({...Qe,[xe]:"error"})),Je(Qe=>{const at={...Qe};return delete at[xe],at}),setTimeout(()=>{Ae(Qe=>({...Qe,[xe]:null}))},3e3)}},gr=async(xe,ze)=>{console.log(`[YOUTUBE] Processing YouTube URL for item ${xe}:`,ze);const We=ze.trim().replace(/[<>"']/g,"");if(!/^https?:\/\/(www\.)?(youtube\.com\/watch\?v=[\w-]+|youtu\.be\/[\w-]+)(\?.*|&.*)?$/.test(We)){console.log(`[YOUTUBE] URL validation failed for: ${We}`),pe({message:"Please enter a valid YouTube URL (e.g., https://youtube.com/watch?v=...)"}),M(!0);return}console.log("[YOUTUBE] URL validation passed, setting progress state"),Ae(at=>({...at,[xe]:"checking_transcript"}));try{console.log("[YOUTUBE] Fetching transcript from YouTube API");const at=await fetch("/api/youtube/check-transcript",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:We})});if(!at.ok)throw new Error("Failed to fetch YouTube transcript");const tt=await at.json();if(!tt.hasTranscript||!tt.transcript){pe({message:"This YouTube video does not have a transcript available. Please try a different video or use file upload instead."}),M(!0);return}console.log(`[YOUTUBE] Transcript fetched successfully, length: ${tt.transcript.length} characters`),Ae(ir=>({...ir,[xe]:"processing"}));const rt=new Blob([tt.transcript],{type:"text/plain"}),it=new File([rt],"youtube_transcript.txt",{type:"text/plain"}),At=new FormData;At.append("file0",it),At.append("itemId",xe),At.append("userChoice","chord_names"),console.log("[AUTOCREATE] Sending transcript to autocreate endpoint");const _t=await fetch("/api/autocreate-chord-charts",{method:"POST",body:At});if(!_t.ok){const ir=await _t.text();let Pn;try{Pn=JSON.parse(ir)}catch{Pn={error:ir}}if(Pn.requires_api_key){Ae(ys=>{const Ar={...ys};return delete Ar[xe],Ar}),pe({message:Pn.error||"Autocreate requires an API key.",requiresApiKey:!0}),M(!0);return}throw new Error(`Failed to process YouTube transcript: ${_t.status} ${_t.statusText} - ${ir}`)}const $t=await _t.json();console.log("[AUTOCREATE] YouTube transcript processed successfully:",$t);const gt=await(await fetch(`/api/items/${xe}/chord-charts`)).json();c(ir=>({...ir,[xe]:gt})),d(ir=>({...ir,[xe]:Et(gt)})),Z(ir=>({...ir,[xe]:""})),ri();const Wt=Lt(xe);Te({itemName:(Wt==null?void 0:Wt.C)||`Item ${xe}`,chordCount:gt.length,contentType:"chord_names",uploadedFileNames:"YouTube transcript",isVisionAnalysis:!1}),Le(!0)}catch(at){console.error("Error processing YouTube URL:",at),pe({message:"Failed to process YouTube URL. Please try again."}),M(!0)}finally{Ae(at=>{const tt={...at};return delete tt[xe],tt})}},Cr=async(xe,ze)=>{try{Ae(At=>({...At,[xe]:"uploading"}));const We=new AbortController;Je(At=>({...At,[xe]:We}));const Qe=new FormData;ze.forEach((At,_t)=>{Qe.append(`file${_t}`,At)}),Qe.append("itemId",xe);const at=2e3;let tt=!1;const rt=setTimeout(()=>{tt||Ae(At=>({...At,[xe]:"processing"}))},at),it=await fetch("/api/autocreate-chord-charts",{method:"POST",body:Qe,signal:We.signal});if(it.ok){ri(),Ae(gt=>({...gt,[xe]:"complete"}));const _t=await(await fetch(`/api/items/${xe}/chord-charts`)).json();c(gt=>({...gt,[xe]:_t})),d(gt=>({...gt,[xe]:Et(_t)})),C(gt=>({...gt,[xe]:[]})),Zs("autocreate_completed",{itemId:xe,fileCount:ze.length});const $t=Lt(xe),Yt=ze.map(gt=>gt.name).join(", ");Te({itemName:($t==null?void 0:$t.C)||`Item ${xe}`,chordCount:_t.length,contentType:"auto-detected",uploadedFileNames:Yt,isVisionAnalysis:!1}),Le(!0),Je(gt=>{const Wt={...gt};return delete Wt[xe],Wt}),setTimeout(()=>{Ae(gt=>({...gt,[xe]:null})),oe(gt=>({...gt,[xe]:!1}))},2e3)}else{tt=!0,clearTimeout(rt);let At=`Failed to create chord charts: ${it.statusText}`;try{const _t=await it.json();if(_t.error&&(At=_t.error),_t.requires_api_key){Ae($t=>{const Yt={...$t};return delete Yt[xe],Yt}),pe({message:At,requiresApiKey:!0}),M(!0),Je($t=>{const Yt={...$t};return delete Yt[xe],Yt});return}}catch(_t){console.warn("Could not parse error response:",_t)}pe({message:At}),M(!0),Ae(_t=>{const $t={..._t};return delete $t[xe],$t}),Je(_t=>{const $t={..._t};return delete $t[xe],$t})}}catch(We){hasErrorOccurred=!0,clearTimeout(processingTimer),console.error("Error processing files:",We),Ae(Qe=>{const at={...Qe};return delete at[xe],at}),Je(Qe=>{const at={...Qe};return delete at[xe],at})}},dr=xe=>{(i[xe]||[]).length>0?(mt(xe),dt(!0)):oe(We=>({...We,[xe]:!0}))},es=async()=>{if(Vt)try{const xe=i[Vt]||[];for(const ze of xe)if(!(await fetch(`/api/items/${Vt}/chord-charts/${ze.id}`,{method:"DELETE"})).ok)throw new Error(`Failed to delete chord chart ${ze.id}`);c(ze=>({...ze,[Vt]:[]})),d(ze=>({...ze,[Vt]:[]})),oe(ze=>({...ze,[Vt]:!0})),dt(!1),mt(null)}catch(xe){console.error("Error deleting existing chord charts:",xe)}},wr=xe=>{ot(xe),ht(!0)},Sn=xe=>{Me[xe]&&Me[xe].abort(),Ae(ze=>{const We={...ze};return delete We[xe],We}),Je(ze=>{const We={...ze};return delete We[xe],We}),C(ze=>{const We={...ze};return delete We[xe],We}),Z(ze=>({...ze,[xe]:""})),fe(ze=>({...ze,[xe]:""})),oe(ze=>({...ze,[xe]:!1}))},tn=xe=>{console.log("Open copy from modal for item:",xe)},kn=async xe=>{console.log("Opening copy modal for item:",xe),X(xe);const ze=s==null?void 0:s.find(tt=>tt.B===xe),We=(ze==null?void 0:ze.C)||"",Qe=$d(We,s,xe);console.log("Source:",We),console.log("Found similar songs:",Qe.map(tt=>tt.C));const at=[xe,...Qe.map(tt=>tt.B)];console.log("Loading chord charts for relevant items:",at.length,"items");for(const tt of at)try{const rt=await fetch(`/api/items/${tt}/chord-charts`);if(rt.ok){const it=await rt.json();c(At=>({...At,[tt]:it})),console.log(`Loaded ${it.length} charts for item ${tt}`)}}catch(rt){console.error(`Error loading chord charts for item ${tt}:`,rt)}E(!0),H(""),Y(new Set),ve(null)},$r=()=>{E(!1),X(null),H(""),Y(new Set),S(new Set),N(!1),ve(null)},Yr=xe=>{Y(ze=>{const We=new Set(ze);if(We.has(xe))We.delete(xe);else{We.add(xe);const Qe=s==null?void 0:s.find(tt=>tt.A===xe),at=Qe==null?void 0:Qe.B;at&&zt(at)}return We})},En=async()=>{if(console.log("handleConfirmCopy called",{copySourceItemId:O,selectedTargetItems:Array.from(P)}),!O||P.size===0){console.log("Early return: missing source or targets");return}if(I.size>0&&!R){console.log("Showing overwrite confirmation, items with existing charts:",I.size),N(!0);return}try{const xe=await fetch("/api/chord-charts/copy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({source_item_id:O,target_item_ids:Array.from(P).map(at=>{const tt=s==null?void 0:s.find(rt=>rt.A===at);return tt==null?void 0:tt.B}).filter(Boolean)})});if(!xe.ok)throw new Error(`Failed to copy chord charts: ${xe.statusText}`);const ze=await xe.json();console.log("Chord charts copied successfully:",ze),ve("complete");const We=Array.from(P).map(at=>{const tt=s==null?void 0:s.find(rt=>rt.A===at);return tt==null?void 0:tt.B}).filter(Boolean),Qe=[O,...We];console.log("[DEBUG COPY] About to refresh chord charts for affected items:",Qe);for(const at of Qe)try{const tt=await fetch(`/api/items/${at}/chord-charts`);if(tt.ok){const rt=await tt.json();console.log("[DEBUG COPY] Updating chordCharts state for item",at,"with",rt.length,"charts"),c(it=>({...it,[at]:rt})),d(it=>({...it,[at]:Et(rt)}))}}catch(tt){console.error(`Error refreshing chord charts for item ${at}:`,tt)}}catch(xe){console.error("Error copying chord charts:",xe)}};if(!t)return null;const lt=e;return n.jsxs(n.Fragment,{children:[n.jsx(gs,{open:t&&!L,onOpenChange:r,children:n.jsxs(Jn,{className:"max-w-[95vw] sm:max-w-2xl md:max-w-3xl lg:max-w-4xl max-h-[90vh] overflow-y-auto",children:[n.jsxs(Zn,{children:[n.jsxs(Xn,{className:"flex items-center gap-2",children:[n.jsx(Ch,{className:"h-5 w-5"}),"Chord Charts - ",a||e]}),n.jsx(xs,{className:"sr-only",children:"View and manage chord charts for this practice item"})]}),n.jsx("div",{className:"space-y-4",children:(()=>{var at;const xe=o[lt],ze=xe?null:wt(lt),Qe=(xe||ze||[]).map((tt,rt)=>n.jsxs("div",{className:"mb-6",children:[n.jsxs("div",{className:"flex justify-between items-center mb-3",children:[n.jsx("input",{type:"text",value:tt.label,onChange:it=>{console.log("Updating section label:",tt.id,it.target.value),ar(lt,tt.id,{label:it.target.value})},className:"bg-gray-900 text-white px-2 py-1 rounded text-sm font-semibold border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Section name"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"text",value:tt.repeatCount,onChange:it=>ar(lt,tt.id,{repeatCount:it.target.value}),className:"bg-gray-900 text-white px-2 py-1 rounded text-sm w-16 text-center border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"x2",maxLength:"3"}),n.jsx("button",{onClick:()=>Ot(lt,tt.id),disabled:y.size>0,className:`w-5 h-5 rounded-full flex items-center justify-center text-xs font-bold transition-colors ${y.size>0?"bg-gray-500 cursor-not-allowed":"bg-red-600 hover:bg-red-700 cursor-pointer"} text-white`,title:y.size>0?"Deleting...":"Delete section",children:y.size>0?n.jsx(Hr,{className:"h-3 w-3 animate-spin"}):"Ã—"})]})]}),rt===0&&(()=>{const it=tt.chords[0];if(!it)return null;const At=it.tuning||"EADGBE",_t=it.capo||0;return n.jsx("div",{className:"text-center text-white font-bold text-sm mb-3",children:_t>0?`${At} | Capo on ${_t}`:At})})(),tt.chords.length>0&&n.jsx("div",{className:"space-y-2",children:(()=>{const it=[];let At=[];return tt.chords.forEach((_t,$t)=>{At.push(_t),(_t.hasLineBreakAfter||At.length>=5||$t===tt.chords.length-1)&&(it.push([...At]),At=[])}),it.map((_t,$t)=>n.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-2",children:_t.map(Yt=>n.jsx(gm,{chart:Yt,onEdit:(gt,Wt)=>Xt(lt,gt),onDelete:gt=>er(lt,gt),onInsertAfter:(gt,Wt)=>Or(lt,gt,Wt)},Yt.id))},$t))})()})]},tt.id));return n.jsxs(n.Fragment,{children:[Qe,(i[lt]||[]).length>0?n.jsx("div",{className:"flex justify-end mb-2",children:n.jsx(Be,{variant:"outline",size:"sm",onClick:rt=>{rt.stopPropagation(),Ut(lt)},className:"p-2 border-gray-600 text-gray-400 hover:text-gray-200 hover:bg-gray-600",title:"Print chord charts",children:n.jsx(Lh,{className:"h-4 w-4"})})}):null,(()=>{var At,_t,$t,Yt;const tt=i[lt]||[],rt=ie[lt],it=le[lt];return tt.length===0?n.jsxs("div",{className:"mb-4",children:[it?n.jsx(Be,{onClick:()=>oe(gt=>({...gt,[lt]:!1})),variant:"ghost",size:"sm",className:"text-gray-400 hover:text-gray-300 mb-2",title:"Collapse autocreate section",children:"â†"}):n.jsx("div",{className:"flex justify-center",children:n.jsxs(Be,{onClick:()=>oe(gt=>({...gt,[lt]:!0})),className:"max-w-md bg-gray-700 text-gray-300 hover:bg-gray-600 mb-2 flex items-center justify-center",children:[n.jsx(Ti,{className:"h-4 w-4 mr-2"}),"Autocreate Chord Charts"]})}),it&&n.jsxs("div",{className:"border border-gray-600/30 rounded-lg p-4 bg-gray-800/10",children:[n.jsxs("div",{className:"text-sm text-gray-400 mb-6",children:[n.jsx("p",{children:"â€¢ Upload lyrics with chord names to create charts"}),n.jsx("p",{children:'â€¢ Upload image or PDF of chord charts to "import"'}),n.jsx("p",{children:"â€¢ One method at a time"})]}),!rt&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6 items-start",children:[n.jsxs("div",{className:"flex flex-col",children:[n.jsx("div",{className:"text-center mb-2",children:n.jsx("p",{className:"text-gray-400 text-sm font-medium",children:"Upload files"})}),n.jsx("div",{className:`flex-1 p-4 border-2 border-dashed rounded-lg transition-colors cursor-pointer ${Ce[lt]?"border-gray-500 bg-gray-800/20":"border-gray-600 hover:border-gray-500 bg-gray-800/10"}`,onDragOver:gt=>{gt.preventDefault(),Re(Wt=>Wt[lt]!==!0?{...Wt,[lt]:!0}:Wt)},onDragLeave:gt=>{gt.preventDefault(),Re(Wt=>Wt[lt]!==!1?{...Wt,[lt]:!1}:Wt)},onDrop:gt=>{gt.preventDefault(),Re(Wt=>({...Wt,[lt]:!1})),wn(lt,gt.dataTransfer.files)},onClick:()=>{const gt=document.createElement("input");gt.type="file",gt.multiple=!0,gt.accept=".pdf,.png,.jpg,.jpeg",gt.onchange=Wt=>wn(lt,Wt.target.files),gt.click()},children:n.jsxs("div",{className:"text-center",children:[n.jsx(Ti,{className:`h-12 w-12 mx-auto mb-2 ${te[lt]&&te[lt].length>0?"text-gray-300":"text-gray-400"}`}),n.jsx("p",{className:`text-sm font-medium mb-2 ${te[lt]&&te[lt].length>0?"text-gray-200":"text-gray-300"}`,children:"Drop files or click"}),n.jsx("p",{className:"text-gray-400 text-xs mb-2",children:"PDFs, images â€¢ 5mb max"}),te[lt]&&te[lt].length>0&&n.jsx("div",{children:n.jsxs("p",{className:"text-gray-300 text-xs font-medium mb-1",children:[te[lt].length," file(s)"]})})]})})]}),n.jsxs("div",{className:"flex flex-col",children:[n.jsxs("div",{className:"text-center mb-2",children:[n.jsx("p",{className:"text-gray-400 text-sm font-medium",children:"YouTube guitar lesson"}),n.jsx("p",{className:"text-gray-500 text-xs",children:"(video must have a transcript)"})]}),n.jsx("form",{className:"flex-1 flex flex-col justify-center",onSubmit:gt=>{var Wt;gt.preventDefault(),(Wt=G[lt])!=null&&Wt.trim()&&Vr(lt)},children:n.jsx("input",{type:"url",placeholder:"Paste YouTube URL",value:G[lt]||"",onChange:gt=>{const Wt=gt.target.value.replace(/[<>"']/g,"");Z(ir=>({...ir,[lt]:Wt}))},maxLength:500,className:"w-full p-3 bg-gray-700 text-white rounded border-2 border-gray-600 focus:border-gray-500 text-sm"})})]}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("div",{className:"text-center mb-2",children:n.jsx("p",{className:"text-gray-400 text-sm font-medium",children:"Manual entry"})}),n.jsxs("div",{className:"flex-1 flex flex-col justify-center relative",children:[n.jsx("textarea",{placeholder:`Enter song section names and chord names, like this:
Intro
Am7 Em/A E7sus
Verse
C G/B Am (space or comma-separated)`,value:Q[lt]||"",onChange:gt=>{const Wt=gt.target.value;Wt.length<=500&&(fe(ir=>({...ir,[lt]:Wt})),pn(Wt,lt))},maxLength:500,className:`w-full p-3 text-white rounded border-2 focus:border-gray-500 text-sm resize-none min-h-[160px] ${we[lt]?"bg-red-900/20 border-red-500":"bg-gray-700 border-gray-600"}`}),n.jsxs("div",{className:"absolute bottom-1 right-2 text-xs text-gray-400",children:[(Q[lt]||"").length,"/500"]}),we[lt]&&n.jsx("div",{className:"mt-1 text-xs text-red-400",children:we[lt]})]})]})]}),n.jsx("div",{className:"flex justify-center",children:n.jsxs(Be,{onClick:()=>Vr(lt),disabled:rt||(te[lt]||[]).length===0&&!((At=G[lt])!=null&&At.trim())&&!((_t=Q[lt])!=null&&_t.trim())||((te[lt]||[]).length>0?1:0)+(($t=G[lt])!=null&&$t.trim()?1:0)+((Yt=Q[lt])!=null&&Yt.trim()?1:0)>1,className:"px-6",children:[n.jsx(bc,{className:"h-4 w-4 mr-2"}),"Create Chord Charts"]})})]}),n.jsx("div",{className:"w-full p-6 border-2 border-dashed rounded-lg mt-4 bg-gray-800/10 border-gray-600/50",children:n.jsxs("div",{className:"text-center",children:[rt==="checking_transcripts"&&n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-yellow-500"}),n.jsx("span",{className:"text-yellow-400",children:"Checking for transcripts..."})]}),n.jsx("br",{}),n.jsxs(Be,{variant:"outline",size:"sm",onClick:()=>wr(lt),className:"text-gray-400 hover:text-gray-200 border-gray-600",children:[n.jsx(Gr,{className:"h-3 w-3 mr-1"}),"Cancel"]})]}),rt==="reading_transcript"&&n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-500"}),n.jsx("span",{className:"text-gray-400",children:"Reading transcript..."})]}),n.jsx("br",{}),n.jsxs(Be,{variant:"outline",size:"sm",onClick:()=>wr(lt),className:"text-gray-400 hover:text-gray-200 border-gray-600",children:[n.jsx(Gr,{className:"h-3 w-3 mr-1"}),"Cancel"]})]}),rt==="uploading"&&n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-500"}),n.jsx("span",{className:"text-gray-400",children:"Uploading files..."})]}),n.jsx("br",{}),n.jsxs(Be,{variant:"outline",size:"sm",onClick:()=>wr(lt),className:"text-gray-400 hover:text-gray-200 border-gray-600",children:[n.jsx(Gr,{className:"h-3 w-3 mr-1"}),"Cancel"]})]}),rt==="processing_transcript"&&n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-purple-500"}),n.jsx("span",{className:"text-white",children:"Processing transcript..."})]}),n.jsx("br",{}),n.jsxs(Be,{variant:"outline",size:"sm",onClick:()=>wr(lt),className:"text-gray-400 hover:text-gray-200 border-gray-600",children:[n.jsx(Gr,{className:"h-3 w-3 mr-1"}),"Cancel"]})]}),rt==="processing"&&n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-purple-500"}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("span",{className:"text-white",children:je[j]}),n.jsx("div",{className:"ml-2 animate-spin",children:"âš™ï¸"})]})]}),n.jsx("br",{}),n.jsxs(Be,{variant:"outline",size:"sm",onClick:()=>wr(lt),className:"text-gray-400 hover:text-gray-200 border-gray-600",children:[n.jsx(Gr,{className:"h-3 w-3 mr-1"}),"Cancel"]})]}),rt==="complete"&&n.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[n.jsx(Nn,{className:"h-4 w-4 text-green-500"}),n.jsx("span",{className:"text-green-400",children:"Chord charts created!"})]}),rt==="error"&&n.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[n.jsx(Rn,{className:"h-4 w-4 text-red-500"}),n.jsx("span",{className:"text-red-400",children:"Error processing files. Please try again."})]}),!rt&&n.jsx(n.Fragment,{children:i[lt]&&i[lt].length>0?n.jsxs(n.Fragment,{children:[n.jsx(Rn,{className:"h-8 w-8 text-orange-400 mx-auto mb-2"}),n.jsx("p",{className:"text-orange-300 font-medium mb-1",children:"Chord charts already exist"}),n.jsx("p",{className:"text-gray-400 text-sm",children:"Please delete all chord charts from this song before using autocreate"})]}):n.jsx(n.Fragment,{children:(te[lt]||[]).length>0?n.jsxs(n.Fragment,{children:[n.jsx(pl,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),n.jsx("p",{className:"text-gray-300 font-medium mb-1",children:"Ready to create chord charts"}),n.jsx("p",{className:"text-gray-400 text-sm",children:"Click 'Create chord charts'"})]}):n.jsxs(n.Fragment,{children:[n.jsx(pl,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),n.jsx("p",{className:"text-gray-300 font-medium mb-1",children:"Add a file, paste a YouTube URL, or type in the 'Manual entry' box, then click 'Create Chord Charts'"}),n.jsx("p",{className:"text-gray-400 text-xs",children:"(The results will probably contain errors. Use the âœï¸edit icon on a chart to correct it.)"})]})})})]})})]})]}):n.jsx("div",{className:"mb-4 flex justify-center",children:n.jsxs(Be,{variant:"outline",onClick:()=>dr(lt),className:"max-w-md text-orange-300 hover:bg-orange-800 hover:border-orange-600",children:[n.jsx(Ti,{className:"h-4 w-4 mr-2"}),"Replace with autocreated charts"]})})})(),n.jsx("div",{className:"mb-4 flex justify-center",children:n.jsx(Be,{variant:"default",onClick:()=>{_({itemId:lt,scrollPosition:window.scrollY}),p(tt=>({...tt,[lt]:!0})),setTimeout(()=>{const tt=document.querySelector(`[data-editor-for-item="${lt}"]`);tt&&tt.scrollIntoView({behavior:"smooth",block:"start"})},100)},className:"min-w-48",children:"+ Add new chord"})}),n.jsx("div",{className:"mb-4 flex justify-center",children:n.jsx(Be,{variant:"default",onClick:()=>xt(lt),className:"min-w-48",children:"+ Add new section"})}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-4 max-w-2xl mx-auto",children:[n.jsx(Be,{variant:"default",onClick:()=>tn(lt),className:"flex-1",children:"Copy chord charts from other song"}),n.jsx(Be,{variant:"default",onClick:()=>kn(lt),disabled:!i[lt]||i[lt].length===0,className:"flex-1 disabled:opacity-50 disabled:cursor-not-allowed",children:"Copy chord charts to other song"})]}),h[lt]&&n.jsx("div",{"data-editor-for-item":lt,children:n.jsx(Dh,{itemId:lt,defaultTuning:((at=Lt(lt))==null?void 0:at.H)||"EADGBE",editingChordId:b,insertionContext:u,onSave:tt=>bn(lt,tt),onCancel:()=>{p(tt=>({...tt,[lt]:!1})),m(null),w(null),fn()}})})]})})()}),ce&&n.jsx(vc,{isOpen:ce,onClose:()=>Le(!1)}),Ve&&n.jsx(Xs,{open:Ve,onOpenChange:ht,children:n.jsxs(Os,{children:[n.jsxs(Ds,{children:[n.jsx(Bs,{children:"Cancel processing?"}),n.jsx(Ms,{children:"This will stop the current autocreate operation. Any progress will be lost."})]}),n.jsxs(Rs,{children:[n.jsx(xa,{children:"Continue processing"}),n.jsx(js,{onClick:()=>{st&&Sn(st),ht(!1),ot(null)},children:"Cancel processing"})]})]})}),yt&&n.jsx(Xs,{open:yt,onOpenChange:dt,children:n.jsxs(Os,{children:[n.jsxs(Ds,{children:[n.jsxs(Bs,{className:"flex items-center space-x-2",children:[n.jsx(Rn,{className:"h-5 w-5 text-orange-500"}),n.jsx("span",{children:"Replace Existing Chord Charts"})]}),n.jsx(Ms,{children:"This song already has chord charts. To use autocreate, all existing chord charts must be deleted first. This action cannot be undone."})]}),n.jsxs(Rs,{children:[n.jsx(xa,{onClick:()=>{dt(!1),mt(null)},children:"Cancel"}),n.jsx(js,{onClick:es,className:"bg-orange-500 hover:bg-orange-600 text-white border-orange-500 shadow-lg font-medium",children:"Delete all & autocreate"})]})]})}),n.jsx(Bh,{isOpen:z,onClose:()=>{M(!1),pe(null)},error:ue}),n.jsx(vc,{isOpen:ce,onClose:()=>{Le(!1),Te(null)},autocreateData:Ie})]})}),L&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100]",onClick:$r,children:n.jsx("div",{className:`bg-gray-700 rounded-lg p-6 ${R||re==="complete"?"max-w-xs":"w-full max-w-md"} max-h-[80vh] flex flex-col`,onClick:xe=>xe.stopPropagation(),onWheel:xe=>xe.stopPropagation(),children:re==="complete"?n.jsxs(n.Fragment,{children:[n.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Success!"}),n.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-4",children:[n.jsx(Nn,{className:"h-6 w-6 text-green-500"}),n.jsx("span",{className:"text-green-400 text-lg",children:"Chord charts copied successfully!"})]}),n.jsx("div",{className:"flex justify-end",children:n.jsx(Be,{onClick:$r,className:"min-w-24 bg-green-600 hover:bg-green-700",children:"Done"})})]}):R?n.jsxs(n.Fragment,{children:[n.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"âš ï¸ Confirm Overwrite"}),n.jsxs("p",{className:"text-gray-300 mb-4",children:["This will overwrite existing chord charts on ",I.size," song",I.size!==1?"s":"",". Continue?"]}),n.jsxs("div",{className:"flex gap-2 justify-end",children:[n.jsx(Be,{variant:"outline",onClick:()=>N(!1),className:"min-w-24",children:"Cancel"}),n.jsx(Be,{onClick:En,className:"min-w-24 bg-red-600 hover:bg-red-700",children:"Overwrite"})]})]}):n.jsxs(n.Fragment,{children:[n.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Copy Chord Charts"}),n.jsxs("p",{className:"text-gray-300 mb-2",children:['Copy chord charts from "',((Kr=s==null?void 0:s.find(xe=>xe.B===O))==null?void 0:Kr.C)||"Unknown Song",'" to:']}),n.jsx("input",{type:"text",placeholder:"Search songs...",value:K,onChange:xe=>H(xe.target.value),className:"w-full p-2 mb-4 bg-gray-700 text-white rounded border border-gray-600 focus:border-purple-500"}),n.jsx("div",{className:"flex-1 overflow-y-auto mb-4 min-h-0 modal-scroll",children:Nt.map(xe=>n.jsxs("div",{className:"flex items-center mb-2",children:[n.jsx("input",{type:"checkbox",id:`copy-item-${xe.A}`,checked:P.has(xe.A),onChange:()=>Yr(xe.A),className:"mr-3"}),n.jsxs("label",{htmlFor:`copy-item-${xe.A}`,className:"text-white cursor-pointer flex-1 flex items-center",children:[n.jsx("span",{children:xe.C||"Untitled"}),I.has(xe.A)&&n.jsx("span",{className:"text-yellow-400 ml-2 text-sm",children:" âš ï¸will overwrite"})]})]},xe.A))}),n.jsxs("div",{className:"flex gap-2 justify-end",children:[n.jsx(Be,{variant:"outline",onClick:$r,className:"min-w-24",children:"Cancel"}),n.jsx(Be,{onClick:En,disabled:P.size===0,style:P.size===0?{backgroundColor:"#4b5563",color:"#d1d5db",opacity:"1"}:I.size>0?{backgroundColor:"#dc2626",color:"#ffffff",opacity:"1"}:{backgroundColor:"#5b1f1f",color:"#ffffff",opacity:"1"},className:"bg-purple-600 hover:bg-purple-700 disabled:cursor-not-allowed",children:I.size>0?`Copy and Overwrite ${P.size} song${P.size!==1?"s":""}`:`Copy to ${P.size} song${P.size!==1?"s":""}`})]})]})})})]})}const of=({className:t="h-5 w-5",title:r="Chord chart"})=>n.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,role:"img","aria-label":r,children:[n.jsx("line",{x1:"4",y1:"6",x2:"20",y2:"6",stroke:"currentColor",strokeWidth:"1.5"}),n.jsx("line",{x1:"4",y1:"10",x2:"20",y2:"10",stroke:"currentColor",strokeWidth:"0.8"}),n.jsx("line",{x1:"4",y1:"14",x2:"20",y2:"14",stroke:"currentColor",strokeWidth:"0.8"}),n.jsx("line",{x1:"4",y1:"18",x2:"20",y2:"18",stroke:"currentColor",strokeWidth:"0.8"}),n.jsx("line",{x1:"7",y1:"6",x2:"7",y2:"18",stroke:"currentColor",strokeWidth:"0.5"}),n.jsx("line",{x1:"10",y1:"6",x2:"10",y2:"18",stroke:"currentColor",strokeWidth:"0.5"}),n.jsx("line",{x1:"13",y1:"6",x2:"13",y2:"18",stroke:"currentColor",strokeWidth:"0.5"}),n.jsx("line",{x1:"16",y1:"6",x2:"16",y2:"18",stroke:"currentColor",strokeWidth:"0.5"}),n.jsx("line",{x1:"19",y1:"6",x2:"19",y2:"18",stroke:"currentColor",strokeWidth:"0.5"}),n.jsx("line",{x1:"4",y1:"6",x2:"4",y2:"18",stroke:"currentColor",strokeWidth:"0.5"}),n.jsx("line",{x1:"3",y1:"3",x2:"5",y2:"5",stroke:"currentColor",strokeWidth:"1"}),n.jsx("line",{x1:"5",y1:"3",x2:"3",y2:"5",stroke:"currentColor",strokeWidth:"1"}),n.jsx("circle",{cx:"7",cy:"14",r:"1.5",fill:"currentColor"}),n.jsx("circle",{cx:"10",cy:"10",r:"1.5",fill:"currentColor"}),n.jsx("circle",{cx:"16",cy:"6",r:"1.5",fill:"currentColor"})]}),xm=Ui.memo(({item:t,onEdit:r,onDelete:e,onOpenChordCharts:a})=>{const{attributes:s,listeners:i,setNodeRef:c,transform:o,transition:d,isDragging:h}=Nl({id:t.B}),p={transform:_l.Transform.toString(o),transition:d,zIndex:h?1:0},b=async m=>{m.preventDefault(),m.stopPropagation(),await e(t.B)};return n.jsxs("div",{ref:c,style:p,className:`flex flex-col sm:flex-row sm:items-center sm:justify-between p-3 sm:p-5 rounded-lg gap-3 ${h?"bg-gray-700":"bg-gray-800"}`,children:[n.jsxs("div",{className:"flex items-center min-w-0 flex-1",children:[n.jsx("div",{...s,...i,className:"flex-shrink-0","aria-label":"Drag to reorder item","data-ph-capture-attribute-drag":"item-drag-handle",children:n.jsx(jl,{className:"h-6 w-6 text-gray-500 mr-2 sm:mr-4 cursor-move","aria-hidden":"true"})}),n.jsx("span",{className:"text-base sm:text-xl",children:t.C})]}),n.jsxs("div",{className:"flex space-x-3 justify-end sm:justify-start flex-shrink-0",children:[n.jsxs(Be,{variant:"ghost",size:"lg",onClick:()=>r(t),className:"hover:bg-gray-700",title:"Edit item","data-ph-capture-attribute-button":"edit-item",children:[n.jsx(po,{className:"h-5 w-5","aria-hidden":"true"}),n.jsx("span",{className:"sr-only",children:"Edit item"})]}),n.jsxs(Be,{variant:"ghost",size:"lg",onClick:()=>a(t.B,t.C),className:"text-blue-400 hover:text-blue-300 hover:bg-gray-700",title:"Add or edit chord charts","data-ph-capture-attribute-button":"open-chord-charts-modal",children:[n.jsx(of,{className:"h-5 w-5","aria-hidden":"true"}),n.jsx("span",{className:"sr-only",children:"Chord charts"})]}),n.jsxs(Be,{variant:"ghost",size:"lg",onClick:b,className:"text-red-500 hover:text-red-400 hover:bg-gray-700",title:"Delete this item and remove it from all routines","data-ph-capture-attribute-button":"delete-item",children:[n.jsx(Eh,{className:"h-5 w-5","aria-hidden":"true"}),n.jsx("span",{className:"sr-only",children:"Delete item"})]})]})]})}),ym=({items:t=[],onItemsChange:r})=>{const[e,a]=U.useState(""),[s,i]=U.useState(!1),[c,o]=U.useState(!1),[d,h]=U.useState(!1),[p,b]=U.useState(null),[m,u]=U.useState(null),[w,x]=U.useState(!1),[_,y]=U.useState(null),[A,L]=U.useState(""),E=async R=>{c||u(R)},O=async()=>{if(m){i(!0);try{if(!(await fetch(`/api/items/${m}`,{method:"DELETE"})).ok)throw new Error("Failed to delete item");const N=t.find(re=>re.B===m);if(N){const re=N.C||`Item ${m}`;fo("deleted","item",re)}r()}catch(R){console.error("Delete failed:",R)}finally{i(!1),u(null)}}},X=R=>{b(R),h(!0)},K=(R,N)=>{y(R),L(N),x(!0)},H=async()=>{r(),b(null),h(!1)},P=()=>{o(!0)},Y=async({active:R,over:N})=>{if(o(!1),s||!R||!N||R.id===N.id)return;const re=t.findIndex(le=>le.B===R.id),ve=t.findIndex(le=>le.B===N.id);try{const oe=fl(t,re,ve).map((Ae,te)=>({A:Ae.B,G:te}));if(!(await fetch("/api/items/order",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(oe)})).ok)throw new Error("Failed to update items");r()}catch(le){console.error("Reorder failed:",le)}},I=Uc(Mi($c,{activationConstraint:{delay:100,tolerance:5}}),Mi(qc,{coordinateGetter:zc})),S=t.filter(R=>{if(!e)return!0;const N=(R==null?void 0:R.C)||"",re=oe=>oe.replace(/[''`]/g,"'"),ve=re(N.toLowerCase()),le=re(e.toLowerCase());return ve.includes(le)});return n.jsxs(n.Fragment,{children:[n.jsxs(on,{className:"w-full max-w-4xl mx-auto bg-gray-900 text-gray-100",children:[n.jsxs(_n,{className:"flex flex-row items-center justify-between",children:[n.jsx(ln,{className:"text-2xl",children:"Practice items"}),n.jsx("div",{className:"flex items-center space-x-2",children:n.jsxs(Be,{className:"bg-blue-600 hover:bg-blue-700 text-lg px-4 py-6",onClick:()=>{b(null),h(!0)},"data-ph-capture-attribute-button":"add-new-item",children:[n.jsx(yo,{className:"mr-2 h-5 w-5","aria-hidden":"true"}),"Add item"]})})]}),n.jsxs(cn,{children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("label",{htmlFor:"search-items-input",className:"sr-only",children:"Search practice items"}),n.jsx(Rr,{id:"search-items-input",type:"text",placeholder:"Search items...",value:e,onChange:R=>a(R.target.value),className:"w-full text-lg py-6 px-4",autoComplete:"off"})]}),n.jsx(cl,{sensors:I,collisionDetection:dl,onDragStart:P,onDragEnd:Y,children:n.jsx(ul,{items:S.map(R=>R.B),strategy:hl,children:n.jsx("div",{className:"space-y-4",children:S.map(R=>n.jsx(xm,{item:R,onEdit:X,onDelete:E,onOpenChordCharts:K},R.B))})})})]})]}),d&&n.jsx(U0,{open:d,onOpenChange:R=>{R||(b(null),h(!1))},item:p,onItemChange:H}),n.jsx(Xs,{open:!!m,onOpenChange:()=>u(null),children:n.jsxs(Os,{children:[n.jsxs(Ds,{children:[n.jsx(Bs,{children:"Are you sure?"}),n.jsx(Ms,{children:"This action cannot be undone. This will permanently delete the practice item and remove it from all routines."})]}),n.jsxs(Rs,{children:[n.jsx(xa,{children:"Cancel"}),n.jsx(js,{onClick:O,children:"Delete"})]})]})}),n.jsx(af,{isOpen:w,onClose:()=>x(!1),itemId:_,itemTitle:A})]})},bm=()=>{const[t,r]=U.useState(null),[e,a]=U.useState(!0),[s,i]=U.useState(null),[c,o]=U.useState(0),d=async()=>{try{const p=await fetch("/api/practice/active-routine/lightweight");if(!p.ok)throw new Error("Failed to fetch active routine");const b=await p.json();if(!b.active_id){r(null),i(null),a(!1);return}const m=b.items.sort((u,w)=>parseInt(u.routineEntry.C)-parseInt(w.routineEntry.C));r({id:b.active_id,name:b.name,items:m.map(u=>({...u.routineEntry,minimalDetails:u.itemMinimal}))}),i(null)}catch(p){i(p.message),console.error("Fetch error:",p)}finally{a(!1)}},h=async()=>{o(p=>p+1)};return U.useEffect(()=>{d()},[c]),{routine:t,loading:e,error:s,refreshRoutine:h}},wm=()=>{const[t,r]=U.useState({}),[e,a]=U.useState(new Set),[s,i]=U.useState(null),c=U.useCallback(async p=>{if(t[p])return t[p];if(e.has(p))return null;try{a(u=>new Set([...u,p])),i(null);const b=await fetch(`/api/items/${p}`);if(!b.ok)throw new Error(`Failed to fetch item details: ${b.statusText}`);const m=await b.json();return r(u=>({...u,[p]:m})),m}catch(b){return i(b.message),console.error("Error fetching item details:",b),null}finally{a(b=>{const m=new Set(b);return m.delete(p),m})}},[t,e]),o=U.useCallback(p=>t[p]||null,[t]),d=U.useCallback(p=>e.has(p),[e]),h=U.useCallback(()=>{r({}),a(new Set),i(null)},[]);return{fetchItemDetails:c,getItemDetails:o,isLoadingItem:d,error:s,clearCache:h}},vm=(t,r)=>{let e;return function(...s){const i=()=>{clearTimeout(e),t(...s)};clearTimeout(e),e=setTimeout(i,r)}},Nm=({className:t,...r})=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:t,"aria-hidden":"true",...r,children:n.jsx("path",{d:"M8 5v14l11-7z"})}),_m=({className:t,...r})=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:t,"aria-hidden":"true",...r,children:n.jsx("path",{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"})}),Wd=({className:t,...r})=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:t,"aria-hidden":"true",...r,children:n.jsx("path",{d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})}),Hd=t=>{const r=Math.floor(t/60),e=Math.floor(t%60);return`${r}:${e.toString().padStart(2,"0")}`},Gd=t=>{const r=Math.floor(t/60),e=t%60;return`${r.toString().padStart(2,"0")}:${e.toString().padStart(2,"0")}`},jm=U.memo(({chart:t,onEdit:r,onDelete:e,onInsertAfter:a})=>{const s=U.useRef(null);return U.useEffect(()=>{if(!s.current)return;(()=>{if(!(!window.svguitar||!s.current))try{const c=t.chordData||t;s.current.innerHTML="";const o=new window.svguitar.SVGuitarChord(s.current),d={strings:c.numStrings||6,frets:c.numFrets||5,position:c.startingFret||1,tuning:[],width:176,height:248,fretSize:1.2,fingerSize:.75,sidePadding:.2,fontFamily:"Arial",color:"#ffffff",backgroundColor:"transparent",strokeColor:"#ffffff",textColor:"#ffffff",fretLabelColor:"#ffffff",fingerTextColor:"#000000",fingerTextSize:28},b={fingers:[...(c.fingers||[]).map(m=>{const[u,w,x]=m;return x&&x!=="undefined"?[u,w,x]:[u,w]}),...(c.openStrings||[]).map(m=>[m,0]),...(c.mutedStrings||[]).map(m=>[m,"x"])],barres:c.barres||[]};o.configure(d).chord(b).draw(),setTimeout(()=>{var u;const m=(u=s.current)==null?void 0:u.querySelector("svg");m&&(m.style.width="100%",m.style.height="100%",m.style.maxWidth="144px",m.style.maxHeight="154px",m.style.position="relative",m.style.zIndex="1",m.setAttribute("role","img"),m.setAttribute("aria-label",Sm(t)))},50)}catch(c){console.error("Error rendering memoized chord chart:",c)}})()},[t]),n.jsxs("div",{className:"bg-gray-800 p-1 rounded-lg relative","data-chord-id":t.id,style:{minWidth:"0",maxWidth:"100%",width:"100%",position:"relative"},children:[n.jsx("button",{onClick:i=>{i.stopPropagation(),r(t.id,t)},className:"absolute bottom-1 left-1 w-6 h-6 text-gray-400 hover:text-gray-200 flex items-center justify-center text-sm transition-colors cursor-pointer z-20 bg-gray-900 bg-opacity-75 rounded shadow-lg",title:"Edit chord chart",style:{position:"absolute",bottom:"4px",left:"4px",zIndex:20},"aria-label":"Edit chord chart","data-ph-capture-attribute-button":"edit-chord-chart",children:"âœï¸"}),n.jsx("button",{onClick:i=>{i.stopPropagation(),e(t.id)},className:"absolute bottom-1 right-1 w-6 h-6 text-red-500 hover:text-red-700 flex items-center justify-center text-lg font-black transition-colors cursor-pointer z-20 bg-gray-900 bg-opacity-75 rounded shadow-lg",title:"Delete chord chart",style:{position:"absolute",bottom:"4px",right:"4px",zIndex:20},"aria-label":"Delete chord chart","data-ph-capture-attribute-button":"delete-chord-chart",children:"Ã—"}),a&&n.jsx("button",{onClick:i=>{i.stopPropagation(),a(t.id,t)},className:"absolute bottom-1 right-8 w-6 h-6 bg-blue-500 hover:bg-blue-400 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors cursor-pointer z-20 shadow-lg",title:"Insert chord after this one",style:{position:"absolute",bottom:"4px",right:"32px",zIndex:20},"aria-label":"Insert chord after this one","data-ph-capture-attribute-button":"insert-chord-after",children:"+"}),n.jsx("div",{className:"relative mx-auto flex items-center justify-center overflow-hidden",style:{width:"144px",height:"154px"},children:n.jsx("div",{ref:s,className:"w-full h-full"})}),n.jsx("div",{className:"text-sm font-semibold mt-2 text-center text-gray-300",children:t.title})]})}),Sm=t=>{const r=t.chordData||t,a=[`${t.title||"Chord"} chord diagram.`],s=r.fingers||[];if(s.length>0){const d=s.map(h=>{const[p,b,m]=h,u=7-p,w=m?` with finger ${m}`:"";return`string ${u} fret ${b}${w}`});a.push(`Finger positions: ${d.join(", ")}.`)}const i=r.openStrings||[];if(i.length>0){const d=i.map(h=>7-h).sort((h,p)=>h-p);a.push(`Open strings: ${d.join(", ")}.`)}const c=r.mutedStrings||[];if(c.length>0){const d=c.map(h=>7-h).sort((h,p)=>h-p);a.push(`Muted strings: ${d.join(", ")}.`)}const o=r.barres||[];if(o.length>0){const d=o.map(h=>{const p=7-h.fromString,b=7-h.toString;return`Barre at fret ${h.fret} from string ${p} to ${b}`});a.push(`${d.join(". ")}.`)}return a.join(" ")},Ei=t=>t.replace(/[''`"]/g,"'").replace(/[â€“â€”âˆ’]/g,"-").replace(/\s+/g," ").trim().toLowerCase(),Vd=t=>t.replace(/\s*\([^)]*\)\s*/g,"").trim(),Vl=(t,r,e)=>{const a=Vd(t),s=Ei(a);return console.log("DEBUG: findSimilarSongs - sourceTitle:",t,"-> baseName:",a,"-> normalized:",s),r.filter(i=>{if(i.B===e)return!1;const c=i.C||"",o=Vd(c),d=Ei(o),h=s===d||s.length>3&&d.includes(s)||d.length>3&&s.includes(d);return(c.toLowerCase().includes("feelin")||c.toLowerCase().includes("alright"))&&(console.log("DEBUG: Checking item:",c,"-> itemBaseName:",o,"-> normalized:",d,"-> matches:",h),console.log("  normalizedBaseName:",s),console.log("  normalizedItemBaseName:",d)),h})},km=()=>{var qt,Jt,or;const{routine:t}=bm(),{fetchItemDetails:r,getItemDetails:e,isLoadingItem:a}=wm();zi();const{items:s}=Oh(),[i,c]=U.useState(new Set),[o,d]=U.useState(new Set),[h,p]=U.useState(new Set),[b,m]=U.useState({}),[u,w]=U.useState(!1),[x,_]=U.useState(null),[y,A]=U.useState({}),[L,E]=U.useState(new Set),[O,X]=U.useState({}),[K,H]=U.useState({}),[P,Y]=U.useState({}),[I,S]=U.useState(new Set),[R,N]=U.useState(null),[re,ve]=U.useState(null),[le,oe]=U.useState(null),[ie,Ae]=U.useState(!1),[te,C]=U.useState(null),[G,Z]=U.useState(""),[Q,fe]=U.useState(new Set),[we,Se]=U.useState(new Set),[Ce,Re]=U.useState(!1),[Me,Je]=U.useState(!1),[je,j]=U.useState(null),[T,V]=U.useState({}),[$,z]=U.useState(null),[M,ue]=U.useState(!1),[pe,ce]=U.useState(""),[Le,Ie]=U.useState(null),[Te,Ve]=U.useState(null),[ht,st]=U.useState({}),[ot,yt]=U.useState({}),[dt,Vt]=U.useState({}),[mt,Lt]=U.useState(0),[zt,Et]=U.useState([]),[wt,Kt]=U.useState(!1),[Nt,Ft]=U.useState(!1),[ar,Ot]=U.useState(""),[xt,Xt]=U.useState(null),[er,Or]=U.useState({}),[bn,fn]=U.useState(!1),[Ut,pn]=U.useState(null),[wn,Vr]=U.useState(!1),[qr,gr]=U.useState(null),[Cr,dr]=U.useState(!1),[es,wr]=U.useState(null),[Sn,tn]=U.useState(!1),[kn,$r]=U.useState(null),[Yr,En]=U.useState({}),[lt,Kr]=U.useState({}),[xe,ze]=U.useState({}),[We,Qe]=U.useState(!1),[at,tt]=U.useState(null),[rt,it]=U.useState(""),[At,_t]=U.useState(!1),[$t,Yt]=U.useState(!1),[gt,Wt]=U.useState(null),ir=["âœ¨ Claude is making magic happen","âœ¨ Claude is *still* making magic happen","Yeah, we all love instant gratification, but it'll still be quicker than you could do it from scratch","Are you familiar with the phrase 'A watched pot never boils'? It's kinda like that","Chill, I'm working on it.","You could be stretching or something while you wait, couldn't you?","The pyramids weren't built in a day... ","but hey, at least I'm not going to ask you for an email address to send the chord charts to.","Perfect chord charts take time to craft. These will take less time and they won't be perfect.","Yeah, I could show you a progress bar, but we both know it would just lie to you","This is taking precisely as long as it needs to take","Meanwhile, your guitar is getting dusty just sitting there...","Quality over speed, as they say in the chord chart business. We'll see which this turns out to be","Calculating the optimal finger placement for maximum laziness...","Teaching AI to read guitar tabs is harder than teaching humans, surprisingly","Processing at the speed of artisanal chord crafting","Your patience is being converted into beautiful chord diagrams","Still faster than drawing the chord charts by hand","Fun fact: I process thousands of tokens per second, but this still takes a while. Go figure.","At least you're not on hold listening to elevator music right now","I'd apologize for the wait, but I'm kinda busy with building your chord charts","Remember when you had to buy chord books? Yeah, this is still better than that","I'm doing math that would make your guitar teacher's head spin. Or maybe just mild geometry.","Analyzing fret positions with the intensity of a guitarist tuning by ear in a loud bar","If you're wondering why this takes so long: perfectionism. Just kidding, it's token processing limits.","Good news: I found all the chords. Bad news: I'm still drawing the little dots","Pro tip: This wait time is perfect for questioning your life choices that led to learning Wonderwall","Yes, I could work faster, but then where would the suspense be?","Translating guitar hieroglyphics into something your fingers can actually use...","Automating what should have been automated decades ago. You're welcome.","The AI is thinking. Or maybe procrastinating. Hard to tell, really.","Breaking news: Local AI still processing, guitarist growing older by the second","This would go faster if you stopped watching. Seriously, go practice your scales or something.","Reminder: You could have practiced barre chords for 2 minutes by now. Just saying.","I promise this is the most interesting thing happening on your screen right now. Probably.","Currently debating whether that's a Cadd9 or just someone's finger slipped on the photo"],Pn=F=>{const de=O[F]||[];if(console.log(`[DEBUG] getChordSections for item ${F}:`,de),de.length===0)return[];const me=new Map;return de.forEach(he=>{const Ne=he.sectionId||"section-1",Fe=he.sectionLabel||"Verse",qe=he.sectionRepeatCount||"";console.log(`[DEBUG] Processing chord ${he.id} (${he.title}) for section ${Ne}`,{chordSectionId:he.sectionId,chordSectionLabel:he.sectionLabel,fallbackUsed:!he.sectionId}),me.has(Ne)||me.set(Ne,{id:Ne,label:Fe,repeatCount:qe,chords:[]}),me.get(Ne).chords.push(he)}),Array.from(me.values())},ys=F=>{if(F.length===0)return[];const de=new Map;F.forEach(ge=>{const he=ge.sectionId||"section-1",Ne=ge.sectionLabel||"Verse",Fe=ge.sectionRepeatCount||"";de.has(he)||de.set(he,{id:he,label:Ne,repeatCount:Fe,chords:[]}),de.get(he).chords.push(ge)});const me=Array.from(de.values()).sort((ge,he)=>{const Ne=Math.min(...ge.chords.map(qe=>qe.order||0)),Fe=Math.min(...he.chords.map(qe=>qe.order||0));return Ne-Fe});return me.forEach(ge=>{ge.chords.sort((he,Ne)=>(he.order||0)-(Ne.order||0))}),me},Ar=(F,de="New Section")=>{console.log("Adding new section for item:",F,"with label:",de);const me={id:`section-${Date.now()}`,label:de,repeatCount:"",chords:[]};Y(ge=>{const he={...ge,[F]:[...ge[F]||[],me]};return console.log("Updated chordSections:",he),he})},He=U.useCallback(vm(async(F,de,me)=>{console.log("Debounced section update:",de,me);try{const ge=await fetch(`/api/items/${F}/chord-charts`);if(!ge.ok)throw new Error(`Failed to fetch chord charts for item ${F}`);const Ne=await ge.json();console.log(`[DEBUG] Fresh charts for item ${F}:`,Ne.map(Ke=>({id:Ke.id,title:Ke.title,sectionId:Ke.sectionId||"default-section"})));const Fe=Ne.filter(Ke=>(Ke.sectionId||"section-1")===de);if(Fe.length===0){console.log(`No chord charts to update for section: ${de}. This might be a new section without any chord charts yet.`);return}console.log(`Updating ${Fe.length} chord charts for section ${de}:`,Fe.map(Ke=>Ke.id));const qe=Fe.map(Ke=>{const ut={};return me.label!==void 0&&(ut.sectionLabel=me.label),me.repeatCount!==void 0&&(ut.sectionRepeatCount=me.repeatCount),console.log(`Updating chord chart ${Ke.id} with:`,ut),fetch(`/api/chord-charts/${Ke.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ut)}).then(Xe=>{if(!Xe.ok)throw new Error(`Failed to update chord chart ${Ke.id}: ${Xe.status} ${Xe.statusText}`);return Xe.json()})});await Promise.all(qe),console.log(`Successfully persisted ${Fe.length} chord charts for section ${de}`)}catch(ge){console.error("Error persisting section updates:",ge)}},500),[]),ft=(F,de,me)=>{Y(ge=>({...ge,[F]:(ge[F]||[]).map(he=>he.id===de?{...he,...me}:he)})),X(ge=>({...ge,[F]:(ge[F]||[]).map(he=>(he.sectionId||"section-1")===de?{...he,sectionLabel:me.label!==void 0?me.label:he.sectionLabel,sectionRepeatCount:me.repeatCount!==void 0?me.repeatCount:he.sectionRepeatCount}:he)})),He(F,de,me)},ur=async(F,de)=>{if(!F){console.error("ERROR: deleteSection called with empty itemId",{itemId:F,sectionId:de});return}const me=`${F}-${de}`;if(I.has(me)){console.log(`Delete already in progress for section ${de}`);return}S(ge=>new Set([...ge,me]));try{const ge=(O[F]||[]).filter(qe=>(qe.sectionId||"section-1")===de);if(ge.length===0){console.log(`No chord charts to delete in section ${de}`),Y(qe=>({...qe,[F]:(qe[F]||[]).filter(Ke=>Ke.id!==de)}));return}const he=ge.map(qe=>qe.id);console.log(`Batch deleting ${ge.length} chord charts from section ${de}:`,he),console.log(`DEBUG: Sending item_id=${F} to batch-delete endpoint`);const Ne=await fetch("/api/chord-charts/batch-delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chord_ids:he,item_id:F})});if(!Ne.ok){if(Ne.status===429){const qe=await Ne.json();console.warn("Rate limit exceeded, will retry after delay"),alert(`Rate limit exceeded. Please wait a moment and try again. (${qe.error})`);return}throw new Error(`HTTP ${Ne.status}: Failed to batch delete chord charts`)}const Fe=await Ne.json();if(console.log("Batch delete result:",Fe),Fe.deleted&&Fe.deleted.length>0&&console.log(`Successfully deleted ${Fe.deleted.length} chord charts`),Fe.not_found&&Fe.not_found.length>0&&console.warn(`${Fe.not_found.length} chord charts were already deleted:`,Fe.not_found),Fe.failed&&Fe.failed.length>0&&console.error(`Failed to delete ${Fe.failed.length} chord charts:`,Fe.failed),X(qe=>({...qe,[F]:(qe[F]||[]).filter(Ke=>(Ke.sectionId||"section-1")!==de)})),Y(qe=>({...qe,[F]:(qe[F]||[]).filter(Ke=>Ke.id!==de)})),!Fe.success&&Fe.failed&&Fe.failed.length===he.length)throw new Error(Fe.error||"All chord chart deletions failed")}catch(ge){console.error("Error deleting section:",ge)}finally{S(ge=>{const he=new Set(ge);return he.delete(me),he})}},Wr=U.useCallback(async()=>{if(console.log("[DEBUG BATCH] loadAllChordCharts called"),!t||!t.items)return;const F=t.items.map(me=>me.B),de=F.filter(me=>!O[me]);if(console.log("[DEBUG BATCH] All routine items:",F,"Items needing loading:",de,"Current chordCharts keys:",Object.keys(O)),de.length!==0)try{const me=await fetch("/api/chord-charts/batch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({item_ids:de})});if(me.ok){const he=await me.json();X(Ne=>({...Ne,...he})),Object.entries(he).forEach(([Ne,Fe])=>{if(Fe.length===0)Y(qe=>({...qe,[Ne]:[]}));else{const qe=new Map;Fe.forEach(ut=>{const Xe=ut.sectionId||"section-1",ct=ut.sectionLabel||"Verse",be=ut.sectionRepeatCount||"";qe.has(Xe)||qe.set(Xe,{id:Xe,label:ct,repeatCount:be,chords:[]}),qe.get(Xe).chords.push(ut)});const Ke=Array.from(qe.values());Y(ut=>({...ut,[Ne]:Ke}))}})}}catch(me){console.error("Error batch loading chord charts:",me)}},[t]);U.useEffect(()=>{console.log("[DEBUG EFFECT] useEffect triggered for routine/loadAllChordCharts"),t&&t.items&&(Wr(),_0(t.name))},[t,Wr]),U.useEffect(()=>{if(Q.size>0){const F=new Set;Q.forEach(de=>{const me=s==null?void 0:s.find(Ne=>Ne.A===de),ge=me==null?void 0:me.B;(O[ge]||[]).length>0&&F.add(de)}),Se(F)}else Se(new Set)},[Q,O,s]),U.useEffect(()=>{if(Object.values(T).filter(he=>he==="processing").length===0){Lt(0),Et([]);return}Lt(0);const me=Array.from({length:ir.length-1},(he,Ne)=>Ne+1).sort(()=>Math.random()-.5);Et(me);const ge=setInterval(()=>{Et(he=>{if(he.length===0){const Fe=Array.from({length:ir.length},(ut,Xe)=>Xe).sort(()=>Math.random()-.5),qe=Fe[0],Ke=Fe.slice(1);return Lt(qe),Ke}else{const Ne=he[0],Fe=he.slice(1);return Lt(Ne),Fe}})},1e4);return()=>clearInterval(ge)},[T,ir.length]);const Mr=async F=>{if(!O[F])try{const de=await fetch(`/api/items/${F}/chord-charts`);if(de.ok){const me=await de.json(),ge=me;if(X(Ne=>({...Ne,[F]:ge})),ge.length===0){Y(Ne=>({...Ne,[F]:[]}));return}const he=new Map;ge.forEach(Ne=>{const Fe=Ne.sectionId||"section-1",qe=Ne.sectionLabel||"Verse",Ke=Ne.sectionRepeatCount||"";he.has(Fe)||he.set(Fe,{id:Fe,label:qe,repeatCount:Ke,chords:[]}),he.get(Fe).chords.push(Ne)}),Y(Ne=>({...Ne,[F]:Array.from(he.values())})),console.log("[DEBUG] Loaded chord charts for item:",F,me.length)}}catch(de){console.error("Error loading chord charts for item:",F,de)}},Lr=U.useMemo(()=>t!=null&&t.items?new Set(t.items.filter(F=>F.D==="TRUE").map(F=>F.A)):new Set,[t]),[Hn,ba]=U.useState(new Set),Jr=U.useRef(null),wa=U.useRef(null),Ir=U.useRef(null),va=U.useRef(null);U.useEffect(()=>{Jr.current=new(window.AudioContext||window.webkitAudioContext),wa.current=Jr.current.createGain();const F=localStorage.getItem("gpra_timer_volume"),de=F!==null?parseFloat(F):5.5;return wa.current.gain.value=de/11*3,wa.current.connect(Jr.current.destination),fetch("/static/sound/timesUp.mp3").then(me=>me.arrayBuffer()).then(me=>Jr.current.decodeAudioData(me)).then(me=>{va.current=me}).catch(me=>console.error("Error loading sound:",me)),()=>{Jr.current&&Jr.current.close()}},[]),U.useEffect(()=>{const F=setInterval(()=>{A(de=>{const me={...de};let ge=!1;return h.forEach(he=>{me[he]>0&&(me[he]=me[he]-1,ge=!0,me[he]===0&&(Ir.current&&Ir.current.stop(),va.current&&Jr.current&&(Ir.current=Jr.current.createBufferSource(),Ir.current.buffer=va.current,Ir.current.connect(wa.current),Ir.current.start(),console.log("[AUDIO] Timer completion sound played"))))}),ge?me:de})},1e3);return console.log("Timer effect: Active timers:",Array.from(h)),()=>{clearInterval(F),Ir.current&&(Ir.current.stop(),Ir.current=null)}},[h]),U.useEffect(()=>{ba(Lr)},[Lr]);const Na=U.useCallback(async F=>{try{const de=await fetch(`/api/items/${F}/notes`);if(!de.ok)throw new Error("Failed to fetch notes");const me=await de.json();me.notes&&m(ge=>({...ge,[F]:me.notes}))}catch(de){console.error("Error fetching notes:",de)}},[]),$s=U.useMemo(()=>{if(!te||!s)return new Set;const F=s.find(ge=>ge.B===te),de=(F==null?void 0:F.C)||"",me=s.filter(ge=>ge.B!==te);return new Set(Vl(de,me,te).map(ge=>ge.A))},[te,s]),Ws=U.useMemo(()=>s?s.filter(F=>{if(F.B===te)return!1;if(G.trim()){const de=F.C||"",me=Ei(de),ge=Ei(G);return ge?(console.log(`DEBUG SEARCH: "${G}" -> "${ge}" searching in "${de}" -> "${me}" -> match: ${me.includes(ge)}`),me.includes(ge)):!0}return!0}).sort((F,de)=>{if(G.trim()){const Fe=F.C||"",qe=de.C||"";return Fe.localeCompare(qe)}const me=$s.has(F.A),ge=$s.has(de.A);if(me&&!ge)return-1;if(!me&&ge)return 1;const he=F.C||"",Ne=de.C||"";return he.localeCompare(Ne)}):[],[s,te,G,$s]),$a=U.useMemo(()=>{if(!Te||!s)return new Set;const F=s.find(ge=>ge.B===Te),de=(F==null?void 0:F.C)||"",me=s.filter(ge=>ge.B!==Te);return new Set(Vl(de,me,Te).map(ge=>ge.A))},[Te,s]),di=U.useMemo(()=>s?s.filter(F=>{if(F.B===Te)return!1;if(pe.trim()){const de=F.C||"",me=Ei(de),ge=Ei(pe);return ge?me.includes(ge):!0}return!0}).sort((F,de)=>{if(pe.trim()){const Fe=F.C||"",qe=de.C||"";return Fe.localeCompare(qe)}const me=$a.has(F.A),ge=$a.has(de.A);if(me&&!ge)return-1;if(!me&&ge)return 1;const he=F.C||"",Ne=de.C||"";return he.localeCompare(Ne)}):[],[s,Te,pe,$a]),[ra,_a]=U.useState({});U.useEffect(()=>{M&&s&&Object.keys(ra).length===0&&(async()=>{const de={},me=s.map(ge=>ge.B);try{const ge=await fetch("/api/chord-charts/batch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({item_ids:me})});if(ge.ok){const he=await ge.json();Object.entries(he).forEach(([Ne,Fe])=>{de[Ne]=(Fe||[]).length}),_a(de)}}catch(ge){console.error("Error loading chord chart counts:",ge)}})()},[M,s,ra]);const ui=U.useMemo(()=>di.filter(F=>{const de=F.B;return ra[de]>0}),[di,ra]);U.useEffect(()=>{const F=de=>{de.key==="Escape"&&(ie?Gn():M?Sa():Me?(Je(!1),j(null)):bn?fn(!1):wn?Vr(!1):wt?Kt(!1):Cr?dr(!1):We?(Qe(!1),tt(null),it("")):At&&_t(!1))};return document.addEventListener("keydown",F),()=>document.removeEventListener("keydown",F)},[ie,M,Me,bn,wn,wt,Cr,We,At]);const Bn=U.useCallback((F,de)=>{console.log(`Initializing timer for item ${F} with duration ${de} minutes`),A(me=>me[F]?me:{...me,[F]:de*60})},[]),hi=async F=>{c(de=>{const me=new Set(de);if(me.has(F))me.delete(F);else{me.add(F);const ge=t.items.find(he=>he.A===F);if(ge){const he=ge.B;r(he).then(Ne=>{Ne&&(Bn(F,Ne.E||5),Na(he))})}}return me})},ks=async(F,de=!0)=>{const me=t.items.find(ge=>ge.A===F);if(me){if(de&&Jr.current&&Jr.current.state==="suspended")try{await Jr.current.resume(),console.log("[AUDIO] AudioContext resumed after user interaction")}catch(ge){console.error("[AUDIO] Failed to resume AudioContext:",ge)}if(Ir.current&&Ir.current.stop(),!y[F]){console.log(`Timer ${F} not found, initializing...`);const ge=e(me.B),he=(ge==null?void 0:ge.E)||5;Bn(F,he)}p(ge=>{const he=new Set(ge),Ne=e(me.B),Fe=(Ne==null?void 0:Ne.C)||`Item ${F}`;return console.log(`Activating timer ${F}`),he.add(F),$o("started_timer",Fe),he})}},Wa=async()=>{localStorage.setItem("timerSoundModalDismissed","true"),sessionStorage.setItem("timerSoundModalDismissedSession","true"),window.posthog&&window.posthog.capture("timer_sound_modal_dismissed",{action:"got_it",$set:{timer_sound_modal_dismissed:!0}}),Yt(!1),gt&&(await ks(gt,!0),Wt(null))},fi=async()=>{sessionStorage.setItem("timerSoundModalDismissedSession","true"),Yt(!1),gt&&(await ks(gt,!0),Wt(null))},Ht=async(F,de)=>{de==null||de.stopPropagation();const me=t.items.find(ge=>ge.A===F);if(me)if(h.has(F))Ir.current&&Ir.current.stop(),p(he=>{const Ne=new Set(he),Fe=e(me.B),qe=(Fe==null?void 0:Fe.C)||`Item ${F}`;console.log(`Deactivating timer ${F}`),Ne.delete(F);const Ke=((Fe==null?void 0:Fe.E)||5)*60,ut=y[F]||Ke,Xe=Ke-ut;return $o("timer_stopped",qe,{time_elapsed_seconds:Math.max(0,Xe),initial_duration_minutes:(Fe==null?void 0:Fe.E)||5}),Ne});else{if(Jr.current&&Jr.current.state==="suspended")try{await Jr.current.resume(),console.log("[AUDIO] AudioContext state after resume:",Jr.current.state)}catch(Fe){console.log("[AUDIO] Resume failed:",Fe)}const he=localStorage.getItem("timerSoundModalDismissed")==="true",Ne=sessionStorage.getItem("timerSoundModalDismissedSession")==="true";he||Ne?await ks(F,!0):(console.log("[AUDIO] First timer start this session, showing sound info modal"),Wt(F),Yt(!0))}},pi=async(F,de)=>{de==null||de.stopPropagation();const me=!Hn.has(F);try{const ge=await fetch(`/api/routines/${t.id}/items/${F}/complete`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({completed:me})});if(!ge.ok)throw new Error("Failed to update completion state");(await ge.json()).success&&ba(Ne=>{const Fe=new Set(Ne);if(me){Fe.add(F);const qe=t.items.find(ut=>ut.A===F);if(qe){const ut=e(qe.B),Xe=(ut==null?void 0:ut.C)||`Item ${F}`,ct=((ut==null?void 0:ut.E)||5)*60,be=y[F]||ct,bt=ct-be;$o("marked_done",Xe,{time_elapsed_seconds:Math.max(0,bt),was_timer_active:h.has(F),initial_duration_minutes:(ut==null?void 0:ut.E)||5})}p(ut=>{const Xe=new Set(ut);return Xe.delete(F),Xe});const Ke=t.items.findIndex(ut=>ut.A===F);c(ut=>{const Xe=new Set(ut);if(Xe.delete(F),Ke<t.items.length-1){const ct=t.items[Ke+1];Xe.add(ct.A);const be=ct.B;r(be).then(bt=>{bt&&(Bn(ct.A,bt.E||5),Na(be))})}return Xe})}else Fe.delete(F);return Fe})}catch(ge){console.error("Error updating completion state:",ge)}},mi=async(F,de)=>{if(de==null||de.stopPropagation(),Jr.current&&Jr.current.state==="suspended")try{await Jr.current.resume(),console.log("[AUDIO] AudioContext resumed after user interaction")}catch(ge){console.error("[AUDIO] Failed to resume AudioContext:",ge)}Ir.current&&Ir.current.stop();const me=t.items.find(ge=>ge.A===F);if(me){const ge=e(me.B),he=(ge==null?void 0:ge.E)||5,Ne=(ge==null?void 0:ge.C)||`Item ${F}`;A(Fe=>({...Fe,[F]:he*60})),$o("timer_reset",Ne)}},$i=async(F,de)=>{de==null||de.stopPropagation(),_(F),w(!0)},As=async()=>{await Na(x),_(null)},bs=(F,de)=>{de==null||de.stopPropagation(),d(me=>{const ge=new Set(me);return ge.has(F)?ge.delete(F):ge.add(F),ge})},Wi=async F=>{F==null||F.stopPropagation();try{if(!(await fetch(`/api/routines/${t.id}/reset`,{method:"POST",headers:{"Content-Type":"application/json"}})).ok)throw new Error("Failed to reset progress");ba(new Set)}catch(de){console.error("Error resetting progress:",de)}},{totalMinutes:Hi,completedMinutes:na}=U.useMemo(()=>{if(!(t!=null&&t.items))return{totalMinutes:0,completedMinutes:0};const F=t.items.reduce((me,ge)=>{const he=e(ge.B),Ne=parseInt(he==null?void 0:he.E)||5;return me+Ne},0),de=t.items.filter(me=>Hn.has(me.A)).reduce((me,ge)=>{const he=e(ge.B),Ne=parseInt(he==null?void 0:he.E)||5;return me+Ne},0);return{totalMinutes:F,completedMinutes:de}},[t,Hn,e]);U.useEffect(()=>{if(!window.svguitar){const F=document.createElement("script");F.src="https://omnibrain.github.io/svguitar/js/svguitar.umd.js",F.async=!0,document.body.appendChild(F)}},[]);const ja=(F,de)=>{de==null||de.stopPropagation(),E(me=>{const ge=new Set(me);if(ge.has(F))ge.delete(F);else{ge.add(F);const he=t.items.find(Ne=>Ne.A===F);if(he){const Ne=he.B;Mr(Ne)}}return ge})},sa=async(F,de)=>{var me;try{zd("Saving chord chart for item",{itemId:F,chartData:de}),Qr("PracticePage handleSaveChordChart called",{editingChordId:R,chartData:de});const ge=de.editingChordId;Qr("PracticePage isUpdate check result",{isUpdate:ge,editingChordIdFromState:R,editingChordIdFromChartData:de.editingChordId});let he={...de};if(ge){const Xe=(O[F]||[]).find(ct=>ct.id===de.editingChordId);he.sectionId=Xe==null?void 0:Xe.sectionId,he.sectionLabel=Xe==null?void 0:Xe.sectionLabel,he.sectionRepeatCount=Xe==null?void 0:Xe.sectionRepeatCount,Qr("Updating chord, preserving section",{originalSection:{id:Xe==null?void 0:Xe.sectionId,label:Xe==null?void 0:Xe.sectionLabel,repeatCount:Xe==null?void 0:Xe.sectionRepeatCount}})}else{const Xe=P[F]||Pn(F);let ct;de.insertionContext?ct={id:de.insertionContext.sectionId,label:de.insertionContext.sectionLabel,repeatCount:de.insertionContext.sectionRepeatCount}:Xe.length===0?ct={id:"section-1",label:"Verse",repeatCount:""}:ct=Xe[Xe.length-1],he.sectionId=ct.id,he.sectionLabel=ct.label,he.sectionRepeatCount=ct.repeatCount}he.hasLineBreakAfter=de.startOnNewLine||!1,Qr("Setting line break after chord",{title:he.title,hasLineBreakAfter:he.hasLineBreakAfter}),Qr("Chord data with section metadata",{chartDataWithSection:he});const Ne=ge?`/api/chord-charts/${de.editingChordId}`:`/api/items/${F}/chord-charts`,Fe=ge?"PUT":"POST";Qr(`${ge?"Updating":"Creating"} chord chart`,{method:Fe,url:Ne}),console.log("[DEBUG LINE BREAKS] Sending to server:",{title:he.title,hasLineBreakAfter:he.hasLineBreakAfter});const qe=await fetch(Ne,{method:Fe,headers:{"Content-Type":"application/json"},body:JSON.stringify(he)});if(!qe.ok)throw new Error(`Failed to save chord chart: ${qe.statusText}`);const Ke=await qe.json();if(zd("Chord chart saved successfully",{savedChart:Ke}),console.log("[DEBUG LINE BREAKS] Server returned:",{id:Ke.id,title:Ke.title,hasLineBreakAfter:Ke.hasLineBreakAfter}),console.log("DEBUG: Saved chord detailed breakdown:",{id:Ke.id,title:Ke.title,fingers:Ke.fingers,fingersType:typeof Ke.fingers,fingersLength:(me=Ke.fingers)==null?void 0:me.length,barres:Ke.barres,barresType:typeof Ke.barres,tuning:Ke.tuning,startingFret:Ke.startingFret,numFrets:Ke.numFrets,numStrings:Ke.numStrings,openStrings:Ke.openStrings,mutedStrings:Ke.mutedStrings}),X(Xe=>{const ct=Xe[F]||[];if(ge){const be=parseInt(de.editingChordId);Qr("Updating chordCharts state",{editingId:be,editingChordIdOriginal:de.editingChordId,existingChartIds:ct.map(jt=>({id:jt.id,type:typeof jt.id}))});let bt=ct.map(jt=>{const tr=parseInt(jt.id)===be;return tr&&(Qr("Found matching chord to update",{chart:jt.id,editingId:be}),console.log("DEBUG: State update - replacing old chart:",{oldChart:jt,newChart:Ke,fingersOld:jt.fingers,fingersNew:Ke.fingers})),tr?Ke:jt});return he._lineBreakUpdater&&(Qr("Applying stored line break updater to preserve line breaks"),bt=he._lineBreakUpdater(bt)),Qr("Updated charts result",{originalCount:ct.length,updatedCount:bt.length,foundMatch:bt.some(jt=>parseInt(jt.id)===be),hasLineBreakUpdater:!!he._lineBreakUpdater}),{...Xe,[F]:bt}}else{let be=[...ct,Ke];return he._lineBreakUpdater&&(Qr("Applying stored line break updater to preserve line breaks for new chord"),be=he._lineBreakUpdater(be)),{...Xe,[F]:be}}}),Y(Xe=>{const ct=Xe[F]||[];if(ge){const be=parseInt(de.editingChordId);Qr("Updating chordSections state",{editingId:be,sectionsCount:ct.length});let bt=ct.map(jt=>{const tr=jt.chords.map(vr=>{const Dt=parseInt(vr.id)===be;return Dt&&Qr("Found matching chord in section",{sectionId:jt.id,sectionLabel:jt.label,chordId:vr.id,editingId:be}),Dt?Ke:vr});return{...jt,chords:tr}});return he._lineBreakUpdater&&(Qr("Applying line break updater to sections state"),bt=bt.map(jt=>({...jt,chords:he._lineBreakUpdater(jt.chords)}))),console.log("[DEBUG LINE BREAKS] setChordSections update:",F,"updated sections with hasLineBreakAfter values:",bt.flatMap(jt=>jt.chords).map(jt=>({id:jt.id,title:jt.title,hasLineBreakAfter:jt.hasLineBreakAfter}))),{...Xe,[F]:bt}}else{if(ct.length===0){const bt=[{id:"section-1",label:"Verse",repeatCount:"",chords:[Ke]}];return he._lineBreakUpdater&&(Qr("Applying line break updater to new section"),bt[0].chords=he._lineBreakUpdater(bt[0].chords)),{...Xe,[F]:bt}}const be=[...ct];if(de.insertionContext){const bt=be.findIndex(jt=>jt.id===de.insertionContext.sectionId);if(bt>=0){const jt={...be[bt]},tr=de.insertionContext.insertOrder,vr=jt.chords.findIndex(Dt=>parseInt(Dt.order)>=tr);vr>=0?jt.chords=[...jt.chords.slice(0,vr),Ke,...jt.chords.slice(vr)]:jt.chords=[...jt.chords,Ke],be[bt]=jt}else{const jt={...be[be.length-1]};jt.chords=[...jt.chords,Ke],be[be.length-1]=jt}}else{const bt={...be[be.length-1]};bt.chords=[...bt.chords,Ke],be[be.length-1]=bt}return he._lineBreakUpdater&&(Qr("Applying line break updater to updated sections"),be.forEach(bt=>{bt.chords=he._lineBreakUpdater(bt.chords)})),{...Xe,[F]:be}}}),t.items.find(Xe=>Xe.B===F)){const Xe=e(F),ct=(Xe==null?void 0:Xe.C)||`Item ${F}`;ge?Zs("edited",ct,{chord_name:de.title||"Unknown Chord",section_id:he.sectionId,section_label:he.sectionLabel}):Zs("added",ct,{chord_name:de.title||"Unknown Chord",section_id:he.sectionId,section_label:he.sectionLabel})}H(Xe=>({...Xe,[F]:!1})),N(null),ve(null),ws()}catch(ge){console.error("Error saving chord chart:",ge)}},Gi=async(F,de)=>{try{console.log("Deleting chord chart:",de,"for item:",F);const me=await fetch(`/api/items/${F}/chord-charts/${de}`,{method:"DELETE"});if(!me.ok){if(me.status===429){const he=await me.json();console.warn("Rate limit exceeded for individual delete"),alert(`Rate limit exceeded. Please wait a moment and try again. (${he.error})`);return}throw new Error(`Failed to delete chord chart: ${me.statusText}`)}if(console.log("Chord chart deleted successfully"),t.items.find(he=>he.B===F)){const he=e(F),Ne=(he==null?void 0:he.C)||`Item ${F}`,Fe=(O[F]||[]).find(qe=>qe.id===de);Zs("deleted",Ne,{chord_name:(Fe==null?void 0:Fe.title)||"Unknown Chord",chord_id:de})}X(he=>{const Ne=he[F]||[];return{...he,[F]:Ne.filter(Fe=>Fe.id!==de)}}),Y(he=>{const Fe=(he[F]||[]).map(qe=>({...qe,chords:qe.chords.filter(Ke=>Ke.id!==de)}));return{...he,[F]:Fe}})}catch(me){console.error("Error deleting chord chart:",me)}},ws=()=>{le&&(setTimeout(()=>{const F=document.querySelector(`[data-chord-id="${le.chordId}"]`);F?F.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"}):window.scrollTo({top:le.scrollPosition,behavior:"smooth"})},100),oe(null))},Vi=(F,de,me)=>{console.log("Edit chord chart:",de,"for item:",F,"with data:",me),oe({itemId:F,chordId:de,scrollPosition:window.scrollY}),H(ge=>({...ge,[F]:!0})),N(de),setTimeout(()=>{const ge=document.querySelector(`[data-editor-for-item="${F}"]`);ge&&ge.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})},100)},Ha=(F,de,me)=>{console.log("Insert chord after:",de,"for item:",F,"with data:",me),oe({itemId:F,chordId:de,scrollPosition:window.scrollY}),H(ge=>({...ge,[F]:!0})),ve({afterChordId:de,sectionId:me.sectionId,sectionLabel:me.sectionLabel,sectionRepeatCount:me.sectionRepeatCount,insertOrder:parseInt(me.order)+1}),N(null),setTimeout(()=>{const ge=document.querySelector(`[data-editor-for-item="${F}"]`);ge&&ge.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},100)},Ga=F=>{console.log("Print button clicked for item:",F);const de=document.querySelector(`[data-item-id="${F}"].chord-charts-container`);console.log("Found container:",de),de?(de.classList.add("chord-chart-print-area"),window.print(),setTimeout(()=>{de.classList.remove("chord-chart-print-area")},100)):console.error("Could not find chord charts container for item:",F)},gi=async F=>{console.log("Opening copy modal for item:",F),C(F);const de=s==null?void 0:s.find(Ne=>Ne.B===F),me=(de==null?void 0:de.C)||"",ge=Vl(me,s,F);console.log("Source:",me),console.log("Found similar songs:",ge.map(Ne=>Ne.C));const he=[F,...ge.map(Ne=>Ne.B)];console.log("Loading chord charts for relevant items:",he.length,"items");for(const Ne of he)try{const Fe=await fetch(`/api/items/${Ne}/chord-charts`);if(Fe.ok){const qe=await Fe.json();X(Ke=>({...Ke,[Ne]:qe})),console.log(`Loaded ${qe.length} charts for item ${Ne}`)}}catch(Fe){console.error(`Error loading chord charts for item ${Ne}:`,Fe)}Ae(!0),Z(""),fe(new Set),z(null)},Gn=()=>{Ae(!1),C(null),Z(""),fe(new Set),Se(new Set),Re(!1),z(null)},Va=F=>{fe(de=>{const me=new Set(de);if(me.has(F))me.delete(F);else{me.add(F);const ge=s==null?void 0:s.find(Ne=>Ne.A===F),he=ge==null?void 0:ge.B;he&&Mr(he)}return me})},aa=async()=>{if(console.log("handleConfirmCopy called",{copySourceItemId:te,selectedTargetItems:Array.from(Q)}),!te||Q.size===0){console.log("Early return: missing source or targets");return}if(we.size>0&&!Ce){console.log("Showing overwrite confirmation, items with existing charts:",we.size),Re(!0);return}try{const F=await fetch("/api/chord-charts/copy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({source_item_id:te,target_item_ids:Array.from(Q).map(he=>{const Ne=s==null?void 0:s.find(Fe=>Fe.A===he);return Ne==null?void 0:Ne.B}).filter(Boolean)})});if(!F.ok)throw new Error(`Failed to copy chord charts: ${F.statusText}`);const de=await F.json();console.log("Chord charts copied successfully:",de),z("complete");const me=Array.from(Q).map(he=>{const Ne=s==null?void 0:s.find(Fe=>Fe.A===he);return Ne==null?void 0:Ne.B}).filter(Boolean),ge=[te,...me];console.log("[DEBUG COPY] About to refresh chord charts for affected items:",ge);for(const he of ge)try{const Ne=await fetch(`/api/items/${he}/chord-charts`);if(Ne.ok){const Fe=await Ne.json();if(console.log("[DEBUG COPY] Updating chordCharts state for item",he,"with",Fe.length,"charts"),X(qe=>({...qe,[he]:Fe})),Fe.length===0)Y(qe=>({...qe,[he]:[]}));else{const qe=new Map;Fe.forEach(ut=>{const Xe=ut.sectionId||"section-1",ct=ut.sectionLabel||"Verse",be=ut.sectionRepeatCount||"";qe.has(Xe)||qe.set(Xe,{id:Xe,label:ct,repeatCount:be,chords:[]}),qe.get(Xe).chords.push(ut)});const Ke=Array.from(qe.values()).sort((ut,Xe)=>{const ct=ut.chords.length>0&&ut.chords[0].order||0,be=Xe.chords.length>0&&Xe.chords[0].order||0;return ct-be});console.log("[DEBUG COPY] Updating chordSections state for item",he,"with",Ke.length,"sections"),Y(ut=>({...ut,[he]:Ke}))}}}catch(Ne){console.error("Error refreshing chord charts for item",he,Ne)}Gn()}catch(F){console.error("Error copying chord charts:",F)}},Ya=()=>{console.log("Overwrite confirmed, proceeding with copy"),Re(!1),aa()},ia=()=>{console.log("Overwrite cancelled, returning to item selection"),Re(!1)},Ka=F=>{console.log("Opening copy from modal for item:",F),Ve(F),ue(!0),ce(""),Ie(null)},Sa=()=>{ue(!1),Ve(null),ce(""),Ie(null),_a({})},xi=async()=>{if(console.log("handleConfirmCopyFrom called",{selectedSourceItem:Le,copyFromTargetItemId:Te}),!Le||!Te){console.log("Early return: missing source or target");return}try{const F=await fetch("/api/chord-charts/copy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({source_item_id:Le,target_item_ids:[Te]})});if(!F.ok)throw new Error(`Failed to copy chord charts: ${F.statusText}`);const de=await F.json();console.log("Chord charts copied successfully:",de);const me=await fetch(`/api/items/${Te}/chord-charts`);if(me.ok){const ge=await me.json();if(X(he=>({...he,[Te]:ge})),ge.length===0)Y(he=>({...he,[Te]:[]}));else{const he=new Map;ge.forEach(Fe=>{const qe=Fe.sectionId||"section-1",Ke=Fe.sectionLabel||"Verse",ut=Fe.sectionRepeatCount||"";he.has(qe)||he.set(qe,{id:qe,label:Ke,repeatCount:ut,chords:[]}),he.get(qe).chords.push(Fe)});const Ne=Array.from(he.values()).sort((Fe,qe)=>{const Ke=Fe.chords.length>0&&Fe.chords[0].order||0,ut=qe.chords.length>0&&qe.chords[0].order||0;return Ke-ut});Y(Fe=>({...Fe,[Te]:Ne}))}}Sa()}catch(F){console.error("Error copying chord charts:",F)}},Cs=F=>{(O[F]||[]).length>0&&(j(F),Je(!0))},Ls=async()=>{if(je)try{const F=O[je]||[];for(const de of F)if(!(await fetch(`/api/items/${je}/chord-charts/${de.id}`,{method:"DELETE"})).ok)throw new Error(`Failed to delete chord chart ${de.id}`);X(de=>({...de,[je]:[]})),Y(de=>({...de,[je]:[]})),Je(!1),j(null)}catch(F){console.error("Error deleting existing chord charts:",F)}},yi=F=>{dt[F]&&dt[F].abort(),V(de=>{const me={...de};return delete me[F],me}),Vt(de=>{const me={...de};return delete me[F],me}),Or(de=>{const me={...de};return delete me[F],me})},ts=F=>{Xt(F),Kt(!0)},bi=()=>{xt&&yi(xt),Kt(!1),Xt(null)},g=()=>{Kt(!1),Xt(null)},D=(F,de)=>{if(!(!de||de.length===0)){if(de.length>5){alert("Maximum 5 files allowed. Please select fewer files.");return}Or(me=>({...me,[F]:Array.from(de)}))}},ne=(F,de)=>{if(!F||F.trim().length===0)return ze(Fe=>({...Fe,[de]:null})),!0;const me=F.trim();return/^[A-Za-z0-9#bâ™­â™¯/\s,\n\r-]+$/.test(me)?me.split(/[\n\r]+/).some(Fe=>{const qe=Fe.trim();return qe.length===0?!1:/^[A-Za-z]+$/.test(qe)?!0:qe.split(/[,\s]+/).filter(Xe=>Xe.trim().length>0).every(Xe=>/^[A-Ga-g][A-Za-z0-9#bâ™­â™¯/]*$/.test(Xe))})?(ze(Fe=>({...Fe,[de]:null})),!0):(ze(Fe=>({...Fe,[de]:'Please enter chord names separated by commas, spaces, or section names (e.g., "C, G, Am, F" or "D A G D" or "Intro")'})),!1):(ze(Fe=>({...Fe,[de]:"Only chord names (A-G), numbers, #, b, â™­, â™¯, /, commas, spaces, and section names are allowed"})),!1)},ye=async F=>{var he,Ne;const de=er[F]||[],me=(he=Yr[F])==null?void 0:he.trim(),ge=(Ne=lt[F])==null?void 0:Ne.trim();if(console.log(`[AUTOCREATE] handleProcessFiles called for item ${F}, files:`,de.length,"youtubeUrl:",me,"manualChords:",ge),me){await Ge(F,me);return}if(ge)if(ne(ge,F)){await Ee(F,ge);return}else return;if(de.length===0){alert("Please add at least one file, YouTube URL, or manual chord input before processing.");return}await Pt(F,de)},Ee=async(F,de)=>{console.log(`[AUTOCREATE] Processing manual chord input for item ${F}:`,de),V(me=>({...me,[F]:"processing"}));try{const me=new Blob([de],{type:"text/plain"}),ge=new File([me],"manual-input.txt",{type:"text/plain"}),he=new FormData;he.append("file0",ge),he.append("itemId",F),he.append("userChoice","chord_names"),console.log("[AUTOCREATE] Sending manual input to autocreate endpoint");const Ne=await fetch("/api/autocreate-chord-charts",{method:"POST",body:he});if(!Ne.ok){let Xe=`Failed to process manual input: ${Ne.statusText}`;try{const ct=await Ne.json();if(ct.error&&(Xe=ct.error),ct.requires_api_key)throw new Error("API_KEY_REQUIRED: "+Xe)}catch(ct){if(!ct.message.startsWith("API_KEY_REQUIRED"))console.warn("Could not parse error response:",ct);else throw ct}throw new Error(Xe)}const Fe=await Ne.json();console.log("[AUTOCREATE] Manual input processed successfully:",Fe),ri();const Ke=await(await fetch(`/api/items/${F}/chord-charts`)).json();X(Xe=>({...Xe,[F]:Ke})),Y(Xe=>({...Xe,[F]:ys(Ke)})),Kr(Xe=>({...Xe,[F]:""}));const ut=e(F);$r({itemTitle:(ut==null?void 0:ut.C)||`Item ${F}`,chordsCreated:Ke.length,processingMethod:"Manual Entry"}),tn(!0)}catch(me){if(console.error("Error processing manual chord input:",me),me.message&&me.message.startsWith("API_KEY_REQUIRED: ")){const ge=me.message.replace("API_KEY_REQUIRED: ","");wr({message:ge,requiresApiKey:!0})}else wr({message:me.message||"Failed to process manual chord input. Please try again."});dr(!0)}finally{V(me=>{const ge={...me};return delete ge[F],ge})}},Ge=async(F,de)=>{console.log(`[YOUTUBE] Processing YouTube URL for item ${F}:`,de);const me=de.trim().replace(/[<>"']/g,"");if(!/^https?:\/\/(www\.)?(youtube\.com\/watch\?v=[\w-]+|youtu\.be\/[\w-]+)(\?.*|&.*)?$/.test(me)){wr({message:"Please enter a valid YouTube URL (e.g., https://youtube.com/watch?v=...)"}),dr(!0);return}V(he=>({...he,[F]:"checking_transcript"}));try{console.log("[YOUTUBE] Fetching transcript from YouTube API");const he=await fetch("/api/youtube/check-transcript",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:me})});if(!he.ok)throw new Error("Failed to fetch YouTube transcript");const Ne=await he.json();if(!Ne.hasTranscript||!Ne.transcript){wr({message:"This YouTube video does not have a transcript available. Please try a different video or use file upload instead."}),dr(!0);return}console.log(`[YOUTUBE] Transcript fetched successfully, length: ${Ne.transcript.length} characters`),await Ze(F,Ne.transcript)}catch(he){console.error("Error processing YouTube URL:",he),wr({message:"Failed to process YouTube URL. Please try again."}),dr(!0),V(Ne=>{const Fe={...Ne};return delete Fe[F],Fe})}},Ze=async(F,de)=>{let me=!1,ge=null;try{V(ct=>({...ct,[F]:"reading_transcript"}));const he=new FormData;he.append("itemId",F);const Ne=new Blob([de],{type:"text/plain"});he.append("file0",Ne,"youtube_transcript.txt"),ge=setTimeout(()=>{me||V(ct=>({...ct,[F]:"processing"}))},2e3);const qe=await fetch("/api/autocreate-chord-charts",{method:"POST",headers:{"X-Item-Id":F},body:he});if(!qe.ok){let ct=`Failed to create chord charts: ${qe.statusText}`;try{const be=await qe.json();if(be.error&&(ct=be.error),be.requires_api_key)throw new Error("API_KEY_REQUIRED: "+ct)}catch(be){if(!be.message.startsWith("API_KEY_REQUIRED"))console.warn("Could not parse error response:",be);else throw be}throw new Error(ct)}const Ke=await qe.json();if(console.log("[YOUTUBE] Chord charts created successfully:",Ke),ri(),Ke.error&&Ke.error.includes("No chord names found in this transcript")){_t(!0),V(ct=>{const be={...ct};return delete be[F],be}),En(ct=>({...ct,[F]:""}));return}if(t.items.find(ct=>ct.B===F)){const ct=e(F),be=(ct==null?void 0:ct.C)||`Item ${F}`;Zs("autocreated",be,{content_type:"youtube_transcript",source:"youtube_url"})}const Xe=e(F);$r({itemName:(Xe==null?void 0:Xe.C)||`Item ${F}`,chordCount:Ke.chord_count||0,contentType:"youtube_transcript",uploadedFileNames:"YouTube transcript",isVisionAnalysis:!1}),tn(!0);try{const ct=await fetch(`/api/items/${F}/chord-charts`);if(ct.ok){const bt=await ct.json();if(X(jt=>({...jt,[F]:bt})),bt.length===0)Y(jt=>({...jt,[F]:[]}));else{const jt=new Map;bt.forEach(vr=>{const Dt=vr.sectionId||"section-1",xr=vr.sectionLabel||"Verse",Nr=vr.sectionRepeatCount||"";jt.has(Dt)||jt.set(Dt,{id:Dt,label:xr,repeatCount:Nr,chords:[]}),jt.get(Dt).chords.push(vr)});const tr=Array.from(jt.values());Y(vr=>({...vr,[F]:tr}))}}}catch(ct){console.error("Error refreshing chord charts:",ct)}En(ct=>({...ct,[F]:""})),V(ct=>{const be={...ct};return delete be[F],be})}catch(he){if(me=!0,ge&&clearTimeout(ge),console.error("Error processing YouTube transcript:",he),he.message&&he.message.startsWith("API_KEY_REQUIRED: ")){const Ne=he.message.replace("API_KEY_REQUIRED: ","");wr({message:Ne,requiresApiKey:!0})}else wr({message:he.message||"Failed to create chord charts from transcript. Please try again."});dr(!0),V(Ne=>{const Fe={...Ne};return delete Fe[F],Fe})}},vt=async F=>{if(!Ut)return;const{itemId:de,files:me}=Ut;console.log(`[AUTOCREATE] handleMixedContentChoice called with contentType: ${F}, itemId: ${de}, files:`,me.length);try{V(Fe=>({...Fe,[de]:"processing"})),fn(!1),console.log(`[AUTOCREATE] Starting processing for ${F} with ${me.length} files`);const ge=new FormData;me.forEach((Fe,qe)=>{const Ke=atob(Fe.data),ut=Array.from({length:Ke.length});for(let be=0;be<Ke.length;be++)ut[be]=Ke.charCodeAt(be);const Xe=new Uint8Array(ut),ct=new File([Xe],Fe.name,{type:Fe.media_type});ge.append(`file${qe}`,ct)}),ge.append("itemId",de),ge.append("userChoice",F),console.log("[AUTOCREATE] Sending API request to /api/autocreate-chord-charts");const he=await fetch("/api/autocreate-chord-charts",{method:"POST",body:ge});if(console.log(`[AUTOCREATE] API response status: ${he.status} ${he.statusText}`),!he.ok){let Fe="Failed to process files";try{const qe=await he.json();if(qe.error&&(Fe=qe.error),qe.requires_api_key)throw new Error("API_KEY_REQUIRED: "+Fe)}catch(qe){if(!qe.message.startsWith("API_KEY_REQUIRED"))console.warn("Could not parse error response:",qe);else throw qe}throw new Error(Fe)}const Ne=await he.json();if(console.log("[AUTOCREATE] API response data:",Ne),Ne.success){console.log("[AUTOCREATE] Processing successful, setting state to complete"),ri(),V(ut=>({...ut,[de]:"complete"}));const Fe=e(de),qe=(Fe==null?void 0:Fe.C)||`Item ${de}`;t.items.find(ut=>ut.B===de)&&Zs("autocreated",qe,{file_count:(me==null?void 0:me.length)||0,content_type:F||"mixed",uploaded_file_names:(me==null?void 0:me.map(ut=>ut.name).join(", "))||""}),$r({itemName:qe,chordCount:Ne.chord_count||0,contentType:F||"mixed",uploadedFileNames:(me==null?void 0:me.map(ut=>ut.name).join(", "))||"",isVisionAnalysis:F==="chord_charts"||Ne.used_vision_analysis===!0}),tn(!0);try{const ut=await fetch(`/api/items/${de}/chord-charts`);if(ut.ok){const ct=await ut.json();if(X(be=>({...be,[de]:ct})),ct&&ct.length>0){const be=ys(ct);Y(bt=>({...bt,[de]:be}))}}}catch(ut){console.error("Failed to refresh chord charts after mixed content choice:",ut)}setTimeout(()=>{V(ut=>{const Xe={...ut};return delete Xe[de],Xe}),Or(ut=>{const Xe={...ut};return delete Xe[de],Xe}),pn(null)},2e3)}}catch(ge){if(console.error("[AUTOCREATE] Error processing mixed content choice:",ge),console.error("[AUTOCREATE] Full error details:",{message:ge.message,stack:ge.stack,name:ge.name}),ge.message&&ge.message.startsWith("API_KEY_REQUIRED: ")){const he=ge.message.replace("API_KEY_REQUIRED: ","");wr({message:he,requiresApiKey:!0})}else wr({message:ge.message||"Failed to process files. Please try again."});dr(!0),V(he=>{const Ne={...he};return delete Ne[de],Ne}),pn(null)}},Pt=async(F,de)=>{if(!de||de.length===0)return;if(de.length>5){alert("Maximum 5 files allowed. Please select fewer files.");return}let me=!1,ge=null;try{V(be=>({...be,[F]:"uploading"}));const he=new AbortController;Vt(be=>({...be,[F]:he}));const Ne=new FormData;Array.from(de).forEach((be,bt)=>{Ne.append(`file${bt}`,be)}),Ne.append("itemId",F),ge=setTimeout(()=>{me||V(be=>({...be,[F]:"processing"}))},2e3);const qe=await fetch("/api/autocreate-chord-charts",{method:"POST",body:Ne,signal:he.signal});if(!qe.ok){const be=await qe.json();throw new Error(be.error||"Failed to process files")}const Ke=await qe.json();if(Ke.needs_user_choice){pn({itemId:F,options:Ke.mixed_content_options||[],files:Ke.files||[]}),fn(!0),V(be=>{const bt={...be};return delete bt[F],bt});return}if(Ke.error==="unsupported_format"){gr({message:Ke.message,title:Ke.title}),Vr(!0),V(be=>{const bt={...be};return delete bt[F],bt});return}ri(),V(be=>({...be,[F]:"complete"}));const ut=e(F),Xe=(ut==null?void 0:ut.C)||`Item ${F}`;t.items.find(be=>be.B===F)&&Zs("autocreated",Xe,{file_count:Ke.file_count||0,content_type:Ke.content_type||"auto-detected",uploaded_file_names:Ke.uploaded_file_names||""}),$r({itemName:Xe,chordCount:Ke.chord_count||0,contentType:Ke.content_type||"auto-detected",uploadedFileNames:Ke.uploaded_file_names||"",isVisionAnalysis:Ke.content_type==="chord_charts"||Ke.used_vision_analysis===!0||!Ke.content_type&&Ke.used_vision_analysis!==!1}),tn(!0);try{const be=await fetch(`/api/items/${F}/chord-charts`);if(be.ok){const jt=await be.json();if(X(tr=>({...tr,[F]:jt})),jt.length===0)Y(tr=>({...tr,[F]:[]}));else{const tr=new Map;jt.forEach(Dt=>{const xr=Dt.sectionId||"section-1",Nr=Dt.sectionLabel||"Verse",fr=Dt.sectionRepeatCount||"";tr.has(xr)||tr.set(xr,{id:xr,label:Nr,repeatCount:fr,chords:[]}),tr.get(xr).chords.push(Dt)});const vr=Array.from(tr.values()).sort((Dt,xr)=>{const Nr=Math.min(...Dt.chords.map(pr=>pr.order||0)),fr=Math.min(...xr.chords.map(pr=>pr.order||0));return Nr-fr});vr.forEach(Dt=>{Dt.chords.sort((xr,Nr)=>(xr.order||0)-(Nr.order||0))}),Y(Dt=>({...Dt,[F]:vr}))}}}catch(be){console.error("Failed to refresh chord charts after autocreate:",be)}setTimeout(()=>{V(be=>{const bt={...be};return delete bt[F],bt}),yt(be=>({...be,[F]:!1})),Vt(be=>{const bt={...be};return delete bt[F],bt}),Or(be=>{const bt={...be};return delete bt[F],bt})},5e3)}catch(he){if(me=!0,ge&&clearTimeout(ge),he.name==="AbortError"){console.log("Autocreate request was cancelled");return}console.error("Error in autocreate:",he);const Ne=he.message||he.toString();if(Ne.startsWith("API_KEY_REQUIRED: ")){const Fe=Ne.replace("API_KEY_REQUIRED: ","");wr({message:Fe,requiresApiKey:!0}),dr(!0),V(qe=>{const Ke={...qe};return delete Ke[F],Ke})}else Ne.includes("529")||Ne.includes("overloaded")||Ne.includes("429")||Ne.includes("rate limit")||Ne.includes("500")||Ne.includes("502")||Ne.includes("503")||Ne.includes("timeout")?(wr(he),dr(!0),V(Fe=>{const qe={...Fe};return delete qe[F],qe})):V(Fe=>({...Fe,[F]:"error"}));Ne.includes("529")||Ne.includes("overloaded")||Ne.includes("429")||Ne.includes("rate limit")||Ne.includes("500")||Ne.includes("502")||Ne.includes("503")||Ne.includes("timeout")||setTimeout(()=>{V(Fe=>{const qe={...Fe};return delete qe[F],qe}),Vt(Fe=>{const qe={...Fe};return delete qe[F],qe})},5e3)}};return n.jsxs("div",{className:"max-w-1130px mx-auto border border-gray-700 rounded-lg p-6",style:{maxWidth:"1130px"},children:[n.jsxs("div",{className:"flex justify-between items-center mb-8",children:[n.jsx("h1",{className:"text-3xl font-bold",children:t==null?void 0:t.name}),n.jsxs("div",{className:"flex flex-col items-end gap-2",children:[n.jsxs("div",{className:"text-xl font-mono",children:[n.jsx("span",{title:"Time practiced so far",children:Gd(na)})," / ",n.jsx("span",{title:"Total time of remaining items",children:Gd(Hi-na)})]}),n.jsx(Be,{variant:"outline",onClick:Wi,className:"text-gray-300 hover:text-white",title:"Reset progress and all timers","data-ph-capture-attribute-button":"reset-routine-progress",children:"Reset progress"})]})]}),n.jsx("div",{className:"space-y-4",children:(qt=t==null?void 0:t.items)==null?void 0:qt.map(F=>{var ct;const de=i.has(F.A),me=o.has(F.A),ge=h.has(F.A),he=Hn.has(F.A),Ne=e(F.B),Fe=y[F.A]!==void 0?y[F.A]:((Ne==null?void 0:Ne.E)||5)*60,qe=b[F.B]||"",Ke=L.has(F.A),ut=((ct=F.minimalDetails)==null?void 0:ct.C)||"Loading...",Xe=de&&!Ne&&a(F.B);return n.jsxs("div",{className:"rounded-lg bg-gray-800 overflow-hidden",children:[n.jsxs("h2",{className:"sr-only",children:["Practice Item: ",ut]}),n.jsxs("div",{className:"flex items-center justify-between p-5 cursor-pointer hover:bg-gray-700",onClick:()=>hi(F.A),role:"button","aria-expanded":de,"aria-controls":`practice-item-content-${F.A}`,tabIndex:0,"data-item-header":F.A,"data-expanded":de?"true":"false",onKeyDown:be=>{(be.key==="Enter"||be.key===" ")&&(be.preventDefault(),hi(F.A))},children:[n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsx("button",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center ${he?"bg-green-500 border-green-500 text-white":"border-gray-400 text-transparent hover:border-gray-300"}`,onClick:be=>pi(F.A,be),"aria-label":he?"Mark as incomplete":"Mark as complete","data-ph-capture-attribute-button":"toggle-item-complete",children:n.jsx(Nn,{className:"h-4 w-4","aria-hidden":"true"})}),de?n.jsx(Kn,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"}):n.jsx(us,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"}),n.jsxs("span",{className:`text-xl ${he?"line-through text-gray-500":""}`,id:`practice-item-title-${F.A}`,children:[ut,Xe&&n.jsx("span",{className:"text-gray-500 ml-2",role:"status","aria-live":"polite",children:"(Loading details...)"})]})]}),n.jsx("div",{className:"flex items-center space-x-4",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Be,{variant:"ghost",size:"sm",className:"text-gray-400",onClick:be=>mi(F.A,be),title:"Reset timer","data-ph-capture-attribute-button":"reset-timer-header",children:n.jsx(Wd,{className:"h-5 w-5"})}),n.jsx("span",{className:"text-lg font-mono",title:"Time remaining",children:Hd(Fe)})]})})]}),de&&n.jsxs("div",{className:"px-8 pb-6",children:[n.jsxs("div",{className:"flex flex-col items-center justify-center py-8 space-y-6","data-tour":"practice-timer",children:[n.jsx("button",{onClick:be=>Ht(F.A,be),className:"w-48 h-48 rounded-full border-4 border-gray-600 flex items-center justify-center hover:border-gray-500 transition-colors",title:ge?"Pause timer":"Start timer","aria-label":ge?"Pause practice timer":"Start practice timer","data-ph-capture-attribute-button":ge?"pause-practice-timer":"start-practice-timer",children:ge?n.jsx(_m,{className:"h-24 w-24 text-red-500"}):n.jsx(Nm,{className:"h-24 w-24 text-green-500"})}),n.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[n.jsx("div",{className:"text-5xl font-mono",children:Hd(Fe)}),!ge&&Fe!==((Ne==null?void 0:Ne.E)||5)*60&&n.jsxs("button",{onClick:be=>mi(F.A,be),className:"flex items-center space-x-2 text-gray-400 hover:text-gray-300 transition-colors","data-ph-capture-attribute-button":"reset-practice-timer",children:[n.jsx(Wd,{className:"h-4 w-4"}),n.jsx("span",{children:"Reset Timer"})]})]}),n.jsx("div",{className:"flex justify-center mt-6",children:n.jsx(Be,{variant:"outline",className:"max-w-md text-gray-300 hover:text-white",onClick:be=>pi(F.A,be),"data-ph-capture-attribute-button":"mark-item-done",children:"Mark done"})})]}),n.jsxs("div",{className:"space-y-2 px-4",children:[n.jsxs("div",{"data-tour":"chord-charts-section",children:[n.jsx("div",{className:"flex items-center justify-between p-2 hover:bg-gray-700 rounded cursor-pointer",onClick:be=>ja(F.A,be),role:"button","aria-expanded":Ke,"aria-controls":`chord-charts-content-${F.A}`,tabIndex:0,onKeyDown:be=>{(be.key==="Enter"||be.key===" ")&&(be.preventDefault(),ja(F.A,be))},children:n.jsxs("div",{className:"flex items-center",children:[Ke?n.jsx(Kn,{className:"h-5 w-5 text-gray-400 mr-2","aria-hidden":"true"}):n.jsx(us,{className:"h-5 w-5 text-gray-400 mr-2","aria-hidden":"true"}),n.jsxs("h3",{className:"text-xl text-gray-300 flex items-center",id:`chord-charts-title-${F.A}`,"data-tour":"chord-charts",children:[n.jsx(Ch,{className:"h-5 w-5 mr-2","aria-hidden":"true"}),"Chord charts"]})]})}),Ke&&n.jsx("div",{id:`chord-charts-content-${F.A}`,className:"bg-gray-700 rounded-lg p-4 chord-charts-container relative","data-item-id":F.B,role:"region","aria-labelledby":`chord-charts-title-${F.A}`,children:(()=>{const be=F.B,bt=P[be],jt=bt?null:Pn(be),tr=bt||jt||[];console.log("[DEBUG LINE BREAKS] Rendering sections for item",be,"from state:",!!bt,"chords:",tr.flatMap(Dt=>Dt.chords).map(Dt=>({id:Dt.id,title:Dt.title,hasLineBreakAfter:Dt.hasLineBreakAfter})));const vr=tr.map((Dt,xr)=>n.jsxs("div",{className:"mb-6",children:[n.jsxs("div",{className:"flex justify-between items-center mb-3",children:[n.jsx("input",{type:"text",value:Dt.label,onChange:Nr=>{console.log("Updating section label:",Dt.id,Nr.target.value),ft(be,Dt.id,{label:Nr.target.value})},className:"bg-gray-900 text-white px-2 py-1 rounded text-sm font-semibold border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Section name"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"text",value:Dt.repeatCount,onChange:Nr=>ft(be,Dt.id,{repeatCount:Nr.target.value}),className:"bg-gray-900 text-white px-2 py-1 rounded text-sm w-16 text-center border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"x2",maxLength:"3"}),n.jsx("button",{onClick:()=>ur(be,Dt.id),disabled:I.size>0,className:`w-5 h-5 rounded-full flex items-center justify-center text-xs font-bold transition-colors ${I.size>0?"bg-gray-500 cursor-not-allowed":"bg-red-600 hover:bg-red-700 cursor-pointer"} text-white`,title:I.size>0?"Deleting...":"Delete section","aria-label":"Delete chord section","data-ph-capture-attribute-button":"delete-chord-section",children:I.size>0?n.jsx(Hr,{className:"h-3 w-3 animate-spin"}):"Ã—"})]})]}),xr===0&&(()=>{const Nr=Dt.chords[0];if(!Nr)return null;const fr=Nr.tuning||"EADGBE",pr=Nr.capo||0;return n.jsx("div",{className:"text-center text-white font-bold text-sm mb-3",children:pr>0?`${fr} | Capo on ${pr}`:fr})})(),Dt.chords.length>0&&n.jsx("div",{className:"space-y-2",children:(()=>{const Nr=[];let fr=[];return console.log("[DEBUG LINE BREAKS] Processing section:",Dt.id,"chords:",Dt.chords.map(pr=>({id:pr.id,title:pr.title,hasLineBreakAfter:pr.hasLineBreakAfter}))),Dt.chords.forEach((pr,Mn)=>{fr.push(pr),(pr.hasLineBreakAfter||fr.length>=5||Mn===Dt.chords.length-1)&&(console.log("[DEBUG LINE BREAKS] Creating row with",fr.length,"chords. Reason:",pr.hasLineBreakAfter?"hasLineBreakAfter":fr.length>=5?"max 5":"last chord"),Nr.push([...fr]),fr=[])}),console.log("[DEBUG LINE BREAKS] Final row structure:",Nr.map((pr,Mn)=>`Row ${Mn}: ${pr.map(Un=>Un.title).join(", ")}`)),Nr.map((pr,Mn)=>n.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-2",children:pr.map(Un=>n.jsx(jm,{chart:Un,onEdit:(rr,mr)=>Vi(be,rr,mr),onDelete:rr=>Gi(be,rr),onInsertAfter:(rr,mr)=>Ha(be,rr,mr)},Un.id))},`row-${Mn}-${pr.map(Un=>Un.id).join("-")}`))})()})]},Dt.id));return n.jsxs(n.Fragment,{children:[vr,(O[be]||[]).length>0?n.jsx("div",{className:"flex justify-end mb-2",children:n.jsx(Be,{variant:"outline",size:"sm",onClick:xr=>{xr.stopPropagation(),Ga(be)},className:"p-2 border-gray-600 text-gray-400 hover:text-gray-200 hover:bg-gray-600",title:"Print chord charts",children:n.jsx(Lh,{className:"h-4 w-4"})})}):null,(()=>{var fr,pr,Mn,Un;const Dt=O[be]||[],xr=T[be],Nr=ot[be];return Dt.length===0?n.jsxs("div",{className:"mb-4",children:[Nr?n.jsx(Be,{onClick:()=>yt(rr=>({...rr,[be]:!1})),variant:"ghost",size:"sm",className:"text-gray-400 hover:text-gray-300 mb-2",title:"Collapse autocreate section",children:"â†"}):n.jsx("div",{className:"flex justify-center",children:n.jsxs(Be,{onClick:()=>yt(rr=>({...rr,[be]:!0})),className:"max-w-md bg-gray-700 text-gray-300 hover:bg-gray-600 mb-2 flex items-center justify-center",children:[n.jsx(Ti,{className:"h-4 w-4 mr-2"}),"Autocreate chord charts"]})}),Nr&&n.jsxs("div",{className:"border border-gray-600/30 rounded-lg p-4 bg-gray-800/10",children:[n.jsxs("div",{className:"text-sm text-gray-400 mb-6",children:[n.jsx("p",{children:"â€¢ Upload lyrics with chord names to create charts"}),n.jsx("p",{children:'â€¢ Upload image or PDF of chord charts to "import"'}),n.jsx("p",{children:"â€¢ One method at a time"})]}),!xr&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6 items-start",children:[n.jsxs("div",{className:"flex flex-col",children:[n.jsx("div",{className:"text-center mb-2",children:n.jsx("p",{className:"text-gray-400 text-sm font-medium",children:"Upload files"})}),n.jsx("div",{className:`flex-1 p-4 border-2 border-dashed rounded-lg transition-colors cursor-pointer ${ht[be]?"border-gray-500 bg-gray-800/20":"border-gray-600 hover:border-gray-500 bg-gray-800/10"}`,onDragOver:rr=>{rr.preventDefault(),st(mr=>mr[be]!==!0?{...mr,[be]:!0}:mr)},onDragLeave:rr=>{rr.preventDefault(),st(mr=>mr[be]!==!1?{...mr,[be]:!1}:mr)},onDrop:rr=>{rr.preventDefault(),st(mr=>({...mr,[be]:!1})),D(be,rr.dataTransfer.files)},onClick:()=>{const rr=document.createElement("input");rr.type="file",rr.multiple=!0,rr.accept=".pdf,.png,.jpg,.jpeg",rr.onchange=mr=>D(be,mr.target.files),rr.click()},children:n.jsxs("div",{className:"text-center",children:[n.jsx(Ti,{className:`h-12 w-12 mx-auto mb-2 ${er[be]&&er[be].length>0?"text-gray-300":"text-gray-400"}`}),n.jsx("p",{className:`text-sm font-medium mb-2 ${er[be]&&er[be].length>0?"text-gray-200":"text-gray-300"}`,children:"Drop files or click"}),n.jsx("p",{className:"text-gray-400 text-xs mb-2",children:"PDFs, images â€¢ 5mb max"}),er[be]&&er[be].length>0&&n.jsx("div",{children:n.jsxs("p",{className:"text-gray-300 text-xs font-medium mb-1",children:[er[be].length," file(s)"]})})]})})]}),n.jsxs("div",{className:"flex flex-col",children:[n.jsxs("div",{className:"text-center mb-2",children:[n.jsx("p",{className:"text-gray-400 text-sm font-medium",children:"YouTube guitar lesson"}),n.jsx("p",{className:"text-gray-500 text-xs",children:"(video must have a transcript)"})]}),n.jsx("form",{className:"flex-1 flex flex-col justify-center",onSubmit:rr=>{var mr;rr.preventDefault(),(mr=Yr[be])!=null&&mr.trim()&&ye(be)},children:n.jsx("input",{type:"url",placeholder:"Paste YouTube URL",value:Yr[be]||"",onChange:rr=>{const mr=rr.target.value.replace(/[<>"']/g,"");En(oa=>({...oa,[be]:mr}))},maxLength:500,className:"w-full p-3 bg-gray-700 text-white rounded border-2 border-gray-600 focus:border-gray-500 text-sm"})})]}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("div",{className:"text-center mb-2",children:n.jsx("p",{className:"text-gray-400 text-sm font-medium",children:"Manual entry"})}),n.jsxs("div",{className:"flex-1 flex flex-col justify-center relative",children:[n.jsx("textarea",{placeholder:`Enter song section names and chord names, like this:
Intro
Am7 Em/A E7sus
Verse
C G/B Am (space or comma-separated)`,value:lt[be]||"",onChange:rr=>{const mr=rr.target.value;mr.length<=500&&(Kr(oa=>({...oa,[be]:mr})),ne(mr,be))},maxLength:500,className:`w-full p-3 text-white rounded border-2 focus:border-gray-500 text-sm resize-none min-h-[160px] ${xe[be]?"bg-red-900/20 border-red-500":"bg-gray-700 border-gray-600"}`}),n.jsxs("div",{className:"absolute bottom-1 right-2 text-xs text-gray-400",children:[(lt[be]||"").length,"/500"]}),xe[be]&&n.jsx("div",{className:"mt-1 text-xs text-red-400",children:xe[be]})]})]})]}),n.jsx("div",{className:"flex justify-center",children:n.jsxs(Be,{onClick:()=>ye(be),disabled:xr||(er[be]||[]).length===0&&!((fr=Yr[be])!=null&&fr.trim())&&!((pr=lt[be])!=null&&pr.trim())||((er[be]||[]).length>0?1:0)+((Mn=Yr[be])!=null&&Mn.trim()?1:0)+((Un=lt[be])!=null&&Un.trim()?1:0)>1,className:"px-6",children:[n.jsx(bc,{className:"h-4 w-4 mr-2"}),"Create chord charts"]})})]}),n.jsx("div",{className:"w-full p-6 border-2 border-dashed rounded-lg mt-4 bg-gray-800/10 border-gray-600/50",children:n.jsxs("div",{className:"text-center",children:[xr==="checking_transcripts"&&n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-yellow-500"}),n.jsx("span",{className:"text-yellow-400",children:"Checking for transcripts..."})]}),n.jsx("br",{}),n.jsxs(Be,{variant:"outline",size:"sm",onClick:()=>ts(be),className:"text-gray-400 hover:text-gray-200 border-gray-600",children:[n.jsx(Gr,{className:"h-3 w-3 mr-1"}),"Cancel"]})]}),xr==="reading_transcript"&&n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-500"}),n.jsx("span",{className:"text-gray-400",children:"Reading transcript..."})]}),n.jsx("br",{}),n.jsxs(Be,{variant:"outline",size:"sm",onClick:()=>ts(be),className:"text-gray-400 hover:text-gray-200 border-gray-600",children:[n.jsx(Gr,{className:"h-3 w-3 mr-1"}),"Cancel"]})]}),xr==="uploading"&&n.jsxs("div",{className:"space-y-3",role:"status","aria-live":"polite",children:[n.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-500","aria-hidden":"true"}),n.jsx("span",{className:"text-gray-400",children:"Uploading files..."})]}),n.jsx("br",{}),n.jsxs(Be,{variant:"outline",size:"sm",onClick:()=>ts(be),className:"text-gray-400 hover:text-gray-200 border-gray-600",children:[n.jsx(Gr,{className:"h-3 w-3 mr-1"}),"Cancel"]})]}),xr==="processing_transcript"&&n.jsxs("div",{className:"space-y-3",role:"status","aria-live":"polite",children:[n.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-purple-500","aria-hidden":"true"}),n.jsx("span",{className:"text-white",children:"Processing transcript..."})]}),n.jsx("br",{}),n.jsxs(Be,{variant:"outline",size:"sm",onClick:()=>ts(be),className:"text-gray-400 hover:text-gray-200 border-gray-600",children:[n.jsx(Gr,{className:"h-3 w-3 mr-1"}),"Cancel"]})]}),xr==="processing"&&n.jsxs("div",{className:"space-y-3",role:"status","aria-live":"polite",children:[n.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-purple-500","aria-hidden":"true"}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("span",{className:"text-white",children:ir[mt]}),n.jsx("div",{className:"ml-2 animate-spin","aria-hidden":"true",children:"âš™ï¸"})]})]}),n.jsx("br",{}),n.jsx("div",{className:"flex justify-center",children:n.jsxs(Be,{variant:"outline",size:"sm",onClick:()=>ts(be),className:"text-gray-400 hover:text-gray-200 border-gray-600",children:[n.jsx(Gr,{className:"h-3 w-3 mr-1"}),"Cancel"]})})]}),xr==="complete"&&n.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[n.jsx(Nn,{className:"h-4 w-4 text-green-500"}),n.jsx("span",{className:"text-green-400",children:"Chord charts created!"})]}),xr==="error"&&n.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[n.jsx(Rn,{className:"h-4 w-4 text-red-500"}),n.jsx("span",{className:"text-red-400",children:"Error processing files. Please try again."})]}),!xr&&n.jsx(n.Fragment,{children:O[be]&&O[be].length>0?n.jsxs(n.Fragment,{children:[n.jsx(Rn,{className:"h-8 w-8 text-orange-400 mx-auto mb-2"}),n.jsx("p",{className:"text-orange-300 font-medium mb-1",children:"Chord charts already exist"}),n.jsx("p",{className:"text-gray-400 text-sm",children:"Please delete all chord charts from this song before using autocreate"})]}):n.jsx(n.Fragment,{children:(er[be]||[]).length>0?n.jsxs(n.Fragment,{children:[n.jsx(pl,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),n.jsx("p",{className:"text-gray-300 font-medium mb-1",children:"Ready to create chord charts"}),n.jsx("p",{className:"text-gray-400 text-sm",children:"Click 'Create chord charts'"})]}):n.jsxs(n.Fragment,{children:[n.jsx(pl,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),n.jsx("p",{className:"text-gray-300 font-medium mb-1",children:"Add a file, paste a YouTube URL, or type in the 'Manual entry' box, then click 'Create Chord Charts'"}),n.jsx("p",{className:"text-gray-400 text-xs",children:"(The results will probably contain errors. Use the âœï¸edit icon on a chart to correct it.)"})]})})})]})})]})]}):n.jsx("div",{className:"mb-4 flex justify-center",children:n.jsxs(Be,{variant:"outline",onClick:()=>Cs(be),className:"max-w-md text-orange-300 hover:bg-orange-800 hover:border-orange-600",children:[n.jsx(Ti,{className:"h-4 w-4 mr-2"}),"Replace with autocreated charts"]})})})(),n.jsx("div",{className:"mb-4 flex justify-center",children:n.jsx(Be,{variant:"default",onClick:()=>{oe({itemId:be,scrollPosition:window.scrollY}),H(Dt=>({...Dt,[be]:!0})),setTimeout(()=>{const Dt=document.querySelector(`[data-editor-for-item="${be}"]`);Dt&&Dt.scrollIntoView({behavior:"smooth",block:"start"})},100)},className:"min-w-48",children:"+ Add new chord"})}),n.jsx("div",{className:"mb-4 flex justify-center",children:n.jsx(Be,{variant:"default",onClick:()=>Ar(be),className:"min-w-48",children:"+ Add new section"})}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-4 max-w-2xl mx-auto",children:[n.jsx(Be,{variant:"default",onClick:()=>Ka(be),className:"flex-1",children:"Copy chord charts from other song"}),n.jsx(Be,{variant:"default",onClick:()=>gi(be),disabled:!O[be]||O[be].length===0,className:"flex-1 bg-purple-700 text-purple-300 hover:bg-purple-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Copy chord charts to other song"})]}),K[be]&&n.jsx("div",{"data-editor-for-item":be,children:n.jsx(Dh,{itemId:be,defaultTuning:(Ne==null?void 0:Ne.H)||"EADGBE",editingChordId:R,insertionContext:re,onSave:Dt=>sa(be,Dt),onCancel:()=>{H(Dt=>({...Dt,[be]:!1})),N(null),ve(null),ws()}})})]})})()})]}),n.jsxs("div",{className:"flex items-center justify-between p-2 hover:bg-gray-700 rounded cursor-pointer",onClick:be=>bs(F.A,be),role:"button","aria-expanded":me,"aria-controls":`notes-content-${F.A}`,tabIndex:0,onKeyDown:be=>{(be.key==="Enter"||be.key===" ")&&(be.preventDefault(),bs(F.A,be))},children:[n.jsxs("div",{className:"flex items-center",children:[me?n.jsx(Kn,{className:"h-5 w-5 text-gray-400 mr-2","aria-hidden":"true"}):n.jsx(us,{className:"h-5 w-5 text-gray-400 mr-2","aria-hidden":"true"}),n.jsxs("h3",{className:"text-xl text-gray-300 flex items-center",id:`notes-title-${F.A}`,children:[n.jsx(Ah,{className:"h-5 w-5 mr-2","aria-hidden":"true"}),"Notes"]})]}),n.jsxs(Be,{variant:"outline",size:"sm",className:"text-gray-300",onClick:be=>{be.stopPropagation(),$i(F.B,be)},children:[n.jsx(yo,{className:"h-4 w-4 mr-2","aria-hidden":"true"}),qe?"Edit note":"Add note"]})]}),me&&qe&&n.jsx("div",{id:`notes-content-${F.A}`,className:"px-4",role:"region","aria-labelledby":`notes-title-${F.A}`,children:n.jsx("div",{className:"bg-gray-700 p-3 rounded",children:n.jsx("div",{className:"text-gray-300",dangerouslySetInnerHTML:{__html:Wc(qe)}})})}),n.jsx("div",{className:"mt-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[(()=>{const be=(Ne==null?void 0:Ne.I)||(Ne==null?void 0:Ne.F);if(!be)return null;const bt=R0(be);if(!bt&&!Th()&&!_i())return null;const jt=(Ne==null?void 0:Ne.C)||`Item ${F.A}`;return bt?n.jsxs("a",{href:be,target:"_blank",rel:"noopener noreferrer",onClick:tr=>{tr.stopPropagation(),Bd(jt,be)},className:"text-gray-400 hover:text-gray-300 hover:underline flex items-center",title:"Open songbook link in new tab",children:[n.jsx(kh,{className:"h-4 w-4 mr-2"}),"Open Songbook Link"]}):n.jsxs("button",{onClick:tr=>{tr.stopPropagation(),Bd(jt,be),_i()?(Ot(be),Ft(!0)):navigator.clipboard.writeText(be).then(()=>{Ot(be),Ft(!0)}).catch(vr=>{console.error("Failed to copy to clipboard:",vr),Ot(be),Ft(!0)})},className:"text-gray-400 hover:text-gray-300 hover:underline flex items-center",title:_i()?"View folder path":"Copy folder path",children:[n.jsx(S0,{className:"h-4 w-4 mr-2"}),_i()?"View Songbook Folder":"Copy Folder Path"]})})(),(Ne==null?void 0:Ne.H)&&n.jsx("span",{className:"text-sm font-mono font-bold text-gray-400",children:Ne.H})]})})]})]}),i.has(F.A)&&n.jsx("div",{id:`practice-item-content-${F.A}`,className:"px-5 pb-5",role:"region","aria-labelledby":`practice-item-title-${F.A}`,children:n.jsx("div",{className:"text-gray-400"})})]},F.A)})}),n.jsx(M0,{open:u,onOpenChange:w,itemId:x,currentNote:x?b[x]:"",onNoteSave:As}),ie&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsx("div",{className:`bg-gray-700 rounded-lg p-6 ${Ce||$==="complete"?"max-w-xs":"w-full max-w-md"} max-h-[80vh] flex flex-col`,onWheel:F=>F.stopPropagation(),children:$==="complete"?n.jsxs(n.Fragment,{children:[n.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Success!"}),n.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-4",children:[n.jsx(Nn,{className:"h-6 w-6 text-green-500"}),n.jsx("span",{className:"text-green-400 text-lg",children:"Chord charts copied successfully!"})]}),n.jsx(Be,{onClick:Gn,className:"w-full bg-green-600 hover:bg-green-700",children:"Done"})]}):Ce?n.jsxs(n.Fragment,{children:[n.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Confirm Overwrite"}),n.jsxs("p",{className:"text-gray-300 mb-4",children:[we.size," of the selected songs already have chord charts. Copying will replace all existing chord charts in those songs."]}),n.jsxs("div",{className:"bg-gray-600 rounded p-3 mb-4",children:[n.jsx("p",{className:"text-sm text-gray-200 mb-2 font-medium",children:"Songs that will be overwritten:"}),n.jsx("ul",{className:"text-sm text-gray-300 space-y-1",children:Ws.filter(F=>Q.has(F.A)&&we.has(F.A)).map(F=>n.jsxs("li",{className:"flex items-center",children:[n.jsx("span",{className:"text-yellow-400 mr-2",children:"â€¢"}),F.C||"Unknown Song"]},F.A))})]}),n.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"This action cannot be undone."}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(Be,{variant:"outline",onClick:ia,className:"flex-1",children:"Go Back"}),n.jsx(Be,{onClick:Ya,className:"flex-1 bg-red-600 hover:bg-red-700",children:"Yes, Overwrite"})]})]}):n.jsxs(n.Fragment,{children:[n.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Copy chord charts"}),n.jsxs("p",{className:"text-gray-300 mb-2",children:['Copy chord charts from "',((Jt=s==null?void 0:s.find(F=>F.B===te))==null?void 0:Jt.C)||"Unknown Song",'" to:']}),n.jsx("input",{type:"text",placeholder:"Search songs...",value:G,onChange:F=>Z(F.target.value),className:"w-full p-2 mb-4 bg-gray-700 text-white rounded border border-gray-600 focus:border-purple-500"}),n.jsx("div",{className:"flex-1 overflow-y-auto mb-4 min-h-0 modal-scroll",children:Ws.map(F=>n.jsxs("div",{className:"flex items-center mb-2",children:[n.jsx("input",{type:"checkbox",id:`copy-item-${F.A}`,checked:Q.has(F.A),onChange:()=>Va(F.A),className:"mr-3"}),n.jsxs("label",{htmlFor:`copy-item-${F.A}`,className:"text-white cursor-pointer flex-1 flex items-center",children:[n.jsx("span",{children:F.C||"Untitled"}),we.has(F.A)&&n.jsx("span",{className:"text-yellow-400 ml-2 text-sm",children:" âš ï¸will overwrite"})]})]},F.A))}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(Be,{variant:"outline",onClick:Gn,className:"flex-1",children:"Cancel"}),n.jsx(Be,{onClick:aa,disabled:Q.size===0,style:Q.size===0?{backgroundColor:"#4b5563",color:"#d1d5db",opacity:"1"}:we.size>0?{backgroundColor:"#dc2626",color:"#ffffff",opacity:"1"}:{backgroundColor:"#5b1f1f",color:"#ffffff",opacity:"1"},className:"flex-1 bg-purple-600 hover:bg-purple-700 disabled:cursor-not-allowed",children:we.size>0?`Copy and Overwrite ${Q.size} song${Q.size!==1?"s":""}`:`Copy to ${Q.size} song${Q.size!==1?"s":""}`})]})]})})}),M&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-gray-700 rounded-lg p-6 w-full max-w-md max-h-[80vh] flex flex-col",onWheel:F=>F.stopPropagation(),children:[n.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Copy chord charts from other song"}),n.jsxs("p",{className:"text-gray-300 mb-2",children:['Copy chord charts to "',((or=s==null?void 0:s.find(F=>F.B===Te))==null?void 0:or.C)||"Unknown Song",'" from:']}),n.jsx("input",{type:"text",placeholder:"Search songs with chord charts...",value:pe,onChange:F=>ce(F.target.value),className:"w-full p-2 mb-4 bg-gray-700 text-white rounded border border-gray-600 focus:border-blue-500"}),n.jsx("div",{className:"flex-1 overflow-y-auto mb-4 min-h-0 modal-scroll",children:ui.map(F=>n.jsxs("div",{className:"flex items-center mb-2",children:[n.jsx("input",{type:"radio",id:`copy-from-item-${F.A}`,name:"copyFromSource",checked:Le===F.B,onChange:()=>Ie(F.B),className:"mr-3"}),n.jsxs("label",{htmlFor:`copy-from-item-${F.A}`,className:"flex-1 cursor-pointer text-white hover:text-gray-300",children:[F.C||"Unknown Song",n.jsxs("span",{className:"text-xs text-gray-400 ml-2",children:["(",ra[F.B]||0," charts)"]})]})]},F.A))}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(Be,{variant:"outline",onClick:Sa,className:"flex-1",children:"Cancel"}),n.jsx(Be,{onClick:xi,disabled:!Le,className:"flex-1 bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Copy chord charts"})]})]})}),n.jsx(Xs,{open:Me,onOpenChange:Je,children:n.jsxs(Os,{children:[n.jsxs(Ds,{children:[n.jsxs(Bs,{className:"flex items-center space-x-2",children:[n.jsx(Rn,{className:"h-5 w-5 text-orange-500"}),n.jsx("span",{children:"Replace existing chord charts"})]}),n.jsx(Ms,{children:"This song already has chord charts. To use autocreate, all existing chord charts must be deleted first. This action cannot be undone."})]}),n.jsxs(Rs,{children:[n.jsx(xa,{onClick:()=>{Je(!1),j(null)},children:"Cancel"}),n.jsx(js,{onClick:Ls,className:"bg-orange-500 hover:bg-orange-600 text-white border-orange-500 shadow-lg font-medium",children:"Delete all & autocreate"})]})]})}),n.jsx(Xs,{open:bn,onOpenChange:fn,children:n.jsxs(Os,{className:"w-80 min-h-[600px]",children:[n.jsxs(Ds,{children:[n.jsxs(Bs,{className:"flex items-center space-x-2",children:[n.jsx(Rn,{className:"h-5 w-5 text-blue-500"}),n.jsx("span",{children:"Mixed Content Detected"})]}),n.jsx(Ms,{children:"Your file contains both chord names and chord charts. How would you like to process it?"})]}),n.jsxs("div",{className:"space-y-4 my-8",children:[n.jsxs(js,{onClick:()=>vt("chord_names"),className:"w-full h-auto p-6 flex flex-col items-center bg-slate-700 hover:bg-slate-600 text-white",children:[n.jsx("div",{className:"font-medium",children:"Process Chord Names"}),n.jsx("div",{className:"text-sm text-slate-300 mt-1",children:"(standard tuning)"})]}),n.jsx(js,{onClick:()=>vt("chord_charts"),className:"w-full p-4 bg-slate-700 hover:bg-slate-600 text-white",children:"Import chord charts"})]}),n.jsx(Rs,{children:n.jsx(xa,{onClick:()=>{fn(!1),pn(null)},children:"Cancel"})})]})}),n.jsx(Xs,{open:wn,onOpenChange:Vr,children:n.jsxs(Os,{children:[n.jsxs(Ds,{children:[n.jsxs(Bs,{className:"flex items-center space-x-2",children:[n.jsx(Rn,{className:"h-5 w-5 text-red-500"}),n.jsx("span",{children:(qr==null?void 0:qr.title)||"Format Not Supported"})]}),n.jsx(Ms,{children:(qr==null?void 0:qr.message)||"Sorry, we can only build chord charts. This file format is not supported."})]}),n.jsx(Rs,{children:n.jsx(js,{onClick:()=>{Vr(!1),gr(null)},children:"OK"})})]})}),n.jsx(Xs,{open:wt,onOpenChange:Kt,children:n.jsxs(Os,{children:[n.jsxs(Ds,{children:[n.jsx(Bs,{children:"Are you sure you wanna do that?"}),n.jsx(Ms,{children:"You'll have to wait just as long next time if you start over"})]}),n.jsxs(Rs,{children:[n.jsx(xa,{onClick:g,children:"*sigh* Ok, I'll wait..."}),n.jsx(js,{onClick:bi,children:"Yes, damnit, cancel!"})]})]})}),n.jsx(Xs,{open:$t,onOpenChange:F=>{F||fi()},children:n.jsxs(Os,{className:"max-w-md",children:[n.jsxs(Ds,{children:[n.jsxs(Bs,{className:"flex items-center space-x-2",children:[n.jsx("span",{children:"ðŸ””"}),n.jsx("span",{children:"Timer sound"})]}),n.jsx(Ms,{asChild:!0,children:n.jsxs("div",{className:"space-y-3",children:[n.jsxs("p",{children:["Since this is your first time with the timer, you're going to want to set a level for it. It should be loud enough for you to hear it over your playing, but not loud enough to give you a jump scare or make your ears ring. ",n.jsx("a",{href:"/#Account",className:"text-blue-400 hover:text-blue-300 underline",children:"Go to settings"})," to set your levels now."]}),n.jsx("p",{children:"A bell will ring when your timer is up. If you don't hear it, click the settings icon in your browser's address bar and enable sound:"}),n.jsx("img",{src:"/static/images/chromiumsoundsettings.png",alt:"Browser sound settings - click the settings icon in the address bar and toggle Sound on",className:"rounded border border-gray-600 mx-auto"})]})})]}),n.jsxs(Rs,{className:"flex-col sm:flex-row gap-2",children:[n.jsx(xa,{onClick:fi,children:"Remind me next time"}),n.jsx(js,{onClick:Wa,className:"bg-blue-600 hover:bg-blue-700",children:"Got it"})]})]})}),n.jsx(Bh,{isOpen:Cr,onClose:()=>{dr(!1),wr(null)},error:es}),n.jsx(vc,{isOpen:Sn,onClose:()=>{tn(!1),$r(null)},autocreateData:kn}),n.jsx(Xs,{open:Nt,onOpenChange:Ft,children:n.jsxs(Os,{className:"bg-gray-800 border-gray-700 max-w-2xl",children:[n.jsxs(Ds,{children:[n.jsx(Bs,{className:"text-gray-100",children:_i()?"Songbook Folder Path":"Path Copied to Clipboard"}),n.jsx(Ms,{className:"text-gray-300",children:_i()?n.jsxs(n.Fragment,{children:[n.jsx("p",{className:"mb-2",children:"Here's the folder path for this item:"}),n.jsx("code",{className:"block bg-gray-900 p-2 rounded text-sm break-all text-gray-200",children:ar})]}):n.jsxs(n.Fragment,{children:[n.jsxs("p",{className:"mb-2",children:["The path has been copied to your clipboard. Open ",n.jsx("strong",{children:D0()}),", paste, then hit ",n.jsx("kbd",{className:"bg-gray-700 px-2 py-1 rounded text-xs",children:"Enter"})," to open the folder."]}),n.jsx("code",{className:"block bg-gray-900 p-2 rounded text-sm break-all text-gray-200",children:ar})]})})]}),n.jsx(Rs,{children:n.jsx(js,{onClick:()=>Ft(!1),className:"bg-orange-600 hover:bg-orange-700 text-white",children:"OK"})})]})}),We&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-gray-700 rounded-lg p-6 w-full max-w-md max-h-[80vh] flex flex-col",children:[n.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"No Transcripts Available"}),n.jsx("p",{className:"text-gray-300 mb-4",children:"Oh, drag. This YouTube video doesn't have transcripts on it. So, go find a free tool to generate transcripts from YouTube videos, then copy/paste the transcript below:"}),n.jsx("textarea",{value:rt,onChange:F=>it(F.target.value),placeholder:"Paste the transcript here...",className:"w-full h-32 p-3 bg-gray-800 text-white rounded border border-gray-600 focus:border-red-500 resize-none mb-4",maxLength:25e3}),n.jsxs("p",{className:"text-xs text-gray-400 mb-4",children:[rt.length,"/25,000 characters"]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx(Be,{variant:"outline",onClick:()=>{Qe(!1),tt(null),it("")},className:"flex-1 border-gray-600 text-gray-300 hover:bg-gray-600",children:"Cancel"}),n.jsxs(Be,{variant:"outline",onClick:async()=>{if(!rt.trim()){alert("Please paste a transcript before proceeding.");return}const{itemId:F}=at;Qe(!1),tt(null),await Ze(F,rt),it("")},disabled:!rt.trim(),className:`flex-1 ${rt.trim()?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-600 text-gray-500 cursor-not-allowed"}`,children:[n.jsx(bc,{className:"h-4 w-4 mr-2"}),"ðŸª„ Create chord charts"]})]})]})}),n.jsx(gs,{open:At,onOpenChange:F=>!F&&_t(!1),children:n.jsxs(Jn,{className:"sm:max-w-md",children:[n.jsxs(Zn,{children:[n.jsxs(Xn,{className:"flex items-center gap-2",children:[n.jsx(Rn,{className:"h-6 w-6 text-orange-500"}),"No Chord Names Found"]}),n.jsx(xs,{className:"text-left space-y-1",children:n.jsx("p",{children:"So, um, we can't find any chord names mentioned in this video. Sorry, we can't create tablature yet, just chord charts."})})]}),n.jsx("div",{className:"flex justify-end gap-2 -mt-2",children:n.jsx(Be,{onClick:()=>_t(!1),className:"min-w-20",children:"Ok"})})]})})]})},lf=()=>{const[t,r]=U.useState(!1),[e,a]=U.useState(!1),[s,i]=U.useState(!0),[c,o]=U.useState(null),d=U.useCallback(async()=>{try{const b=await fetch("/api/auth/status");if(!b.ok)throw new Error("Auth check failed");const m=await b.json();r(m.authenticated),a(m.hasSpreadsheetAccess),o(null)}catch(b){console.error("Auth check failed:",b),r(!1),a(!1),o(b.message)}finally{i(!1)}},[]);return U.useEffect(()=>{d();const b=setInterval(d,900*1e3);return()=>clearInterval(b)},[d]),{isAuthenticated:t,hasSpreadsheetAccess:e,checking:s,error:c,handleLogin:()=>{window.location.href="/authorize"},handleLogout:()=>{sessionStorage.removeItem("lapsedModalDismissed"),window.location.href="/logout/"},checkAuth:d}},Am=l0,Cm=c0,Lm=d0,cf=U.forwardRef(({className:t,sideOffset:r=4,...e},a)=>n.jsx(o0,{ref:a,sideOffset:r,className:"z-50 overflow-hidden rounded-md bg-gray-900 px-3 py-1.5 text-sm text-gray-50 shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",...e}));cf.displayName="TooltipContent";const Em=Cm,Pm=()=>{const{isAuthenticated:t,hasSpreadsheetAccess:r,checking:e,error:a,handleLogin:s,handleLogout:i}=lf(),{setActivePage:c}=zi();return n.jsxs("div",{className:"ml-auto flex items-end gap-2",children:[t&&!r&&n.jsx("span",{className:"text-sm text-red-400",children:"Log in with gmail acct instead"}),t?n.jsxs("div",{className:"flex flex-col gap-1 items-end",children:[n.jsx(Am,{children:n.jsxs(Em,{children:[n.jsx(Lm,{asChild:!0,children:n.jsx(Be,{onClick:()=>c("Account"),variant:"ghost",size:"sm",className:"text-gray-400 hover:text-gray-200 h-auto py-1","aria-label":"Account settings","data-ph-capture-attribute-button":"account-settings",children:n.jsx(T0,{className:"h-4 w-4"})})}),n.jsx(cf,{children:n.jsx("p",{children:"Account/Settings"})})]})}),n.jsx(Be,{onClick:i,variant:"ghost",size:"sm",className:"text-gray-400 hover:text-gray-200 h-auto py-1","data-ph-capture-attribute-button":"logout",children:"logout"})]}):e?null:n.jsx(Be,{onClick:s,variant:"default",className:"bg-blue-600 hover:bg-blue-700 text-gray-100","data-ph-capture-attribute-button":"login",children:a?"Auth Error - Click to retry":n.jsxs(n.Fragment,{children:[n.jsx(C0,{className:"mr-2 h-4 w-4","aria-hidden":"true"}),"Let me in"]})})]})},Tm=({className:t,userStatus:r,onUnpluggedAttempt:e})=>{const{activePage:a,setActivePage:s}=zi(),i=["Practice","Routines","Items"],c=o=>{if(r!=null&&r.unplugged_mode&&(o==="Routines"||o==="Items")){e==null||e(o);return}s(o)};return n.jsxs("nav",{className:zr("flex flex-wrap items-center gap-4",t),"aria-label":"Main navigation",children:[n.jsxs("div",{className:"flex flex-wrap gap-4",children:[i.map(o=>n.jsx(Be,{variant:a===o?"secondary":"ghost",className:zr("text-xl py-6 px-8",a===o?"bg-secondary hover:bg-secondary/90":"hover:bg-accent"),onClick:()=>c(o),"aria-current":a===o?"page":void 0,"data-tour":o==="Practice"?"practice-tab":o==="Routines"?"routines-tab":o==="Items"?"items-tab":void 0,"data-ph-capture-attribute-nav":`nav-${o.toLowerCase()}`,children:o},o)),n.jsx(Be,{variant:a==="Account"?"secondary":"ghost",className:zr("text-xl py-6 px-8",a==="Account"?"bg-secondary hover:bg-secondary/90":"hover:bg-accent","hidden"),onClick:()=>s("Account"),"aria-current":a==="Account"?"page":void 0,"data-tour":"account-tab",children:"Account"})]}),n.jsx(Pm,{})]})},Im=(t=null,r=null,e=[])=>{const[a,s]=U.useState([]),[i,c]=U.useState({}),[o,d]=U.useState(""),[h,p]=U.useState(!0),[b,m]=U.useState(null);U.useEffect(()=>{r!=null&&r.items?(s(r.items),p(!1)):t?u():(s([]),p(!1))},[t,r]);const u=async()=>{try{const A=await fetch(`/api/routines/${t}/details`);if(!A.ok)throw new Error("Failed to fetch routine");const E=(await A.json()).items.sort((O,X)=>parseInt(O.routineEntry.C)-parseInt(X.routineEntry.C));s(E),m(null)}catch(A){m(A.message),console.error("Fetch error:",A)}finally{p(!1)}};return{availableItems:U.useMemo(()=>{const A=new Set(a.map(E=>{var O,X;return((O=E.itemDetails)==null?void 0:O.B)||((X=E.routineEntry)==null?void 0:X.B)}));return e.filter(E=>{const O=A.has(E.B),X=I=>I.replace(/[''`]/g,"'"),K=E.C||"",H=X(K.toLowerCase()),P=X(o.toLowerCase()),Y=H.includes(P);return!O&&Y})},[e,a,o]),selectedItems:a,setSelectedItems:s,searchQuery:o,setSearchQuery:d,loading:h,error:b,addToRoutine:async(A,L)=>{try{if(!(await fetch(`/api/routines/${A}/items`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({itemId:L})})).ok)throw new Error("Failed to add item to routine");return await u(),!0}catch(E){return console.error("Error adding item:",E),!1}},removeFromRoutine:async(A,L)=>{try{const E=await fetch(`/api/routines/${A}/items/${L}`,{method:"DELETE"});if(!E.ok){const O=await E.json().catch(()=>({}));throw new Error(O.message||"Failed to remove item from routine")}return s(O=>O.filter(X=>X.routineEntry.A!==L)),!0}catch(E){return console.error("Error removing item:",E),!1}},updateRoutineOrder:async(A,L)=>{try{const E=L.map(K=>({A:K.A,C:K.C})),O=`/api/routines/${A}/order`,X=await fetch(O,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(E)});if(!X.ok){const K=await X.json().catch(()=>({}));throw console.error("Order update failed:",K),new Error(K.message||"Failed to update routine order")}return await u(),!0}catch(E){return console.error("Error updating routine order:",E),!1}}}},Fm=Ui.memo(({item:t,onAdd:r})=>n.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-800 rounded-lg",children:[n.jsx("span",{className:"text-lg",children:t.C}),n.jsx(Be,{variant:"ghost",size:"sm",onClick:()=>r(t),className:"text-blue-500 hover:text-blue-400","aria-label":"Add item to routine","data-ph-capture-attribute-button":"routine-add-item",children:n.jsx(yo,{className:"h-4 w-4","aria-hidden":"true"})})]})),Om=Ui.memo(({item:t,onRemove:r})=>{var h,p;const{attributes:e,listeners:a,setNodeRef:s,transform:i,transition:c,isDragging:o}=Nl({id:((h=t.routineEntry)==null?void 0:h.A)||t.A}),d={transform:_l.Transform.toString(i),transition:c,zIndex:o?1:0};return n.jsxs("div",{ref:s,style:d,className:`flex items-center justify-between p-4 ${o?"bg-gray-700":"bg-gray-800"} rounded-lg`,children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{...e,...a,"aria-label":"Drag to reorder item in routine","data-ph-capture-attribute-drag":"routine-editor-drag-handle",children:n.jsx(jl,{className:"h-5 w-5 text-gray-500 mr-4 cursor-move","aria-hidden":"true"})}),n.jsx("span",{className:"text-lg",children:((p=t.itemDetails)==null?void 0:p.C)||"Loading..."})]}),n.jsx(Be,{variant:"ghost",size:"sm",onClick:()=>{var b;return r(((b=t.routineEntry)==null?void 0:b.A)||t.A)},className:"text-red-500 hover:text-red-400","aria-label":"Remove item from routine","data-ph-capture-attribute-button":"routine-remove-item",children:n.jsx(Gr,{className:"h-4 w-4","aria-hidden":"true"})})]})}),Dm=({open:t,onOpenChange:r,routine:e=null,onRoutineChange:a,items:s=[]})=>{const{availableItems:i,selectedItems:c,setSelectedItems:o,searchQuery:d,setSearchQuery:h,loading:p,error:b,addToRoutine:m,removeFromRoutine:u,updateRoutineOrder:w}=Im(e==null?void 0:e.id,e==null?void 0:e.details,s),[x,_]=U.useState((e==null?void 0:e.name)||""),[y,A]=U.useState(null);U.useEffect(()=>{t&&A(null)},[t]),U.useEffect(()=>{},[e]);const L=Uc(Mi($c,{activationConstraint:{delay:100,tolerance:5}}),Mi(qc,{coordinateGetter:zc})),E=async({active:K,over:H})=>{if(K.id!==(H==null?void 0:H.id)){const P=c.findIndex(R=>{var N;return(((N=R.routineEntry)==null?void 0:N.A)||R.A)===K.id}),Y=c.findIndex(R=>{var N;return(((N=R.routineEntry)==null?void 0:N.A)||R.A)===H.id}),I=fl(c,P,Y),S=I.map((R,N)=>{var re;return{A:((re=R.routineEntry)==null?void 0:re.A)||R.A,C:N.toString()}});if(o(I),e!=null&&e.id)try{await w(e.id,S),a&&a()}catch(R){console.error("Failed to update routine order:",R),o(c)}}},O=async K=>{try{if(A(null),!(e!=null&&e.id))o(H=>[...H,{routineEntry:{A:K.A,B:K.B,C:H.length.toString(),D:"FALSE"},itemDetails:K}]);else{if(!await m(e.id,K.B))throw new Error("Failed to add item to routine");yc("item_added",e.name,K.C,{routine_id:e.id,item_id:K.B}),a==null||a()}}catch(H){A(H.message),console.error("Error adding item:",H)}},X=async K=>{var H,P;try{if(A(null),!(e!=null&&e.id))o(Y=>Y.filter(I=>I.routineEntry.A!==K));else{const Y=c.find(S=>{var R;return(((R=S.routineEntry)==null?void 0:R.A)||S.A)===K});if(!await u(e.id,K))throw new Error("Failed to remove item from routine");Y&&yc("item_removed",e.name,(H=Y.itemDetails)==null?void 0:H.C,{routine_id:e.id,item_id:(P=Y.itemDetails)==null?void 0:P.B}),a==null||a()}}catch(Y){A(Y.message),console.error("Error removing item:",Y)}};return p?n.jsx("div",{className:"text-2xl text-center p-8",role:"status","aria-live":"polite",children:"Loading..."}):b?n.jsx("div",{className:"text-2xl text-red-500 text-center p-8",role:"alert",children:b}):n.jsx(gs,{open:t,onOpenChange:r,children:n.jsxs(Jn,{className:"max-w-4xl max-h-[80vh]",children:[n.jsxs(Zn,{children:[n.jsx(Xn,{children:e?`Edit routine: ${e.name}`:"Create new routine"}),n.jsx(xs,{children:"Add or remove items and arrange them in your preferred order"}),y&&n.jsx("div",{className:"mt-2 text-sm text-red-500",role:"alert",children:y})]}),n.jsxs("div",{className:"flex gap-8 h-[60vh]",children:[n.jsxs(on,{className:"w-1/2 bg-gray-900",children:[n.jsxs(_n,{children:[n.jsx(ln,{children:"Selected items"}),!(e!=null&&e.name)&&n.jsx(Rr,{placeholder:"Enter routine name...",value:x,onChange:K=>_(K.target.value),className:"mt-2",autoComplete:"off"})]}),n.jsx(cn,{className:"space-y-4 overflow-y-auto h-[calc(100%-100px)]",children:n.jsx(cl,{sensors:L,collisionDetection:dl,onDragEnd:E,children:n.jsx(ul,{items:c.map(K=>{var H;return((H=K.routineEntry)==null?void 0:H.A)||K.A}).filter(K=>K!=null),strategy:hl,children:n.jsx("div",{className:"space-y-4",children:c.filter(K=>{var H;return(((H=K.routineEntry)==null?void 0:H.A)||K.A)!=null}).map(K=>{var H;return n.jsx(Om,{item:K,onRemove:X},((H=K.routineEntry)==null?void 0:H.A)||K.A)})})})})})]}),n.jsxs(on,{className:"w-1/2 bg-gray-900",children:[n.jsxs(_n,{children:[n.jsx(ln,{children:"Available items"}),n.jsxs("div",{className:"relative",children:[n.jsx(P0,{className:"absolute left-3 top-3 h-4 w-4 text-gray-500"}),n.jsx(Rr,{className:"pl-9",placeholder:"Search items...",value:d,onChange:K=>h(K.target.value),autoComplete:"off"})]})]}),n.jsx(cn,{className:"space-y-4 overflow-y-auto h-[calc(100%-100px)]",children:i.map(K=>n.jsx(Fm,{item:K,onAdd:O},K.A))})]})]})]})})},Rm=Ui.memo(({item:t,itemDetails:r,handleOpenChordCharts:e})=>{var p,b,m;const{attributes:a,listeners:s,setNodeRef:i,transform:c,transition:o,isDragging:d}=Nl({id:((p=t.routineEntry)==null?void 0:p.A)||t.A}),h={transform:_l.Transform.toString(c),transition:o,zIndex:d?1:0};return n.jsxs("div",{ref:i,style:h,className:`flex items-center justify-between p-4 rounded-lg ${d?"bg-gray-700":"bg-gray-800"}`,children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{...a,...s,"aria-label":"Drag to reorder item","data-ph-capture-attribute-drag":"routine-item-drag-handle",children:n.jsx(jl,{className:"h-5 w-5 text-gray-500 mr-4 cursor-move","aria-hidden":"true"})}),n.jsx("span",{className:"text-lg",children:(r==null?void 0:r.C)||`Item ${((b=t.routineEntry)==null?void 0:b.B)||t.B}`})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(Be,{variant:"ghost",size:"icon",onClick:()=>{var u,w;return e(((u=t.routineEntry)==null?void 0:u.B)||t.B,(r==null?void 0:r.C)||`Item ${((w=t.routineEntry)==null?void 0:w.B)||t.B}`)},className:"text-blue-400 hover:text-blue-300 hover:bg-gray-700 h-8 w-8",title:"Click to add or edit chord charts","data-ph-capture-attribute-button":"routine-item-chord-charts",children:[n.jsx(of,{className:"h-5 w-5","aria-hidden":"true"}),n.jsx("span",{className:"sr-only",children:"Chord charts"})]}),(((m=t.routineEntry)==null?void 0:m.D)||t.D)==="TRUE"&&n.jsx(Mc,{className:"h-5 w-5 text-green-500","aria-hidden":"true"})]})]})}),Bm=Ui.memo(({routine:t,handleActivateRoutine:r,handleEditClick:e,handleDeleteClick:a})=>{const{attributes:s,listeners:i,setNodeRef:c,transform:o,transition:d,isDragging:h}=Nl({id:t.ID}),p={transform:_l.Transform.toString(o),transition:d,zIndex:h?1:0};return n.jsxs("div",{ref:c,style:p,className:`flex items-center justify-between p-3 ${h?"bg-gray-700":"bg-gray-800"} rounded-lg`,children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{...s,...i,"aria-label":"Drag to reorder routine","data-ph-capture-attribute-drag":"routine-drag-handle",children:n.jsx(jl,{className:"h-5 w-5 text-gray-500 mr-4 cursor-move","aria-hidden":"true"})}),n.jsx("span",{children:t.name})]}),n.jsxs("div",{className:"flex space-x-2",children:[n.jsxs(Be,{variant:"ghost",size:"sm",onClick:()=>r(t.ID),className:"text-green-500 hover:text-green-400",title:"Make this the active routine","data-ph-capture-attribute-button":"activate-routine",children:[n.jsx(yo,{className:"h-4 w-4","aria-hidden":"true"}),n.jsx("span",{className:"sr-only",children:"Activate routine"})]}),n.jsxs(Be,{variant:"ghost",size:"sm",onClick:()=>e(t),className:"text-blue-500 hover:text-blue-400",title:"Edit routine","data-ph-capture-attribute-button":"edit-routine",children:[n.jsx(po,{className:"h-4 w-4","aria-hidden":"true"}),n.jsx("span",{className:"sr-only",children:"Edit routine"})]}),n.jsxs(Be,{variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-400",onClick:()=>a(t.ID),title:"Delete this routine","data-ph-capture-attribute-button":"delete-routine",children:[n.jsx(Gr,{className:"h-4 w-4","aria-hidden":"true"}),n.jsx("span",{className:"sr-only",children:"Delete routine"})]})]})]})}),Mm=()=>{const{isAuthenticated:t,checking:r}=lf(),[e,a]=U.useState([]),[s,i]=U.useState(""),[c,o]=U.useState([]),[d,h]=U.useState(!0),[p,b]=U.useState(null),[m,u]=U.useState(!1),[w,x]=U.useState(null),[_,y]=U.useState(null),[A,L]=U.useState([]),[E,O]=U.useState(!1),[X,K]=U.useState(null),[H,P]=U.useState(""),[Y,I]=U.useState(!1),[S,R]=U.useState({limitType:"routines",currentTier:"free",currentCount:0,limitAmount:1}),N=U.useRef(null),re=U.useRef(null),ve=U.useMemo(()=>c.find(je=>je.active),[c]),le=U.useMemo(()=>c.filter(je=>!je.active).sort((je,j)=>Number(je.order)-Number(j.order)),[c]),oe=Uc(Mi($c,{activationConstraint:{delay:100,tolerance:5}}),Mi(qc,{coordinateGetter:zc})),ie=U.useCallback(async()=>{if(!t){h(!1);return}try{y(null);const je=await fetch("/api/routines");if(!je.ok)throw new Error("Failed to fetch routines");const j=await je.json();o(j)}catch(je){console.error("Error:",je),y(je.message)}finally{h(!1)}},[t]),Ae=U.useCallback(async()=>{if(e.length===0)try{const je=await fetch("/api/items");if(!je.ok)throw new Error("Failed to fetch items");const j=await je.json();a(j)}catch(je){console.error("Error fetching items:",je),y(je.message)}},[e.length]),te=U.useCallback(async je=>{try{if(!(await fetch(`/api/routines/${je}/active`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({active:!0})})).ok)throw new Error("Failed to activate routine");const T=await fetch("/api/routines");if(T.ok){const V=await T.json();o(V);const $=V.find(z=>z.active);if($){yc("activated",$.Name,null,{routine_id:$.ID,item_count:$.ItemCount||0});const z=await fetch(`/api/routines/${$.ID}`);if(z.ok){const ue=(await z.json()).items.sort((pe,ce)=>parseInt(pe.routineEntry.C)-parseInt(ce.routineEntry.C)).map(pe=>({...pe,itemDetails:pe.itemDetails||pe}));L(ue)}}}}catch(j){console.error("Error:",j),y(j.message)}},[]),C=U.useCallback(async je=>{try{if(!(await fetch(`/api/routines/${je}/active`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({active:!1})})).ok)throw new Error("Failed to deactivate routine");const T=await fetch("/api/routines");if(T.ok){const V=await T.json();o(V),L([])}}catch(j){console.error("Error:",j),y(j.message)}},[]),G=U.useCallback(je=>{b(c.find(j=>j.ID===je))},[c]),Z=U.useCallback((je,j)=>{K(je),P(j),O(!0)},[]),Q=U.useCallback(async()=>{if(p)try{if(!(await fetch(`/api/routines/${p.ID}`,{method:"DELETE"})).ok)throw new Error("Failed to delete routine");fo("deleted","routine",p.Name),await ie()}catch(je){console.error("Failed to delete routine:",je),y(je.message)}finally{b(null)}},[p,ie]),fe=U.useCallback(async()=>{if(s.trim())try{const je=await fetch("/api/routines",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({routineName:s.trim()})});if(!je.ok){if(je.status===403){const j=await je.json();if(j.error==="Routine limit reached"){R({limitType:"routines",currentTier:j.tier||"free",currentCount:j.current||0,limitAmount:j.limit||1}),I(!0);return}}throw new Error("Failed to create routine")}fo("created","routine",s.trim()),await ie(),i("")}catch(je){console.error("Failed to create routine:",je),y(je.message)}},[s,ie]),we=U.useCallback(async je=>{await Ae();const j=je.active?{id:je.ID,name:je.name,items:A.map(T=>({routineEntry:T.routineEntry||T,itemDetails:T.itemDetails}))}:null;x({id:je.ID,name:je.name,details:j}),u(!0)},[A,Ae]),Se=U.useCallback(async()=>{const je=await fetch("/api/routines");if(!je.ok){console.error("Failed to fetch routines");return}const j=await je.json();o(j);const T=j.find($=>$.active);if(!T){L([]);return}const V=await fetch(`/api/routines/${T.ID}`);if(V.ok){const z=(await V.json()).items.sort((M,ue)=>parseInt(M.routineEntry.C)-parseInt(ue.routineEntry.C)).map(M=>({...M,itemDetails:M.itemDetails||M}));L(z)}},[]),Ce=U.useCallback(async()=>{try{const je=await fetch("/api/routines");if(!je.ok)throw new Error("Failed to fetch routines");const T=(await je.json()).find(M=>M.active);if(!T){L([]);return}const V=await fetch(`/api/routines/${T.ID}`);if(!V.ok)throw new Error("Failed to fetch routine details");const z=(await V.json()).items.sort((M,ue)=>parseInt(M.routineEntry.C)-parseInt(ue.routineEntry.C)).map(M=>({...M,itemDetails:M.itemDetails||M}));L(z),fetch("/api/debug/log",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:`LOAD: Active routine items loaded: ${z.length} items`,level:"info"})}),z.length>0&&fetch("/api/debug/log",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:`LOAD: Sortable IDs: ${z.map(M=>{var ue;return((ue=M.routineEntry)==null?void 0:ue.A)||M.A}).join(", ")}`,level:"info"})})}catch(je){console.error("Error fetching routine items:",je),y(je.message)}},[]);U.useEffect(()=>{Ce()},[Ce]);const Re=async({active:je,over:j})=>{if(fetch("/api/debug/log",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:`ACTIVE ROUTINE handleDragEnd called: active=${je==null?void 0:je.id}, over=${j==null?void 0:j.id}`,level:"info"})}),!je||!j||je.id===j.id){fetch("/api/debug/log",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:"ACTIVE ROUTINE Drag end early return - no valid drag",level:"info"})});return}const T=A.findIndex($=>{var z;return(((z=$.routineEntry)==null?void 0:z.A)||$.A)===je.id}),V=A.findIndex($=>{var z;return(((z=$.routineEntry)==null?void 0:z.A)||$.A)===j.id});fetch("/api/debug/log",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:`ACTIVE ROUTINE Indices: old=${T}, new=${V}, activeId=${je.id}, overId=${j.id}`,level:"info"})});try{const $=await fetch("/api/routines/active");if(!$.ok)throw new Error("Failed to fetch active routine");const M=(await $.json()).A;if(!M)throw new Error("No active routine found");const ue=fl(A,T,V),pe=ue.map((Ie,Te)=>{var Ve;return{A:((Ve=Ie.routineEntry)==null?void 0:Ve.A)||Ie.A,C:Te.toString()}});L(ue);const ce=`/api/routines/${M}/order`,Le=await fetch(ce,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(pe)});if(!Le.ok){const Ie=await Le.text();throw new Error(`Failed to update routine order: ${Ie}`)}await Ce()}catch($){console.error("Reorder failed:",$),await Ce()}},Me=U.useCallback(async je=>{try{const j=await fetch("/api/routines/order",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(je)});if(!j.ok){const T=await j.text();throw new Error(`Failed to update routine order: ${T}`)}}catch(j){console.error("Failed to save routine order:",j),y("Failed to save routine order. Please refresh the page."),await ie()}},[ie]),Je=({active:je,over:j})=>{if(fetch("/api/debug/log",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:`INACTIVE ROUTINES handleDragEnd called: active=${je==null?void 0:je.id}, over=${j==null?void 0:j.id}`,level:"info"})}),!je||!j||je.id===j.id)return;const T=le.findIndex(M=>M.ID===je.id),V=le.findIndex(M=>M.ID===j.id),z=fl(le,T,V).map((M,ue)=>({A:M.ID,D:ue.toString()}));o(M=>{const ue=M.find(ce=>ce.active),pe=z.map(ce=>({...M.find(Ie=>Ie.ID===ce.A),order:ce.D}));return ue?[ue,...pe]:pe}),re.current=z,N.current&&clearTimeout(N.current),N.current=setTimeout(()=>{re.current&&(Me(re.current),re.current=null)},500)};return U.useEffect(()=>{r||(h(!0),ie())},[r,ie]),U.useEffect(()=>()=>{N.current&&(clearTimeout(N.current),re.current&&Me(re.current))},[Me]),r?n.jsx("div",{className:"text-center p-8",role:"status","aria-live":"polite",children:n.jsx("h2",{className:"text-2xl mb-4",children:"Checking authentication..."})}):d?n.jsx("div",{className:"text-center p-8",role:"status","aria-live":"polite",children:n.jsx("h2",{className:"text-2xl mb-4",children:"Loading routines..."})}):_?n.jsxs("div",{className:"text-center p-8",children:[n.jsxs("h2",{className:"text-2xl text-red-500 mb-4",children:["Error: ",_]}),n.jsx(Be,{onClick:ie,className:"bg-blue-600 hover:bg-blue-700",children:"Retry"})]}):t?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs(on,{className:"bg-gray-900 text-gray-100","data-tour":"routines-items",children:[n.jsx(_n,{children:n.jsx(ln,{children:"Current active routine"})}),n.jsx(cn,{children:t?ve?n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("span",{className:"flex items-center",children:[n.jsx(Mc,{className:"h-5 w-5 text-green-500 mr-2","aria-hidden":"true"}),ve.name]}),n.jsxs("div",{className:"flex space-x-2","data-tour":"edit-routine-icon",children:[n.jsxs(Be,{variant:"ghost",size:"sm",onClick:()=>we(ve),className:"text-blue-500 hover:text-blue-400",title:"Edit routine",children:[n.jsx(po,{className:"h-4 w-4","aria-hidden":"true"}),n.jsx("span",{className:"sr-only",children:"Edit routine"})]}),n.jsxs(Be,{variant:"ghost",size:"sm",onClick:()=>C(ve.ID),className:"text-gray-400 hover:text-gray-200",title:"Deactivate this routine",children:[n.jsx(Gr,{className:"h-4 w-4","aria-hidden":"true"}),n.jsx("span",{className:"sr-only",children:"Deactivate routine"})]})]})]}),n.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"(use drag and drop handles on the left to change order of items)"}),n.jsx(cl,{sensors:oe,collisionDetection:dl,onDragStart:je=>{fetch("/api/debug/log",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:`ACTIVE ROUTINE Drag started: ${je.active.id}`,level:"info"})})},onDragEnd:Re,children:n.jsx(ul,{items:A.map(je=>{var j;return((j=je.routineEntry)==null?void 0:j.A)||je.A}),strategy:hl,children:n.jsx("div",{className:"space-y-2 mt-4",children:A.map(je=>{var j;return n.jsx(Rm,{item:je,itemDetails:je.itemDetails,handleOpenChordCharts:Z},((j=je.routineEntry)==null?void 0:j.A)||je.A)})})})})]}):n.jsx("div",{className:"text-gray-400",children:"No active routine selected"}):n.jsx("div",{className:"text-gray-400",children:"Please log in to manage routines"})})]}),n.jsxs(on,{className:"bg-gray-900 text-gray-100",children:[n.jsx(_n,{children:n.jsx(ln,{children:"Routines"})}),n.jsx(cn,{children:t?n.jsx(n.Fragment,{children:n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"mb-4 flex space-x-2","data-tour":"new-routine-input",children:[n.jsx("label",{htmlFor:"new-routine-name-input",className:"sr-only",children:"New routine name"}),n.jsx(Rr,{id:"new-routine-name-input",placeholder:"Enter name for new routine, then click '+ Add'",value:s,onChange:je=>i(je.target.value),onKeyPress:je=>je.key==="Enter"&&!je.shiftKey&&fe(),className:"flex-grow"}),n.jsxs(Be,{onClick:fe,className:"bg-blue-600 hover:bg-blue-700",disabled:!s.trim(),"data-ph-capture-attribute-button":"add-new-routine",children:[n.jsx(yo,{className:"h-5 w-5 mr-2","aria-hidden":"true"}),"Add"]})]}),n.jsx(cl,{sensors:oe,collisionDetection:dl,onDragEnd:Je,children:n.jsx(ul,{items:le.map(je=>je.ID).filter(je=>je!=null),strategy:hl,children:n.jsx("div",{className:"space-y-2",children:le.filter(je=>je.ID!=null).map(je=>n.jsx(Bm,{routine:je,handleActivateRoutine:te,handleEditClick:we,handleDeleteClick:G},je.ID))})})})]})}):n.jsx("div",{className:"text-gray-400",children:"Please log in to manage routines"})})]}),n.jsx(Xs,{open:!!p,onOpenChange:je=>{je||b(null)},children:n.jsxs(Os,{children:[n.jsxs(Ds,{children:[n.jsx(Bs,{children:"Delete routine"}),n.jsxs(Ms,{children:['Are you sure you want to delete the "',p==null?void 0:p.name,`" routine? You can't undo this deletion. (Items will remain, but the routine will be gone.)`]})]}),n.jsxs(Rs,{children:[n.jsx(xa,{children:"Cancel"}),n.jsx(js,{onClick:Q,className:"bg-red-500 hover:bg-red-600",children:"Delete"})]})]})})]}),n.jsx(Dm,{open:m,onOpenChange:u,routine:w,onRoutineChange:Se,items:e}),n.jsx(af,{isOpen:E,onClose:()=>O(!1),itemId:X,itemTitle:H}),n.jsx(Fh,{isOpen:Y,onClose:()=>I(!1),limitType:S.limitType,currentTier:S.currentTier,currentCount:S.currentCount,limitAmount:S.limitAmount})]}):n.jsx("div",{className:"text-center p-8",children:n.jsx("h2",{className:"text-2xl mb-4",children:"Please log in to manage routines"})})},Um=()=>{const[t,r]=U.useState([]),[e,a]=U.useState(null),[s,i]=U.useState(!0),[c,o]=U.useState(null),d=async()=>{try{i(!0);const m=await fetch("/api/routines");if(!m.ok)throw new Error("Failed to fetch routines");const u=await m.json();r(u),o(null)}catch(m){console.error("Fetch routines error:",m),o(m.message)}finally{i(!1)}},h=async m=>{try{if(!(await fetch("/api/routines",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({routineName:m})})).ok)throw new Error("Failed to create routine");return await d(),!0}catch(u){return console.error("Create routine error:",u),o(u.message),!1}},p=async m=>{try{if(!(await fetch(`/api/routines/${m}`,{method:"DELETE"})).ok)throw new Error("Failed to delete routine");return await d(),!0}catch(u){return console.error("Delete routine error:",u),o(u.message),!1}},b=async m=>{a(m)};return U.useEffect(()=>{d()},[]),{routines:t,activeRoutine:e,loading:s,error:c,createRoutine:h,deleteRoutine:p,activateRoutine:b,refreshRoutines:d}},zm=g0,qm=x0,df=U.forwardRef(({className:t,children:r,...e},a)=>n.jsxs(bh,{ref:a,className:zr("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...e,children:[r,n.jsx(u0,{asChild:!0,children:n.jsx(Kn,{className:"h-4 w-4 opacity-50"})})]}));df.displayName=bh.displayName;const uf=U.forwardRef(({className:t,children:r,position:e="popper",...a},s)=>n.jsx(h0,{children:n.jsx(wh,{ref:s,className:zr("relative z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:e,...a,children:n.jsx(f0,{className:zr("p-1",e==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r})})}));uf.displayName=wh.displayName;const $m=U.forwardRef(({className:t,...r},e)=>n.jsx(vh,{ref:e,className:zr("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...r}));$m.displayName=vh.displayName;const hf=U.forwardRef(({className:t,children:r,...e},a)=>n.jsxs(Nh,{ref:a,className:zr("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...e,children:[n.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:n.jsx(p0,{children:n.jsx(Nn,{className:"h-4 w-4"})})}),n.jsx(m0,{children:r})]}));hf.displayName=Nh.displayName;const Wm=U.forwardRef(({className:t,...r},e)=>n.jsx(_h,{ref:e,className:zr("-mx-1 my-1 h-px bg-muted",t),...r}));Wm.displayName=_h.displayName;function Hm(){const[t,r]=U.useState(""),[e,a]=U.useState(""),[s,i]=U.useState(""),[c,o]=U.useState(""),{routines:d,loading:h}=Um(),p=async()=>{try{const u=JSON.parse(t);if(!(await fetch("/api/items/import",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)})).ok)throw new Error("Failed to import items");r("")}catch(u){console.error("Import error:",u)}},b=async()=>{try{const u=JSON.parse(e);if(!(await fetch("/api/routines/import",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)})).ok)throw new Error("Failed to import routines");a("")}catch(u){console.error("Import error:",u)}},m=async()=>{try{if(!c)throw new Error("Please select a routine first");const u=JSON.parse(s);if(!(await fetch(`/api/routines/${c}/items/import`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)})).ok)throw new Error("Failed to import routine items");i("")}catch(u){console.error("Import error:",u)}};return n.jsx(on,{className:"w-full max-w-4xl bg-gray-900 text-gray-100",children:n.jsxs(cn,{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx(ln,{className:"text-2xl mb-4",children:"Import Items"}),n.jsx("p",{className:"text-gray-300 mb-4",children:"Import practice items from other sources. Items will be appended to your existing items."}),n.jsx(Ii,{value:t,onChange:u=>r(u.target.value),placeholder:"Paste your JSON data here...",className:"h-48 font-mono bg-gray-800 mb-2"}),n.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Expected format: Array of objects with 'title' and 'duration' fields"}),n.jsx(Be,{onClick:p,className:"bg-blue-600 hover:bg-blue-700",children:"Import Items"})]}),n.jsxs("div",{children:[n.jsx(ln,{className:"text-2xl mb-4",children:"Import Routine Items"}),n.jsx("p",{className:"text-gray-300 mb-4",children:"Import items into an existing routine. Items will be matched by title with existing items."}),n.jsxs("div",{className:"mb-4",children:[n.jsx(Wn,{htmlFor:"routine-select",className:"block mb-2",children:"Select Routine"}),n.jsxs(zm,{value:c,onValueChange:o,disabled:h,children:[n.jsx(df,{className:"w-full bg-gray-800",children:n.jsx(qm,{placeholder:"Select a routine"})}),n.jsx(uf,{className:"bg-gray-800",children:d.map(u=>n.jsx(hf,{value:u.ID,className:"text-gray-100 hover:bg-gray-700",children:u.name},u.ID))})]})]}),n.jsx(Ii,{value:s,onChange:u=>i(u.target.value),placeholder:"Paste your JSON data here...",className:"h-48 font-mono bg-gray-800 mb-2"}),n.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Expected format: Array of objects with 'title' field"}),n.jsx(Be,{onClick:m,className:"bg-blue-600 hover:bg-blue-700",children:"Import Routine Items"})]}),n.jsxs("div",{children:[n.jsx(ln,{className:"text-2xl mb-4",children:"Import Routines"}),n.jsx("p",{className:"text-gray-300 mb-4",children:"Import practice routines. Each routine will be created as a new routine."}),n.jsx(Ii,{value:e,onChange:u=>a(u.target.value),placeholder:"Paste your JSON data here...",className:"h-48 font-mono bg-gray-800 mb-2"}),n.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Expected format: Array of objects with 'name' field"}),n.jsx(Be,{onClick:b,className:"bg-blue-600 hover:bg-blue-700",children:"Import Routines"})]})]})})}const Gm=({isOpen:t,onClose:r,title:e,message:a,icon:s})=>{if(!t)return null;const i=()=>s||(e!=null&&e.includes("Upgraded")?n.jsx(I0,{className:"h-6 w-6 text-green-500"}):e!=null&&e.includes("Billing Updated")?n.jsx(Sh,{className:"h-6 w-6 text-blue-500"}):e!=null&&e.includes("Changed")?n.jsx(E0,{className:"h-6 w-6 text-orange-500"}):n.jsx(k0,{className:"h-6 w-6 text-green-500"}));return n.jsx(gs,{open:t,onOpenChange:c=>!c&&r(),children:n.jsxs(Jn,{className:"sm:max-w-md",children:[n.jsxs(Zn,{children:[n.jsxs(Xn,{className:"flex items-center gap-2 text-xl",children:[i(),e]}),n.jsx(xs,{className:"text-left space-y-3 text-base mt-4",children:n.jsx("div",{className:"whitespace-pre-line text-gray-700 dark:text-gray-300",children:a})})]}),n.jsx("div",{className:"flex justify-end mt-6",children:n.jsx(Be,{onClick:r,className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6",children:"Got it! ðŸŽ¸"})})]})})},Vm=({currentTier:t="free"})=>{const[r,e]=U.useState(null),[a,s]=U.useState(null),[i,c]=U.useState(!1),[o,d]=U.useState({title:"",message:""}),[h,p]=U.useState(!1),[b,m]=U.useState("free"),[u,w]=U.useState(()=>{const P=sessionStorage.getItem("pricingTiersCollapsed");return P?JSON.parse(P):{free:!0,basic:!0,thegoods:!0,moregoods:!0,themost:!0,rollyourown:!0}}),x=P=>{w(Y=>{const I={...Y,[P]:!Y[P]};return sessionStorage.setItem("pricingTiersCollapsed",JSON.stringify(I)),I})};U.useEffect(()=>{(async()=>{try{const Y=await fetch("/api/auth/status");if(Y.ok){const I=await Y.json();p(I.unplugged_mode||!1),m(I.actual_tier||"free")}}catch(Y){console.error("Error fetching unplugged status:",Y)}})()},[]);const _=[{id:"free",name:"Free",itemsLimit:15,routinesLimit:1,price:0,autocreate:!1,description:"Get started with basic features",byocNote:"BYOClaude (enter your own Anthropic API key) for autocreated chord charts"},{id:"basic",name:"Basic",itemsLimit:80,routinesLimit:5,price:3,autocreate:!1,description:"More items and routines",byocNote:"BYOClaude (enter your own Anthropic API key) for autocreated chord charts"},{id:"thegoods",name:"The Goods",itemsLimit:200,routinesLimit:10,price:6,autocreate:!0,description:"Includes Autocreate for chord charts"},{id:"moregoods",name:"More Goods",itemsLimit:600,routinesLimit:25,price:12,autocreate:!0,description:"Even more items and routines"},{id:"themost",name:"The Most",itemsLimit:1500,routinesLimit:50,price:20,autocreate:!0,description:"Goes to 11"}],y=P=>{const{old_tier:Y,new_tier:I,tier_changed:S,proration_amount:R,autocreate_enabled:N}=P,ve={free:"Free",basic:"Basic",thegoods:"The Goods",moregoods:"More Goods",themost:"The Most"}[I]||I,le=["free","basic","thegoods","moregoods","themost"],oe=le.indexOf(Y),ie=le.indexOf(I);if(S&&ie<oe)return{title:"Plan Changed",message:`You've downgraded to ${ve}. Your new limits will take effect immediately. Thanks for sticking with us! ðŸŽ¸`};if(S&&ie>oe){const Ae=`Right on, you've upgraded to ${ve}!`,te=R>0?` Your card was charged a prorated amount of $${R.toFixed(2)} usd.`:"";return N&&Y==="basic"?{title:"ðŸŽ‰ Upgraded!",message:`${Ae}${te} You're ready to add more items, organize more routines, and have your chord charts autocreated! ðŸ¤˜Rock on!`}:{title:"ðŸŽ‰ Upgraded!",message:`${Ae}${te} You're ready to add more items and organize more routines! ðŸ¤˜Rock on!`}}return S?{title:"Plan Updated",message:`You've switched to ${ve}. Rock on! ðŸ¤˜`}:{title:"Subscription Updated",message:"Your subscription has been updated successfully. ðŸŽ¸"}},A=async P=>{if(P!=="free"){e(P),s(null);try{const S=await fetch(b!=="free"&&!h?"/api/billing/update-subscription":"/api/billing/create-checkout-session",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({tier:P,billing_period:"monthly"})}),R=await S.json();if(!S.ok){s(R.error||"Failed to process request"),e(null);return}if(R.url)window.location.href=R.url;else if(R.details){const N=y(R.details||{});d(N),c(!0),e(null)}else s("Unexpected response from server"),e(null)}catch(Y){d({title:"âŒ Error",message:`Error: ${Y.message||"Error connecting to payment system"}`}),c(!0),e(null)}}},L=()=>{c(!1),window.location.reload()},E=async()=>{e("portal"),s(null);try{const P=await fetch("/api/billing/create-portal-session",{method:"POST",headers:{"Content-Type":"application/json"}}),Y=await P.json();P.ok&&Y.url?window.location.href=Y.url:(s(Y.error||"Failed to open subscription portal"),e(null))}catch{s("Error connecting to subscription portal"),e(null)}},O=async()=>{e("unpause"),s(null);try{const P=await fetch("/api/billing/unpause-subscription",{method:"POST",headers:{"Content-Type":"application/json"}}),Y=await P.json();P.ok?(d({title:"âœ… Subscription Resumed",message:"Welcome back! Your subscription has been reactivated. You now have access to all your routines and features. ðŸŽ¸"}),c(!0)):(s(Y.error||"Failed to unpause subscription"),e(null))}catch{s("Error unpausing subscription"),e(null)}},K=(P=>_.findIndex(Y=>Y.id===P))(t),H=P=>P===K?"Current Plan":P<K?"Downgrade":"Upgrade";return n.jsxs("div",{className:"space-y-4",children:[h&&n.jsx(on,{className:"bg-orange-900/20 border-orange-700",children:n.jsx(cn,{className:"pt-6",children:n.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold text-orange-300 mb-1",children:"Your subscription is paused"}),n.jsx("p",{className:"text-sm text-gray-300",children:`You're currently in free mode with access to your last active routine. Click "Unpause" to restore full access to all your routines and features.`})]}),n.jsx(Be,{onClick:O,disabled:r==="unpause",className:"bg-green-600 hover:bg-green-700",children:r==="unpause"?n.jsxs(n.Fragment,{children:[n.jsx(Hr,{className:"w-4 h-4 mr-2 animate-spin"}),"Unpausing..."]}):"Unpause Subscription"})]})})}),a&&n.jsx("div",{className:"bg-red-900/30 border border-red-700 rounded-md p-3 text-sm text-red-300",children:a}),n.jsxs("div",{className:"space-y-4",children:[_.map((P,Y)=>{const I=P.id===t,S=r===P.id,R=u[P.id];return n.jsxs(on,{className:`relative bg-gray-800 border-gray-700 ${I?"border-orange-600 border-2":""}`,children:[n.jsx(_n,{className:"cursor-pointer select-none",onClick:()=>x(P.id),"data-ph-capture-attribute-toggle":`pricing-tier-${P.id}`,children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs(ln,{className:"text-gray-100 text-lg flex items-center gap-2",children:[P.name,I&&n.jsx("span",{className:"text-xs font-normal text-orange-400 bg-orange-400/10 px-2 py-0.5 rounded",children:"Your current plan"}),R&&P.price>0&&n.jsxs("span",{className:"text-sm font-normal text-gray-400",children:["$",P.price,"/mo"]}),R&&P.price===0&&n.jsx("span",{className:"text-sm font-normal text-gray-400",children:"Free"})]}),n.jsx(Fs,{className:"text-gray-400 text-xs",children:P.description})]}),R?n.jsx(us,{className:"w-5 h-5 text-gray-400"}):n.jsx(Kn,{className:"w-5 h-5 text-gray-400"})]})}),!R&&n.jsxs(cn,{className:"space-y-3",children:[n.jsx("div",{className:"text-center py-2",children:P.price===0?n.jsx("div",{className:"text-3xl font-bold text-gray-100",children:"Free"}):n.jsxs("div",{className:"text-3xl font-bold text-gray-100",children:["$",P.price,n.jsx("span",{className:"text-sm text-gray-400 font-normal",children:"usd/mo"})]})}),n.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx(Nn,{className:"w-4 h-4 text-green-400 flex-shrink-0 mt-0.5"}),n.jsxs("span",{children:[P.itemsLimit," items"]})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx(Nn,{className:"w-4 h-4 text-green-400 flex-shrink-0 mt-0.5"}),n.jsxs("span",{children:[P.routinesLimit," ",P.routinesLimit===1?"routine":"routines"]})]}),P.autocreate&&n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx(Nn,{className:"w-4 h-4 text-green-400 flex-shrink-0 mt-0.5"}),n.jsx("span",{className:"font-medium text-orange-400",children:"Includes Autocreate for chord charts"})]})]}),P.byocNote&&n.jsx("div",{className:"text-xs text-gray-300",children:P.byocNote}),P.id!=="free"&&!I&&n.jsx(Be,{onClick:()=>A(P.id),disabled:S,className:`w-full ${Y>K?"bg-orange-600 hover:bg-orange-700":"bg-gray-700 hover:bg-gray-600 border border-gray-600"}`,"data-ph-capture-attribute-button":Y>K?`upgrade-to-${P.id}`:`downgrade-to-${P.id}`,children:S?n.jsxs(n.Fragment,{children:[n.jsx(Hr,{className:"w-4 h-4 mr-2 animate-spin"}),"Loading..."]}):H(Y)})]})]},P.id)}),n.jsxs(on,{className:"relative bg-gray-800 border-gray-700",children:[n.jsx(_n,{className:"cursor-pointer select-none",onClick:()=>x("rollyourown"),"data-ph-capture-attribute-toggle":"pricing-tier-rollyourown",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx(ln,{className:"text-gray-100 text-lg",children:"Roll your own"}),n.jsx(Fs,{className:"text-gray-400 text-xs",children:"Local-only, on your laptop or desktop"})]}),u.rollyourown?n.jsx(us,{className:"w-5 h-5 text-gray-400"}):n.jsx(Kn,{className:"w-5 h-5 text-gray-400"})]})}),!u.rollyourown&&n.jsxs(cn,{className:"space-y-3",children:[n.jsx("div",{className:"text-center py-2",children:n.jsx("div",{className:"text-2xl font-bold text-gray-100",children:"Time and effort"})}),n.jsx("div",{className:"text-xs font-semibold text-gray-400 mb-1",children:"Requirements:"}),n.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("span",{className:"text-gray-500",children:"â€¢"}),n.jsx("span",{children:"Familiarity with Linux CLI"})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("span",{className:"text-gray-500",children:"â€¢"}),n.jsx("span",{children:"Familiarity with GitHub"})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("span",{className:"text-gray-500",children:"â€¢"}),n.jsx("span",{children:"Familiarity with using APIs"})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("span",{className:"text-gray-500",children:"â€¢"}),n.jsx("span",{children:"Familiarity with being a nerd"})]})]}),n.jsx(Be,{onClick:()=>window.open("https://github.com/slshults/guitar-practice-routine-app_postgresql/blob/main/README.md","_blank"),className:"w-full bg-gray-700 hover:bg-gray-600 border border-gray-600","data-ph-capture-attribute-button":"github-roll-your-own",children:"Get it from GitHub"})]})]})]}),b!=="free"&&n.jsx(on,{className:"bg-gray-800 border-gray-700 mt-6",children:n.jsx(cn,{className:"pt-6",children:n.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-100 mb-1",children:"Manage your subscription"}),n.jsx("p",{className:"text-sm text-gray-400",children:h?"Reactivate your subscription or view billing details":"Log in to your Stripe account to update your payment method, view invoices, view payment history, etc."})]}),n.jsx(Be,{onClick:E,disabled:r==="portal",className:"bg-orange-600 hover:bg-orange-700","data-ph-capture-attribute-button":"stripe-billing-portal",children:r==="portal"?n.jsxs(n.Fragment,{children:[n.jsx(Hr,{className:"w-4 h-4 mr-2 animate-spin","aria-hidden":"true"}),"Loading..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Sh,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Stripe billing portal"]})})]})})}),n.jsx(Gm,{isOpen:i,onClose:L,title:o.title,message:o.message})]})},Ym=({userTier:t,unpluggedMode:r})=>{const[e,a]=U.useState("initial"),[s,i]=U.useState(!1),[c,o]=U.useState(null),[d,h]=U.useState(!1),[p,b]=U.useState(!1),[m,u]=U.useState(null),[w,x]=U.useState(""),[_,y]=U.useState(""),[A,L]=U.useState(""),[E,O]=U.useState(!1),[X,K]=U.useState(r||!1),H=t==="free";U.useEffect(()=>{H||Y(),P()},[H]),U.useEffect(()=>{K(r||!1)},[r]);const P=async()=>{try{const oe=await fetch("/api/auth/status");if(oe.ok){const ie=await oe.json();O(!!ie.deletion_scheduled_for)}}catch(oe){console.error("Error checking deletion status:",oe)}},Y=async()=>{try{const oe=await fetch("/api/user/calculate-deletion-refund");if(oe.ok){const ie=await oe.json();x(ie.renewal_date)}}catch(oe){console.error("Error fetching refund calculation:",oe)}},I=async()=>{i(!0),o(null);try{const oe=await fetch("/api/user/delete-account-scheduled",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({confirmation_phrase:_,email:A})}),ie=await oe.json();oe.ok?(o({type:"success",text:`Account deletion scheduled for ${ie.deletion_date}. You can cancel this anytime before then.`}),a("initial"),y(""),L(""),O(!0)):o({type:"error",text:ie.error||"Failed to schedule deletion"})}catch(oe){console.error("Error scheduling deletion:",oe),o({type:"error",text:"Error scheduling deletion"})}finally{i(!1)}},S=async()=>{i(!0),o(null);try{const ie=await fetch(H?"/api/user/delete-account-free":"/api/user/delete-account-immediate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({confirmation_phrase:_,email:A})}),Ae=await ie.json();ie.ok?(u(Ae.redirect_url||"/login"),h(!0),y(""),L("")):o({type:"error",text:Ae.error||"Failed to delete account"})}catch(oe){console.error("Error deleting account:",oe),o({type:"error",text:"Error deleting account"})}finally{i(!1)}},R=()=>{window.location.href=m||"/login"},N=async()=>{try{const oe=await fetch("/api/user/export/all");if(!oe.ok)throw new Error("Failed to download data");const ie=await oe.blob(),Ae=window.URL.createObjectURL(ie),te=document.createElement("a");te.href=Ae;const C=new Date().toISOString().split("T")[0];te.download=`gpra-export-${C}.zip`,document.body.appendChild(te),te.click(),window.URL.revokeObjectURL(Ae),document.body.removeChild(te)}catch(oe){console.error("Error downloading data:",oe),o({type:"error",text:"Failed to download your data. Please try again."})}},re=async()=>{i(!0),o(null);try{const oe=await fetch("/api/user/cancel-deletion",{method:"POST",headers:{"Content-Type":"application/json"}}),ie=await oe.json();oe.ok?(o({type:"success",text:"Deletion canceled successfully!"}),O(!1)):o({type:"error",text:ie.error||"Failed to cancel deletion"})}catch(oe){console.error("Error canceling deletion:",oe),o({type:"error",text:"Error canceling deletion"})}finally{i(!1)}},ve=async()=>{b(!1),i(!0),o(null);try{const ie=await fetch(X?"/api/billing/unpause-subscription":"/api/billing/set-unplugged",{method:"POST",headers:{"Content-Type":"application/json"}}),Ae=await ie.json();ie.ok?(o({type:"success",text:X?"Subscription resumed! You now have access to all routines.":"Subscription paused. You can now use your most recently active routine for free."}),K(!X),setTimeout(()=>window.location.reload(),1500)):o({type:"error",text:Ae.error||`Failed to ${X?"unpause":"pause"} subscription`})}catch(oe){console.error(`Error ${X?"unpausing":"pausing"} subscription:`,oe),o({type:"error",text:`Error ${X?"unpausing":"pausing"} subscription`})}finally{i(!1)}};let le;if(e==="initial")le=n.jsxs(on,{className:"bg-red-900/10 border-red-700",children:[n.jsxs(_n,{children:[n.jsxs(ln,{className:"text-gray-100 flex items-center gap-2",children:[n.jsx(Rn,{className:"w-5 h-5 text-red-400"}),"Danger zone"]}),n.jsx(Fs,{className:"text-gray-400",children:"Permanently delete your account and all associated data"})]}),n.jsxs(cn,{className:"space-y-6",children:[n.jsxs(hs,{className:"bg-orange-900/30 border-orange-700",children:[n.jsx(Rn,{className:"h-4 w-4 text-orange-400"}),n.jsxs(fs,{className:"text-gray-300",children:[n.jsx("strong",{children:"Warning:"})," Deleting your account will permanently remove:",n.jsxs("ul",{className:"list-disc pl-5 mt-2 space-y-1",children:[n.jsx("li",{children:"All practice items and routines"}),n.jsx("li",{children:"All chord charts"}),n.jsx("li",{children:"Practice history (last 90 days)"}),n.jsx("li",{children:"Account settings and preferences"})]}),n.jsx("p",{className:"mt-2",children:n.jsx("strong",{children:"This action cannot be undone."})})]})]}),n.jsxs("div",{className:"flex items-center justify-between bg-blue-900/20 border border-blue-700 rounded-md p-4",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-semibold text-gray-200",children:"Download your data first"}),n.jsx("p",{className:"text-xs text-gray-400",children:"Your items, routines, chord charts, and practice history"})]}),n.jsxs(Be,{onClick:N,variant:"outline",size:"sm",className:"border-blue-600 text-blue-400 hover:bg-blue-900/40",children:[n.jsx(Ks,{className:"w-4 h-4 mr-2"}),"Download all your data"]})]}),n.jsxs("div",{className:"space-y-3",children:[E&&n.jsx(Be,{onClick:re,disabled:s,className:"w-full bg-green-600 hover:bg-green-700",children:s?"Canceling...":"Keep my account"}),!E&&!H&&n.jsx(Be,{onClick:()=>b(!0),disabled:s,variant:"outline",className:`w-full h-auto py-5 px-4 flex flex-col items-center gap-2 ${X?"border-green-600 text-green-400 hover:bg-green-900/40":"border-orange-600 text-orange-400 hover:bg-orange-900/40"}`,children:s?X?"Unpausing...":"Pausing...":X?n.jsx("span",{className:"font-semibold",children:"Unpause"}):n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"font-semibold",children:"Pause subscription when it expires"}),n.jsxs("span",{className:"text-xs font-normal leading-normal text-center whitespace-normal max-w-full",children:["Keep using your most recently active routine for free when your paid subscription ends. ",n.jsx("br",{})," We'll save your other routines for 90 days in case you renew."]})]})}),!H&&n.jsxs(Be,{onClick:()=>a("scheduled"),variant:"outline",className:"w-full border-orange-600 text-orange-400 hover:bg-orange-900/40",children:["Delete account after current paid subscription ends on ",w]}),n.jsxs(Be,{onClick:()=>a("immediate"),variant:"destructive",className:"w-full bg-red-900 hover:bg-red-800",children:["Delete my account now! ",!H&&"(No refund)"]})]}),c&&n.jsx(hs,{className:c.type==="success"?"bg-green-900/30 border-green-700":"bg-red-900/30 border-red-700",children:n.jsx(fs,{className:"text-gray-300",children:c.text})})]})]});else if(e==="scheduled"){const oe="If I delete it I cannot get it back",ie=_===oe;le=n.jsxs(on,{className:"bg-orange-900/10 border-orange-700",children:[n.jsxs(_n,{children:[n.jsx(ln,{className:"text-gray-100",children:"Schedule account deletion"}),n.jsx(Fs,{className:"text-gray-400",children:"Delete your account on your next renewal date"})]}),n.jsxs(cn,{className:"space-y-6",children:[n.jsx(hs,{className:"bg-blue-900/30 border-blue-700",children:n.jsxs(fs,{className:"text-gray-300",children:[n.jsx("p",{className:"font-semibold mb-2",children:"Here's what will happen:"}),n.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[n.jsx("li",{children:"Your subscription will be canceled"}),n.jsxs("li",{children:["Your account will stay active until ",n.jsx("strong",{children:w})]}),n.jsxs("li",{children:["On ",w,", all your data will be permanently deleted"]}),n.jsxs("li",{children:["You can cancel this deletion anytime before ",w]})]}),n.jsxs("p",{className:"mt-2 text-sm font-semibold text-orange-300",children:["Note: You're paying to use the service until ",w,", so no refunds."]})]})}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Wn,{htmlFor:"confirm-scheduled",className:"text-gray-200",children:"Type the following phrase to confirm:"}),n.jsx("p",{className:"text-sm font-mono bg-gray-800 border border-gray-700 rounded p-2 text-gray-300",children:oe}),n.jsx(Rr,{id:"confirm-scheduled",value:_,onChange:Ae=>y(Ae.target.value),placeholder:"Type the phrase exactly as shown",className:`bg-gray-900 border-gray-600 text-gray-100 ${_.length>0&&(ie?"border-green-500":"border-red-500")}`,disabled:s}),_.length>=oe.length&&!ie&&n.jsx("p",{className:"text-xs text-red-400",children:"Phrase does not match (case-sensitive)"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Wn,{htmlFor:"email-scheduled",className:"text-gray-200",children:"Enter your email address to confirm:"}),n.jsx(Rr,{id:"email-scheduled",type:"email",value:A,onChange:Ae=>L(Ae.target.value),placeholder:"your-email@example.com",className:"bg-gray-900 border-gray-600 text-gray-100",disabled:s}),n.jsx("p",{className:"text-xs text-gray-500",children:"Must match your account email"})]}),c&&n.jsx(hs,{className:c.type==="success"?"bg-green-900/30 border-green-700":"bg-red-900/30 border-red-700",children:n.jsx(fs,{className:"text-gray-300",children:c.text})}),n.jsxs("div",{className:"flex gap-3",children:[n.jsxs(Be,{onClick:()=>{a("initial"),y(""),L(""),o(null)},className:"flex-1 bg-green-600 hover:bg-green-700",disabled:s,children:[n.jsx(Gr,{className:"w-4 h-4 mr-2"}),"Nevermind. I'll stay for now"]}),n.jsx(Be,{onClick:I,disabled:!ie||!A||s,className:"flex-1 bg-orange-600 hover:bg-orange-700",children:s?n.jsxs(n.Fragment,{children:[n.jsx(Hr,{className:"w-4 h-4 mr-2 animate-spin"}),"Scheduling..."]}):"Confirm scheduled deletion"})]})]})]})}else if(e==="immediate"){const oe="If I delete now I cannot get my data or money back",ie=_===oe;le=n.jsxs(on,{className:"bg-red-900/10 border-red-700",children:[n.jsxs(_n,{children:[n.jsxs(ln,{className:"text-gray-100 flex items-center gap-2",children:[n.jsx(Rn,{className:"w-5 h-5 text-red-400"}),"Delete account immediately"]}),n.jsx(Fs,{className:"text-gray-400",children:"This action is immediate and permanent"})]}),n.jsxs(cn,{className:"space-y-6",children:[n.jsxs(hs,{className:"bg-red-900/40 border-red-700",children:[n.jsx(Rn,{className:"h-4 w-4 text-red-400"}),n.jsxs(fs,{className:"text-gray-300",children:[n.jsx("p",{className:"font-bold mb-2",children:"âš ï¸ FINAL WARNING âš ï¸"}),n.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[n.jsxs("li",{children:[n.jsx("strong",{children:"NO REFUND"})," - You will not receive any money back"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"IMMEDIATE"})," - Your account will be deleted right now"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"PERMANENT"})," - All data will be permanently erased"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"NO RECOVERY"})," - You cannot undo this action"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"CANNOT ACCESS GPRA AGAIN"})," - You'll need to create a new account"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"YOU WILL BE FORGOTTEN"})," - We won't keep your email address or IP address, or anything. Most of it will be deleted immediately, but some anonymous logs which can't be connected to you (without a warrant) will age out of the logs within 90 days"]})]}),n.jsx("p",{className:"mt-2 text-sm font-semibold text-orange-300",children:"In addition to no refunds, the remainder of your prepaid period will not be prorated back to you."})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Wn,{htmlFor:"confirm-immediate",className:"text-gray-200",children:"Type the following phrase to confirm:"}),n.jsx("p",{className:"text-sm font-mono bg-gray-800 border border-gray-700 rounded p-2 text-gray-300",children:oe}),n.jsx(Rr,{id:"confirm-immediate",value:_,onChange:Ae=>y(Ae.target.value),onPaste:Ae=>Ae.preventDefault(),autoComplete:"off",placeholder:"Type the phrase exactly as shown (paste disabled)",className:`bg-gray-900 border-gray-600 text-gray-100 ${_.length>0&&(ie?"border-green-500":"border-red-500")}`,disabled:s}),_.length>=oe.length&&!ie&&n.jsx("p",{className:"text-xs text-red-400",children:"Phrase does not match (case-sensitive)"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Wn,{htmlFor:"email-immediate",className:"text-gray-200",children:"Enter your email address to confirm:"}),n.jsx(Rr,{id:"email-immediate",type:"email",value:A,onChange:Ae=>L(Ae.target.value),placeholder:"your-email@example.com",className:"bg-gray-900 border-gray-600 text-gray-100",disabled:s}),n.jsx("p",{className:"text-xs text-gray-500",children:"Must match your account email. Will also be deleted when you click the red button."})]}),c&&n.jsx(hs,{className:c.type==="success"?"bg-green-900/30 border-green-700":"bg-red-900/30 border-red-700",children:n.jsx(fs,{className:"text-gray-300",children:c.text})}),n.jsxs("div",{className:"flex gap-3",children:[n.jsxs(Be,{onClick:()=>{a("initial"),y(""),L(""),o(null)},className:"flex-1 bg-green-600 hover:bg-green-700",disabled:s,children:[n.jsx(Gr,{className:"w-4 h-4 mr-2"}),"Nevermind, I'll stay for now."]}),n.jsx(Be,{onClick:S,disabled:!ie||!A||s,variant:"destructive",className:"flex-1 bg-red-900 hover:bg-red-800",children:s?n.jsxs(n.Fragment,{children:[n.jsx(Hr,{className:"w-4 h-4 mr-2 animate-spin"}),"Deleting..."]}):"Delete immediately - No refund"})]})]})]})}return n.jsxs(n.Fragment,{children:[le,n.jsx(gs,{open:p,onOpenChange:b,children:n.jsxs(Jn,{className:"bg-gray-900 border-gray-700 text-gray-100",children:[n.jsxs(Zn,{children:[n.jsx(Xn,{className:"text-xl text-gray-100",children:X?"Resume subscription?":"Pause subscription?"}),n.jsx(xs,{className:"text-gray-300 space-y-3 pt-4",children:X?n.jsx("p",{children:"Your subscription will resume and you'll be charged when your next billing period arrives. You'll regain access to all your routines."}):n.jsxs(n.Fragment,{children:[n.jsx("p",{children:"When your paid period ends, you'll only have access to your most recently active routine."}),n.jsx("p",{children:"Your other routines will be saved for 90 days in case you decide to come back."})]})})]}),n.jsxs(wc,{className:"flex gap-3 sm:gap-3",children:[n.jsx(Be,{onClick:()=>b(!1),variant:"outline",className:"flex-1 border-gray-600 text-gray-300 hover:bg-gray-800",children:"Cancel"}),n.jsx(Be,{onClick:ve,className:`flex-1 ${X?"bg-green-600 hover:bg-green-700":"bg-orange-600 hover:bg-orange-700"}`,children:X?"Resume":"Pause"})]})]})}),n.jsx(gs,{open:d,onOpenChange:h,children:n.jsxs(Jn,{className:"bg-gray-900 border-gray-700 text-gray-100",children:[n.jsxs(Zn,{children:[n.jsx(Xn,{className:"text-xl text-gray-100",children:"Account deleted"}),n.jsx(xs,{className:"text-gray-300 space-y-3 pt-4",children:H?n.jsxs(n.Fragment,{children:[n.jsx("p",{children:"Ok, done. We've deleted all your stuff."}),n.jsx("p",{children:"Your account has been deleted. Click Ok to return to login."})]}):n.jsxs(n.Fragment,{children:[n.jsx("p",{children:"Ok, done. We've deleted all your stuff, and we've cancelled your subscription on Stripe so it won't charge your card again."}),n.jsx("p",{children:`When you click "Ok", we'll send you to your Stripe portal, which will show you any saved cards and your past invoices. (Sadly, it won't show you confirmation of the cancelled subscription, it will just show you the absence of any subscriptions. ðŸ¤· Please feel free to complain to Stripe about that. I have.)`})]})})]}),n.jsx(wc,{children:n.jsx(Be,{onClick:R,className:"bg-orange-600 hover:bg-orange-700 text-white",children:"Ok"})})]})})]})},Km="modulepreload",Jm=function(t){return"/static/"+t},Yd={},Yl=function(r,e,a){let s=Promise.resolve();if(e&&e.length>0){let c=function(h){return Promise.all(h.map(p=>Promise.resolve(p).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),d=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=c(e.map(h=>{if(h=Jm(h),h in Yd)return;Yd[h]=!0;const p=h.endsWith(".css"),b=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${b}`))return;const m=document.createElement("link");if(m.rel=p?"stylesheet":Km,p||(m.as="script"),m.crossOrigin="",m.href=h,d&&m.setAttribute("nonce",d),document.head.appendChild(m),p)return new Promise((u,w)=>{m.addEventListener("load",u),m.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${h}`)))})}))}function i(c){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=c,window.dispatchEvent(o),!o.defaultPrevented)throw c}return s.then(c=>{for(const o of c||[])o.status==="rejected"&&i(o.reason);return r().catch(i)})};function kr(t){"@babel/helpers - typeof";return kr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},kr(t)}var Us=Uint8Array,ms=Uint16Array,Yc=Int32Array,Kc=new Us([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Jc=new Us([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Kd=new Us([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ff=function(t,r){for(var e=new ms(31),a=0;a<31;++a)e[a]=r+=1<<t[a-1];for(var s=new Yc(e[30]),a=1;a<30;++a)for(var i=e[a];i<e[a+1];++i)s[i]=i-e[a]<<5|a;return{b:e,r:s}},pf=ff(Kc,2),Zm=pf.b,Nc=pf.r;Zm[28]=258,Nc[258]=28;var Xm=ff(Jc,0),Jd=Xm.r,_c=new ms(32768);for(var Br=0;Br<32768;++Br){var Ma=(Br&43690)>>1|(Br&21845)<<1;Ma=(Ma&52428)>>2|(Ma&13107)<<2,Ma=(Ma&61680)>>4|(Ma&3855)<<4,_c[Br]=((Ma&65280)>>8|(Ma&255)<<8)>>1}var uo=(function(t,r,e){for(var a=t.length,s=0,i=new ms(r);s<a;++s)t[s]&&++i[t[s]-1];var c=new ms(r);for(s=1;s<r;++s)c[s]=c[s-1]+i[s-1]<<1;var o;if(e){o=new ms(1<<r);var d=15-r;for(s=0;s<a;++s)if(t[s])for(var h=s<<4|t[s],p=r-t[s],b=c[t[s]-1]++<<p,m=b|(1<<p)-1;b<=m;++b)o[_c[b]>>d]=h}else for(o=new ms(a),s=0;s<a;++s)t[s]&&(o[s]=_c[c[t[s]-1]++]>>15-t[s]);return o}),ii=new Us(288);for(var Br=0;Br<144;++Br)ii[Br]=8;for(var Br=144;Br<256;++Br)ii[Br]=9;for(var Br=256;Br<280;++Br)ii[Br]=7;for(var Br=280;Br<288;++Br)ii[Br]=8;var gl=new Us(32);for(var Br=0;Br<32;++Br)gl[Br]=5;var Qm=uo(ii,9,0),eg=uo(gl,5,0),mf=function(t){return(t+7)/8|0},tg=function(t,r,e){return(e==null||e>t.length)&&(e=t.length),new Us(t.subarray(r,e))},fa=function(t,r,e){e<<=r&7;var a=r/8|0;t[a]|=e,t[a+1]|=e>>8},oo=function(t,r,e){e<<=r&7;var a=r/8|0;t[a]|=e,t[a+1]|=e>>8,t[a+2]|=e>>16},Kl=function(t,r){for(var e=[],a=0;a<t.length;++a)t[a]&&e.push({s:a,f:t[a]});var s=e.length,i=e.slice();if(!s)return{t:xf,l:0};if(s==1){var c=new Us(e[0].s+1);return c[e[0].s]=1,{t:c,l:1}}e.sort(function(O,X){return O.f-X.f}),e.push({s:-1,f:25001});var o=e[0],d=e[1],h=0,p=1,b=2;for(e[0]={s:-1,f:o.f+d.f,l:o,r:d};p!=s-1;)o=e[e[h].f<e[b].f?h++:b++],d=e[h!=p&&e[h].f<e[b].f?h++:b++],e[p++]={s:-1,f:o.f+d.f,l:o,r:d};for(var m=i[0].s,a=1;a<s;++a)i[a].s>m&&(m=i[a].s);var u=new ms(m+1),w=jc(e[p-1],u,0);if(w>r){var a=0,x=0,_=w-r,y=1<<_;for(i.sort(function(X,K){return u[K.s]-u[X.s]||X.f-K.f});a<s;++a){var A=i[a].s;if(u[A]>r)x+=y-(1<<w-u[A]),u[A]=r;else break}for(x>>=_;x>0;){var L=i[a].s;u[L]<r?x-=1<<r-u[L]++-1:++a}for(;a>=0&&x;--a){var E=i[a].s;u[E]==r&&(--u[E],++x)}w=r}return{t:new Us(u),l:w}},jc=function(t,r,e){return t.s==-1?Math.max(jc(t.l,r,e+1),jc(t.r,r,e+1)):r[t.s]=e},Zd=function(t){for(var r=t.length;r&&!t[--r];);for(var e=new ms(++r),a=0,s=t[0],i=1,c=function(d){e[a++]=d},o=1;o<=r;++o)if(t[o]==s&&o!=r)++i;else{if(!s&&i>2){for(;i>138;i-=138)c(32754);i>2&&(c(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(c(s),--i;i>6;i-=6)c(8304);i>2&&(c(i-3<<5|8208),i=0)}for(;i--;)c(s);i=1,s=t[o]}return{c:e.subarray(0,a),n:r}},lo=function(t,r){for(var e=0,a=0;a<r.length;++a)e+=t[a]*r[a];return e},gf=function(t,r,e){var a=e.length,s=mf(r+2);t[s]=a&255,t[s+1]=a>>8,t[s+2]=t[s]^255,t[s+3]=t[s+1]^255;for(var i=0;i<a;++i)t[s+i+4]=e[i];return(s+4+a)*8},Xd=function(t,r,e,a,s,i,c,o,d,h,p){fa(r,p++,e),++s[256];for(var b=Kl(s,15),m=b.t,u=b.l,w=Kl(i,15),x=w.t,_=w.l,y=Zd(m),A=y.c,L=y.n,E=Zd(x),O=E.c,X=E.n,K=new ms(19),H=0;H<A.length;++H)++K[A[H]&31];for(var H=0;H<O.length;++H)++K[O[H]&31];for(var P=Kl(K,7),Y=P.t,I=P.l,S=19;S>4&&!Y[Kd[S-1]];--S);var R=h+5<<3,N=lo(s,ii)+lo(i,gl)+c,re=lo(s,m)+lo(i,x)+c+14+3*S+lo(K,Y)+2*K[16]+3*K[17]+7*K[18];if(d>=0&&R<=N&&R<=re)return gf(r,p,t.subarray(d,d+h));var ve,le,oe,ie;if(fa(r,p,1+(re<N)),p+=2,re<N){ve=uo(m,u,0),le=m,oe=uo(x,_,0),ie=x;var Ae=uo(Y,I,0);fa(r,p,L-257),fa(r,p+5,X-1),fa(r,p+10,S-4),p+=14;for(var H=0;H<S;++H)fa(r,p+3*H,Y[Kd[H]]);p+=3*S;for(var te=[A,O],C=0;C<2;++C)for(var G=te[C],H=0;H<G.length;++H){var Z=G[H]&31;fa(r,p,Ae[Z]),p+=Y[Z],Z>15&&(fa(r,p,G[H]>>5&127),p+=G[H]>>12)}}else ve=Qm,le=ii,oe=eg,ie=gl;for(var H=0;H<o;++H){var Q=a[H];if(Q>255){var Z=Q>>18&31;oo(r,p,ve[Z+257]),p+=le[Z+257],Z>7&&(fa(r,p,Q>>23&31),p+=Kc[Z]);var fe=Q&31;oo(r,p,oe[fe]),p+=ie[fe],fe>3&&(oo(r,p,Q>>5&8191),p+=Jc[fe])}else oo(r,p,ve[Q]),p+=le[Q]}return oo(r,p,ve[256]),p+le[256]},rg=new Yc([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),xf=new Us(0),ng=function(t,r,e,a,s,i){var c=i.z||t.length,o=new Us(a+c+5*(1+Math.ceil(c/7e3))+s),d=o.subarray(a,o.length-s),h=i.l,p=(i.r||0)&7;if(r){p&&(d[0]=i.r>>3);for(var b=rg[r-1],m=b>>13,u=b&8191,w=(1<<e)-1,x=i.p||new ms(32768),_=i.h||new ms(w+1),y=Math.ceil(e/3),A=2*y,L=function(j){return(t[j]^t[j+1]<<y^t[j+2]<<A)&w},E=new Yc(25e3),O=new ms(288),X=new ms(32),K=0,H=0,P=i.i||0,Y=0,I=i.w||0,S=0;P+2<c;++P){var R=L(P),N=P&32767,re=_[R];if(x[N]=re,_[R]=N,I<=P){var ve=c-P;if((K>7e3||Y>24576)&&(ve>423||!h)){p=Xd(t,d,0,E,O,X,H,Y,S,P-S,p),Y=K=H=0,S=P;for(var le=0;le<286;++le)O[le]=0;for(var le=0;le<30;++le)X[le]=0}var oe=2,ie=0,Ae=u,te=N-re&32767;if(ve>2&&R==L(P-te))for(var C=Math.min(m,ve)-1,G=Math.min(32767,P),Z=Math.min(258,ve);te<=G&&--Ae&&N!=re;){if(t[P+oe]==t[P+oe-te]){for(var Q=0;Q<Z&&t[P+Q]==t[P+Q-te];++Q);if(Q>oe){if(oe=Q,ie=te,Q>C)break;for(var fe=Math.min(te,Q-2),we=0,le=0;le<fe;++le){var Se=P-te+le&32767,Ce=x[Se],Re=Se-Ce&32767;Re>we&&(we=Re,re=Se)}}}N=re,re=x[N],te+=N-re&32767}if(ie){E[Y++]=268435456|Nc[oe]<<18|Jd[ie];var Me=Nc[oe]&31,Je=Jd[ie]&31;H+=Kc[Me]+Jc[Je],++O[257+Me],++X[Je],I=P+oe,++K}else E[Y++]=t[P],++O[t[P]]}}for(P=Math.max(P,I);P<c;++P)E[Y++]=t[P],++O[t[P]];p=Xd(t,d,h,E,O,X,H,Y,S,P-S,p),h||(i.r=p&7|d[p/8|0]<<3,p-=7,i.h=_,i.p=x,i.i=P,i.w=I)}else{for(var P=i.w||0;P<c+h;P+=65535){var je=P+65535;je>=c&&(d[p/8|0]=h,je=c),p=gf(d,p+1,t.subarray(P,je))}i.i=c}return tg(o,0,a+mf(p)+s)},yf=function(){var t=1,r=0;return{p:function(e){for(var a=t,s=r,i=e.length|0,c=0;c!=i;){for(var o=Math.min(c+2655,i);c<o;++c)s+=a+=e[c];a=(a&65535)+15*(a>>16),s=(s&65535)+15*(s>>16)}t=a,r=s},d:function(){return t%=65521,r%=65521,(t&255)<<24|(t&65280)<<8|(r&255)<<8|r>>8}}},sg=function(t,r,e,a,s){if(!s&&(s={l:1},r.dictionary)){var i=r.dictionary.subarray(-32768),c=new Us(i.length+t.length);c.set(i),c.set(t,i.length),t=c,s.w=i.length}return ng(t,r.level==null?6:r.level,r.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+r.mem,e,a,s)},bf=function(t,r,e){for(;e;++r)t[r]=e,e>>>=8},ag=function(t,r){var e=r.level,a=e==0?0:e<6?1:e==9?3:2;if(t[0]=120,t[1]=a<<6|(r.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,r.dictionary){var s=yf();s.p(r.dictionary),bf(t,2,s.d())}};function Sc(t,r){r||(r={});var e=yf();e.p(t);var a=sg(t,r,r.dictionary?6:2,4);return ag(a,r),bf(a,a.length-4,e.d()),a}var ig=typeof TextDecoder<"u"&&new TextDecoder,og=0;try{ig.decode(xf,{stream:!0}),og=1}catch{}function lg(t){if(Array.isArray(t))return t}function cg(t,r){var e=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var a,s,i,c,o=[],d=!0,h=!1;try{if(i=(e=e.call(t)).next,r!==0)for(;!(d=(a=i.call(e)).done)&&(o.push(a.value),o.length!==r);d=!0);}catch(p){h=!0,s=p}finally{try{if(!d&&e.return!=null&&(c=e.return(),Object(c)!==c))return}finally{if(h)throw s}}return o}}function Qd(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,a=Array(r);e<r;e++)a[e]=t[e];return a}function dg(t,r){if(t){if(typeof t=="string")return Qd(t,r);var e={}.toString.call(t).slice(8,-1);return e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set"?Array.from(t):e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Qd(t,r):void 0}}function ug(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eu(t,r){return lg(t)||cg(t,r)||dg(t,r)||ug()}function tu(t,r="utf8"){return new TextDecoder(r).decode(t)}const hg=new TextEncoder;function fg(t){return hg.encode(t)}const pg=1024*8,mg=(()=>{const t=new Uint8Array(4),r=new Uint32Array(t.buffer);return!((r[0]=1)&t[0])})(),Jl={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class Zc{constructor(r=pg,e={}){Sr(this,"buffer");Sr(this,"byteLength");Sr(this,"byteOffset");Sr(this,"length");Sr(this,"offset");Sr(this,"lastWrittenByte");Sr(this,"littleEndian");Sr(this,"_data");Sr(this,"_mark");Sr(this,"_marks");let a=!1;typeof r=="number"?r=new ArrayBuffer(r):(a=!0,this.lastWrittenByte=r.byteLength);const s=e.offset?e.offset>>>0:0,i=r.byteLength-s;let c=s;(ArrayBuffer.isView(r)||r instanceof Zc)&&(r.byteLength!==r.buffer.byteLength&&(c=r.byteOffset+s),r=r.buffer),a?this.lastWrittenByte=i:this.lastWrittenByte=0,this.buffer=r,this.length=i,this.byteLength=i,this.byteOffset=c,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,c,i),this._mark=0,this._marks=[]}available(r=1){return this.offset+r<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(r=1){return this.offset+=r,this}back(r=1){return this.offset-=r,this}seek(r){return this.offset=r,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const r=this._marks.pop();if(r===void 0)throw new Error("Mark stack empty");return this.seek(r),this}rewind(){return this.offset=0,this}ensureAvailable(r=1){if(!this.available(r)){const a=(this.offset+r)*2,s=new Uint8Array(a);s.set(new Uint8Array(this.buffer)),this.buffer=s.buffer,this.length=a,this.byteLength=a,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(r=1){return this.readArray(r,"uint8")}readArray(r,e){const a=Jl[e].BYTES_PER_ELEMENT*r,s=this.byteOffset+this.offset,i=this.buffer.slice(s,s+a);if(this.littleEndian===mg&&e!=="uint8"&&e!=="int8"){const o=new Uint8Array(this.buffer.slice(s,s+a));o.reverse();const d=new Jl[e](o.buffer);return this.offset+=a,d.reverse(),d}const c=new Jl[e](i);return this.offset+=a,c}readInt16(){const r=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,r}readUint16(){const r=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,r}readInt32(){const r=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,r}readUint32(){const r=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,r}readFloat32(){const r=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,r}readFloat64(){const r=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,r}readBigInt64(){const r=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,r}readBigUint64(){const r=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,r}readChar(){return String.fromCharCode(this.readInt8())}readChars(r=1){let e="";for(let a=0;a<r;a++)e+=this.readChar();return e}readUtf8(r=1){return tu(this.readBytes(r))}decodeText(r=1,e="utf8"){return tu(this.readBytes(r),e)}writeBoolean(r){return this.writeUint8(r?255:0),this}writeInt8(r){return this.ensureAvailable(1),this._data.setInt8(this.offset++,r),this._updateLastWrittenByte(),this}writeUint8(r){return this.ensureAvailable(1),this._data.setUint8(this.offset++,r),this._updateLastWrittenByte(),this}writeByte(r){return this.writeUint8(r)}writeBytes(r){this.ensureAvailable(r.length);for(let e=0;e<r.length;e++)this._data.setUint8(this.offset++,r[e]);return this._updateLastWrittenByte(),this}writeInt16(r){return this.ensureAvailable(2),this._data.setInt16(this.offset,r,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(r){return this.ensureAvailable(2),this._data.setUint16(this.offset,r,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(r){return this.ensureAvailable(4),this._data.setInt32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(r){return this.ensureAvailable(4),this._data.setUint32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(r){return this.ensureAvailable(4),this._data.setFloat32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(r){return this.ensureAvailable(8),this._data.setFloat64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(r){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(r){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(r){return this.writeUint8(r.charCodeAt(0))}writeChars(r){for(let e=0;e<r.length;e++)this.writeUint8(r.charCodeAt(e));return this}writeUtf8(r){return this.writeBytes(fg(r))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function qi(t){let r=t.length;for(;--r>=0;)t[r]=0}const gg=3,xg=258,wf=29,yg=256,bg=yg+1+wf,vf=30,wg=512,vg=new Array((bg+2)*2);qi(vg);const Ng=new Array(vf*2);qi(Ng);const _g=new Array(wg);qi(_g);const jg=new Array(xg-gg+1);qi(jg);const Sg=new Array(wf);qi(Sg);const kg=new Array(vf);qi(kg);const Ag=(t,r,e,a)=>{let s=t&65535|0,i=t>>>16&65535|0,c=0;for(;e!==0;){c=e>2e3?2e3:e,e-=c;do s=s+r[a++]|0,i=i+s|0;while(--c);s%=65521,i%=65521}return s|i<<16|0};var kc=Ag;const Cg=()=>{let t,r=[];for(var e=0;e<256;e++){t=e;for(var a=0;a<8;a++)t=t&1?3988292384^t>>>1:t>>>1;r[e]=t}return r},Lg=new Uint32Array(Cg()),Eg=(t,r,e,a)=>{const s=Lg,i=a+e;t^=-1;for(let c=a;c<i;c++)t=t>>>8^s[(t^r[c])&255];return t^-1};var Ys=Eg,Ac={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Nf={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const Pg=(t,r)=>Object.prototype.hasOwnProperty.call(t,r);var Tg=function(t){const r=Array.prototype.slice.call(arguments,1);for(;r.length;){const e=r.shift();if(e){if(typeof e!="object")throw new TypeError(e+"must be non-object");for(const a in e)Pg(e,a)&&(t[a]=e[a])}}return t},Ig=t=>{let r=0;for(let a=0,s=t.length;a<s;a++)r+=t[a].length;const e=new Uint8Array(r);for(let a=0,s=0,i=t.length;a<i;a++){let c=t[a];e.set(c,s),s+=c.length}return e},_f={assign:Tg,flattenChunks:Ig};let jf=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{jf=!1}const mo=new Uint8Array(256);for(let t=0;t<256;t++)mo[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;mo[254]=mo[254]=1;var Fg=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let r,e,a,s,i,c=t.length,o=0;for(s=0;s<c;s++)e=t.charCodeAt(s),(e&64512)===55296&&s+1<c&&(a=t.charCodeAt(s+1),(a&64512)===56320&&(e=65536+(e-55296<<10)+(a-56320),s++)),o+=e<128?1:e<2048?2:e<65536?3:4;for(r=new Uint8Array(o),i=0,s=0;i<o;s++)e=t.charCodeAt(s),(e&64512)===55296&&s+1<c&&(a=t.charCodeAt(s+1),(a&64512)===56320&&(e=65536+(e-55296<<10)+(a-56320),s++)),e<128?r[i++]=e:e<2048?(r[i++]=192|e>>>6,r[i++]=128|e&63):e<65536?(r[i++]=224|e>>>12,r[i++]=128|e>>>6&63,r[i++]=128|e&63):(r[i++]=240|e>>>18,r[i++]=128|e>>>12&63,r[i++]=128|e>>>6&63,r[i++]=128|e&63);return r};const Og=(t,r)=>{if(r<65534&&t.subarray&&jf)return String.fromCharCode.apply(null,t.length===r?t:t.subarray(0,r));let e="";for(let a=0;a<r;a++)e+=String.fromCharCode(t[a]);return e};var Dg=(t,r)=>{const e=r||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,r));let a,s;const i=new Array(e*2);for(s=0,a=0;a<e;){let c=t[a++];if(c<128){i[s++]=c;continue}let o=mo[c];if(o>4){i[s++]=65533,a+=o-1;continue}for(c&=o===2?31:o===3?15:7;o>1&&a<e;)c=c<<6|t[a++]&63,o--;if(o>1){i[s++]=65533;continue}c<65536?i[s++]=c:(c-=65536,i[s++]=55296|c>>10&1023,i[s++]=56320|c&1023)}return Og(i,s)},Rg=(t,r)=>{r=r||t.length,r>t.length&&(r=t.length);let e=r-1;for(;e>=0&&(t[e]&192)===128;)e--;return e<0||e===0?r:e+mo[t[e]]>r?e:r},Cc={string2buf:Fg,buf2string:Dg,utf8border:Rg};function Bg(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Mg=Bg;const Ho=16209,Ug=16191;var zg=function(r,e){let a,s,i,c,o,d,h,p,b,m,u,w,x,_,y,A,L,E,O,X,K,H,P,Y;const I=r.state;a=r.next_in,P=r.input,s=a+(r.avail_in-5),i=r.next_out,Y=r.output,c=i-(e-r.avail_out),o=i+(r.avail_out-257),d=I.dmax,h=I.wsize,p=I.whave,b=I.wnext,m=I.window,u=I.hold,w=I.bits,x=I.lencode,_=I.distcode,y=(1<<I.lenbits)-1,A=(1<<I.distbits)-1;e:do{w<15&&(u+=P[a++]<<w,w+=8,u+=P[a++]<<w,w+=8),L=x[u&y];t:for(;;){if(E=L>>>24,u>>>=E,w-=E,E=L>>>16&255,E===0)Y[i++]=L&65535;else if(E&16){O=L&65535,E&=15,E&&(w<E&&(u+=P[a++]<<w,w+=8),O+=u&(1<<E)-1,u>>>=E,w-=E),w<15&&(u+=P[a++]<<w,w+=8,u+=P[a++]<<w,w+=8),L=_[u&A];r:for(;;){if(E=L>>>24,u>>>=E,w-=E,E=L>>>16&255,E&16){if(X=L&65535,E&=15,w<E&&(u+=P[a++]<<w,w+=8,w<E&&(u+=P[a++]<<w,w+=8)),X+=u&(1<<E)-1,X>d){r.msg="invalid distance too far back",I.mode=Ho;break e}if(u>>>=E,w-=E,E=i-c,X>E){if(E=X-E,E>p&&I.sane){r.msg="invalid distance too far back",I.mode=Ho;break e}if(K=0,H=m,b===0){if(K+=h-E,E<O){O-=E;do Y[i++]=m[K++];while(--E);K=i-X,H=Y}}else if(b<E){if(K+=h+b-E,E-=b,E<O){O-=E;do Y[i++]=m[K++];while(--E);if(K=0,b<O){E=b,O-=E;do Y[i++]=m[K++];while(--E);K=i-X,H=Y}}}else if(K+=b-E,E<O){O-=E;do Y[i++]=m[K++];while(--E);K=i-X,H=Y}for(;O>2;)Y[i++]=H[K++],Y[i++]=H[K++],Y[i++]=H[K++],O-=3;O&&(Y[i++]=H[K++],O>1&&(Y[i++]=H[K++]))}else{K=i-X;do Y[i++]=Y[K++],Y[i++]=Y[K++],Y[i++]=Y[K++],O-=3;while(O>2);O&&(Y[i++]=Y[K++],O>1&&(Y[i++]=Y[K++]))}}else if((E&64)===0){L=_[(L&65535)+(u&(1<<E)-1)];continue r}else{r.msg="invalid distance code",I.mode=Ho;break e}break}}else if((E&64)===0){L=x[(L&65535)+(u&(1<<E)-1)];continue t}else if(E&32){I.mode=Ug;break e}else{r.msg="invalid literal/length code",I.mode=Ho;break e}break}}while(a<s&&i<o);O=w>>3,a-=O,w-=O<<3,u&=(1<<w)-1,r.next_in=a,r.next_out=i,r.avail_in=a<s?5+(s-a):5-(a-s),r.avail_out=i<o?257+(o-i):257-(i-o),I.hold=u,I.bits=w};const ji=15,ru=852,nu=592,su=0,Zl=1,au=2,qg=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),$g=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Wg=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Hg=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Gg=(t,r,e,a,s,i,c,o)=>{const d=o.bits;let h=0,p=0,b=0,m=0,u=0,w=0,x=0,_=0,y=0,A=0,L,E,O,X,K,H=null,P;const Y=new Uint16Array(ji+1),I=new Uint16Array(ji+1);let S=null,R,N,re;for(h=0;h<=ji;h++)Y[h]=0;for(p=0;p<a;p++)Y[r[e+p]]++;for(u=d,m=ji;m>=1&&Y[m]===0;m--);if(u>m&&(u=m),m===0)return s[i++]=1<<24|64<<16|0,s[i++]=1<<24|64<<16|0,o.bits=1,0;for(b=1;b<m&&Y[b]===0;b++);for(u<b&&(u=b),_=1,h=1;h<=ji;h++)if(_<<=1,_-=Y[h],_<0)return-1;if(_>0&&(t===su||m!==1))return-1;for(I[1]=0,h=1;h<ji;h++)I[h+1]=I[h]+Y[h];for(p=0;p<a;p++)r[e+p]!==0&&(c[I[r[e+p]]++]=p);if(t===su?(H=S=c,P=20):t===Zl?(H=qg,S=$g,P=257):(H=Wg,S=Hg,P=0),A=0,p=0,h=b,K=i,w=u,x=0,O=-1,y=1<<u,X=y-1,t===Zl&&y>ru||t===au&&y>nu)return 1;for(;;){R=h-x,c[p]+1<P?(N=0,re=c[p]):c[p]>=P?(N=S[c[p]-P],re=H[c[p]-P]):(N=96,re=0),L=1<<h-x,E=1<<w,b=E;do E-=L,s[K+(A>>x)+E]=R<<24|N<<16|re|0;while(E!==0);for(L=1<<h-1;A&L;)L>>=1;if(L!==0?(A&=L-1,A+=L):A=0,p++,--Y[h]===0){if(h===m)break;h=r[e+c[p]]}if(h>u&&(A&X)!==O){for(x===0&&(x=u),K+=b,w=h-x,_=1<<w;w+x<m&&(_-=Y[w+x],!(_<=0));)w++,_<<=1;if(y+=1<<w,t===Zl&&y>ru||t===au&&y>nu)return 1;O=A&X,s[O]=u<<24|w<<16|K-i|0}}return A!==0&&(s[K+A]=h-x<<24|64<<16|0),o.bits=u,0};var ho=Gg;const Vg=0,Sf=1,kf=2,{Z_FINISH:iu,Z_BLOCK:Yg,Z_TREES:Go,Z_OK:oi,Z_STREAM_END:Kg,Z_NEED_DICT:Jg,Z_STREAM_ERROR:Ss,Z_DATA_ERROR:Af,Z_MEM_ERROR:Cf,Z_BUF_ERROR:Zg,Z_DEFLATED:ou}=Nf,Sl=16180,lu=16181,cu=16182,du=16183,uu=16184,hu=16185,fu=16186,pu=16187,mu=16188,gu=16189,xl=16190,pa=16191,Xl=16192,xu=16193,Ql=16194,yu=16195,bu=16196,wu=16197,vu=16198,Vo=16199,Yo=16200,Nu=16201,_u=16202,ju=16203,Su=16204,ku=16205,ec=16206,Au=16207,Cu=16208,Ur=16209,Lf=16210,Ef=16211,Xg=852,Qg=592,e1=15,t1=e1,Lu=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function r1(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const li=t=>{if(!t)return 1;const r=t.state;return!r||r.strm!==t||r.mode<Sl||r.mode>Ef?1:0},Pf=t=>{if(li(t))return Ss;const r=t.state;return t.total_in=t.total_out=r.total=0,t.msg="",r.wrap&&(t.adler=r.wrap&1),r.mode=Sl,r.last=0,r.havedict=0,r.flags=-1,r.dmax=32768,r.head=null,r.hold=0,r.bits=0,r.lencode=r.lendyn=new Int32Array(Xg),r.distcode=r.distdyn=new Int32Array(Qg),r.sane=1,r.back=-1,oi},Tf=t=>{if(li(t))return Ss;const r=t.state;return r.wsize=0,r.whave=0,r.wnext=0,Pf(t)},If=(t,r)=>{let e;if(li(t))return Ss;const a=t.state;return r<0?(e=0,r=-r):(e=(r>>4)+5,r<48&&(r&=15)),r&&(r<8||r>15)?Ss:(a.window!==null&&a.wbits!==r&&(a.window=null),a.wrap=e,a.wbits=r,Tf(t))},Ff=(t,r)=>{if(!t)return Ss;const e=new r1;t.state=e,e.strm=t,e.window=null,e.mode=Sl;const a=If(t,r);return a!==oi&&(t.state=null),a},n1=t=>Ff(t,t1);let Eu=!0,tc,rc;const s1=t=>{if(Eu){tc=new Int32Array(512),rc=new Int32Array(32);let r=0;for(;r<144;)t.lens[r++]=8;for(;r<256;)t.lens[r++]=9;for(;r<280;)t.lens[r++]=7;for(;r<288;)t.lens[r++]=8;for(ho(Sf,t.lens,0,288,tc,0,t.work,{bits:9}),r=0;r<32;)t.lens[r++]=5;ho(kf,t.lens,0,32,rc,0,t.work,{bits:5}),Eu=!1}t.lencode=tc,t.lenbits=9,t.distcode=rc,t.distbits=5},Of=(t,r,e,a)=>{let s;const i=t.state;return i.window===null&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),a>=i.wsize?(i.window.set(r.subarray(e-i.wsize,e),0),i.wnext=0,i.whave=i.wsize):(s=i.wsize-i.wnext,s>a&&(s=a),i.window.set(r.subarray(e-a,e-a+s),i.wnext),a-=s,a?(i.window.set(r.subarray(e-a,e),0),i.wnext=a,i.whave=i.wsize):(i.wnext+=s,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=s))),0},a1=(t,r)=>{let e,a,s,i,c,o,d,h,p,b,m,u,w,x,_=0,y,A,L,E,O,X,K,H;const P=new Uint8Array(4);let Y,I;const S=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(li(t)||!t.output||!t.input&&t.avail_in!==0)return Ss;e=t.state,e.mode===pa&&(e.mode=Xl),c=t.next_out,s=t.output,d=t.avail_out,i=t.next_in,a=t.input,o=t.avail_in,h=e.hold,p=e.bits,b=o,m=d,H=oi;e:for(;;)switch(e.mode){case Sl:if(e.wrap===0){e.mode=Xl;break}for(;p<16;){if(o===0)break e;o--,h+=a[i++]<<p,p+=8}if(e.wrap&2&&h===35615){e.wbits===0&&(e.wbits=15),e.check=0,P[0]=h&255,P[1]=h>>>8&255,e.check=Ys(e.check,P,2,0),h=0,p=0,e.mode=lu;break}if(e.head&&(e.head.done=!1),!(e.wrap&1)||(((h&255)<<8)+(h>>8))%31){t.msg="incorrect header check",e.mode=Ur;break}if((h&15)!==ou){t.msg="unknown compression method",e.mode=Ur;break}if(h>>>=4,p-=4,K=(h&15)+8,e.wbits===0&&(e.wbits=K),K>15||K>e.wbits){t.msg="invalid window size",e.mode=Ur;break}e.dmax=1<<e.wbits,e.flags=0,t.adler=e.check=1,e.mode=h&512?gu:pa,h=0,p=0;break;case lu:for(;p<16;){if(o===0)break e;o--,h+=a[i++]<<p,p+=8}if(e.flags=h,(e.flags&255)!==ou){t.msg="unknown compression method",e.mode=Ur;break}if(e.flags&57344){t.msg="unknown header flags set",e.mode=Ur;break}e.head&&(e.head.text=h>>8&1),e.flags&512&&e.wrap&4&&(P[0]=h&255,P[1]=h>>>8&255,e.check=Ys(e.check,P,2,0)),h=0,p=0,e.mode=cu;case cu:for(;p<32;){if(o===0)break e;o--,h+=a[i++]<<p,p+=8}e.head&&(e.head.time=h),e.flags&512&&e.wrap&4&&(P[0]=h&255,P[1]=h>>>8&255,P[2]=h>>>16&255,P[3]=h>>>24&255,e.check=Ys(e.check,P,4,0)),h=0,p=0,e.mode=du;case du:for(;p<16;){if(o===0)break e;o--,h+=a[i++]<<p,p+=8}e.head&&(e.head.xflags=h&255,e.head.os=h>>8),e.flags&512&&e.wrap&4&&(P[0]=h&255,P[1]=h>>>8&255,e.check=Ys(e.check,P,2,0)),h=0,p=0,e.mode=uu;case uu:if(e.flags&1024){for(;p<16;){if(o===0)break e;o--,h+=a[i++]<<p,p+=8}e.length=h,e.head&&(e.head.extra_len=h),e.flags&512&&e.wrap&4&&(P[0]=h&255,P[1]=h>>>8&255,e.check=Ys(e.check,P,2,0)),h=0,p=0}else e.head&&(e.head.extra=null);e.mode=hu;case hu:if(e.flags&1024&&(u=e.length,u>o&&(u=o),u&&(e.head&&(K=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(a.subarray(i,i+u),K)),e.flags&512&&e.wrap&4&&(e.check=Ys(e.check,a,u,i)),o-=u,i+=u,e.length-=u),e.length))break e;e.length=0,e.mode=fu;case fu:if(e.flags&2048){if(o===0)break e;u=0;do K=a[i+u++],e.head&&K&&e.length<65536&&(e.head.name+=String.fromCharCode(K));while(K&&u<o);if(e.flags&512&&e.wrap&4&&(e.check=Ys(e.check,a,u,i)),o-=u,i+=u,K)break e}else e.head&&(e.head.name=null);e.length=0,e.mode=pu;case pu:if(e.flags&4096){if(o===0)break e;u=0;do K=a[i+u++],e.head&&K&&e.length<65536&&(e.head.comment+=String.fromCharCode(K));while(K&&u<o);if(e.flags&512&&e.wrap&4&&(e.check=Ys(e.check,a,u,i)),o-=u,i+=u,K)break e}else e.head&&(e.head.comment=null);e.mode=mu;case mu:if(e.flags&512){for(;p<16;){if(o===0)break e;o--,h+=a[i++]<<p,p+=8}if(e.wrap&4&&h!==(e.check&65535)){t.msg="header crc mismatch",e.mode=Ur;break}h=0,p=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),t.adler=e.check=0,e.mode=pa;break;case gu:for(;p<32;){if(o===0)break e;o--,h+=a[i++]<<p,p+=8}t.adler=e.check=Lu(h),h=0,p=0,e.mode=xl;case xl:if(e.havedict===0)return t.next_out=c,t.avail_out=d,t.next_in=i,t.avail_in=o,e.hold=h,e.bits=p,Jg;t.adler=e.check=1,e.mode=pa;case pa:if(r===Yg||r===Go)break e;case Xl:if(e.last){h>>>=p&7,p-=p&7,e.mode=ec;break}for(;p<3;){if(o===0)break e;o--,h+=a[i++]<<p,p+=8}switch(e.last=h&1,h>>>=1,p-=1,h&3){case 0:e.mode=xu;break;case 1:if(s1(e),e.mode=Vo,r===Go){h>>>=2,p-=2;break e}break;case 2:e.mode=bu;break;case 3:t.msg="invalid block type",e.mode=Ur}h>>>=2,p-=2;break;case xu:for(h>>>=p&7,p-=p&7;p<32;){if(o===0)break e;o--,h+=a[i++]<<p,p+=8}if((h&65535)!==(h>>>16^65535)){t.msg="invalid stored block lengths",e.mode=Ur;break}if(e.length=h&65535,h=0,p=0,e.mode=Ql,r===Go)break e;case Ql:e.mode=yu;case yu:if(u=e.length,u){if(u>o&&(u=o),u>d&&(u=d),u===0)break e;s.set(a.subarray(i,i+u),c),o-=u,i+=u,d-=u,c+=u,e.length-=u;break}e.mode=pa;break;case bu:for(;p<14;){if(o===0)break e;o--,h+=a[i++]<<p,p+=8}if(e.nlen=(h&31)+257,h>>>=5,p-=5,e.ndist=(h&31)+1,h>>>=5,p-=5,e.ncode=(h&15)+4,h>>>=4,p-=4,e.nlen>286||e.ndist>30){t.msg="too many length or distance symbols",e.mode=Ur;break}e.have=0,e.mode=wu;case wu:for(;e.have<e.ncode;){for(;p<3;){if(o===0)break e;o--,h+=a[i++]<<p,p+=8}e.lens[S[e.have++]]=h&7,h>>>=3,p-=3}for(;e.have<19;)e.lens[S[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,Y={bits:e.lenbits},H=ho(Vg,e.lens,0,19,e.lencode,0,e.work,Y),e.lenbits=Y.bits,H){t.msg="invalid code lengths set",e.mode=Ur;break}e.have=0,e.mode=vu;case vu:for(;e.have<e.nlen+e.ndist;){for(;_=e.lencode[h&(1<<e.lenbits)-1],y=_>>>24,A=_>>>16&255,L=_&65535,!(y<=p);){if(o===0)break e;o--,h+=a[i++]<<p,p+=8}if(L<16)h>>>=y,p-=y,e.lens[e.have++]=L;else{if(L===16){for(I=y+2;p<I;){if(o===0)break e;o--,h+=a[i++]<<p,p+=8}if(h>>>=y,p-=y,e.have===0){t.msg="invalid bit length repeat",e.mode=Ur;break}K=e.lens[e.have-1],u=3+(h&3),h>>>=2,p-=2}else if(L===17){for(I=y+3;p<I;){if(o===0)break e;o--,h+=a[i++]<<p,p+=8}h>>>=y,p-=y,K=0,u=3+(h&7),h>>>=3,p-=3}else{for(I=y+7;p<I;){if(o===0)break e;o--,h+=a[i++]<<p,p+=8}h>>>=y,p-=y,K=0,u=11+(h&127),h>>>=7,p-=7}if(e.have+u>e.nlen+e.ndist){t.msg="invalid bit length repeat",e.mode=Ur;break}for(;u--;)e.lens[e.have++]=K}}if(e.mode===Ur)break;if(e.lens[256]===0){t.msg="invalid code -- missing end-of-block",e.mode=Ur;break}if(e.lenbits=9,Y={bits:e.lenbits},H=ho(Sf,e.lens,0,e.nlen,e.lencode,0,e.work,Y),e.lenbits=Y.bits,H){t.msg="invalid literal/lengths set",e.mode=Ur;break}if(e.distbits=6,e.distcode=e.distdyn,Y={bits:e.distbits},H=ho(kf,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,Y),e.distbits=Y.bits,H){t.msg="invalid distances set",e.mode=Ur;break}if(e.mode=Vo,r===Go)break e;case Vo:e.mode=Yo;case Yo:if(o>=6&&d>=258){t.next_out=c,t.avail_out=d,t.next_in=i,t.avail_in=o,e.hold=h,e.bits=p,zg(t,m),c=t.next_out,s=t.output,d=t.avail_out,i=t.next_in,a=t.input,o=t.avail_in,h=e.hold,p=e.bits,e.mode===pa&&(e.back=-1);break}for(e.back=0;_=e.lencode[h&(1<<e.lenbits)-1],y=_>>>24,A=_>>>16&255,L=_&65535,!(y<=p);){if(o===0)break e;o--,h+=a[i++]<<p,p+=8}if(A&&(A&240)===0){for(E=y,O=A,X=L;_=e.lencode[X+((h&(1<<E+O)-1)>>E)],y=_>>>24,A=_>>>16&255,L=_&65535,!(E+y<=p);){if(o===0)break e;o--,h+=a[i++]<<p,p+=8}h>>>=E,p-=E,e.back+=E}if(h>>>=y,p-=y,e.back+=y,e.length=L,A===0){e.mode=ku;break}if(A&32){e.back=-1,e.mode=pa;break}if(A&64){t.msg="invalid literal/length code",e.mode=Ur;break}e.extra=A&15,e.mode=Nu;case Nu:if(e.extra){for(I=e.extra;p<I;){if(o===0)break e;o--,h+=a[i++]<<p,p+=8}e.length+=h&(1<<e.extra)-1,h>>>=e.extra,p-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=_u;case _u:for(;_=e.distcode[h&(1<<e.distbits)-1],y=_>>>24,A=_>>>16&255,L=_&65535,!(y<=p);){if(o===0)break e;o--,h+=a[i++]<<p,p+=8}if((A&240)===0){for(E=y,O=A,X=L;_=e.distcode[X+((h&(1<<E+O)-1)>>E)],y=_>>>24,A=_>>>16&255,L=_&65535,!(E+y<=p);){if(o===0)break e;o--,h+=a[i++]<<p,p+=8}h>>>=E,p-=E,e.back+=E}if(h>>>=y,p-=y,e.back+=y,A&64){t.msg="invalid distance code",e.mode=Ur;break}e.offset=L,e.extra=A&15,e.mode=ju;case ju:if(e.extra){for(I=e.extra;p<I;){if(o===0)break e;o--,h+=a[i++]<<p,p+=8}e.offset+=h&(1<<e.extra)-1,h>>>=e.extra,p-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){t.msg="invalid distance too far back",e.mode=Ur;break}e.mode=Su;case Su:if(d===0)break e;if(u=m-d,e.offset>u){if(u=e.offset-u,u>e.whave&&e.sane){t.msg="invalid distance too far back",e.mode=Ur;break}u>e.wnext?(u-=e.wnext,w=e.wsize-u):w=e.wnext-u,u>e.length&&(u=e.length),x=e.window}else x=s,w=c-e.offset,u=e.length;u>d&&(u=d),d-=u,e.length-=u;do s[c++]=x[w++];while(--u);e.length===0&&(e.mode=Yo);break;case ku:if(d===0)break e;s[c++]=e.length,d--,e.mode=Yo;break;case ec:if(e.wrap){for(;p<32;){if(o===0)break e;o--,h|=a[i++]<<p,p+=8}if(m-=d,t.total_out+=m,e.total+=m,e.wrap&4&&m&&(t.adler=e.check=e.flags?Ys(e.check,s,m,c-m):kc(e.check,s,m,c-m)),m=d,e.wrap&4&&(e.flags?h:Lu(h))!==e.check){t.msg="incorrect data check",e.mode=Ur;break}h=0,p=0}e.mode=Au;case Au:if(e.wrap&&e.flags){for(;p<32;){if(o===0)break e;o--,h+=a[i++]<<p,p+=8}if(e.wrap&4&&h!==(e.total&4294967295)){t.msg="incorrect length check",e.mode=Ur;break}h=0,p=0}e.mode=Cu;case Cu:H=Kg;break e;case Ur:H=Af;break e;case Lf:return Cf;case Ef:default:return Ss}return t.next_out=c,t.avail_out=d,t.next_in=i,t.avail_in=o,e.hold=h,e.bits=p,(e.wsize||m!==t.avail_out&&e.mode<Ur&&(e.mode<ec||r!==iu))&&Of(t,t.output,t.next_out,m-t.avail_out),b-=t.avail_in,m-=t.avail_out,t.total_in+=b,t.total_out+=m,e.total+=m,e.wrap&4&&m&&(t.adler=e.check=e.flags?Ys(e.check,s,m,t.next_out-m):kc(e.check,s,m,t.next_out-m)),t.data_type=e.bits+(e.last?64:0)+(e.mode===pa?128:0)+(e.mode===Vo||e.mode===Ql?256:0),(b===0&&m===0||r===iu)&&H===oi&&(H=Zg),H},i1=t=>{if(li(t))return Ss;let r=t.state;return r.window&&(r.window=null),t.state=null,oi},o1=(t,r)=>{if(li(t))return Ss;const e=t.state;return(e.wrap&2)===0?Ss:(e.head=r,r.done=!1,oi)},l1=(t,r)=>{const e=r.length;let a,s,i;return li(t)||(a=t.state,a.wrap!==0&&a.mode!==xl)?Ss:a.mode===xl&&(s=1,s=kc(s,r,e,0),s!==a.check)?Af:(i=Of(t,r,e,e),i?(a.mode=Lf,Cf):(a.havedict=1,oi))};var c1=Tf,d1=If,u1=Pf,h1=n1,f1=Ff,p1=a1,m1=i1,g1=o1,x1=l1,y1="pako inflate (from Nodeca project)",ga={inflateReset:c1,inflateReset2:d1,inflateResetKeep:u1,inflateInit:h1,inflateInit2:f1,inflate:p1,inflateEnd:m1,inflateGetHeader:g1,inflateSetDictionary:x1,inflateInfo:y1};function b1(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var w1=b1;const Df=Object.prototype.toString,{Z_NO_FLUSH:v1,Z_FINISH:N1,Z_OK:go,Z_STREAM_END:nc,Z_NEED_DICT:sc,Z_STREAM_ERROR:_1,Z_DATA_ERROR:Pu,Z_MEM_ERROR:j1}=Nf;function wo(t){this.options=_f.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const r=this.options;r.raw&&r.windowBits>=0&&r.windowBits<16&&(r.windowBits=-r.windowBits,r.windowBits===0&&(r.windowBits=-15)),r.windowBits>=0&&r.windowBits<16&&!(t&&t.windowBits)&&(r.windowBits+=32),r.windowBits>15&&r.windowBits<48&&(r.windowBits&15)===0&&(r.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Mg,this.strm.avail_out=0;let e=ga.inflateInit2(this.strm,r.windowBits);if(e!==go)throw new Error(Ac[e]);if(this.header=new w1,ga.inflateGetHeader(this.strm,this.header),r.dictionary&&(typeof r.dictionary=="string"?r.dictionary=Cc.string2buf(r.dictionary):Df.call(r.dictionary)==="[object ArrayBuffer]"&&(r.dictionary=new Uint8Array(r.dictionary)),r.raw&&(e=ga.inflateSetDictionary(this.strm,r.dictionary),e!==go)))throw new Error(Ac[e])}wo.prototype.push=function(t,r){const e=this.strm,a=this.options.chunkSize,s=this.options.dictionary;let i,c,o;if(this.ended)return!1;for(r===~~r?c=r:c=r===!0?N1:v1,Df.call(t)==="[object ArrayBuffer]"?e.input=new Uint8Array(t):e.input=t,e.next_in=0,e.avail_in=e.input.length;;){for(e.avail_out===0&&(e.output=new Uint8Array(a),e.next_out=0,e.avail_out=a),i=ga.inflate(e,c),i===sc&&s&&(i=ga.inflateSetDictionary(e,s),i===go?i=ga.inflate(e,c):i===Pu&&(i=sc));e.avail_in>0&&i===nc&&e.state.wrap>0&&t[e.next_in]!==0;)ga.inflateReset(e),i=ga.inflate(e,c);switch(i){case _1:case Pu:case sc:case j1:return this.onEnd(i),this.ended=!0,!1}if(o=e.avail_out,e.next_out&&(e.avail_out===0||i===nc))if(this.options.to==="string"){let d=Cc.utf8border(e.output,e.next_out),h=e.next_out-d,p=Cc.buf2string(e.output,d);e.next_out=h,e.avail_out=a-h,h&&e.output.set(e.output.subarray(d,d+h),0),this.onData(p)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(!(i===go&&o===0)){if(i===nc)return i=ga.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(e.avail_in===0)break}}return!0};wo.prototype.onData=function(t){this.chunks.push(t)};wo.prototype.onEnd=function(t){t===go&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=_f.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function S1(t,r){const e=new wo(r);if(e.push(t),e.err)throw e.msg||Ac[e.err];return e.result}var k1=wo,A1=S1,C1={Inflate:k1,inflate:A1};const{Inflate:L1,inflate:E1}=C1;var Tu=L1,P1=E1;const Rf=[];for(let t=0;t<256;t++){let r=t;for(let e=0;e<8;e++)r&1?r=3988292384^r>>>1:r=r>>>1;Rf[t]=r}const Iu=4294967295;function T1(t,r,e){let a=t;for(let s=0;s<e;s++)a=Rf[(a^r[s])&255]^a>>>8;return a}function I1(t,r){return(T1(Iu,t,r)^Iu)>>>0}function Fu(t,r,e){const a=t.readUint32(),s=I1(new Uint8Array(t.buffer,t.byteOffset+t.offset-r-4,r),r);if(s!==a)throw new Error(`CRC mismatch for chunk ${e}. Expected ${a}, found ${s}`)}function Bf(t,r,e){for(let a=0;a<e;a++)r[a]=t[a]}function Mf(t,r,e,a){let s=0;for(;s<a;s++)r[s]=t[s];for(;s<e;s++)r[s]=t[s]+r[s-a]&255}function Uf(t,r,e,a){let s=0;if(e.length===0)for(;s<a;s++)r[s]=t[s];else for(;s<a;s++)r[s]=t[s]+e[s]&255}function zf(t,r,e,a,s){let i=0;if(e.length===0){for(;i<s;i++)r[i]=t[i];for(;i<a;i++)r[i]=t[i]+(r[i-s]>>1)&255}else{for(;i<s;i++)r[i]=t[i]+(e[i]>>1)&255;for(;i<a;i++)r[i]=t[i]+(r[i-s]+e[i]>>1)&255}}function qf(t,r,e,a,s){let i=0;if(e.length===0){for(;i<s;i++)r[i]=t[i];for(;i<a;i++)r[i]=t[i]+r[i-s]&255}else{for(;i<s;i++)r[i]=t[i]+e[i]&255;for(;i<a;i++)r[i]=t[i]+F1(r[i-s],e[i],e[i-s])&255}}function F1(t,r,e){const a=t+r-e,s=Math.abs(a-t),i=Math.abs(a-r),c=Math.abs(a-e);return s<=i&&s<=c?t:i<=c?r:e}function O1(t,r,e,a,s,i){switch(t){case 0:Bf(r,e,s);break;case 1:Mf(r,e,s,i);break;case 2:Uf(r,e,a,s);break;case 3:zf(r,e,a,s,i);break;case 4:qf(r,e,a,s,i);break;default:throw new Error(`Unsupported filter: ${t}`)}}const D1=new Uint16Array([255]),R1=new Uint8Array(D1.buffer),B1=R1[0]===255;function M1(t){const{data:r,width:e,height:a,channels:s,depth:i}=t,c=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(i/8)*s,d=new Uint8Array(a*e*o);let h=0;for(let p=0;p<7;p++){const b=c[p],m=Math.ceil((e-b.x)/b.xStep),u=Math.ceil((a-b.y)/b.yStep);if(m<=0||u<=0)continue;const w=m*o,x=new Uint8Array(w);for(let _=0;_<u;_++){const y=r[h++],A=r.subarray(h,h+w);h+=w;const L=new Uint8Array(w);O1(y,A,L,x,w,o),x.set(L);for(let E=0;E<m;E++){const O=b.x+E*b.xStep,X=b.y+_*b.yStep;if(!(O>=e||X>=a))for(let K=0;K<o;K++)d[(X*e+O)*o+K]=L[E*o+K]}}}if(i===16){const p=new Uint16Array(d.buffer);if(B1)for(let b=0;b<p.length;b++)p[b]=U1(p[b]);return p}else return d}function U1(t){return(t&255)<<8|t>>8&255}const z1=new Uint16Array([255]),q1=new Uint8Array(z1.buffer),$1=q1[0]===255,W1=new Uint8Array(0);function Ou(t){const{data:r,width:e,height:a,channels:s,depth:i}=t,c=Math.ceil(i/8)*s,o=Math.ceil(i/8*s*e),d=new Uint8Array(a*o);let h=W1,p=0,b,m;for(let u=0;u<a;u++){switch(b=r.subarray(p+1,p+1+o),m=d.subarray(u*o,(u+1)*o),r[p]){case 0:Bf(b,m,o);break;case 1:Mf(b,m,o,c);break;case 2:Uf(b,m,h,o);break;case 3:zf(b,m,h,o,c);break;case 4:qf(b,m,h,o,c);break;default:throw new Error(`Unsupported filter: ${r[p]}`)}h=m,p+=o+1}if(i===16){const u=new Uint16Array(d.buffer);if($1)for(let w=0;w<u.length;w++)u[w]=H1(u[w]);return u}else return d}function H1(t){return(t&255)<<8|t>>8&255}const nl=Uint8Array.of(137,80,78,71,13,10,26,10);function Du(t){if(!G1(t.readBytes(nl.length)))throw new Error("wrong PNG signature")}function G1(t){if(t.length<nl.length)return!1;for(let r=0;r<nl.length;r++)if(t[r]!==nl[r])return!1;return!0}const V1="tEXt",Y1=0,$f=new TextDecoder("latin1");function K1(t){if(Z1(t),t.length===0||t.length>79)throw new Error("keyword length must be between 1 and 79")}const J1=/^[\u0000-\u00FF]*$/;function Z1(t){if(!J1.test(t))throw new Error("invalid latin1 text")}function X1(t,r,e){const a=Wf(r);t[a]=Q1(r,e-a.length-1)}function Wf(t){for(t.mark();t.readByte()!==Y1;);const r=t.offset;t.reset();const e=$f.decode(t.readBytes(r-t.offset-1));return t.skip(1),K1(e),e}function Q1(t,r){return $f.decode(t.readBytes(r))}const ds={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},ac={UNKNOWN:-1,DEFLATE:0},Ru={UNKNOWN:-1,ADAPTIVE:0},ic={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Ko={NONE:0,BACKGROUND:1,PREVIOUS:2},oc={SOURCE:0,OVER:1};class e2 extends Zc{constructor(e,a={}){super(e);Sr(this,"_checkCrc");Sr(this,"_inflator");Sr(this,"_png");Sr(this,"_apng");Sr(this,"_end");Sr(this,"_hasPalette");Sr(this,"_palette");Sr(this,"_hasTransparency");Sr(this,"_transparency");Sr(this,"_compressionMethod");Sr(this,"_filterMethod");Sr(this,"_interlaceMethod");Sr(this,"_colorType");Sr(this,"_isAnimated");Sr(this,"_numberOfFrames");Sr(this,"_numberOfPlays");Sr(this,"_frames");Sr(this,"_writingDataChunks");const{checkCrc:s=!1}=a;this._checkCrc=s,this._inflator=new Tu,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=ac.UNKNOWN,this._filterMethod=Ru.UNKNOWN,this._interlaceMethod=ic.UNKNOWN,this._colorType=ds.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(Du(this);!this._end;){const e=this.readUint32(),a=this.readChars(4);this.decodeChunk(e,a)}return this.decodeImage(),this._png}decodeApng(){for(Du(this);!this._end;){const e=this.readUint32(),a=this.readChars(4);this.decodeApngChunk(e,a)}return this.decodeApngImage(),this._apng}decodeChunk(e,a){const s=this.offset;switch(a){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case V1:X1(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e);break}if(this.offset-s!==e)throw new Error(`Length mismatch while decoding chunk ${a}`);this._checkCrc?Fu(this,e+4,a):this.skip(4)}decodeApngChunk(e,a){const s=this.offset;switch(a!=="fdAT"&&a!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),a){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,a),this.offset=s+e;break}if(this.offset-s!==e)throw new Error(`Length mismatch while decoding chunk ${a}`);this._checkCrc?Fu(this,e+4,a):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=t2(this.readUint8());const a=this.readUint8();this._colorType=a;let s;switch(a){case ds.GREYSCALE:s=1;break;case ds.TRUECOLOUR:s=3;break;case ds.INDEXED_COLOUR:s=1;break;case ds.GREYSCALE_ALPHA:s=2;break;case ds.TRUECOLOUR_ALPHA:s=4;break;case ds.UNKNOWN:default:throw new Error(`Unknown color type: ${a}`)}if(this._png.channels=s,this._compressionMethod=this.readUint8(),this._compressionMethod!==ac.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${e}`);const a=e/3;this._hasPalette=!0;const s=[];this._palette=s;for(let i=0;i<a;i++)s.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const a=e,s=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,s,a)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let a=e,s=this.offset+this.byteOffset;if(s+=4,a-=4,this._inflator.push(new Uint8Array(this.buffer,s,a)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(e)}decodetRNS(e){switch(this._colorType){case ds.GREYSCALE:case ds.TRUECOLOUR:{if(e%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${e}`);if(e/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${e/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let a=0;a<e/2;a++)this._transparency[a]=this.readUint16();break}case ds.INDEXED_COLOUR:{if(e>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${e} vs ${this._palette.length})`);let a=0;for(;a<e;a++){const s=this.readByte();this._palette[a].push(s)}for(;a<this._palette.length;a++)this._palette[a].push(255);break}case ds.UNKNOWN:case ds.GREYSCALE_ALPHA:case ds.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(e){const a=Wf(this),s=this.readUint8();if(s!==ac.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${s}`);const i=this.readBytes(e-a.length-2);this._png.iccEmbeddedProfile={name:a,profile:P1(i)}}decodepHYs(){const e=this.readUint32(),a=this.readUint32(),s=this.readByte();this._png.resolution={x:e,y:a,unit:s}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const a={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},s=this._frames.at(e);if(s){if(s.data=Ou({data:s.data,width:s.width,height:s.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),e===0||s.xOffset===0&&s.yOffset===0&&s.width===this._png.width&&s.height===this._png.height)a.data=s.data;else{const i=this._apng.frames.at(e-1);this.disposeFrame(s,i,a),this.addFrameDataToCanvas(a,s)}this._apng.frames.push(a)}}return this._apng}disposeFrame(e,a,s){switch(e.disposeOp){case Ko.NONE:break;case Ko.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let c=0;c<this._png.width;c++){const o=(i*e.width+c)*this._png.channels;for(let d=0;d<this._png.channels;d++)s.data[o+d]=0}break;case Ko.PREVIOUS:s.data.set(a.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,a){const s=1<<this._png.depth,i=(c,o)=>{const d=((c+a.yOffset)*this._png.width+a.xOffset+o)*this._png.channels,h=(c*a.width+o)*this._png.channels;return{index:d,frameIndex:h}};switch(a.blendOp){case oc.SOURCE:for(let c=0;c<a.height;c++)for(let o=0;o<a.width;o++){const{index:d,frameIndex:h}=i(c,o);for(let p=0;p<this._png.channels;p++)e.data[d+p]=a.data[h+p]}break;case oc.OVER:for(let c=0;c<a.height;c++)for(let o=0;o<a.width;o++){const{index:d,frameIndex:h}=i(c,o);for(let p=0;p<this._png.channels;p++){const b=a.data[h+this._png.channels-1]/s,m=p%(this._png.channels-1)===0?1:a.data[h+p],u=Math.floor(b*m+(1-b)*e.data[d+p]);e.data[d+p]+=u}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var a;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const e=this._isAnimated?((a=this._frames)==null?void 0:a.at(0)).data:this._inflator.result;if(this._filterMethod!==Ru.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===ic.NO_INTERLACE)this._png.data=Ou({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===ic.ADAM7)this._png.data=M1({data:e,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,a=this._frames.at(-1);a?a.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Ko.NONE,blendOp:oc.SOURCE,data:e}),this._inflator=new Tu,this._writingDataChunks=!1}}function t2(t){if(t!==1&&t!==2&&t!==4&&t!==8&&t!==16)throw new Error(`invalid bit depth: ${t}`);return t}var Bu;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"})(Bu||(Bu={}));function r2(t,r){return new e2(t,r).decode()}var Gt=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function lc(){Gt.console&&typeof Gt.console.log=="function"&&Gt.console.log.apply(Gt.console,arguments)}var Tr={log:lc,warn:function(t){Gt.console&&(typeof Gt.console.warn=="function"?Gt.console.warn.apply(Gt.console,arguments):lc.call(null,arguments))},error:function(t){Gt.console&&(typeof Gt.console.error=="function"?Gt.console.error.apply(Gt.console,arguments):lc(t))}};function cc(t,r,e){var a=new XMLHttpRequest;a.open("GET",t),a.responseType="blob",a.onload=function(){ei(a.response,r,e)},a.onerror=function(){Tr.error("could not download file")},a.send()}function Mu(t){var r=new XMLHttpRequest;r.open("HEAD",t,!1);try{r.send()}catch{}return r.status>=200&&r.status<=299}function Jo(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(r)}}var ei=Gt.saveAs||((typeof window>"u"?"undefined":kr(window))!=="object"||window!==Gt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,r,e){var a=Gt.URL||Gt.webkitURL,s=document.createElement("a");r=r||t.name||"download",s.download=r,s.rel="noopener",typeof t=="string"?(s.href=t,s.origin!==location.origin?Mu(s.href)?cc(t,r,e):Jo(s,s.target="_blank"):Jo(s)):(s.href=a.createObjectURL(t),setTimeout(function(){a.revokeObjectURL(s.href)},4e4),setTimeout(function(){Jo(s)},0))}:"msSaveOrOpenBlob"in navigator?function(t,r,e){if(r=r||t.name||"download",typeof t=="string")if(Mu(t))cc(t,r,e);else{var a=document.createElement("a");a.href=t,a.target="_blank",setTimeout(function(){Jo(a)})}else navigator.msSaveOrOpenBlob((function(s,i){return i===void 0?i={autoBom:!1}:kr(i)!=="object"&&(Tr.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s})(t,e),r)}:function(t,r,e,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),typeof t=="string")return cc(t,r,e);var s=t.type==="application/octet-stream",i=/constructor/i.test(Gt.HTMLElement)||Gt.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||s&&i)&&(typeof FileReader>"u"?"undefined":kr(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var p=o.result;p=c?p:p.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=p:location=p,a=null},o.readAsDataURL(t)}else{var d=Gt.URL||Gt.webkitURL,h=d.createObjectURL(t);a?a.location=h:location.href=h,a=null,setTimeout(function(){d.revokeObjectURL(h)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Hf(t){var r;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var e=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],a=0;a<e.length;a++){var s=e[a].re,i=e[a].process,c=s.exec(t);c&&(r=i(c),this.r=r[0],this.g=r[1],this.b=r[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),d=this.g.toString(16),h=this.b.toString(16);return o.length==1&&(o="0"+o),d.length==1&&(d="0"+d),h.length==1&&(h="0"+h),"#"+o+d+h}}var sl=Gt.atob.bind(Gt),Uu=Gt.btoa.bind(Gt);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function dc(t,r){var e=t[0],a=t[1],s=t[2],i=t[3];e=In(e,a,s,i,r[0],7,-680876936),i=In(i,e,a,s,r[1],12,-389564586),s=In(s,i,e,a,r[2],17,606105819),a=In(a,s,i,e,r[3],22,-1044525330),e=In(e,a,s,i,r[4],7,-176418897),i=In(i,e,a,s,r[5],12,1200080426),s=In(s,i,e,a,r[6],17,-1473231341),a=In(a,s,i,e,r[7],22,-45705983),e=In(e,a,s,i,r[8],7,1770035416),i=In(i,e,a,s,r[9],12,-1958414417),s=In(s,i,e,a,r[10],17,-42063),a=In(a,s,i,e,r[11],22,-1990404162),e=In(e,a,s,i,r[12],7,1804603682),i=In(i,e,a,s,r[13],12,-40341101),s=In(s,i,e,a,r[14],17,-1502002290),e=Fn(e,a=In(a,s,i,e,r[15],22,1236535329),s,i,r[1],5,-165796510),i=Fn(i,e,a,s,r[6],9,-1069501632),s=Fn(s,i,e,a,r[11],14,643717713),a=Fn(a,s,i,e,r[0],20,-373897302),e=Fn(e,a,s,i,r[5],5,-701558691),i=Fn(i,e,a,s,r[10],9,38016083),s=Fn(s,i,e,a,r[15],14,-660478335),a=Fn(a,s,i,e,r[4],20,-405537848),e=Fn(e,a,s,i,r[9],5,568446438),i=Fn(i,e,a,s,r[14],9,-1019803690),s=Fn(s,i,e,a,r[3],14,-187363961),a=Fn(a,s,i,e,r[8],20,1163531501),e=Fn(e,a,s,i,r[13],5,-1444681467),i=Fn(i,e,a,s,r[2],9,-51403784),s=Fn(s,i,e,a,r[7],14,1735328473),e=On(e,a=Fn(a,s,i,e,r[12],20,-1926607734),s,i,r[5],4,-378558),i=On(i,e,a,s,r[8],11,-2022574463),s=On(s,i,e,a,r[11],16,1839030562),a=On(a,s,i,e,r[14],23,-35309556),e=On(e,a,s,i,r[1],4,-1530992060),i=On(i,e,a,s,r[4],11,1272893353),s=On(s,i,e,a,r[7],16,-155497632),a=On(a,s,i,e,r[10],23,-1094730640),e=On(e,a,s,i,r[13],4,681279174),i=On(i,e,a,s,r[0],11,-358537222),s=On(s,i,e,a,r[3],16,-722521979),a=On(a,s,i,e,r[6],23,76029189),e=On(e,a,s,i,r[9],4,-640364487),i=On(i,e,a,s,r[12],11,-421815835),s=On(s,i,e,a,r[15],16,530742520),e=Dn(e,a=On(a,s,i,e,r[2],23,-995338651),s,i,r[0],6,-198630844),i=Dn(i,e,a,s,r[7],10,1126891415),s=Dn(s,i,e,a,r[14],15,-1416354905),a=Dn(a,s,i,e,r[5],21,-57434055),e=Dn(e,a,s,i,r[12],6,1700485571),i=Dn(i,e,a,s,r[3],10,-1894986606),s=Dn(s,i,e,a,r[10],15,-1051523),a=Dn(a,s,i,e,r[1],21,-2054922799),e=Dn(e,a,s,i,r[8],6,1873313359),i=Dn(i,e,a,s,r[15],10,-30611744),s=Dn(s,i,e,a,r[6],15,-1560198380),a=Dn(a,s,i,e,r[13],21,1309151649),e=Dn(e,a,s,i,r[4],6,-145523070),i=Dn(i,e,a,s,r[11],10,-1120210379),s=Dn(s,i,e,a,r[2],15,718787259),a=Dn(a,s,i,e,r[9],21,-343485551),t[0]=za(e,t[0]),t[1]=za(a,t[1]),t[2]=za(s,t[2]),t[3]=za(i,t[3])}function kl(t,r,e,a,s,i){return r=za(za(r,t),za(a,i)),za(r<<s|r>>>32-s,e)}function In(t,r,e,a,s,i,c){return kl(r&e|~r&a,t,r,s,i,c)}function Fn(t,r,e,a,s,i,c){return kl(r&a|e&~a,t,r,s,i,c)}function On(t,r,e,a,s,i,c){return kl(r^e^a,t,r,s,i,c)}function Dn(t,r,e,a,s,i,c){return kl(e^(r|~a),t,r,s,i,c)}function Gf(t){var r,e=t.length,a=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=t.length;r+=64)dc(a,n2(t.substring(r-64,r)));t=t.substring(r-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<t.length;r++)s[r>>2]|=t.charCodeAt(r)<<(r%4<<3);if(s[r>>2]|=128<<(r%4<<3),r>55)for(dc(a,s),r=0;r<16;r++)s[r]=0;return s[14]=8*e,dc(a,s),a}function n2(t){var r,e=[];for(r=0;r<64;r+=4)e[r>>2]=t.charCodeAt(r)+(t.charCodeAt(r+1)<<8)+(t.charCodeAt(r+2)<<16)+(t.charCodeAt(r+3)<<24);return e}var zu="0123456789abcdef".split("");function s2(t){for(var r="",e=0;e<4;e++)r+=zu[t>>8*e+4&15]+zu[t>>8*e&15];return r}function a2(t){return String.fromCharCode(255&t,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function Lc(t){return Gf(t).map(a2).join("")}var i2=(function(t){for(var r=0;r<t.length;r++)t[r]=s2(t[r]);return t.join("")})(Gf("hello"))!="5d41402abc4b2a76b9719d911017c592";function za(t,r){if(i2){var e=(65535&t)+(65535&r);return(t>>16)+(r>>16)+(e>>16)<<16|65535&e}return t+r&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Ec(t,r){var e,a,s,i;if(t!==e){for(var c=(s=t,i=1+(256/t.length|0),new Array(i+1).join(s)),o=[],d=0;d<256;d++)o[d]=d;var h=0;for(d=0;d<256;d++){var p=o[d];h=(h+p+c.charCodeAt(d))%256,o[d]=o[h],o[h]=p}e=t,a=o}else o=a;var b=r.length,m=0,u=0,w="";for(d=0;d<b;d++)u=(u+(p=o[m=(m+1)%256]))%256,o[m]=o[u],o[u]=p,c=o[(o[m]+o[u])%256],w+=String.fromCharCode(r.charCodeAt(d)^c);return w}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var qu={print:4,modify:8,copy:16,"annot-forms":32};function Ci(t,r,e,a){this.v=1,this.r=2;var s=192;t.forEach(function(o){if(qu.perm!==void 0)throw new Error("Invalid permission: "+o);s+=qu[o]}),this.padding="(Â¿N^NuÂŠAd\0NVÃ¿Ãº\b..\0Â¶Ãh>Â€/\fÂ©Ã¾dSiz";var i=(r+this.padding).substr(0,32),c=(e+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,c),this.P=-(1+(255^s)),this.encryptionKey=Lc(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(a)).substr(0,5),this.U=Ec(this.encryptionKey,this.padding)}function Li(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var r="",e=t.length,a=0;a<e;a++){var s=t.charCodeAt(a);r+=s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?"#"+("0"+s.toString(16)).slice(-2):t[a]}return r}function $u(t){if(kr(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var r={};this.subscribe=function(e,a,s){if(s=s||!1,typeof e!="string"||typeof a!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");r.hasOwnProperty(e)||(r[e]={});var i=Math.random().toString(35);return r[e][i]=[a,!!s],i},this.unsubscribe=function(e){for(var a in r)if(r[a][e])return delete r[a][e],Object.keys(r[a]).length===0&&delete r[a],!0;return!1},this.publish=function(e){if(r.hasOwnProperty(e)){var a=Array.prototype.slice.call(arguments,1),s=[];for(var i in r[e]){var c=r[e][i];try{c[0].apply(t,a)}catch(o){Gt.console&&Tr.error("jsPDF PubSub Error",o.message,o)}c[1]&&s.push(i)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return r}}function yl(t){if(!(this instanceof yl))return new yl(t);var r="opacity,stroke-opacity".split(",");for(var e in t)t.hasOwnProperty(e)&&r.indexOf(e)>=0&&(this[e]=t[e]);this.id="",this.objectNumber=-1}function Vf(t,r){this.gState=t,this.matrix=r,this.id="",this.objectNumber=-1}function ti(t,r,e,a,s){if(!(this instanceof ti))return new ti(t,r,e,a,s);this.type=t==="axial"?2:3,this.coords=r,this.colors=e,Vf.call(this,a,s)}function Pi(t,r,e,a,s){if(!(this instanceof Pi))return new Pi(t,r,e,a,s);this.boundingBox=t,this.xStep=r,this.yStep=e,this.stream="",this.cloneIndex=0,Vf.call(this,a,s)}function Mt(t){var r,e=typeof arguments[0]=="string"?arguments[0]:"p",a=arguments[1],s=arguments[2],i=arguments[3],c=[],o=1,d=16,h="S",p=null;kr(t=t||{})==="object"&&(e=t.orientation,a=t.unit||a,s=t.format||s,i=t.compress||t.compressPdf||i,(p=t.encryption||null)!==null&&(p.userPassword=p.userPassword||"",p.ownerPassword=p.ownerPassword||"",p.userPermissions=p.userPermissions||[]),o=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(r=t.precision),t.floatPrecision!==void 0&&(d=t.floatPrecision),h=t.defaultPathOperation||"S"),c=t.filters||(i===!0?["FlateEncode"]:c),a=a||"mm",e=(""+(e||"P")).toLowerCase();var b=t.putOnlyUsedFonts||!1,m={},u={internal:{},__private__:{}};u.__private__.PubSub=$u;var w="1.3",x=u.__private__.getPdfVersion=function(){return w};u.__private__.setPdfVersion=function(g){w=g};var _={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};u.__private__.getPageFormats=function(){return _};var y=u.__private__.getPageFormat=function(g){return _[g]};s=s||"a4";var A="compat",L="advanced",E=A;function O(){this.saveGraphicsState(),T(new Ut(yt,0,0,-yt,0,ts()*yt).toString()+" cm"),this.setFontSize(this.getFontSize()/yt),h="n",E=L}function X(){this.restoreGraphicsState(),h="S",E=A}var K=u.__private__.combineFontStyleAndFontWeight=function(g,D){if(g=="bold"&&D=="normal"||g=="bold"&&D==400||g=="normal"&&D=="italic"||g=="bold"&&D=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return D&&(g=D==400||D==="normal"?g==="italic"?"italic":"normal":D!=700&&D!=="bold"||g!=="normal"?(D==700?"bold":D)+""+g:"bold"),g};u.advancedAPI=function(g){var D=E===A;return D&&O.call(this),typeof g!="function"||(g(this),D&&X.call(this)),this},u.compatAPI=function(g){var D=E===L;return D&&X.call(this),typeof g!="function"||(g(this),D&&O.call(this)),this},u.isAdvancedAPI=function(){return E===L};var H,P=function(g){if(E!==L)throw new Error(g+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},Y=u.roundToPrecision=u.__private__.roundToPrecision=function(g,D){var ne=r||D;if(isNaN(g)||isNaN(ne))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return g.toFixed(ne).replace(/0+$/,"")};H=u.hpf=u.__private__.hpf=typeof d=="number"?function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.hpf");return Y(g,d)}:d==="smart"?function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.hpf");return Y(g,g>-1&&g<1?16:5)}:function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.hpf");return Y(g,16)};var I=u.f2=u.__private__.f2=function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.f2");return Y(g,2)},S=u.__private__.f3=function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.f3");return Y(g,3)},R=u.scale=u.__private__.scale=function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.scale");return E===A?g*yt:E===L?g:void 0},N=function(g){return R((function(D){return E===A?ts()-D:E===L?D:void 0})(g))};u.__private__.setPrecision=u.setPrecision=function(g){typeof parseInt(g,10)=="number"&&(r=parseInt(g,10))};var re,ve="00000000000000000000000000000000",le=u.__private__.getFileId=function(){return ve},oe=u.__private__.setFileId=function(g){return ve=g!==void 0&&/^[a-fA-F0-9]{32}$/.test(g)?g.toUpperCase():ve.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),p!==null&&(Lr=new Ci(p.userPermissions,p.userPassword,p.ownerPassword,ve)),ve};u.setFileId=function(g){return oe(g),this},u.getFileId=function(){return le()};var ie=u.__private__.convertDateToPDFDate=function(g){var D=g.getTimezoneOffset(),ne=D<0?"+":"-",ye=Math.floor(Math.abs(D/60)),Ee=Math.abs(D%60),Ge=[ne,Z(ye),"'",Z(Ee),"'"].join("");return["D:",g.getFullYear(),Z(g.getMonth()+1),Z(g.getDate()),Z(g.getHours()),Z(g.getMinutes()),Z(g.getSeconds()),Ge].join("")},Ae=u.__private__.convertPDFDateToDate=function(g){var D=parseInt(g.substr(2,4),10),ne=parseInt(g.substr(6,2),10)-1,ye=parseInt(g.substr(8,2),10),Ee=parseInt(g.substr(10,2),10),Ge=parseInt(g.substr(12,2),10),Ze=parseInt(g.substr(14,2),10);return new Date(D,ne,ye,Ee,Ge,Ze,0)},te=u.__private__.setCreationDate=function(g){var D;if(g===void 0&&(g=new Date),g instanceof Date)D=ie(g);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(g))throw new Error("Invalid argument passed to jsPDF.setCreationDate");D=g}return re=D},C=u.__private__.getCreationDate=function(g){var D=re;return g==="jsDate"&&(D=Ae(re)),D};u.setCreationDate=function(g){return te(g),this},u.getCreationDate=function(g){return C(g)};var G,Z=u.__private__.padd2=function(g){return("0"+parseInt(g)).slice(-2)},Q=u.__private__.padd2Hex=function(g){return("00"+(g=g.toString())).substr(g.length)},fe=0,we=[],Se=[],Ce=0,Re=[],Me=[],Je=!1,je=Se;u.__private__.setCustomOutputDestination=function(g){Je=!0,je=g};var j=function(g){Je||(je=g)};u.__private__.resetCustomOutputDestination=function(){Je=!1,je=Se};var T=u.__private__.out=function(g){return g=g.toString(),Ce+=g.length+1,je.push(g),je},V=u.__private__.write=function(g){return T(arguments.length===1?g.toString():Array.prototype.join.call(arguments," "))},$=u.__private__.getArrayBuffer=function(g){for(var D=g.length,ne=new ArrayBuffer(D),ye=new Uint8Array(ne);D--;)ye[D]=g.charCodeAt(D);return ne},z=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];u.__private__.getStandardFonts=function(){return z};var M=t.fontSize||16;u.__private__.setFontSize=u.setFontSize=function(g){return M=E===L?g/yt:g,this};var ue,pe=u.__private__.getFontSize=u.getFontSize=function(){return E===A?M:M*yt},ce=t.R2L||!1;u.__private__.setR2L=u.setR2L=function(g){return ce=g,this},u.__private__.getR2L=u.getR2L=function(){return ce};var Le,Ie=u.__private__.setZoomMode=function(g){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(g))ue=g;else if(isNaN(g)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(g)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+g+'" is not recognized.');ue=g}else ue=parseInt(g,10)};u.__private__.getZoomMode=function(){return ue};var Te,Ve=u.__private__.setPageMode=function(g){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(g)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+g+'" is not recognized.');Le=g};u.__private__.getPageMode=function(){return Le};var ht=u.__private__.setLayoutMode=function(g){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(g)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+g+'" is not recognized.');Te=g};u.__private__.getLayoutMode=function(){return Te},u.__private__.setDisplayMode=u.setDisplayMode=function(g,D,ne){return Ie(g),ht(D),Ve(ne),this};var st={title:"",subject:"",author:"",keywords:"",creator:""};u.__private__.getDocumentProperty=function(g){if(Object.keys(st).indexOf(g)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return st[g]},u.__private__.getDocumentProperties=function(){return st},u.__private__.setDocumentProperties=u.setProperties=u.setDocumentProperties=function(g){for(var D in st)st.hasOwnProperty(D)&&g[D]&&(st[D]=g[D]);return this},u.__private__.setDocumentProperty=function(g,D){if(Object.keys(st).indexOf(g)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return st[g]=D};var ot,yt,dt,Vt,mt,Lt={},zt={},Et=[],wt={},Kt={},Nt={},Ft={},ar=null,Ot=0,xt=[],Xt=new $u(u),er=t.hotfixes||[],Or={},bn={},fn=[],Ut=function g(D,ne,ye,Ee,Ge,Ze){if(!(this instanceof g))return new g(D,ne,ye,Ee,Ge,Ze);isNaN(D)&&(D=1),isNaN(ne)&&(ne=0),isNaN(ye)&&(ye=0),isNaN(Ee)&&(Ee=1),isNaN(Ge)&&(Ge=0),isNaN(Ze)&&(Ze=0),this._matrix=[D,ne,ye,Ee,Ge,Ze]};Object.defineProperty(Ut.prototype,"sx",{get:function(){return this._matrix[0]},set:function(g){this._matrix[0]=g}}),Object.defineProperty(Ut.prototype,"shy",{get:function(){return this._matrix[1]},set:function(g){this._matrix[1]=g}}),Object.defineProperty(Ut.prototype,"shx",{get:function(){return this._matrix[2]},set:function(g){this._matrix[2]=g}}),Object.defineProperty(Ut.prototype,"sy",{get:function(){return this._matrix[3]},set:function(g){this._matrix[3]=g}}),Object.defineProperty(Ut.prototype,"tx",{get:function(){return this._matrix[4]},set:function(g){this._matrix[4]=g}}),Object.defineProperty(Ut.prototype,"ty",{get:function(){return this._matrix[5]},set:function(g){this._matrix[5]=g}}),Object.defineProperty(Ut.prototype,"a",{get:function(){return this._matrix[0]},set:function(g){this._matrix[0]=g}}),Object.defineProperty(Ut.prototype,"b",{get:function(){return this._matrix[1]},set:function(g){this._matrix[1]=g}}),Object.defineProperty(Ut.prototype,"c",{get:function(){return this._matrix[2]},set:function(g){this._matrix[2]=g}}),Object.defineProperty(Ut.prototype,"d",{get:function(){return this._matrix[3]},set:function(g){this._matrix[3]=g}}),Object.defineProperty(Ut.prototype,"e",{get:function(){return this._matrix[4]},set:function(g){this._matrix[4]=g}}),Object.defineProperty(Ut.prototype,"f",{get:function(){return this._matrix[5]},set:function(g){this._matrix[5]=g}}),Object.defineProperty(Ut.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Ut.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Ut.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Ut.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Ut.prototype.join=function(g){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(H).join(g)},Ut.prototype.multiply=function(g){var D=g.sx*this.sx+g.shy*this.shx,ne=g.sx*this.shy+g.shy*this.sy,ye=g.shx*this.sx+g.sy*this.shx,Ee=g.shx*this.shy+g.sy*this.sy,Ge=g.tx*this.sx+g.ty*this.shx+this.tx,Ze=g.tx*this.shy+g.ty*this.sy+this.ty;return new Ut(D,ne,ye,Ee,Ge,Ze)},Ut.prototype.decompose=function(){var g=this.sx,D=this.shy,ne=this.shx,ye=this.sy,Ee=this.tx,Ge=this.ty,Ze=Math.sqrt(g*g+D*D),vt=(g/=Ze)*ne+(D/=Ze)*ye;ne-=g*vt,ye-=D*vt;var Pt=Math.sqrt(ne*ne+ye*ye);return vt/=Pt,g*(ye/=Pt)<D*(ne/=Pt)&&(g=-g,D=-D,vt=-vt,Ze=-Ze),{scale:new Ut(Ze,0,0,Pt,0,0),translate:new Ut(1,0,0,1,Ee,Ge),rotate:new Ut(g,D,-D,g,0,0),skew:new Ut(1,0,vt,1,0,0)}},Ut.prototype.toString=function(g){return this.join(" ")},Ut.prototype.inversed=function(){var g=this.sx,D=this.shy,ne=this.shx,ye=this.sy,Ee=this.tx,Ge=this.ty,Ze=1/(g*ye-D*ne),vt=ye*Ze,Pt=-D*Ze,qt=-ne*Ze,Jt=g*Ze;return new Ut(vt,Pt,qt,Jt,-vt*Ee-qt*Ge,-Pt*Ee-Jt*Ge)},Ut.prototype.applyToPoint=function(g){var D=g.x*this.sx+g.y*this.shx+this.tx,ne=g.x*this.shy+g.y*this.sy+this.ty;return new Gn(D,ne)},Ut.prototype.applyToRectangle=function(g){var D=this.applyToPoint(g),ne=this.applyToPoint(new Gn(g.x+g.w,g.y+g.h));return new Va(D.x,D.y,ne.x-D.x,ne.y-D.y)},Ut.prototype.clone=function(){var g=this.sx,D=this.shy,ne=this.shx,ye=this.sy,Ee=this.tx,Ge=this.ty;return new Ut(g,D,ne,ye,Ee,Ge)},u.Matrix=Ut;var pn=u.matrixMult=function(g,D){return D.multiply(g)},wn=new Ut(1,0,0,1,0,0);u.unitMatrix=u.identityMatrix=wn;var Vr=function(g,D){if(!Kt[g]){var ne=(D instanceof ti?"Sh":"P")+(Object.keys(wt).length+1).toString(10);D.id=ne,Kt[g]=ne,wt[ne]=D,Xt.publish("addPattern",D)}};u.ShadingPattern=ti,u.TilingPattern=Pi,u.addShadingPattern=function(g,D){return P("addShadingPattern()"),Vr(g,D),this},u.beginTilingPattern=function(g){P("beginTilingPattern()"),Ya(g.boundingBox[0],g.boundingBox[1],g.boundingBox[2]-g.boundingBox[0],g.boundingBox[3]-g.boundingBox[1],g.matrix)},u.endTilingPattern=function(g,D){P("endTilingPattern()"),D.stream=Me[G].join(`
`),Vr(g,D),Xt.publish("endTilingPattern",D),fn.pop().restore()};var qr,gr=u.__private__.newObject=function(){var g=Cr();return dr(g,!0),g},Cr=u.__private__.newObjectDeferred=function(){return fe++,we[fe]=function(){return Ce},fe},dr=function(g,D){return D=typeof D=="boolean"&&D,we[g]=Ce,D&&T(g+" 0 obj"),g},es=u.__private__.newAdditionalObject=function(){var g={objId:Cr(),content:""};return Re.push(g),g},wr=Cr(),Sn=Cr(),tn=u.__private__.decodeColorString=function(g){var D=g.split(" ");if(D.length!==2||D[1]!=="g"&&D[1]!=="G")D.length!==5||D[4]!=="k"&&D[4]!=="K"||(D=[(1-D[0])*(1-D[3]),(1-D[1])*(1-D[3]),(1-D[2])*(1-D[3]),"r"]);else{var ne=parseFloat(D[0]);D=[ne,ne,ne,"r"]}for(var ye="#",Ee=0;Ee<3;Ee++)ye+=("0"+Math.floor(255*parseFloat(D[Ee])).toString(16)).slice(-2);return ye},kn=u.__private__.encodeColorString=function(g){var D;typeof g=="string"&&(g={ch1:g});var ne=g.ch1,ye=g.ch2,Ee=g.ch3,Ge=g.ch4,Ze=g.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ne=="string"&&ne.charAt(0)!=="#"){var vt=new Hf(ne);if(vt.ok)ne=vt.toHex();else if(!/^\d*\.?\d*$/.test(ne))throw new Error('Invalid color "'+ne+'" passed to jsPDF.encodeColorString.')}if(typeof ne=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ne)&&(ne="#"+ne[1]+ne[1]+ne[2]+ne[2]+ne[3]+ne[3]),typeof ne=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ne)){var Pt=parseInt(ne.substr(1),16);ne=Pt>>16&255,ye=Pt>>8&255,Ee=255&Pt}if(ye===void 0||Ge===void 0&&ne===ye&&ye===Ee)D=typeof ne=="string"?ne+" "+Ze[0]:g.precision===2?I(ne/255)+" "+Ze[0]:S(ne/255)+" "+Ze[0];else if(Ge===void 0||kr(Ge)==="object"){if(Ge&&!isNaN(Ge.a)&&Ge.a===0)return["1.","1.","1.",Ze[1]].join(" ");D=typeof ne=="string"?[ne,ye,Ee,Ze[1]].join(" "):g.precision===2?[I(ne/255),I(ye/255),I(Ee/255),Ze[1]].join(" "):[S(ne/255),S(ye/255),S(Ee/255),Ze[1]].join(" ")}else D=typeof ne=="string"?[ne,ye,Ee,Ge,Ze[2]].join(" "):g.precision===2?[I(ne),I(ye),I(Ee),I(Ge),Ze[2]].join(" "):[S(ne),S(ye),S(Ee),S(Ge),Ze[2]].join(" ");return D},$r=u.__private__.getFilters=function(){return c},Yr=u.__private__.putStream=function(g){var D=(g=g||{}).data||"",ne=g.filters||$r(),ye=g.alreadyAppliedFilters||[],Ee=g.addLength1||!1,Ge=D.length,Ze=g.objectId,vt=function(ge){return ge};if(p!==null&&Ze===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");p!==null&&(vt=Lr.encryptor(Ze,0));var Pt={};ne===!0&&(ne=["FlateEncode"]);var qt=g.additionalKeyValues||[],Jt=(Pt=Mt.API.processDataByFilters!==void 0?Mt.API.processDataByFilters(D,ne):{data:D,reverseChain:[]}).reverseChain+(Array.isArray(ye)?ye.join(" "):ye.toString());if(Pt.data.length!==0&&(qt.push({key:"Length",value:Pt.data.length}),Ee===!0&&qt.push({key:"Length1",value:Ge})),Jt.length!=0)if(Jt.split("/").length-1==1)qt.push({key:"Filter",value:Jt});else{qt.push({key:"Filter",value:"["+Jt+"]"});for(var or=0;or<qt.length;or+=1)if(qt[or].key==="DecodeParms"){for(var F=[],de=0;de<Pt.reverseChain.split("/").length-1;de+=1)F.push("null");F.push(qt[or].value),qt[or].value="["+F.join(" ")+"]"}}T("<<");for(var me=0;me<qt.length;me++)T("/"+qt[me].key+" "+qt[me].value);T(">>"),Pt.data.length!==0&&(T("stream"),T(vt(Pt.data)),T("endstream"))},En=u.__private__.putPage=function(g){var D=g.number,ne=g.data,ye=g.objId,Ee=g.contentsObjId;dr(ye,!0),T("<</Type /Page"),T("/Parent "+g.rootDictionaryObjId+" 0 R"),T("/Resources "+g.resourceDictionaryObjId+" 0 R"),T("/MediaBox ["+parseFloat(H(g.mediaBox.bottomLeftX))+" "+parseFloat(H(g.mediaBox.bottomLeftY))+" "+H(g.mediaBox.topRightX)+" "+H(g.mediaBox.topRightY)+"]"),g.cropBox!==null&&T("/CropBox ["+H(g.cropBox.bottomLeftX)+" "+H(g.cropBox.bottomLeftY)+" "+H(g.cropBox.topRightX)+" "+H(g.cropBox.topRightY)+"]"),g.bleedBox!==null&&T("/BleedBox ["+H(g.bleedBox.bottomLeftX)+" "+H(g.bleedBox.bottomLeftY)+" "+H(g.bleedBox.topRightX)+" "+H(g.bleedBox.topRightY)+"]"),g.trimBox!==null&&T("/TrimBox ["+H(g.trimBox.bottomLeftX)+" "+H(g.trimBox.bottomLeftY)+" "+H(g.trimBox.topRightX)+" "+H(g.trimBox.topRightY)+"]"),g.artBox!==null&&T("/ArtBox ["+H(g.artBox.bottomLeftX)+" "+H(g.artBox.bottomLeftY)+" "+H(g.artBox.topRightX)+" "+H(g.artBox.topRightY)+"]"),typeof g.userUnit=="number"&&g.userUnit!==1&&T("/UserUnit "+g.userUnit),Xt.publish("putPage",{objId:ye,pageContext:xt[D],pageNumber:D,page:ne}),T("/Contents "+Ee+" 0 R"),T(">>"),T("endobj");var Ge=ne.join(`
`);return E===L&&(Ge+=`
Q`),dr(Ee,!0),Yr({data:Ge,filters:$r(),objectId:Ee}),T("endobj"),ye},lt=u.__private__.putPages=function(){var g,D,ne=[];for(g=1;g<=Ot;g++)xt[g].objId=Cr(),xt[g].contentsObjId=Cr();for(g=1;g<=Ot;g++)ne.push(En({number:g,data:Me[g],objId:xt[g].objId,contentsObjId:xt[g].contentsObjId,mediaBox:xt[g].mediaBox,cropBox:xt[g].cropBox,bleedBox:xt[g].bleedBox,trimBox:xt[g].trimBox,artBox:xt[g].artBox,userUnit:xt[g].userUnit,rootDictionaryObjId:wr,resourceDictionaryObjId:Sn}));dr(wr,!0),T("<</Type /Pages");var ye="/Kids [";for(D=0;D<Ot;D++)ye+=ne[D]+" 0 R ";T(ye+"]"),T("/Count "+Ot),T(">>"),T("endobj"),Xt.publish("postPutPages")},Kr=function(g){Xt.publish("putFont",{font:g,out:T,newObject:gr,putStream:Yr}),g.isAlreadyPutted!==!0&&(g.objectNumber=gr(),T("<<"),T("/Type /Font"),T("/BaseFont /"+Li(g.postScriptName)),T("/Subtype /Type1"),typeof g.encoding=="string"&&T("/Encoding /"+g.encoding),T("/FirstChar 32"),T("/LastChar 255"),T(">>"),T("endobj"))},xe=function(g){g.objectNumber=gr();var D=[];D.push({key:"Type",value:"/XObject"}),D.push({key:"Subtype",value:"/Form"}),D.push({key:"BBox",value:"["+[H(g.x),H(g.y),H(g.x+g.width),H(g.y+g.height)].join(" ")+"]"}),D.push({key:"Matrix",value:"["+g.matrix.toString()+"]"});var ne=g.pages[1].join(`
`);Yr({data:ne,additionalKeyValues:D,objectId:g.objectNumber}),T("endobj")},ze=function(g,D){D||(D=21);var ne=gr(),ye=(function(Ze,vt){var Pt,qt=[],Jt=1/(vt-1);for(Pt=0;Pt<1;Pt+=Jt)qt.push(Pt);if(qt.push(1),Ze[0].offset!=0){var or={offset:0,color:Ze[0].color};Ze.unshift(or)}if(Ze[Ze.length-1].offset!=1){var F={offset:1,color:Ze[Ze.length-1].color};Ze.push(F)}for(var de="",me=0,ge=0;ge<qt.length;ge++){for(Pt=qt[ge];Pt>Ze[me+1].offset;)me++;var he=Ze[me].offset,Ne=(Pt-he)/(Ze[me+1].offset-he),Fe=Ze[me].color,qe=Ze[me+1].color;de+=Q(Math.round((1-Ne)*Fe[0]+Ne*qe[0]).toString(16))+Q(Math.round((1-Ne)*Fe[1]+Ne*qe[1]).toString(16))+Q(Math.round((1-Ne)*Fe[2]+Ne*qe[2]).toString(16))}return de.trim()})(g.colors,D),Ee=[];Ee.push({key:"FunctionType",value:"0"}),Ee.push({key:"Domain",value:"[0.0 1.0]"}),Ee.push({key:"Size",value:"["+D+"]"}),Ee.push({key:"BitsPerSample",value:"8"}),Ee.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ee.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Yr({data:ye,additionalKeyValues:Ee,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ne}),T("endobj"),g.objectNumber=gr(),T("<< /ShadingType "+g.type),T("/ColorSpace /DeviceRGB");var Ge="/Coords ["+H(parseFloat(g.coords[0]))+" "+H(parseFloat(g.coords[1]))+" ";g.type===2?Ge+=H(parseFloat(g.coords[2]))+" "+H(parseFloat(g.coords[3])):Ge+=H(parseFloat(g.coords[2]))+" "+H(parseFloat(g.coords[3]))+" "+H(parseFloat(g.coords[4]))+" "+H(parseFloat(g.coords[5])),T(Ge+="]"),g.matrix&&T("/Matrix ["+g.matrix.toString()+"]"),T("/Function "+ne+" 0 R"),T("/Extend [true true]"),T(">>"),T("endobj")},We=function(g,D){var ne=Cr(),ye=gr();D.push({resourcesOid:ne,objectOid:ye}),g.objectNumber=ye;var Ee=[];Ee.push({key:"Type",value:"/Pattern"}),Ee.push({key:"PatternType",value:"1"}),Ee.push({key:"PaintType",value:"1"}),Ee.push({key:"TilingType",value:"1"}),Ee.push({key:"BBox",value:"["+g.boundingBox.map(H).join(" ")+"]"}),Ee.push({key:"XStep",value:H(g.xStep)}),Ee.push({key:"YStep",value:H(g.yStep)}),Ee.push({key:"Resources",value:ne+" 0 R"}),g.matrix&&Ee.push({key:"Matrix",value:"["+g.matrix.toString()+"]"}),Yr({data:g.stream,additionalKeyValues:Ee,objectId:g.objectNumber}),T("endobj")},Qe=function(g){for(var D in g.objectNumber=gr(),T("<<"),g)switch(D){case"opacity":T("/ca "+I(g[D]));break;case"stroke-opacity":T("/CA "+I(g[D]))}T(">>"),T("endobj")},at=function(g){dr(g.resourcesOid,!0),T("<<"),T("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var D in T("/Font <<"),Lt)Lt.hasOwnProperty(D)&&(b===!1||b===!0&&m.hasOwnProperty(D))&&T("/"+D+" "+Lt[D].objectNumber+" 0 R");T(">>")})(),(function(){if(Object.keys(wt).length>0){for(var D in T("/Shading <<"),wt)wt.hasOwnProperty(D)&&wt[D]instanceof ti&&wt[D].objectNumber>=0&&T("/"+D+" "+wt[D].objectNumber+" 0 R");Xt.publish("putShadingPatternDict"),T(">>")}})(),(function(D){if(Object.keys(wt).length>0){for(var ne in T("/Pattern <<"),wt)wt.hasOwnProperty(ne)&&wt[ne]instanceof u.TilingPattern&&wt[ne].objectNumber>=0&&wt[ne].objectNumber<D&&T("/"+ne+" "+wt[ne].objectNumber+" 0 R");Xt.publish("putTilingPatternDict"),T(">>")}})(g.objectOid),(function(){if(Object.keys(Nt).length>0){var D;for(D in T("/ExtGState <<"),Nt)Nt.hasOwnProperty(D)&&Nt[D].objectNumber>=0&&T("/"+D+" "+Nt[D].objectNumber+" 0 R");Xt.publish("putGStateDict"),T(">>")}})(),(function(){for(var D in T("/XObject <<"),Or)Or.hasOwnProperty(D)&&Or[D].objectNumber>=0&&T("/"+D+" "+Or[D].objectNumber+" 0 R");Xt.publish("putXobjectDict"),T(">>")})(),T(">>"),T("endobj")},tt=function(g){zt[g.fontName]=zt[g.fontName]||{},zt[g.fontName][g.fontStyle]=g.id},rt=function(g,D,ne,ye,Ee){var Ge={id:"F"+(Object.keys(Lt).length+1).toString(10),postScriptName:g,fontName:D,fontStyle:ne,encoding:ye,isStandardFont:Ee||!1,metadata:{}};return Xt.publish("addFont",{font:Ge,instance:this}),Lt[Ge.id]=Ge,tt(Ge),Ge.id},it=u.__private__.pdfEscape=u.pdfEscape=function(g,D){return(function(ne,ye){var Ee,Ge,Ze,vt,Pt,qt,Jt,or,F;if(Ze=(ye=ye||{}).sourceEncoding||"Unicode",Pt=ye.outputEncoding,(ye.autoencode||Pt)&&Lt[ot].metadata&&Lt[ot].metadata[Ze]&&Lt[ot].metadata[Ze].encoding&&(vt=Lt[ot].metadata[Ze].encoding,!Pt&&Lt[ot].encoding&&(Pt=Lt[ot].encoding),!Pt&&vt.codePages&&(Pt=vt.codePages[0]),typeof Pt=="string"&&(Pt=vt[Pt]),Pt)){for(Jt=!1,qt=[],Ee=0,Ge=ne.length;Ee<Ge;Ee++)(or=Pt[ne.charCodeAt(Ee)])?qt.push(String.fromCharCode(or)):qt.push(ne[Ee]),qt[Ee].charCodeAt(0)>>8&&(Jt=!0);ne=qt.join("")}for(Ee=ne.length;Jt===void 0&&Ee!==0;)ne.charCodeAt(Ee-1)>>8&&(Jt=!0),Ee--;if(!Jt)return ne;for(qt=ye.noBOM?[]:[254,255],Ee=0,Ge=ne.length;Ee<Ge;Ee++){if((F=(or=ne.charCodeAt(Ee))>>8)>>8)throw new Error("Character at position "+Ee+" of string '"+ne+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");qt.push(F),qt.push(or-(F<<8))}return String.fromCharCode.apply(void 0,qt)})(g,D).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},At=u.__private__.beginPage=function(g){Me[++Ot]=[],xt[Ot]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(g[0]),topRightY:Number(g[1])}},Yt(Ot),j(Me[G])},_t=function(g,D){var ne,ye,Ee;switch(e=D||e,typeof g=="string"&&(ne=y(g.toLowerCase()),Array.isArray(ne)&&(ye=ne[0],Ee=ne[1])),Array.isArray(g)&&(ye=g[0]*yt,Ee=g[1]*yt),isNaN(ye)&&(ye=s[0],Ee=s[1]),(ye>14400||Ee>14400)&&(Tr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),ye=Math.min(14400,ye),Ee=Math.min(14400,Ee)),s=[ye,Ee],e.substr(0,1)){case"l":Ee>ye&&(s=[Ee,ye]);break;case"p":ye>Ee&&(s=[Ee,ye])}At(s),Ht(Wa),T(na),Ha!==0&&T(Ha+" J"),Ga!==0&&T(Ga+" j"),Xt.publish("addPage",{pageNumber:Ot})},$t=function(g){g>0&&g<=Ot&&(Me.splice(g,1),xt.splice(g,1),Ot--,G>Ot&&(G=Ot),this.setPage(G))},Yt=function(g){g>0&&g<=Ot&&(G=g)},gt=u.__private__.getNumberOfPages=u.getNumberOfPages=function(){return Me.length-1},Wt=function(g,D,ne){var ye,Ee=void 0;return ne=ne||{},g=g!==void 0?g:Lt[ot].fontName,D=D!==void 0?D:Lt[ot].fontStyle,ye=g.toLowerCase(),zt[ye]!==void 0&&zt[ye][D]!==void 0?Ee=zt[ye][D]:zt[g]!==void 0&&zt[g][D]!==void 0?Ee=zt[g][D]:ne.disableWarning===!1&&Tr.warn("Unable to look up font label for font '"+g+"', '"+D+"'. Refer to getFontList() for available fonts."),Ee||ne.noFallback||(Ee=zt.times[D])==null&&(Ee=zt.times.normal),Ee},ir=u.__private__.putInfo=function(){var g=gr(),D=function(ye){return ye};for(var ne in p!==null&&(D=Lr.encryptor(g,0)),T("<<"),T("/Producer ("+it(D("jsPDF "+Mt.version))+")"),st)st.hasOwnProperty(ne)&&st[ne]&&T("/"+ne.substr(0,1).toUpperCase()+ne.substr(1)+" ("+it(D(st[ne]))+")");T("/CreationDate ("+it(D(re))+")"),T(">>"),T("endobj")},Pn=u.__private__.putCatalog=function(g){var D=(g=g||{}).rootDictionaryObjId||wr;switch(gr(),T("<<"),T("/Type /Catalog"),T("/Pages "+D+" 0 R"),ue||(ue="fullwidth"),ue){case"fullwidth":T("/OpenAction [3 0 R /FitH null]");break;case"fullheight":T("/OpenAction [3 0 R /FitV null]");break;case"fullpage":T("/OpenAction [3 0 R /Fit]");break;case"original":T("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ne=""+ue;ne.substr(ne.length-1)==="%"&&(ue=parseInt(ue)/100),typeof ue=="number"&&T("/OpenAction [3 0 R /XYZ null null "+I(ue)+"]")}switch(Te||(Te="continuous"),Te){case"continuous":T("/PageLayout /OneColumn");break;case"single":T("/PageLayout /SinglePage");break;case"two":case"twoleft":T("/PageLayout /TwoColumnLeft");break;case"tworight":T("/PageLayout /TwoColumnRight")}Le&&T("/PageMode /"+Le),Xt.publish("putCatalog"),T(">>"),T("endobj")},ys=u.__private__.putTrailer=function(){T("trailer"),T("<<"),T("/Size "+(fe+1)),T("/Root "+fe+" 0 R"),T("/Info "+(fe-1)+" 0 R"),p!==null&&T("/Encrypt "+Lr.oid+" 0 R"),T("/ID [ <"+ve+"> <"+ve+"> ]"),T(">>")},Ar=u.__private__.putHeader=function(){T("%PDF-"+w),T("%ÂºÃŸÂ¬Ã ")},He=u.__private__.putXRef=function(){var g="0000000000";T("xref"),T("0 "+(fe+1)),T("0000000000 65535 f ");for(var D=1;D<=fe;D++)typeof we[D]=="function"?T((g+we[D]()).slice(-10)+" 00000 n "):we[D]!==void 0?T((g+we[D]).slice(-10)+" 00000 n "):T("0000000000 00000 n ")},ft=u.__private__.buildDocument=function(){var g;fe=0,Ce=0,Se=[],we=[],Re=[],wr=Cr(),Sn=Cr(),j(Se),Xt.publish("buildDocument"),Ar(),lt(),(function(){Xt.publish("putAdditionalObjects");for(var ne=0;ne<Re.length;ne++){var ye=Re[ne];dr(ye.objId,!0),T(ye.content),T("endobj")}Xt.publish("postPutAdditionalObjects")})(),g=[],(function(){for(var ne in Lt)Lt.hasOwnProperty(ne)&&(b===!1||b===!0&&m.hasOwnProperty(ne))&&Kr(Lt[ne])})(),(function(){var ne;for(ne in Nt)Nt.hasOwnProperty(ne)&&Qe(Nt[ne])})(),(function(){for(var ne in Or)Or.hasOwnProperty(ne)&&xe(Or[ne])})(),(function(ne){var ye;for(ye in wt)wt.hasOwnProperty(ye)&&(wt[ye]instanceof ti?ze(wt[ye]):wt[ye]instanceof Pi&&We(wt[ye],ne))})(g),Xt.publish("putResources"),g.forEach(at),at({resourcesOid:Sn,objectOid:Number.MAX_SAFE_INTEGER}),Xt.publish("postPutResources"),p!==null&&(Lr.oid=gr(),T("<<"),T("/Filter /Standard"),T("/V "+Lr.v),T("/R "+Lr.r),T("/U <"+Lr.toHexString(Lr.U)+">"),T("/O <"+Lr.toHexString(Lr.O)+">"),T("/P "+Lr.P),T(">>"),T("endobj")),ir(),Pn();var D=Ce;return He(),ys(),T("startxref"),T(""+D),T("%%EOF"),j(Me[G]),Se.join(`
`)},ur=u.__private__.getBlob=function(g){return new Blob([$(g)],{type:"application/pdf"})},Wr=u.output=u.__private__.output=(qr=function(g,D){switch(typeof(D=D||{})=="string"?D={filename:D}:D.filename=D.filename||"generated.pdf",g){case void 0:return ft();case"save":u.save(D.filename);break;case"arraybuffer":return $(ft());case"blob":return ur(ft());case"bloburi":case"bloburl":if(Gt.URL!==void 0&&typeof Gt.URL.createObjectURL=="function")return Gt.URL&&Gt.URL.createObjectURL(ur(ft()))||void 0;Tr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ne="",ye=ft();try{ne=Uu(ye)}catch{ne=Uu(unescape(encodeURIComponent(ye)))}return"data:application/pdf;filename="+D.filename+";base64,"+ne;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Gt)==="[object Window]"){var Ee="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ge=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';D.pdfObjectUrl&&(Ee=D.pdfObjectUrl,Ge="");var Ze='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ee+'"'+Ge+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(D)+");<\/script></body></html>",vt=Gt.open();return vt!==null&&vt.document.write(Ze),vt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Gt)==="[object Window]"){var Pt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(D.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+D.filename+'" width="500px" height="400px" /></body></html>',qt=Gt.open();if(qt!==null){qt.document.write(Pt);var Jt=this;qt.document.documentElement.querySelector("#pdfViewer").onload=function(){qt.document.title=D.filename,qt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Jt.output("bloburl"))}}return qt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Gt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var or='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",D)+'"></iframe></body></html>',F=Gt.open();if(F!==null&&(F.document.write(or),F.document.title=D.filename),F||typeof safari>"u")return F;break;case"datauri":case"dataurl":return Gt.document.location.href=this.output("datauristring",D);default:return null}},qr.foo=function(){try{return qr.apply(this,arguments)}catch(ne){var g=ne.stack||"";~g.indexOf(" at ")&&(g=g.split(" at ")[1]);var D="Error in function "+g.split(`
`)[0].split("<")[0]+": "+ne.message;if(!Gt.console)throw new Error(D);Gt.console.error(D,ne),Gt.alert&&alert(D)}},qr.foo.bar=qr,qr.foo),Mr=function(g){return Array.isArray(er)===!0&&er.indexOf(g)>-1};switch(a){case"pt":yt=1;break;case"mm":yt=72/25.4;break;case"cm":yt=72/2.54;break;case"in":yt=72;break;case"px":yt=Mr("px_scaling")==1?.75:96/72;break;case"pc":case"em":yt=12;break;case"ex":yt=6;break;default:if(typeof a!="number")throw new Error("Invalid unit: "+a);yt=a}var Lr=null;te(),oe();var Hn=u.__private__.getPageInfo=u.getPageInfo=function(g){if(isNaN(g)||g%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:xt[g].objId,pageNumber:g,pageContext:xt[g]}},ba=u.__private__.getPageInfoByObjId=function(g){if(isNaN(g)||g%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var D in xt)if(xt[D].objId===g)break;return Hn(D)},Jr=u.__private__.getCurrentPageInfo=u.getCurrentPageInfo=function(){return{objId:xt[G].objId,pageNumber:G,pageContext:xt[G]}};u.addPage=function(){return _t.apply(this,arguments),this},u.setPage=function(){return Yt.apply(this,arguments),j.call(this,Me[G]),this},u.insertPage=function(g){return this.addPage(),this.movePage(G,g),this},u.movePage=function(g,D){var ne,ye;if(g>D){ne=Me[g],ye=xt[g];for(var Ee=g;Ee>D;Ee--)Me[Ee]=Me[Ee-1],xt[Ee]=xt[Ee-1];Me[D]=ne,xt[D]=ye,this.setPage(D)}else if(g<D){ne=Me[g],ye=xt[g];for(var Ge=g;Ge<D;Ge++)Me[Ge]=Me[Ge+1],xt[Ge]=xt[Ge+1];Me[D]=ne,xt[D]=ye,this.setPage(D)}return this},u.deletePage=function(){return $t.apply(this,arguments),this},u.__private__.text=u.text=function(g,D,ne,ye,Ee){var Ge,Ze,vt,Pt,qt,Jt,or,F,de,me=(ye=ye||{}).scope||this;if(typeof g=="number"&&typeof D=="number"&&(typeof ne=="string"||Array.isArray(ne))){var ge=ne;ne=D,D=g,g=ge}if(arguments[3]instanceof Ut==0?(vt=arguments[4],Pt=arguments[5],kr(or=arguments[3])==="object"&&or!==null||(typeof vt=="string"&&(Pt=vt,vt=null),typeof or=="string"&&(Pt=or,or=null),typeof or=="number"&&(vt=or,or=null),ye={flags:or,angle:vt,align:Pt})):(P("The transform parameter of text() with a Matrix value"),de=Ee),isNaN(D)||isNaN(ne)||g==null)throw new Error("Invalid arguments passed to jsPDF.text");if(g.length===0)return me;var he,Ne="",Fe=typeof ye.lineHeightFactor=="number"?ye.lineHeightFactor:ks,qe=me.internal.scaleFactor;function Ke(br){return br=br.split("	").join(Array(ye.TabLen||9).join(" ")),it(br,or)}function ut(br){for(var Er,nn=br.concat(),mn=[],ca=nn.length;ca--;)typeof(Er=nn.shift())=="string"?mn.push(Er):Array.isArray(br)&&(Er.length===1||Er[1]===void 0&&Er[2]===void 0)?mn.push(Er[0]):mn.push([Er[0],Er[1],Er[2]]);return mn}function Xe(br,Er){var nn;if(typeof br=="string")nn=Er(br)[0];else if(Array.isArray(br)){for(var mn,ca,eo=br.concat(),vi=[],_o=eo.length;_o--;)typeof(mn=eo.shift())=="string"?vi.push(Er(mn)[0]):Array.isArray(mn)&&typeof mn[0]=="string"&&(ca=Er(mn[0],mn[1],mn[2]),vi.push([ca[0],ca[1],ca[2]]));nn=vi}return nn}var ct=!1,be=!0;if(typeof g=="string")ct=!0;else if(Array.isArray(g)){var bt=g.concat();Ze=[];for(var jt,tr=bt.length;tr--;)(typeof(jt=bt.shift())!="string"||Array.isArray(jt)&&typeof jt[0]!="string")&&(be=!1);ct=be}if(ct===!1)throw new Error('Type of text must be string or Array. "'+g+'" is not recognized.');typeof g=="string"&&(g=g.match(/[\r?\n]/)?g.split(/\r\n|\r|\n/g):[g]);var vr=M/me.internal.scaleFactor,Dt=vr*(Fe-1);switch(ye.baseline){case"bottom":ne-=Dt;break;case"top":ne+=vr-Dt;break;case"hanging":ne+=vr-2*Dt;break;case"middle":ne+=vr/2-Dt}if((Jt=ye.maxWidth||0)>0&&(typeof g=="string"?g=me.splitTextToSize(g,Jt):Object.prototype.toString.call(g)==="[object Array]"&&(g=g.reduce(function(br,Er){return br.concat(me.splitTextToSize(Er,Jt))},[]))),Ge={text:g,x:D,y:ne,options:ye,mutex:{pdfEscape:it,activeFontKey:ot,fonts:Lt,activeFontSize:M}},Xt.publish("preProcessText",Ge),g=Ge.text,vt=(ye=Ge.options).angle,de instanceof Ut==0&&vt&&typeof vt=="number"){vt*=Math.PI/180,ye.rotationDirection===0&&(vt=-vt),E===L&&(vt=-vt);var xr=Math.cos(vt),Nr=Math.sin(vt);de=new Ut(xr,Nr,-Nr,xr,0,0)}else vt&&vt instanceof Ut&&(de=vt);E!==L||de||(de=wn),(qt=ye.charSpace||ws)!==void 0&&(Ne+=H(R(qt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(F=ye.horizontalScale)!==void 0&&(Ne+=H(100*F)+` Tz
`),ye.lang;var fr=-1,pr=ye.renderingMode!==void 0?ye.renderingMode:ye.stroke,Mn=me.internal.getCurrentPageInfo().pageContext;switch(pr){case 0:case!1:case"fill":fr=0;break;case 1:case!0:case"stroke":fr=1;break;case 2:case"fillThenStroke":fr=2;break;case 3:case"invisible":fr=3;break;case 4:case"fillAndAddForClipping":fr=4;break;case 5:case"strokeAndAddPathForClipping":fr=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":fr=6;break;case 7:case"addToPathForClipping":fr=7}var Un=Mn.usedRenderingMode!==void 0?Mn.usedRenderingMode:-1;fr!==-1?Ne+=fr+` Tr
`:Un!==-1&&(Ne+=`0 Tr
`),fr!==-1&&(Mn.usedRenderingMode=fr),Pt=ye.align||"left";var rr,mr=M*Fe,oa=me.internal.pageSize.getWidth(),Yi=Lt[ot];qt=ye.charSpace||ws,Jt=ye.maxWidth||0,or=Object.assign({autoencode:!0,noBOM:!0},ye.flags);var ka=[],Ja=function(br){return me.getStringUnitWidth(br,{font:Yi,charSpace:qt,fontSize:M,doKerning:!1})*M/qe};if(Object.prototype.toString.call(g)==="[object Array]"){var rs;Ze=ut(g),Pt!=="left"&&(rr=Ze.map(Ja));var ns,Aa=0;if(Pt==="right"){D-=rr[0],g=[],tr=Ze.length;for(var la=0;la<tr;la++)la===0?(ns=As(D),rs=bs(ne)):(ns=R(Aa-rr[la]),rs=-mr),g.push([Ze[la],ns,rs]),Aa=rr[la]}else if(Pt==="center"){D-=rr[0]/2,g=[],tr=Ze.length;for(var Ca=0;Ca<tr;Ca++)Ca===0?(ns=As(D),rs=bs(ne)):(ns=R((Aa-rr[Ca])/2),rs=-mr),g.push([Ze[Ca],ns,rs]),Aa=rr[Ca]}else if(Pt==="left"){g=[],tr=Ze.length;for(var Ki=0;Ki<tr;Ki++)g.push(Ze[Ki])}else if(Pt==="justify"&&Yi.encoding==="Identity-H"){g=[],tr=Ze.length,Jt=Jt!==0?Jt:oa;for(var wi=0,rn=0;rn<tr;rn++)if(rs=rn===0?bs(ne):-mr,ns=rn===0?As(D):wi,rn<tr-1){var No=R((Jt-rr[rn])/(Ze[rn].split(" ").length-1)),Hs=Ze[rn].split(" ");g.push([Hs[0]+" ",ns,rs]),wi=0;for(var Gs=1;Gs<Hs.length;Gs++){var Ji=(Ja(Hs[Gs-1]+" "+Hs[Gs])-Ja(Hs[Gs]))*qe+No;Gs==Hs.length-1?g.push([Hs[Gs],Ji,0]):g.push([Hs[Gs]+" ",Ji,0]),wi-=Ji}}else g.push([Ze[rn],ns,rs]);g.push(["",wi,0])}else{if(Pt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(g=[],tr=Ze.length,Jt=Jt!==0?Jt:oa,rn=0;rn<tr;rn++){rs=rn===0?bs(ne):-mr,ns=rn===0?As(D):0;var Zi=Ze[rn].split(" ").length-1,Xi=Zi>0?(Jt-rr[rn])/Zi:0;rn<tr-1?ka.push(H(R(Xi))):ka.push(0),g.push([Ze[rn],ns,rs])}}}(typeof ye.R2L=="boolean"?ye.R2L:ce)===!0&&(g=Xe(g,function(br,Er,nn){return[br.split("").reverse().join(""),Er,nn]})),Ge={text:g,x:D,y:ne,options:ye,mutex:{pdfEscape:it,activeFontKey:ot,fonts:Lt,activeFontSize:M}},Xt.publish("postProcessText",Ge),g=Ge.text,he=Ge.mutex.isHex||!1;var Qi=Lt[ot].encoding;Qi!=="WinAnsiEncoding"&&Qi!=="StandardEncoding"||(g=Xe(g,function(br,Er,nn){return[Ke(br),Er,nn]})),Ze=ut(g),g=[];for(var La,Ea,Pa,Za=Array.isArray(Ze[0])?1:0,Ta="",Xa=function(br,Er,nn){var mn="";return nn instanceof Ut?(nn=typeof ye.angle=="number"?pn(nn,new Ut(1,0,0,1,br,Er)):pn(new Ut(1,0,0,1,br,Er),nn),E===L&&(nn=pn(new Ut(1,0,0,-1,0,0),nn)),mn=nn.join(" ")+` Tm
`):mn=H(br)+" "+H(Er)+` Td
`,mn},vs=0;vs<Ze.length;vs++){switch(Ta="",Za){case 1:Pa=(he?"<":"(")+Ze[vs][0]+(he?">":")"),La=parseFloat(Ze[vs][1]),Ea=parseFloat(Ze[vs][2]);break;case 0:Pa=(he?"<":"(")+Ze[vs]+(he?">":")"),La=As(D),Ea=bs(ne)}ka!==void 0&&ka[vs]!==void 0&&(Ta=ka[vs]+` Tw
`),vs===0?g.push(Ta+Xa(La,Ea,de)+Pa):Za===0?g.push(Ta+Pa):Za===1&&g.push(Ta+Xa(La,Ea,de)+Pa)}g=Za===0?g.join(` Tj
T* `):g.join(` Tj
`),g+=` Tj
`;var Vs=`BT
/`;return Vs+=ot+" "+M+` Tf
`,Vs+=H(M*Fe)+` TL
`,Vs+=sa+`
`,Vs+=Ne,Vs+=g,T(Vs+="ET"),m[ot]=!0,me};var wa=u.__private__.clip=u.clip=function(g){return T(g==="evenodd"?"W*":"W"),this};u.clipEvenOdd=function(){return wa("evenodd")},u.__private__.discardPath=u.discardPath=function(){return T("n"),this};var Ir=u.__private__.isValidStyle=function(g){var D=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(g)!==-1&&(D=!0),D};u.__private__.setDefaultPathOperation=u.setDefaultPathOperation=function(g){return Ir(g)&&(h=g),this};var va=u.__private__.getStyle=u.getStyle=function(g){var D=h;switch(g){case"D":case"S":D="S";break;case"F":D="f";break;case"FD":case"DF":D="B";break;case"f":case"f*":case"B":case"B*":D=g}return D},Na=u.close=function(){return T("h"),this};u.stroke=function(){return T("S"),this},u.fill=function(g){return $s("f",g),this},u.fillEvenOdd=function(g){return $s("f*",g),this},u.fillStroke=function(g){return $s("B",g),this},u.fillStrokeEvenOdd=function(g){return $s("B*",g),this};var $s=function(g,D){kr(D)==="object"?di(D,g):T(g)},Ws=function(g){g===null||E===L&&g===void 0||(g=va(g),T(g))};function $a(g,D,ne,ye,Ee){var Ge=new Pi(D||this.boundingBox,ne||this.xStep,ye||this.yStep,this.gState,Ee||this.matrix);Ge.stream=this.stream;var Ze=g+"$$"+this.cloneIndex+++"$$";return Vr(Ze,Ge),Ge}var di=function(g,D){var ne=Kt[g.key],ye=wt[ne];if(ye instanceof ti)T("q"),T(ra(D)),ye.gState&&u.setGState(ye.gState),T(g.matrix.toString()+" cm"),T("/"+ne+" sh"),T("Q");else if(ye instanceof Pi){var Ee=new Ut(1,0,0,-1,0,ts());g.matrix&&(Ee=Ee.multiply(g.matrix||wn),ne=$a.call(ye,g.key,g.boundingBox,g.xStep,g.yStep,Ee).id),T("q"),T("/Pattern cs"),T("/"+ne+" scn"),ye.gState&&u.setGState(ye.gState),T(D),T("Q")}},ra=function(g){switch(g){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},_a=u.moveTo=function(g,D){return T(H(R(g))+" "+H(N(D))+" m"),this},ui=u.lineTo=function(g,D){return T(H(R(g))+" "+H(N(D))+" l"),this},Bn=u.curveTo=function(g,D,ne,ye,Ee,Ge){return T([H(R(g)),H(N(D)),H(R(ne)),H(N(ye)),H(R(Ee)),H(N(Ge)),"c"].join(" ")),this};u.__private__.line=u.line=function(g,D,ne,ye,Ee){if(isNaN(g)||isNaN(D)||isNaN(ne)||isNaN(ye)||!Ir(Ee))throw new Error("Invalid arguments passed to jsPDF.line");return E===A?this.lines([[ne-g,ye-D]],g,D,[1,1],Ee||"S"):this.lines([[ne-g,ye-D]],g,D,[1,1]).stroke()},u.__private__.lines=u.lines=function(g,D,ne,ye,Ee,Ge){var Ze,vt,Pt,qt,Jt,or,F,de,me,ge,he,Ne;if(typeof g=="number"&&(Ne=ne,ne=D,D=g,g=Ne),ye=ye||[1,1],Ge=Ge||!1,isNaN(D)||isNaN(ne)||!Array.isArray(g)||!Array.isArray(ye)||!Ir(Ee)||typeof Ge!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(_a(D,ne),Ze=ye[0],vt=ye[1],qt=g.length,ge=D,he=ne,Pt=0;Pt<qt;Pt++)(Jt=g[Pt]).length===2?(ge=Jt[0]*Ze+ge,he=Jt[1]*vt+he,ui(ge,he)):(or=Jt[0]*Ze+ge,F=Jt[1]*vt+he,de=Jt[2]*Ze+ge,me=Jt[3]*vt+he,ge=Jt[4]*Ze+ge,he=Jt[5]*vt+he,Bn(or,F,de,me,ge,he));return Ge&&Na(),Ws(Ee),this},u.path=function(g){for(var D=0;D<g.length;D++){var ne=g[D],ye=ne.c;switch(ne.op){case"m":_a(ye[0],ye[1]);break;case"l":ui(ye[0],ye[1]);break;case"c":Bn.apply(this,ye);break;case"h":Na()}}return this},u.__private__.rect=u.rect=function(g,D,ne,ye,Ee){if(isNaN(g)||isNaN(D)||isNaN(ne)||isNaN(ye)||!Ir(Ee))throw new Error("Invalid arguments passed to jsPDF.rect");return E===A&&(ye=-ye),T([H(R(g)),H(N(D)),H(R(ne)),H(R(ye)),"re"].join(" ")),Ws(Ee),this},u.__private__.triangle=u.triangle=function(g,D,ne,ye,Ee,Ge,Ze){if(isNaN(g)||isNaN(D)||isNaN(ne)||isNaN(ye)||isNaN(Ee)||isNaN(Ge)||!Ir(Ze))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ne-g,ye-D],[Ee-ne,Ge-ye],[g-Ee,D-Ge]],g,D,[1,1],Ze,!0),this},u.__private__.roundedRect=u.roundedRect=function(g,D,ne,ye,Ee,Ge,Ze){if(isNaN(g)||isNaN(D)||isNaN(ne)||isNaN(ye)||isNaN(Ee)||isNaN(Ge)||!Ir(Ze))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var vt=4/3*(Math.SQRT2-1);return Ee=Math.min(Ee,.5*ne),Ge=Math.min(Ge,.5*ye),this.lines([[ne-2*Ee,0],[Ee*vt,0,Ee,Ge-Ge*vt,Ee,Ge],[0,ye-2*Ge],[0,Ge*vt,-Ee*vt,Ge,-Ee,Ge],[2*Ee-ne,0],[-Ee*vt,0,-Ee,-Ge*vt,-Ee,-Ge],[0,2*Ge-ye],[0,-Ge*vt,Ee*vt,-Ge,Ee,-Ge]],g+Ee,D,[1,1],Ze,!0),this},u.__private__.ellipse=u.ellipse=function(g,D,ne,ye,Ee){if(isNaN(g)||isNaN(D)||isNaN(ne)||isNaN(ye)||!Ir(Ee))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ge=4/3*(Math.SQRT2-1)*ne,Ze=4/3*(Math.SQRT2-1)*ye;return _a(g+ne,D),Bn(g+ne,D-Ze,g+Ge,D-ye,g,D-ye),Bn(g-Ge,D-ye,g-ne,D-Ze,g-ne,D),Bn(g-ne,D+Ze,g-Ge,D+ye,g,D+ye),Bn(g+Ge,D+ye,g+ne,D+Ze,g+ne,D),Ws(Ee),this},u.__private__.circle=u.circle=function(g,D,ne,ye){if(isNaN(g)||isNaN(D)||isNaN(ne)||!Ir(ye))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(g,D,ne,ne,ye)},u.setFont=function(g,D,ne){return ne&&(D=K(D,ne)),ot=Wt(g,D,{disableWarning:!1}),this};var hi=u.__private__.getFont=u.getFont=function(){return Lt[Wt.apply(u,arguments)]};u.__private__.getFontList=u.getFontList=function(){var g,D,ne={};for(g in zt)if(zt.hasOwnProperty(g))for(D in ne[g]=[],zt[g])zt[g].hasOwnProperty(D)&&ne[g].push(D);return ne},u.addFont=function(g,D,ne,ye,Ee){var Ge=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ge.indexOf(arguments[3])!==-1?Ee=arguments[3]:arguments[3]&&Ge.indexOf(arguments[3])==-1&&(ne=K(ne,ye)),rt.call(this,g,D,ne,Ee=Ee||"Identity-H")};var ks,Wa=t.lineWidth||.200025,fi=u.__private__.getLineWidth=u.getLineWidth=function(){return Wa},Ht=u.__private__.setLineWidth=u.setLineWidth=function(g){return Wa=g,T(H(R(g))+" w"),this};u.__private__.setLineDash=Mt.API.setLineDash=Mt.API.setLineDashPattern=function(g,D){if(g=g||[],D=D||0,isNaN(D)||!Array.isArray(g))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return g=g.map(function(ne){return H(R(ne))}).join(" "),D=H(R(D)),T("["+g+"] "+D+" d"),this};var pi=u.__private__.getLineHeight=u.getLineHeight=function(){return M*ks};u.__private__.getLineHeight=u.getLineHeight=function(){return M*ks};var mi=u.__private__.setLineHeightFactor=u.setLineHeightFactor=function(g){return typeof(g=g||1.15)=="number"&&(ks=g),this},$i=u.__private__.getLineHeightFactor=u.getLineHeightFactor=function(){return ks};mi(t.lineHeight);var As=u.__private__.getHorizontalCoordinate=function(g){return R(g)},bs=u.__private__.getVerticalCoordinate=function(g){return E===L?g:xt[G].mediaBox.topRightY-xt[G].mediaBox.bottomLeftY-R(g)},Wi=u.__private__.getHorizontalCoordinateString=u.getHorizontalCoordinateString=function(g){return H(As(g))},Hi=u.__private__.getVerticalCoordinateString=u.getVerticalCoordinateString=function(g){return H(bs(g))},na=t.strokeColor||"0 G";u.__private__.getStrokeColor=u.getDrawColor=function(){return tn(na)},u.__private__.setStrokeColor=u.setDrawColor=function(g,D,ne,ye){return na=kn({ch1:g,ch2:D,ch3:ne,ch4:ye,pdfColorType:"draw",precision:2}),T(na),this};var ja=t.fillColor||"0 g";u.__private__.getFillColor=u.getFillColor=function(){return tn(ja)},u.__private__.setFillColor=u.setFillColor=function(g,D,ne,ye){return ja=kn({ch1:g,ch2:D,ch3:ne,ch4:ye,pdfColorType:"fill",precision:2}),T(ja),this};var sa=t.textColor||"0 g",Gi=u.__private__.getTextColor=u.getTextColor=function(){return tn(sa)};u.__private__.setTextColor=u.setTextColor=function(g,D,ne,ye){return sa=kn({ch1:g,ch2:D,ch3:ne,ch4:ye,pdfColorType:"text",precision:3}),this};var ws=t.charSpace,Vi=u.__private__.getCharSpace=u.getCharSpace=function(){return parseFloat(ws||0)};u.__private__.setCharSpace=u.setCharSpace=function(g){if(isNaN(g))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return ws=g,this};var Ha=0;u.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},u.__private__.setLineCap=u.setLineCap=function(g){var D=u.CapJoinStyles[g];if(D===void 0)throw new Error("Line cap style of '"+g+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ha=D,T(D+" J"),this};var Ga=0;u.__private__.setLineJoin=u.setLineJoin=function(g){var D=u.CapJoinStyles[g];if(D===void 0)throw new Error("Line join style of '"+g+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ga=D,T(D+" j"),this},u.__private__.setLineMiterLimit=u.__private__.setMiterLimit=u.setLineMiterLimit=u.setMiterLimit=function(g){if(g=g||0,isNaN(g))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return T(H(R(g))+" M"),this},u.GState=yl,u.setGState=function(g){(g=typeof g=="string"?Nt[Ft[g]]:gi(null,g)).equals(ar)||(T("/"+g.id+" gs"),ar=g)};var gi=function(g,D){if(!g||!Ft[g]){var ne=!1;for(var ye in Nt)if(Nt.hasOwnProperty(ye)&&Nt[ye].equals(D)){ne=!0;break}if(ne)D=Nt[ye];else{var Ee="GS"+(Object.keys(Nt).length+1).toString(10);Nt[Ee]=D,D.id=Ee}return g&&(Ft[g]=D.id),Xt.publish("addGState",D),D}};u.addGState=function(g,D){return gi(g,D),this},u.saveGraphicsState=function(){return T("q"),Et.push({key:ot,size:M,color:sa}),this},u.restoreGraphicsState=function(){T("Q");var g=Et.pop();return ot=g.key,M=g.size,sa=g.color,ar=null,this},u.setCurrentTransformationMatrix=function(g){return T(g.toString()+" cm"),this},u.comment=function(g){return T("#"+g),this};var Gn=function(g,D){var ne=g||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ne},set:function(Ge){isNaN(Ge)||(ne=parseFloat(Ge))}});var ye=D||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return ye},set:function(Ge){isNaN(Ge)||(ye=parseFloat(Ge))}});var Ee="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ee},set:function(Ge){Ee=Ge.toString()}}),this},Va=function(g,D,ne,ye){Gn.call(this,g,D),this.type="rect";var Ee=ne||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ee},set:function(Ze){isNaN(Ze)||(Ee=parseFloat(Ze))}});var Ge=ye||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ge},set:function(Ze){isNaN(Ze)||(Ge=parseFloat(Ze))}}),this},aa=function(){this.page=Ot,this.currentPage=G,this.pages=Me.slice(0),this.pagesContext=xt.slice(0),this.x=dt,this.y=Vt,this.matrix=mt,this.width=Ka(G),this.height=xi(G),this.outputDestination=je,this.id="",this.objectNumber=-1};aa.prototype.restore=function(){Ot=this.page,G=this.currentPage,xt=this.pagesContext,Me=this.pages,dt=this.x,Vt=this.y,mt=this.matrix,Sa(G,this.width),Cs(G,this.height),je=this.outputDestination};var Ya=function(g,D,ne,ye,Ee){fn.push(new aa),Ot=G=0,Me=[],dt=g,Vt=D,mt=Ee,At([ne,ye])};for(var ia in u.beginFormObject=function(g,D,ne,ye,Ee){return Ya(g,D,ne,ye,Ee),this},u.endFormObject=function(g){return(function(D){if(bn[D])fn.pop().restore();else{var ne=new aa,ye="Xo"+(Object.keys(Or).length+1).toString(10);ne.id=ye,bn[D]=ye,Or[ye]=ne,Xt.publish("addFormObject",ne),fn.pop().restore()}})(g),this},u.doFormObject=function(g,D){var ne=Or[bn[g]];return T("q"),T(D.toString()+" cm"),T("/"+ne.id+" Do"),T("Q"),this},u.getFormObject=function(g){var D=Or[bn[g]];return{x:D.x,y:D.y,width:D.width,height:D.height,matrix:D.matrix}},u.save=function(g,D){return g=g||"generated.pdf",(D=D||{}).returnPromise=D.returnPromise||!1,D.returnPromise===!1?(ei(ur(ft()),g),typeof ei.unload=="function"&&Gt.setTimeout&&setTimeout(ei.unload,911),this):new Promise(function(ne,ye){try{var Ee=ei(ur(ft()),g);typeof ei.unload=="function"&&Gt.setTimeout&&setTimeout(ei.unload,911),ne(Ee)}catch(Ge){ye(Ge.message)}})},Mt.API)Mt.API.hasOwnProperty(ia)&&(ia==="events"&&Mt.API.events.length?(function(g,D){var ne,ye,Ee;for(Ee=D.length-1;Ee!==-1;Ee--)ne=D[Ee][0],ye=D[Ee][1],g.subscribe.apply(g,[ne].concat(typeof ye=="function"?[ye]:ye))})(Xt,Mt.API.events):u[ia]=Mt.API[ia]);function Ka(g){return xt[g].mediaBox.topRightX-xt[g].mediaBox.bottomLeftX}function Sa(g,D){xt[g].mediaBox.topRightX=D+xt[g].mediaBox.bottomLeftX}function xi(g){return xt[g].mediaBox.topRightY-xt[g].mediaBox.bottomLeftY}function Cs(g,D){xt[g].mediaBox.topRightY=D+xt[g].mediaBox.bottomLeftY}var Ls=u.getPageWidth=function(g){return Ka(g=g||G)/yt},yi=u.setPageWidth=function(g,D){Sa(g,D*yt)},ts=u.getPageHeight=function(g){return xi(g=g||G)/yt},bi=u.setPageHeight=function(g,D){Cs(g,D*yt)};return u.internal={pdfEscape:it,getStyle:va,getFont:hi,getFontSize:pe,getCharSpace:Vi,getTextColor:Gi,getLineHeight:pi,getLineHeightFactor:$i,getLineWidth:fi,write:V,getHorizontalCoordinate:As,getVerticalCoordinate:bs,getCoordinateString:Wi,getVerticalCoordinateString:Hi,collections:{},newObject:gr,newAdditionalObject:es,newObjectDeferred:Cr,newObjectDeferredBegin:dr,getFilters:$r,putStream:Yr,events:Xt,scaleFactor:yt,pageSize:{getWidth:function(){return Ls(G)},setWidth:function(g){yi(G,g)},getHeight:function(){return ts(G)},setHeight:function(g){bi(G,g)}},encryptionOptions:p,encryption:Lr,getEncryptor:function(g){return p!==null?Lr.encryptor(g,0):function(D){return D}},output:Wr,getNumberOfPages:gt,get pages(){return Me},out:T,f2:I,f3:S,getPageInfo:Hn,getPageInfoByObjId:ba,getCurrentPageInfo:Jr,getPDFVersion:x,Point:Gn,Rectangle:Va,Matrix:Ut,hasHotfix:Mr},Object.defineProperty(u.internal.pageSize,"width",{get:function(){return Ls(G)},set:function(g){yi(G,g)},enumerable:!0,configurable:!0}),Object.defineProperty(u.internal.pageSize,"height",{get:function(){return ts(G)},set:function(g){bi(G,g)},enumerable:!0,configurable:!0}),(function(g){for(var D=0,ne=z.length;D<ne;D++){var ye=rt.call(this,g[D][0],g[D][1],g[D][2],z[D][3],!0);b===!1&&(m[ye]=!0);var Ee=g[D][0].split("-");tt({id:ye,fontName:Ee[0],fontStyle:Ee[1]||""})}Xt.publish("addFonts",{fonts:Lt,dictionary:zt})}).call(u,z),ot="F1",_t(s,e),Xt.publish("initialized"),u}Ci.prototype.lsbFirstWord=function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)},Ci.prototype.toHexString=function(t){return t.split("").map(function(r){return("0"+(255&r.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Ci.prototype.hexToBytes=function(t){for(var r=[],e=0;e<t.length;e+=2)r.push(String.fromCharCode(parseInt(t.substr(e,2),16)));return r.join("")},Ci.prototype.processOwnerPassword=function(t,r){return Ec(Lc(r).substr(0,5),t)},Ci.prototype.encryptor=function(t,r){var e=Lc(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&r,r>>8&255)).substr(0,10);return function(a){return Ec(e,a)}},yl.prototype.equals=function(t){var r,e="id,objectNumber,equals";if(!t||kr(t)!==kr(this))return!1;var a=0;for(r in this)if(!(e.indexOf(r)>=0)){if(this.hasOwnProperty(r)&&!t.hasOwnProperty(r)||this[r]!==t[r])return!1;a++}for(r in t)t.hasOwnProperty(r)&&e.indexOf(r)<0&&a--;return a===0},Mt.API={events:[]},Mt.version="4.0.0";var en=Mt.API,Xc=1,ci=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Si=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Zt=function(t){return t.toFixed(2)},Ua=function(t){return t.toFixed(5)};en.__acroform__={};var Qn=function(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t},Wu=function(t){return t*Xc},Js=function(t){var r=new Kf,e=Ct.internal.getHeight(t)||0,a=Ct.internal.getWidth(t)||0;return r.BBox=[0,0,Number(Zt(a)),Number(Zt(e))],r},o2=en.__acroform__.setBit=function(t,r){if(t=t||0,r=r||0,isNaN(t)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|1<<r},l2=en.__acroform__.clearBit=function(t,r){if(t=t||0,r=r||0,isNaN(t)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&~(1<<r)},c2=en.__acroform__.getBit=function(t,r){if(isNaN(t)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return t&1<<r?1:0},dn=en.__acroform__.getBitForPdf=function(t,r){if(isNaN(t)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return c2(t,r-1)},un=en.__acroform__.setBitForPdf=function(t,r){if(isNaN(t)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return o2(t,r-1)},hn=en.__acroform__.clearBitForPdf=function(t,r){if(isNaN(t)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return l2(t,r-1)},d2=en.__acroform__.calculateCoordinates=function(t,r){var e=r.internal.getHorizontalCoordinate,a=r.internal.getVerticalCoordinate,s=t[0],i=t[1],c=t[2],o=t[3],d={};return d.lowerLeft_X=e(s)||0,d.lowerLeft_Y=a(i+o)||0,d.upperRight_X=e(s+c)||0,d.upperRight_Y=a(i)||0,[Number(Zt(d.lowerLeft_X)),Number(Zt(d.lowerLeft_Y)),Number(Zt(d.upperRight_X)),Number(Zt(d.upperRight_Y))]},u2=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var r=[],e=t._V||t.DV,a=Pc(t,e),s=t.scope.internal.getFont(t.fontName,t.fontStyle).id;r.push("/Tx BMC"),r.push("q"),r.push("BT"),r.push(t.scope.__private__.encodeColorString(t.color)),r.push("/"+s+" "+Zt(a.fontSize)+" Tf"),r.push("1 0 0 1 0 0 Tm"),r.push(a.text),r.push("ET"),r.push("Q"),r.push("EMC");var i=Js(t);return i.scope=t.scope,i.stream=r.join(`
`),i}},Pc=function(t,r){var e=t.fontSize===0?t.maxFontSize:t.fontSize,a={text:"",fontSize:""},s=(r=(r=r.substr(0,1)=="("?r.substr(1):r).substr(r.length-1)==")"?r.substr(0,r.length-1):r).split(" ");s=t.multiline?s.map(function(I){return I.split(`
`)}):s.map(function(I){return[I]});var i=e,c=Ct.internal.getHeight(t)||0;c=c<0?-c:c;var o=Ct.internal.getWidth(t)||0;o=o<0?-o:o;var d=function(I,S,R){if(I+1<s.length){var N=S+" "+s[I+1][0];return Zo(N,t,R).width<=o-4}return!1};i++;e:for(;i>0;){r="",i--;var h,p,b=Zo("3",t,i).height,m=t.multiline?c-i:(c-b)/2,u=m+=2,w=0,x=0,_=0;if(i<=0){r=`(...) Tj
`,r+="% Width of Text: "+Zo(r,t,i=12).width+", FieldWidth:"+o+`
`;break}for(var y="",A=0,L=0;L<s.length;L++)if(s.hasOwnProperty(L)){var E=!1;if(s[L].length!==1&&_!==s[L].length-1){if((b+2)*(A+2)+2>c)continue e;y+=s[L][_],E=!0,x=L,L--}else{y=(y+=s[L][_]+" ").substr(y.length-1)==" "?y.substr(0,y.length-1):y;var O=parseInt(L),X=d(O,y,i),K=L>=s.length-1;if(X&&!K){y+=" ",_=0;continue}if(X||K){if(K)x=O;else if(t.multiline&&(b+2)*(A+2)+2>c)continue e}else{if(!t.multiline||(b+2)*(A+2)+2>c)continue e;x=O}}for(var H="",P=w;P<=x;P++){var Y=s[P];if(t.multiline){if(P===x){H+=Y[_]+" ",_=(_+1)%Y.length;continue}if(P===w){H+=Y[Y.length-1]+" ";continue}}H+=Y[0]+" "}switch(H=H.substr(H.length-1)==" "?H.substr(0,H.length-1):H,p=Zo(H,t,i).width,t.textAlign){case"right":h=o-p-2;break;case"center":h=(o-p)/2;break;default:h=2}r+=Zt(h)+" "+Zt(u)+` Td
`,r+="("+ci(H)+`) Tj
`,r+=-Zt(h)+` 0 Td
`,u=-(i+2),p=0,w=E?x:x+1,A++,y=""}break}return a.text=r,a.fontSize=i,a},Zo=function(t,r,e){var a=r.scope.internal.getFont(r.fontName,r.fontStyle),s=r.scope.getStringUnitWidth(t,{font:a,fontSize:parseFloat(e),charSpace:0})*parseFloat(e);return{height:r.scope.getStringUnitWidth("3",{font:a,fontSize:parseFloat(e),charSpace:0})*parseFloat(e)*1.5,width:s}},h2={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},f2=function(t,r){var e={type:"reference",object:t};r.internal.getPageInfo(t.page).pageContext.annotations.find(function(a){return a.type===e.type&&a.object===e.object})===void 0&&r.internal.getPageInfo(t.page).pageContext.annotations.push(e)},p2=function(t,r){if(r.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(zs.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(h2)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Xc=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new Jf,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(e){e.internal.events.unsubscribe(e.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete e.internal.acroformPlugin.acroFormDictionaryRoot._eventID,e.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(e){e.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var a=e.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in a)if(a.hasOwnProperty(s)){var i=a[s];i.objId=void 0,i.hasAnnotation&&f2(i,e)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(e){if(e.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");e.internal.write("/AcroForm "+e.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(e){(function(a,s){var i=!a;for(var c in a||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),a=a||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(a.hasOwnProperty(c)){var o=a[c],d=[],h=o.Rect;if(o.Rect&&(o.Rect=d2(o.Rect,s)),s.internal.newObjectDeferredBegin(o.objId,!0),o.DA=Ct.createDefaultAppearanceStream(o),kr(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(d=o.getKeyValueListForStream()),o.Rect=h,o.hasAppearanceStream&&!o.appearanceStreamContent){var p=u2(o);d.push({key:"AP",value:"<</N "+p+">>"}),s.internal.acroformPlugin.xForms.push(p)}if(o.appearanceStreamContent){var b="";for(var m in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(m)){var u=o.appearanceStreamContent[m];if(b+="/"+m+" ",b+="<<",Object.keys(u).length>=1||Array.isArray(u)){for(var c in u)if(u.hasOwnProperty(c)){var w=u[c];typeof w=="function"&&(w=w.call(s,o)),b+="/"+c+" "+w+" ",s.internal.acroformPlugin.xForms.indexOf(w)>=0||s.internal.acroformPlugin.xForms.push(w)}}else typeof(w=u)=="function"&&(w=w.call(s,o)),b+="/"+c+" "+w,s.internal.acroformPlugin.xForms.indexOf(w)>=0||s.internal.acroformPlugin.xForms.push(w);b+=">>"}d.push({key:"AP",value:`<<
`+b+">>"})}s.internal.putStream({additionalKeyValues:d,objectId:o.objId}),s.internal.out("endobj")}i&&(function(x,_){for(var y in x)if(x.hasOwnProperty(y)){var A=y,L=x[y];_.internal.newObjectDeferredBegin(L.objId,!0),kr(L)==="object"&&typeof L.putStream=="function"&&L.putStream(),delete x[A]}})(s.internal.acroformPlugin.xForms,s)})(e,t)}),t.internal.acroformPlugin.isInitialized=!0}},Yf=en.__acroform__.arrayToPdfArray=function(t,r,e){var a=function(c){return c};if(Array.isArray(t)){for(var s="[",i=0;i<t.length;i++)switch(i!==0&&(s+=" "),kr(t[i])){case"boolean":case"number":case"object":s+=t[i].toString();break;case"string":t[i].substr(0,1)!=="/"?(r!==void 0&&e&&(a=e.internal.getEncryptor(r)),s+="("+ci(a(t[i].toString()))+")"):s+=t[i].toString()}return s+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},uc=function(t,r,e){var a=function(s){return s};return r!==void 0&&e&&(a=e.internal.getEncryptor(r)),(t=t||"").toString(),"("+ci(a(t))+")"},Qs=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Qs.prototype.toString=function(){return this.objId+" 0 R"},Qs.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},Qs.prototype.getKeyValueListForStream=function(){var t=[],r=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var e in r)if(Object.getOwnPropertyDescriptor(this,r[e]).configurable===!1){var a=r[e],s=this[a];s&&(Array.isArray(s)?t.push({key:a,value:Yf(s,this.objId,this.scope)}):s instanceof Qs?(s.scope=this.scope,t.push({key:a,value:s.objId+" 0 R"})):typeof s!="function"&&t.push({key:a,value:s}))}return t};var Kf=function(){Qs.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,r=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(e){t=e.trim()},get:function(){return t||null}})};Qn(Kf,Qs);var Jf=function(){Qs.call(this);var t,r=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return r.length>0?r:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return r}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var e=function(a){return a};return this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),"("+ci(e(t))+")"}},set:function(e){t=e}})};Qn(Jf,Qs);var zs=function t(){Qs.call(this);var r=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return r},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute F supplied.');r=y}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!dn(r,3)},set:function(y){y?this.F=un(r,3):this.F=hn(r,3)}});var e=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return e},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute Ff supplied.');e=y}});var a=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(a.length!==0)return a},set:function(y){a=y!==void 0?y:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[0])?0:a[0]},set:function(y){a[0]=y}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[1])?0:a[1]},set:function(y){a[1]=y}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[2])?0:a[2]},set:function(y){a[2]=y}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[3])?0:a[3]},set:function(y){a[3]=y}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(y){switch(y){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=y;break;default:throw new Error('Invalid value "'+y+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof bl)return;i="FieldObject"+t.FieldNum++}var y=function(A){return A};return this.scope&&(y=this.scope.internal.getEncryptor(this.objId)),"("+ci(y(i))+")"},set:function(y){i=y.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(y){i=y}});var c="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return c},set:function(y){c=y}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(y){o=y}});var d=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return d},set:function(y){d=y}});var h=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return h===void 0?50/Xc:h},set:function(y){h=y}});var p="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return p},set:function(y){p=y}});var b="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!b||this instanceof bl||this instanceof si))return uc(b,this.objId,this.scope)},set:function(y){y=y.toString(),b=y}});var m=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof jn==0?uc(m,this.objId,this.scope):m},set:function(y){y=y.toString(),m=this instanceof jn==0?y.substr(0,1)==="("?Si(y.substr(1,y.length-2)):Si(y):y}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof jn==1?Si(m.substr(1,m.length-1)):m},set:function(y){y=y.toString(),m=this instanceof jn==1?"/"+y:y}});var u=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(u)return u},set:function(y){this.V=y}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(u)return this instanceof jn==0?uc(u,this.objId,this.scope):u},set:function(y){y=y.toString(),u=this instanceof jn==0?y.substr(0,1)==="("?Si(y.substr(1,y.length-2)):Si(y):y}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof jn==1?Si(u.substr(1,u.length-1)):u},set:function(y){y=y.toString(),u=this instanceof jn==1?"/"+y:y}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var w,x=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return x},set:function(y){y=!!y,x=y}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(w)return w},set:function(y){w=y}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,1)},set:function(y){y?this.Ff=un(this.Ff,1):this.Ff=hn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,2)},set:function(y){y?this.Ff=un(this.Ff,2):this.Ff=hn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,3)},set:function(y){y?this.Ff=un(this.Ff,3):this.Ff=hn(this.Ff,3)}});var _=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(_!==null)return _},set:function(y){if([0,1,2].indexOf(y)===-1)throw new Error('Invalid value "'+y+'" for attribute Q supplied.');_=y}}),Object.defineProperty(this,"textAlign",{get:function(){var y;switch(_){case 0:default:y="left";break;case 1:y="center";break;case 2:y="right"}return y},configurable:!0,enumerable:!0,set:function(y){switch(y){case"right":case 2:_=2;break;case"center":case 1:_=1;break;default:_=0}}})};Qn(zs,Qs);var Oi=function(){zs.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){t=e}});var r=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Yf(r,this.objId,this.scope)},set:function(e){var a,s;s=[],typeof(a=e)=="string"&&(s=(function(i,c,o){o||(o=1);for(var d,h=[];d=c.exec(i);)h.push(d[o]);return h})(a,/\((.*?)\)/g)),r=s}}),this.getOptions=function(){return r},this.setOptions=function(e){r=e,this.sort&&r.sort()},this.addOption=function(e){e=(e=e||"").toString(),r.push(e),this.sort&&r.sort()},this.removeOption=function(e,a){for(a=a||!1,e=(e=e||"").toString();r.indexOf(e)!==-1&&(r.splice(r.indexOf(e),1),a!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,18)},set:function(e){e?this.Ff=un(this.Ff,18):this.Ff=hn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,19)},set:function(e){this.combo===!0&&(e?this.Ff=un(this.Ff,19):this.Ff=hn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,20)},set:function(e){e?(this.Ff=un(this.Ff,20),r.sort()):this.Ff=hn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,22)},set:function(e){e?this.Ff=un(this.Ff,22):this.Ff=hn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,23)},set:function(e){e?this.Ff=un(this.Ff,23):this.Ff=hn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,27)},set:function(e){e?this.Ff=un(this.Ff,27):this.Ff=hn(this.Ff,27)}}),this.hasAppearanceStream=!1};Qn(Oi,zs);var Di=function(){Oi.call(this),this.fontName="helvetica",this.combo=!1};Qn(Di,Oi);var Ri=function(){Di.call(this),this.combo=!0};Qn(Ri,Di);var al=function(){Ri.call(this),this.edit=!0};Qn(al,Ri);var jn=function(){zs.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,15)},set:function(e){e?this.Ff=un(this.Ff,15):this.Ff=hn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,16)},set:function(e){e?this.Ff=un(this.Ff,16):this.Ff=hn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,17)},set:function(e){e?this.Ff=un(this.Ff,17):this.Ff=hn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,26)},set:function(e){e?this.Ff=un(this.Ff,26):this.Ff=hn(this.Ff,26)}});var t,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(i){return i};if(this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),Object.keys(r).length!==0){var a,s=[];for(a in s.push("<<"),r)s.push("/"+a+" ("+ci(e(r[a]))+")");return s.push(">>"),s.join(`
`)}},set:function(e){kr(e)==="object"&&(r=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(e){typeof e=="string"&&(r.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(e){t="/"+e}})};Qn(jn,zs);var il=function(){jn.call(this),this.pushButton=!0};Qn(il,jn);var Bi=function(){jn.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r!==void 0?r:[]}})};Qn(Bi,jn);var bl=function(){var t,r;zs.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(s){t=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return r},set:function(s){r=s}});var e,a={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(o){return o};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var i,c=[];for(i in c.push("<<"),a)c.push("/"+i+" ("+ci(s(a[i]))+")");return c.push(">>"),c.join(`
`)},set:function(s){kr(s)==="object"&&(a=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return a.CA||""},set:function(s){typeof s=="string"&&(a.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(s){e=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(s){e="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Ct.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Qn(bl,zs),Bi.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var r in this.Kids)if(this.Kids.hasOwnProperty(r)){var e=this.Kids[r];e.appearanceStreamContent=t.createAppearanceStream(e.optionName),e.caption=t.getCA()}},Bi.prototype.createOption=function(t){var r=new bl;return r.Parent=this,r.optionName=t,this.Kids.push(r),m2.call(this.scope,r),r};var ol=function(){jn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Ct.CheckBox.createAppearanceStream()};Qn(ol,jn);var si=function(){zs.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,13)},set:function(r){r?this.Ff=un(this.Ff,13):this.Ff=hn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,21)},set:function(r){r?this.Ff=un(this.Ff,21):this.Ff=hn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,23)},set:function(r){r?this.Ff=un(this.Ff,23):this.Ff=hn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,24)},set:function(r){r?this.Ff=un(this.Ff,24):this.Ff=hn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,25)},set:function(r){r?this.Ff=un(this.Ff,25):this.Ff=hn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,26)},set:function(r){r?this.Ff=un(this.Ff,26):this.Ff=hn(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){Number.isInteger(r)&&(t=r)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Qn(si,zs);var ll=function(){si.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!dn(this.Ff,14)},set:function(t){t?this.Ff=un(this.Ff,14):this.Ff=hn(this.Ff,14)}}),this.password=!0};Qn(ll,si);var Ct={CheckBox:{createAppearanceStream:function(){return{N:{On:Ct.CheckBox.YesNormal},D:{On:Ct.CheckBox.YesPushDown,Off:Ct.CheckBox.OffPushDown}}},YesPushDown:function(t){var r=Js(t);r.scope=t.scope;var e=[],a=t.scope.internal.getFont(t.fontName,t.fontStyle).id,s=t.scope.__private__.encodeColorString(t.color),i=Pc(t,t.caption);return e.push("0.749023 g"),e.push("0 0 "+Zt(Ct.internal.getWidth(t))+" "+Zt(Ct.internal.getHeight(t))+" re"),e.push("f"),e.push("BMC"),e.push("q"),e.push("0 0 1 rg"),e.push("/"+a+" "+Zt(i.fontSize)+" Tf "+s),e.push("BT"),e.push(i.text),e.push("ET"),e.push("Q"),e.push("EMC"),r.stream=e.join(`
`),r},YesNormal:function(t){var r=Js(t);r.scope=t.scope;var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,a=t.scope.__private__.encodeColorString(t.color),s=[],i=Ct.internal.getHeight(t),c=Ct.internal.getWidth(t),o=Pc(t,t.caption);return s.push("1 g"),s.push("0 0 "+Zt(c)+" "+Zt(i)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+Zt(c-1)+" "+Zt(i-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+e+" "+Zt(o.fontSize)+" Tf "+a),s.push(o.text),s.push("ET"),s.push("Q"),r.stream=s.join(`
`),r},OffPushDown:function(t){var r=Js(t);r.scope=t.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+Zt(Ct.internal.getWidth(t))+" "+Zt(Ct.internal.getHeight(t))+" re"),e.push("f"),r.stream=e.join(`
`),r}},RadioButton:{Circle:{createAppearanceStream:function(t){var r={D:{Off:Ct.RadioButton.Circle.OffPushDown},N:{}};return r.N[t]=Ct.RadioButton.Circle.YesNormal,r.D[t]=Ct.RadioButton.Circle.YesPushDown,r},getCA:function(){return"l"},YesNormal:function(t){var r=Js(t);r.scope=t.scope;var e=[],a=Ct.internal.getWidth(t)<=Ct.internal.getHeight(t)?Ct.internal.getWidth(t)/4:Ct.internal.getHeight(t)/4;a=Number((.9*a).toFixed(5));var s=Ct.internal.Bezier_C,i=Number((a*s).toFixed(5));return e.push("q"),e.push("1 0 0 1 "+Ua(Ct.internal.getWidth(t)/2)+" "+Ua(Ct.internal.getHeight(t)/2)+" cm"),e.push(a+" 0 m"),e.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),e.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),e.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),e.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),e.push("f"),e.push("Q"),r.stream=e.join(`
`),r},YesPushDown:function(t){var r=Js(t);r.scope=t.scope;var e=[],a=Ct.internal.getWidth(t)<=Ct.internal.getHeight(t)?Ct.internal.getWidth(t)/4:Ct.internal.getHeight(t)/4;a=Number((.9*a).toFixed(5));var s=Number((2*a).toFixed(5)),i=Number((s*Ct.internal.Bezier_C).toFixed(5)),c=Number((a*Ct.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+Ua(Ct.internal.getWidth(t)/2)+" "+Ua(Ct.internal.getHeight(t)/2)+" cm"),e.push(s+" 0 m"),e.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),e.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),e.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),e.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),e.push("f"),e.push("Q"),e.push("0 g"),e.push("q"),e.push("1 0 0 1 "+Ua(Ct.internal.getWidth(t)/2)+" "+Ua(Ct.internal.getHeight(t)/2)+" cm"),e.push(a+" 0 m"),e.push(a+" "+c+" "+c+" "+a+" 0 "+a+" c"),e.push("-"+c+" "+a+" -"+a+" "+c+" -"+a+" 0 c"),e.push("-"+a+" -"+c+" -"+c+" -"+a+" 0 -"+a+" c"),e.push(c+" -"+a+" "+a+" -"+c+" "+a+" 0 c"),e.push("f"),e.push("Q"),r.stream=e.join(`
`),r},OffPushDown:function(t){var r=Js(t);r.scope=t.scope;var e=[],a=Ct.internal.getWidth(t)<=Ct.internal.getHeight(t)?Ct.internal.getWidth(t)/4:Ct.internal.getHeight(t)/4;a=Number((.9*a).toFixed(5));var s=Number((2*a).toFixed(5)),i=Number((s*Ct.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+Ua(Ct.internal.getWidth(t)/2)+" "+Ua(Ct.internal.getHeight(t)/2)+" cm"),e.push(s+" 0 m"),e.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),e.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),e.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),e.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),e.push("f"),e.push("Q"),r.stream=e.join(`
`),r}},Cross:{createAppearanceStream:function(t){var r={D:{Off:Ct.RadioButton.Cross.OffPushDown},N:{}};return r.N[t]=Ct.RadioButton.Cross.YesNormal,r.D[t]=Ct.RadioButton.Cross.YesPushDown,r},getCA:function(){return"8"},YesNormal:function(t){var r=Js(t);r.scope=t.scope;var e=[],a=Ct.internal.calculateCross(t);return e.push("q"),e.push("1 1 "+Zt(Ct.internal.getWidth(t)-2)+" "+Zt(Ct.internal.getHeight(t)-2)+" re"),e.push("W"),e.push("n"),e.push(Zt(a.x1.x)+" "+Zt(a.x1.y)+" m"),e.push(Zt(a.x2.x)+" "+Zt(a.x2.y)+" l"),e.push(Zt(a.x4.x)+" "+Zt(a.x4.y)+" m"),e.push(Zt(a.x3.x)+" "+Zt(a.x3.y)+" l"),e.push("s"),e.push("Q"),r.stream=e.join(`
`),r},YesPushDown:function(t){var r=Js(t);r.scope=t.scope;var e=Ct.internal.calculateCross(t),a=[];return a.push("0.749023 g"),a.push("0 0 "+Zt(Ct.internal.getWidth(t))+" "+Zt(Ct.internal.getHeight(t))+" re"),a.push("f"),a.push("q"),a.push("1 1 "+Zt(Ct.internal.getWidth(t)-2)+" "+Zt(Ct.internal.getHeight(t)-2)+" re"),a.push("W"),a.push("n"),a.push(Zt(e.x1.x)+" "+Zt(e.x1.y)+" m"),a.push(Zt(e.x2.x)+" "+Zt(e.x2.y)+" l"),a.push(Zt(e.x4.x)+" "+Zt(e.x4.y)+" m"),a.push(Zt(e.x3.x)+" "+Zt(e.x3.y)+" l"),a.push("s"),a.push("Q"),r.stream=a.join(`
`),r},OffPushDown:function(t){var r=Js(t);r.scope=t.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+Zt(Ct.internal.getWidth(t))+" "+Zt(Ct.internal.getHeight(t))+" re"),e.push("f"),r.stream=e.join(`
`),r}}},createDefaultAppearanceStream:function(t){var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,e=t.scope.__private__.encodeColorString(t.color);return"/"+r+" "+t.fontSize+" Tf "+e}};Ct.internal={Bezier_C:.551915024494,calculateCross:function(t){var r=Ct.internal.getWidth(t),e=Ct.internal.getHeight(t),a=Math.min(r,e);return{x1:{x:(r-a)/2,y:(e-a)/2+a},x2:{x:(r-a)/2+a,y:(e-a)/2},x3:{x:(r-a)/2,y:(e-a)/2},x4:{x:(r-a)/2+a,y:(e-a)/2+a}}}},Ct.internal.getWidth=function(t){var r=0;return kr(t)==="object"&&(r=Wu(t.Rect[2])),r},Ct.internal.getHeight=function(t){var r=0;return kr(t)==="object"&&(r=Wu(t.Rect[3])),r};var m2=en.addField=function(t){if(p2(this,t),!(t instanceof zs))throw new Error("Invalid argument passed to jsPDF.addField.");var r;return(r=t).scope.internal.acroformPlugin.printedOut&&(r.scope.internal.acroformPlugin.printedOut=!1,r.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),r.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(r),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};en.AcroFormChoiceField=Oi,en.AcroFormListBox=Di,en.AcroFormComboBox=Ri,en.AcroFormEditBox=al,en.AcroFormButton=jn,en.AcroFormPushButton=il,en.AcroFormRadioButton=Bi,en.AcroFormCheckBox=ol,en.AcroFormTextField=si,en.AcroFormPasswordField=ll,en.AcroFormAppearance=Ct,en.AcroForm={ChoiceField:Oi,ListBox:Di,ComboBox:Ri,EditBox:al,Button:jn,PushButton:il,RadioButton:Bi,CheckBox:ol,TextField:si,PasswordField:ll,Appearance:Ct},Mt.AcroForm={ChoiceField:Oi,ListBox:Di,ComboBox:Ri,EditBox:al,Button:jn,PushButton:il,RadioButton:Bi,CheckBox:ol,TextField:si,PasswordField:ll,Appearance:Ct};Mt.AcroForm;function Zf(t){return t.reduce(function(r,e,a){return r[e]=a,r},{})}(function(t){var r="addImage_";t.__addimage__={};var e="UNKNOWN",a={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=t.__addimage__.getImageFileTypeByImageData=function(I,S){var R,N,re,ve,le,oe=e;if((S=S||e)==="RGBA"||I.data!==void 0&&I.data instanceof Uint8ClampedArray&&"height"in I&&"width"in I)return"RGBA";if(X(I))for(le in a)for(re=a[le],R=0;R<re.length;R+=1){for(ve=!0,N=0;N<re[R].length;N+=1)if(re[R][N]!==void 0&&re[R][N]!==I[N]){ve=!1;break}if(ve===!0){oe=le;break}}else for(le in a)for(re=a[le],R=0;R<re.length;R+=1){for(ve=!0,N=0;N<re[R].length;N+=1)if(re[R][N]!==void 0&&re[R][N]!==I.charCodeAt(N)){ve=!1;break}if(ve===!0){oe=le;break}}return oe===e&&S!==e&&(oe=S),oe},i=function I(S){for(var R=this.internal.write,N=this.internal.putStream,re=(0,this.internal.getFilters)();re.indexOf("FlateEncode")!==-1;)re.splice(re.indexOf("FlateEncode"),1);S.objectId=this.internal.newObject();var ve=[];if(ve.push({key:"Type",value:"/XObject"}),ve.push({key:"Subtype",value:"/Image"}),ve.push({key:"Width",value:S.width}),ve.push({key:"Height",value:S.height}),S.colorSpace===y.INDEXED?ve.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(S.palette.length/3-1)+" "+("sMask"in S&&S.sMask!==void 0?S.objectId+2:S.objectId+1)+" 0 R]"}):(ve.push({key:"ColorSpace",value:"/"+S.colorSpace}),S.colorSpace===y.DEVICE_CMYK&&ve.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ve.push({key:"BitsPerComponent",value:S.bitsPerComponent}),"decodeParameters"in S&&S.decodeParameters!==void 0&&ve.push({key:"DecodeParms",value:"<<"+S.decodeParameters+">>"}),"transparency"in S&&Array.isArray(S.transparency)&&S.transparency.length>0){for(var le="",oe=0,ie=S.transparency.length;oe<ie;oe++)le+=S.transparency[oe]+" "+S.transparency[oe]+" ";ve.push({key:"Mask",value:"["+le+"]"})}S.sMask!==void 0&&ve.push({key:"SMask",value:S.objectId+1+" 0 R"});var Ae=S.filter!==void 0?["/"+S.filter]:void 0;if(N({data:S.data,additionalKeyValues:ve,alreadyAppliedFilters:Ae,objectId:S.objectId}),R("endobj"),"sMask"in S&&S.sMask!==void 0){var te,C=(te=S.sMaskBitsPerComponent)!==null&&te!==void 0?te:S.bitsPerComponent,G={width:S.width,height:S.height,colorSpace:"DeviceGray",bitsPerComponent:C,data:S.sMask};"filter"in S&&(G.decodeParameters="/Predictor ".concat(S.predictor," /Colors 1 /BitsPerComponent ").concat(C," /Columns ").concat(S.width),G.filter=S.filter),I.call(this,G)}if(S.colorSpace===y.INDEXED){var Z=this.internal.newObject();N({data:H(new Uint8Array(S.palette)),objectId:Z}),R("endobj")}},c=function(){var I=this.internal.collections[r+"images"];for(var S in I)i.call(this,I[S])},o=function(){var I,S=this.internal.collections[r+"images"],R=this.internal.write;for(var N in S)R("/I"+(I=S[N]).index,I.objectId,"0","R")},d=function(){this.internal.collections[r+"images"]||(this.internal.collections[r+"images"]={},this.internal.events.subscribe("putResources",c),this.internal.events.subscribe("putXobjectDict",o))},h=function(){var I=this.internal.collections[r+"images"];return d.call(this),I},p=function(){return Object.keys(this.internal.collections[r+"images"]).length},b=function(I){return typeof t["process"+I.toUpperCase()]=="function"},m=function(I){return kr(I)==="object"&&I.nodeType===1},u=function(I,S){if(I.nodeName==="IMG"&&I.hasAttribute("src")){var R=""+I.getAttribute("src");if(R.indexOf("data:image/")===0)return sl(unescape(R).split("base64,").pop());var N=t.loadFile(R,!0);if(N!==void 0)return N}if(I.nodeName==="CANVAS"){if(I.width===0||I.height===0)throw new Error("Given canvas must have data. Canvas width: "+I.width+", height: "+I.height);var re;switch(S){case"PNG":re="image/png";break;case"WEBP":re="image/webp";break;default:re="image/jpeg"}return sl(I.toDataURL(re,1).split("base64,").pop())}},w=function(I){var S=this.internal.collections[r+"images"];if(S){for(var R in S)if(I===S[R].alias)return S[R]}},x=function(I,S,R){return I||S||(I=-96,S=-96),I<0&&(I=-1*R.width*72/I/this.internal.scaleFactor),S<0&&(S=-1*R.height*72/S/this.internal.scaleFactor),I===0&&(I=S*R.width/R.height),S===0&&(S=I*R.height/R.width),[I,S]},_=function(I,S,R,N,re,ve){var le=x.call(this,R,N,re),oe=this.internal.getCoordinateString,ie=this.internal.getVerticalCoordinateString,Ae=h.call(this);if(R=le[0],N=le[1],Ae[re.index]=re,ve){ve*=Math.PI/180;var te=Math.cos(ve),C=Math.sin(ve),G=function(Q){return Q.toFixed(4)},Z=[G(te),G(C),G(-1*C),G(te),0,0,"cm"]}this.internal.write("q"),ve?(this.internal.write([1,"0","0",1,oe(I),ie(S+N),"cm"].join(" ")),this.internal.write(Z.join(" ")),this.internal.write([oe(R),"0","0",oe(N),"0","0","cm"].join(" "))):this.internal.write([oe(R),"0","0",oe(N),oe(I),ie(S+N),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+re.index+" Do"),this.internal.write("Q")},y=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var A=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},L=t.__addimage__.sHashCode=function(I){var S,R,N=0;if(typeof I=="string")for(R=I.length,S=0;S<R;S++)N=(N<<5)-N+I.charCodeAt(S),N|=0;else if(X(I))for(R=I.byteLength/2,S=0;S<R;S++)N=(N<<5)-N+I[S],N|=0;return N},E=t.__addimage__.validateStringAsBase64=function(I){(I=I||"").toString().trim();var S=!0;return I.length===0&&(S=!1),I.length%4!=0&&(S=!1),/^[A-Za-z0-9+/]+$/.test(I.substr(0,I.length-2))===!1&&(S=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(I.substr(-2))===!1&&(S=!1),S},O=t.__addimage__.extractImageFromDataUrl=function(I){if(I==null||!(I=I.trim()).startsWith("data:"))return null;var S=I.indexOf(",");return S<0?null:I.substring(0,S).trim().endsWith("base64")?I.substring(S+1):null};t.__addimage__.isArrayBuffer=function(I){return I instanceof ArrayBuffer};var X=t.__addimage__.isArrayBufferView=function(I){return I instanceof Int8Array||I instanceof Uint8Array||I instanceof Uint8ClampedArray||I instanceof Int16Array||I instanceof Uint16Array||I instanceof Int32Array||I instanceof Uint32Array||I instanceof Float32Array||I instanceof Float64Array},K=t.__addimage__.binaryStringToUint8Array=function(I){for(var S=I.length,R=new Uint8Array(S),N=0;N<S;N++)R[N]=I.charCodeAt(N);return R},H=t.__addimage__.arrayBufferToBinaryString=function(I){for(var S="",R=X(I)?I:new Uint8Array(I),N=0;N<R.length;N+=8192)S+=String.fromCharCode.apply(null,R.subarray(N,N+8192));return S};t.addImage=function(){var I,S,R,N,re,ve,le,oe,ie;if(typeof arguments[1]=="number"?(S=e,R=arguments[1],N=arguments[2],re=arguments[3],ve=arguments[4],le=arguments[5],oe=arguments[6],ie=arguments[7]):(S=arguments[1],R=arguments[2],N=arguments[3],re=arguments[4],ve=arguments[5],le=arguments[6],oe=arguments[7],ie=arguments[8]),kr(I=arguments[0])==="object"&&!m(I)&&"imageData"in I){var Ae=I;I=Ae.imageData,S=Ae.format||S||e,R=Ae.x||R||0,N=Ae.y||N||0,re=Ae.w||Ae.width||re,ve=Ae.h||Ae.height||ve,le=Ae.alias||le,oe=Ae.compression||oe,ie=Ae.rotation||Ae.angle||ie}var te=this.internal.getFilters();if(oe===void 0&&te.indexOf("FlateEncode")!==-1&&(oe="SLOW"),isNaN(R)||isNaN(N))throw new Error("Invalid coordinates passed to jsPDF.addImage");d.call(this);var C=P.call(this,I,S,le,oe);return _.call(this,R,N,re,ve,C,ie),this};var P=function(I,S,R,N){var re,ve,le;if(typeof I=="string"&&s(I)===e){I=unescape(I);var oe=Y(I,!1);(oe!==""||(oe=t.loadFile(I,!0))!==void 0)&&(I=oe)}if(m(I)&&(I=u(I,S)),S=s(I,S),!b(S))throw new Error("addImage does not support files of type '"+S+"', please ensure that a plugin for '"+S+"' support is added.");if(((le=R)==null||le.length===0)&&(R=(function(ie){return typeof ie=="string"||X(ie)?L(ie):X(ie.data)?L(ie.data):null})(I)),(re=w.call(this,R))||(I instanceof Uint8Array||S==="RGBA"||(ve=I,I=K(I)),re=this["process"+S.toUpperCase()](I,p.call(this),R,(function(ie){return ie&&typeof ie=="string"&&(ie=ie.toUpperCase()),ie in t.image_compression?ie:A.NONE})(N),ve)),!re)throw new Error("An unknown error occurred whilst processing the image.");return re},Y=t.__addimage__.convertBase64ToBinaryString=function(I,S){S=typeof S!="boolean"||S;var R,N="";if(typeof I=="string"){var re;R=(re=O(I))!==null&&re!==void 0?re:I;try{N=sl(R)}catch(ve){if(S)throw E(R)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ve.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return N};t.getImageProperties=function(I){var S,R,N="";if(m(I)&&(I=u(I)),typeof I=="string"&&s(I)===e&&((N=Y(I,!1))===""&&(N=t.loadFile(I)||""),I=N),R=s(I),!b(R))throw new Error("addImage does not support files of type '"+R+"', please ensure that a plugin for '"+R+"' support is added.");if(I instanceof Uint8Array||(I=K(I)),!(S=this["process"+R.toUpperCase()](I)))throw new Error("An unknown error occurred whilst processing the image");return S.fileType=R,S}})(Mt.API),(function(t){var r=function(e){if(e!==void 0&&e!="")return!0};Mt.API.events.push(["addPage",function(e){this.internal.getPageInfo(e.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(e){for(var a,s,i,c=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,d=this.internal.getPageInfoByObjId(e.objId),h=e.pageContext.annotations,p=!1,b=0;b<h.length&&!p;b++)switch((a=h[b]).type){case"link":(r(a.options.url)||r(a.options.pageNumber))&&(p=!0);break;case"reference":case"text":case"freetext":p=!0}if(p!=0){this.internal.write("/Annots [");for(var m=0;m<h.length;m++){a=h[m];var u=this.internal.pdfEscape,w=this.internal.getEncryptor(e.objId);switch(a.type){case"reference":this.internal.write(" "+a.object.objId+" 0 R ");break;case"text":var x=this.internal.newAdditionalObject(),_=this.internal.newAdditionalObject(),y=this.internal.getEncryptor(x.objId),A=a.title||"Note";i="<</Type /Annot /Subtype /Text "+(s="/Rect ["+c(a.bounds.x)+" "+o(a.bounds.y+a.bounds.h)+" "+c(a.bounds.x+a.bounds.w)+" "+o(a.bounds.y)+"] ")+"/Contents ("+u(y(a.contents))+")",i+=" /Popup "+_.objId+" 0 R",i+=" /P "+d.objId+" 0 R",i+=" /T ("+u(y(A))+") >>",x.content=i;var L=x.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+c(a.bounds.x+30)+" "+o(a.bounds.y+a.bounds.h)+" "+c(a.bounds.x+a.bounds.w+30)+" "+o(a.bounds.y)+"] ")+" /Parent "+L,a.open&&(i+=" /Open true"),i+=" >>",_.content=i,this.internal.write(x.objId,"0 R",_.objId,"0 R");break;case"freetext":s="/Rect ["+c(a.bounds.x)+" "+o(a.bounds.y)+" "+c(a.bounds.x+a.bounds.w)+" "+o(a.bounds.y+a.bounds.h)+"] ";var E=a.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+u(w(a.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+E+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(a.options.name){var O=this.annotations._nameMap[a.options.name];a.options.pageNumber=O.page,a.options.top=O.y}else a.options.top||(a.options.top=0);if(s="/Rect ["+a.finalBounds.x+" "+a.finalBounds.y+" "+a.finalBounds.w+" "+a.finalBounds.h+"] ",i="",a.options.url)i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+u(w(a.options.url))+") >>";else if(a.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(a.options.pageNumber).objId+" 0 R",a.options.magFactor=a.options.magFactor||"XYZ",a.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+a.options.top+"]";break;case"FitV":a.options.left=a.options.left||0,i+=" /FitV "+a.options.left+"]";break;default:var X=o(a.options.top);a.options.left=a.options.left||0,a.options.zoom===void 0&&(a.options.zoom=0),i+=" /XYZ "+a.options.left+" "+X+" "+a.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),t.createAnnotation=function(e){var a=this.internal.getCurrentPageInfo();switch(e.type){case"link":this.link(e.bounds.x,e.bounds.y,e.bounds.w,e.bounds.h,e);break;case"text":case"freetext":a.pageContext.annotations.push(e)}},t.link=function(e,a,s,i,c){var o=this.internal.getCurrentPageInfo(),d=this.internal.getCoordinateString,h=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:d(e),y:h(a),w:d(e+s),h:h(a+i)},options:c,type:"link"})},t.textWithLink=function(e,a,s,i){var c,o,d=this.getTextWidth(e),h=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){o=i.maxWidth;var p=this.splitTextToSize(e,o).length;c=Math.ceil(h*p)}else o=d,c=h;return this.text(e,a,s,i),s+=.2*h,i.align==="center"&&(a-=d/2),i.align==="right"&&(a-=d),this.link(a,s-h,o,c,i),d},t.getTextWidth=function(e){var a=this.internal.getFontSize();return this.getStringUnitWidth(e)*a/this.internal.scaleFactor}})(Mt.API),(function(t){var r={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},e={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},a={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];t.__arabicParser__={};var i=t.__arabicParser__.isInArabicSubstitutionA=function(x){return r[x.charCodeAt(0)]!==void 0},c=t.__arabicParser__.isArabicLetter=function(x){return typeof x=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(x)},o=t.__arabicParser__.isArabicEndLetter=function(x){return c(x)&&i(x)&&r[x.charCodeAt(0)].length<=2},d=t.__arabicParser__.isArabicAlfLetter=function(x){return c(x)&&s.indexOf(x.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(x){return c(x)&&i(x)&&r[x.charCodeAt(0)].length>=1};var h=t.__arabicParser__.arabicLetterHasFinalForm=function(x){return c(x)&&i(x)&&r[x.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(x){return c(x)&&i(x)&&r[x.charCodeAt(0)].length>=3};var p=t.__arabicParser__.arabicLetterHasMedialForm=function(x){return c(x)&&i(x)&&r[x.charCodeAt(0)].length==4},b=t.__arabicParser__.resolveLigatures=function(x){var _=0,y=e,A="",L=0;for(_=0;_<x.length;_+=1)y[x.charCodeAt(_)]!==void 0?(L++,typeof(y=y[x.charCodeAt(_)])=="number"&&(A+=String.fromCharCode(y),y=e,L=0),_===x.length-1&&(y=e,A+=x.charAt(_-(L-1)),_-=L-1,L=0)):(y=e,A+=x.charAt(_-L),_-=L,L=0);return A};t.__arabicParser__.isArabicDiacritic=function(x){return x!==void 0&&a[x.charCodeAt(0)]!==void 0};var m=t.__arabicParser__.getCorrectForm=function(x,_,y){return c(x)?i(x)===!1?-1:!h(x)||!c(_)&&!c(y)||!c(y)&&o(_)||o(x)&&!c(_)||o(x)&&d(_)||o(x)&&o(_)?0:p(x)&&c(_)&&!o(_)&&c(y)&&h(y)?3:o(x)||!c(y)?1:2:-1},u=function(x){var _=0,y=0,A=0,L="",E="",O="",X=(x=x||"").split("\\s+"),K=[];for(_=0;_<X.length;_+=1){for(K.push(""),y=0;y<X[_].length;y+=1)L=X[_][y],E=X[_][y-1],O=X[_][y+1],c(L)?(A=m(L,E,O),K[_]+=A!==-1?String.fromCharCode(r[L.charCodeAt(0)][A]):L):K[_]+=L;K[_]=b(K[_])}return K.join(" ")},w=t.__arabicParser__.processArabic=t.processArabic=function(){var x,_=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,y=[];if(Array.isArray(_)){var A=0;for(y=[],A=0;A<_.length;A+=1)Array.isArray(_[A])?y.push([u(_[A][0]),_[A][1],_[A][2]]):y.push([u(_[A])]);x=y}else x=u(_);return typeof arguments[0]=="string"?x:(arguments[0].text=x,arguments[0])};t.events.push(["preProcessText",w])})(Mt.API),Mt.API.autoPrint=function(t){var r;return(t=t||{}).variant=t.variant||"non-conform",t.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){r=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+r+" 0 R")})),this},(function(t){var r=function(){var e=void 0;Object.defineProperty(this,"pdf",{get:function(){return e},set:function(o){e=o}});var a=150;Object.defineProperty(this,"width",{get:function(){return a},set:function(o){a=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=a+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(o){s=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(o){i=o}});var c={};Object.defineProperty(this,"style",{get:function(){return c},set:function(o){c=o}}),Object.defineProperty(this,"parentNode",{})};r.prototype.getContext=function(e,a){var s;if((e=e||"2d")!=="2d")return null;for(s in a)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=a[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},r.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new r,this.canvas.pdf=this}])})(Mt.API),(function(t){var r={left:0,top:0,bottom:0,right:0},e=!1,a=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},r),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var d=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return d},set:function(x){d=x}});var h=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return h},set:function(x){h=x}});var p=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return p},set:function(x){p=x}});var b=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return b},set:function(x){b=x}});var m=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return m},set:function(x){m=x}});var u=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return u},set:function(x){u=x}});var w=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return w},set:function(x){w=x}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(d){return a.call(this),this.internal.__cell__.headerFunction=typeof d=="function"?d:void 0,this},t.getTextDimensions=function(d,h){a.call(this);var p=(h=h||{}).fontSize||this.getFontSize(),b=h.font||this.getFont(),m=h.scaleFactor||this.internal.scaleFactor,u=0,w=0,x=0,_=this;if(!Array.isArray(d)&&typeof d!="string"){if(typeof d!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");d=String(d)}var y=h.maxWidth;y>0?typeof d=="string"?d=this.splitTextToSize(d,y):Object.prototype.toString.call(d)==="[object Array]"&&(d=d.reduce(function(L,E){return L.concat(_.splitTextToSize(E,y))},[])):d=Array.isArray(d)?d:[d];for(var A=0;A<d.length;A++)u<(x=this.getStringUnitWidth(d[A],{font:b})*p)&&(u=x);return u!==0&&(w=d.length),{w:u/=m,h:Math.max((w*p*this.getLineHeightFactor()-p*(this.getLineHeightFactor()-1))/m,0)}},t.cellAddPage=function(){a.call(this),this.addPage();var d=this.internal.__cell__.margins||r;return this.internal.__cell__.lastCell=new i(d.left,d.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var c=t.cell=function(){var d;d=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),a.call(this);var h=this.internal.__cell__.lastCell,p=this.internal.__cell__.padding,b=this.internal.__cell__.margins||r,m=this.internal.__cell__.tableHeaderRow,u=this.internal.__cell__.printHeaders;return h.lineNumber!==void 0&&(h.lineNumber===d.lineNumber?(d.x=(h.x||0)+(h.width||0),d.y=h.y||0):h.y+h.height+d.height+b.bottom>this.getPageHeight()?(this.cellAddPage(),d.y=b.top,u&&m&&(this.printHeaderRow(d.lineNumber,!0),d.y+=m[0].height)):d.y=h.y+h.height||d.y),d.text[0]!==void 0&&(this.rect(d.x,d.y,d.width,d.height,e===!0?"FD":void 0),d.align==="right"?this.text(d.text,d.x+d.width-p,d.y+p,{align:"right",baseline:"top"}):d.align==="center"?this.text(d.text,d.x+d.width/2,d.y+p,{align:"center",baseline:"top",maxWidth:d.width-p-p}):this.text(d.text,d.x+p,d.y+p,{align:"left",baseline:"top",maxWidth:d.width-p-p})),this.internal.__cell__.lastCell=d,this};t.table=function(d,h,p,b,m){if(a.call(this),!p)throw new Error("No data for PDF table.");var u,w,x,_,y=[],A=[],L=[],E={},O={},X=[],K=[],H=(m=m||{}).autoSize||!1,P=m.printHeaders!==!1,Y=m.css&&m.css["font-size"]!==void 0?16*m.css["font-size"]:m.fontSize||12,I=m.margins||Object.assign({width:this.getPageWidth()},r),S=typeof m.padding=="number"?m.padding:3,R=m.headerBackgroundColor||"#c8c8c8",N=m.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=P,this.internal.__cell__.margins=I,this.internal.__cell__.table_font_size=Y,this.internal.__cell__.padding=S,this.internal.__cell__.headerBackgroundColor=R,this.internal.__cell__.headerTextColor=N,this.setFontSize(Y),b==null)A=y=Object.keys(p[0]),L=y.map(function(){return"left"});else if(Array.isArray(b)&&kr(b[0])==="object")for(y=b.map(function(Ae){return Ae.name}),A=b.map(function(Ae){return Ae.prompt||Ae.name||""}),L=b.map(function(Ae){return Ae.align||"left"}),u=0;u<b.length;u+=1)O[b[u].name]=.7499990551181103*b[u].width;else Array.isArray(b)&&typeof b[0]=="string"&&(A=y=b,L=y.map(function(){return"left"}));if(H||Array.isArray(b)&&typeof b[0]=="string")for(u=0;u<y.length;u+=1){for(E[_=y[u]]=p.map(function(Ae){return Ae[_]}),this.setFont(void 0,"bold"),X.push(this.getTextDimensions(A[u],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),w=E[_],this.setFont(void 0,"normal"),x=0;x<w.length;x+=1)X.push(this.getTextDimensions(w[x],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);O[_]=Math.max.apply(null,X)+S+S,X=[]}if(P){var re={};for(u=0;u<y.length;u+=1)re[y[u]]={},re[y[u]].text=A[u],re[y[u]].align=L[u];var ve=o.call(this,re,O);K=y.map(function(Ae){return new i(d,h,O[Ae],ve,re[Ae].text,void 0,re[Ae].align)}),this.setTableHeaderRow(K),this.printHeaderRow(1,!1)}var le=b.reduce(function(Ae,te){return Ae[te.name]=te.align,Ae},{});for(u=0;u<p.length;u+=1){"rowStart"in m&&m.rowStart instanceof Function&&m.rowStart({row:u,data:p[u]},this);var oe=o.call(this,p[u],O);for(x=0;x<y.length;x+=1){var ie=p[u][y[x]];"cellStart"in m&&m.cellStart instanceof Function&&m.cellStart({row:u,col:x,data:ie},this),c.call(this,new i(d,h,O[y[x]],oe,ie,u+2,le[y[x]]))}}return this.internal.__cell__.table_x=d,this.internal.__cell__.table_y=h,this};var o=function(d,h){var p=this.internal.__cell__.padding,b=this.internal.__cell__.table_font_size,m=this.internal.scaleFactor;return Object.keys(d).map(function(u){var w=d[u];return this.splitTextToSize(w.hasOwnProperty("text")?w.text:w,h[u]-p-p)},this).map(function(u){return this.getLineHeightFactor()*u.length*b/m+p+p},this).reduce(function(u,w){return Math.max(u,w)},0)};t.setTableHeaderRow=function(d){a.call(this),this.internal.__cell__.tableHeaderRow=d},t.printHeaderRow=function(d,h){if(a.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var p;if(e=!0,typeof this.internal.__cell__.headerFunction=="function"){var b=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(b[0],b[1],b[2],b[3],void 0,-1)}this.setFont(void 0,"bold");for(var m=[],u=0;u<this.internal.__cell__.tableHeaderRow.length;u+=1){p=this.internal.__cell__.tableHeaderRow[u].clone(),h&&(p.y=this.internal.__cell__.margins.top||0,m.push(p)),p.lineNumber=d;var w=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),c.call(this,p),this.setTextColor(w)}m.length>0&&this.setTableHeaderRow(m),this.setFont(void 0,"normal"),e=!1}})(Mt.API);var Xf={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Qf=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Tc=Zf(Qf),ep=[100,200,300,400,500,600,700,800,900],g2=Zf(ep);function hc(t){var r=t.family.replace(/"|'/g,"").toLowerCase(),e=(function(i){return Xf[i=i||"normal"]?i:"normal"})(t.style),a=(function(i){return i?typeof i=="number"?i>=100&&i<=900&&i%100==0?i:400:/^\d00$/.test(i)?parseInt(i):i==="bold"?700:400:400})(t.weight),s=(function(i){return typeof Tc[i=i||"normal"]=="number"?i:"normal"})(t.stretch);return{family:r,style:e,weight:a,stretch:s,src:t.src||[],ref:t.ref||{name:r,style:[s,e,a].join(" ")}}}function Hu(t,r,e,a){var s;for(s=e;s>=0&&s<r.length;s+=a)if(t[r[s]])return t[r[s]];for(s=e;s>=0&&s<r.length;s-=a)if(t[r[s]])return t[r[s]]}var x2={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Gu={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Vu(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function Yu(t){return t.trimLeft()}function y2(t,r){for(var e=0;e<t.length;){if(t.charAt(e)===r)return[t.substring(0,e),t.substring(e+1)];e+=1}return null}function b2(t){var r=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return r===null?null:[r[0],t.substring(r[0].length)]}var Xo,Ku,Ju,ki,Qo,Zu,Xu,Qu,fc=["times"];function eh(t,r,e,a,s){var i=4,c=rh;switch(s){case Mt.API.image_compression.FAST:i=1,c=th;break;case Mt.API.image_compression.MEDIUM:i=6,c=nh;break;case Mt.API.image_compression.SLOW:i=9,c=sh}t=(function(d,h,p,b){for(var m,u=d.length/h,w=new Uint8Array(d.length+u),x=[w2,th,rh,nh,sh],_=0;_<u;_+=1){var y=_*h,A=d.subarray(y,y+h);if(b)w.set(b(A,p,m),y+_);else{for(var L=x.length,E=[],O=0;O<L;O+=1)E[O]=x[O](A,p,m);var X=N2(E.concat());w.set(E[X],y+_)}m=A}return w})(t,r,Math.ceil(e*a/8),c);var o=Sc(t,{level:i});return Mt.API.__addimage__.arrayBufferToBinaryString(o)}function w2(t){var r=Array.apply([],t);return r.unshift(0),r}function th(t,r){var e=t.length,a=[];a[0]=1;for(var s=0;s<e;s+=1){var i=t[s-r]||0;a[s+1]=t[s]-i+256&255}return a}function rh(t,r,e){var a=t.length,s=[];s[0]=2;for(var i=0;i<a;i+=1){var c=e&&e[i]||0;s[i+1]=t[i]-c+256&255}return s}function nh(t,r,e){var a=t.length,s=[];s[0]=3;for(var i=0;i<a;i+=1){var c=t[i-r]||0,o=e&&e[i]||0;s[i+1]=t[i]+256-(c+o>>>1)&255}return s}function sh(t,r,e){var a=t.length,s=[];s[0]=4;for(var i=0;i<a;i+=1){var c=v2(t[i-r]||0,e&&e[i]||0,e&&e[i-r]||0);s[i+1]=t[i]-c+256&255}return s}function v2(t,r,e){if(t===r&&r===e)return t;var a=Math.abs(r-e),s=Math.abs(t-e),i=Math.abs(t+r-e-e);return a<=s&&a<=i?t:s<=i?r:e}function N2(t){var r=t.map(function(e){return e.reduce(function(a,s){return a+Math.abs(s)},0)});return r.indexOf(Math.min.apply(null,r))}function pc(t,r,e){var a=r*e,s=Math.floor(a/8),i=16-(a-8*s+e),c=(1<<e)-1;return tp(t,s)>>i&c}function ah(t,r,e,a){var s=e*a,i=Math.floor(s/8),c=16-(s-8*i+a),o=(1<<a)-1,d=(r&o)<<c;(function(h,p,b){if(p+1<h.byteLength)h.setUint16(p,b,!1);else{var m=b>>8&255;h.setUint8(p,m)}})(t,i,tp(t,i)&~(o<<c)&65535|d)}function tp(t,r){return r+1<t.byteLength?t.getUint16(r,!1):t.getUint8(r)<<8}function _2(t){var r=0;if(t[r++]!==71||t[r++]!==73||t[r++]!==70||t[r++]!==56||(t[r++]+1&253)!=56||t[r++]!==97)throw new Error("Invalid GIF 87a/89a header.");var e=t[r++]|t[r++]<<8,a=t[r++]|t[r++]<<8,s=t[r++],i=s>>7,c=1<<1+(7&s);t[r++],t[r++];var o=null,d=null;i&&(o=r,d=c,r+=3*c);var h=!0,p=[],b=0,m=null,u=0,w=null;for(this.width=e,this.height=a;h&&r<t.length;)switch(t[r++]){case 33:switch(t[r++]){case 255:if(t[r]!==11||t[r+1]==78&&t[r+2]==69&&t[r+3]==84&&t[r+4]==83&&t[r+5]==67&&t[r+6]==65&&t[r+7]==80&&t[r+8]==69&&t[r+9]==50&&t[r+10]==46&&t[r+11]==48&&t[r+12]==3&&t[r+13]==1&&t[r+16]==0)r+=14,w=t[r++]|t[r++]<<8,r++;else for(r+=12;;){if(!((I=t[r++])>=0))throw Error("Invalid block size");if(I===0)break;r+=I}break;case 249:if(t[r++]!==4||t[r+4]!==0)throw new Error("Invalid graphics extension block.");var x=t[r++];b=t[r++]|t[r++]<<8,m=t[r++],1&x||(m=null),u=x>>2&7,r++;break;case 254:for(;;){if(!((I=t[r++])>=0))throw Error("Invalid block size");if(I===0)break;r+=I}break;default:throw new Error("Unknown graphic control label: 0x"+t[r-1].toString(16))}break;case 44:var _=t[r++]|t[r++]<<8,y=t[r++]|t[r++]<<8,A=t[r++]|t[r++]<<8,L=t[r++]|t[r++]<<8,E=t[r++],O=E>>6&1,X=1<<1+(7&E),K=o,H=d,P=!1;E>>7&&(P=!0,K=r,H=X,r+=3*X);var Y=r;for(r++;;){var I;if(!((I=t[r++])>=0))throw Error("Invalid block size");if(I===0)break;r+=I}p.push({x:_,y,width:A,height:L,has_local_palette:P,palette_offset:K,palette_size:H,data_offset:Y,data_length:r-Y,transparent_index:m,interlaced:!!O,delay:b,disposal:u});break;case 59:h=!1;break;default:throw new Error("Unknown gif block: 0x"+t[r-1].toString(16))}this.numFrames=function(){return p.length},this.loopCount=function(){return w},this.frameInfo=function(S){if(S<0||S>=p.length)throw new Error("Frame index out of range.");return p[S]},this.decodeAndBlitFrameBGRA=function(S,R){var N=this.frameInfo(S),re=N.width*N.height,ve=new Uint8Array(re);ih(t,N.data_offset,ve,re);var le=N.palette_offset,oe=N.transparent_index;oe===null&&(oe=256);var ie=N.width,Ae=e-ie,te=ie,C=4*(N.y*e+N.x),G=4*((N.y+N.height)*e+N.x),Z=C,Q=4*Ae;N.interlaced===!0&&(Q+=4*e*7);for(var fe=8,we=0,Se=ve.length;we<Se;++we){var Ce=ve[we];if(te===0&&(te=ie,(Z+=Q)>=G&&(Q=4*Ae+4*e*(fe-1),Z=C+(ie+Ae)*(fe<<1),fe>>=1)),Ce===oe)Z+=4;else{var Re=t[le+3*Ce],Me=t[le+3*Ce+1],Je=t[le+3*Ce+2];R[Z++]=Je,R[Z++]=Me,R[Z++]=Re,R[Z++]=255}--te}},this.decodeAndBlitFrameRGBA=function(S,R){var N=this.frameInfo(S),re=N.width*N.height,ve=new Uint8Array(re);ih(t,N.data_offset,ve,re);var le=N.palette_offset,oe=N.transparent_index;oe===null&&(oe=256);var ie=N.width,Ae=e-ie,te=ie,C=4*(N.y*e+N.x),G=4*((N.y+N.height)*e+N.x),Z=C,Q=4*Ae;N.interlaced===!0&&(Q+=4*e*7);for(var fe=8,we=0,Se=ve.length;we<Se;++we){var Ce=ve[we];if(te===0&&(te=ie,(Z+=Q)>=G&&(Q=4*Ae+4*e*(fe-1),Z=C+(ie+Ae)*(fe<<1),fe>>=1)),Ce===oe)Z+=4;else{var Re=t[le+3*Ce],Me=t[le+3*Ce+1],Je=t[le+3*Ce+2];R[Z++]=Re,R[Z++]=Me,R[Z++]=Je,R[Z++]=255}--te}}}function ih(t,r,e,a){for(var s=t[r++],i=1<<s,c=i+1,o=c+1,d=s+1,h=(1<<d)-1,p=0,b=0,m=0,u=t[r++],w=new Int32Array(4096),x=null;;){for(;p<16&&u!==0;)b|=t[r++]<<p,p+=8,u===1?u=t[r++]:--u;if(p<d)break;var _=b&h;if(b>>=d,p-=d,_!==i){if(_===c)break;for(var y=_<o?_:x,A=0,L=y;L>i;)L=w[L]>>8,++A;var E=L;if(m+A+(y!==_?1:0)>a)return void Tr.log("Warning, gif stream longer than expected.");e[m++]=E;var O=m+=A;for(y!==_&&(e[m++]=E),L=y;A--;)L=w[L],e[--O]=255&L,L>>=8;x!==null&&o<4096&&(w[o++]=x<<8|E,o>=h+1&&d<12&&(++d,h=h<<1|1)),x=_}else o=c+1,h=(1<<(d=s+1))-1,x=null}return m!==a&&Tr.log("Warning, gif stream shorter than expected."),e}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function mc(t){var r,e,a,s,i,c=Math.floor,o=new Array(64),d=new Array(64),h=new Array(64),p=new Array(64),b=new Array(65535),m=new Array(65535),u=new Array(64),w=new Array(64),x=[],_=0,y=7,A=new Array(64),L=new Array(64),E=new Array(64),O=new Array(256),X=new Array(2048),K=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],H=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],P=[0,1,2,3,4,5,6,7,8,9,10,11],Y=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],I=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],S=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],R=[0,1,2,3,4,5,6,7,8,9,10,11],N=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],re=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ve(C,G){for(var Z=0,Q=0,fe=new Array,we=1;we<=16;we++){for(var Se=1;Se<=C[we];Se++)fe[G[Q]]=[],fe[G[Q]][0]=Z,fe[G[Q]][1]=we,Q++,Z++;Z*=2}return fe}function le(C){for(var G=C[0],Z=C[1]-1;Z>=0;)G&1<<Z&&(_|=1<<y),Z--,--y<0&&(_==255?(oe(255),oe(0)):oe(_),y=7,_=0)}function oe(C){x.push(C)}function ie(C){oe(C>>8&255),oe(255&C)}function Ae(C,G,Z,Q,fe){for(var we,Se=fe[0],Ce=fe[240],Re=(function(M,ue){var pe,ce,Le,Ie,Te,Ve,ht,st,ot,yt,dt=0;for(ot=0;ot<8;++ot){pe=M[dt],ce=M[dt+1],Le=M[dt+2],Ie=M[dt+3],Te=M[dt+4],Ve=M[dt+5],ht=M[dt+6];var Vt=pe+(st=M[dt+7]),mt=pe-st,Lt=ce+ht,zt=ce-ht,Et=Le+Ve,wt=Le-Ve,Kt=Ie+Te,Nt=Ie-Te,Ft=Vt+Kt,ar=Vt-Kt,Ot=Lt+Et,xt=Lt-Et;M[dt]=Ft+Ot,M[dt+4]=Ft-Ot;var Xt=.707106781*(xt+ar);M[dt+2]=ar+Xt,M[dt+6]=ar-Xt;var er=.382683433*((Ft=Nt+wt)-(xt=zt+mt)),Or=.5411961*Ft+er,bn=1.306562965*xt+er,fn=.707106781*(Ot=wt+zt),Ut=mt+fn,pn=mt-fn;M[dt+5]=pn+Or,M[dt+3]=pn-Or,M[dt+1]=Ut+bn,M[dt+7]=Ut-bn,dt+=8}for(dt=0,ot=0;ot<8;++ot){pe=M[dt],ce=M[dt+8],Le=M[dt+16],Ie=M[dt+24],Te=M[dt+32],Ve=M[dt+40],ht=M[dt+48];var wn=pe+(st=M[dt+56]),Vr=pe-st,qr=ce+ht,gr=ce-ht,Cr=Le+Ve,dr=Le-Ve,es=Ie+Te,wr=Ie-Te,Sn=wn+es,tn=wn-es,kn=qr+Cr,$r=qr-Cr;M[dt]=Sn+kn,M[dt+32]=Sn-kn;var Yr=.707106781*($r+tn);M[dt+16]=tn+Yr,M[dt+48]=tn-Yr;var En=.382683433*((Sn=wr+dr)-($r=gr+Vr)),lt=.5411961*Sn+En,Kr=1.306562965*$r+En,xe=.707106781*(kn=dr+gr),ze=Vr+xe,We=Vr-xe;M[dt+40]=We+lt,M[dt+24]=We-lt,M[dt+8]=ze+Kr,M[dt+56]=ze-Kr,dt++}for(ot=0;ot<64;++ot)yt=M[ot]*ue[ot],u[ot]=yt>0?yt+.5|0:yt-.5|0;return u})(C,G),Me=0;Me<64;++Me)w[K[Me]]=Re[Me];var Je=w[0]-Z;Z=w[0],Je==0?le(Q[0]):(le(Q[m[we=32767+Je]]),le(b[we]));for(var je=63;je>0&&w[je]==0;)je--;if(je==0)return le(Se),Z;for(var j,T=1;T<=je;){for(var V=T;w[T]==0&&T<=je;)++T;var $=T-V;if($>=16){j=$>>4;for(var z=1;z<=j;++z)le(Ce);$&=15}we=32767+w[T],le(fe[($<<4)+m[we]]),le(b[we]),T++}return je!=63&&le(Se),Z}function te(C){C=Math.min(Math.max(C,1),100),i!=C&&((function(G){for(var Z=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Q=0;Q<64;Q++){var fe=c((Z[Q]*G+50)/100);fe=Math.min(Math.max(fe,1),255),o[K[Q]]=fe}for(var we=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Se=0;Se<64;Se++){var Ce=c((we[Se]*G+50)/100);Ce=Math.min(Math.max(Ce,1),255),d[K[Se]]=Ce}for(var Re=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Me=0,Je=0;Je<8;Je++)for(var je=0;je<8;je++)h[Me]=1/(o[K[Me]]*Re[Je]*Re[je]*8),p[Me]=1/(d[K[Me]]*Re[Je]*Re[je]*8),Me++})(C<50?Math.floor(5e3/C):Math.floor(200-2*C)),i=C)}this.encode=function(C,G){G&&te(G),x=new Array,_=0,y=7,ie(65496),ie(65504),ie(16),oe(74),oe(70),oe(73),oe(70),oe(0),oe(1),oe(1),oe(0),ie(1),ie(1),oe(0),oe(0),(function(){ie(65499),ie(132),oe(0);for(var ce=0;ce<64;ce++)oe(o[ce]);oe(1);for(var Le=0;Le<64;Le++)oe(d[Le])})(),(function(ce,Le){ie(65472),ie(17),oe(8),ie(Le),ie(ce),oe(3),oe(1),oe(17),oe(0),oe(2),oe(17),oe(1),oe(3),oe(17),oe(1)})(C.width,C.height),(function(){ie(65476),ie(418),oe(0);for(var ce=0;ce<16;ce++)oe(H[ce+1]);for(var Le=0;Le<=11;Le++)oe(P[Le]);oe(16);for(var Ie=0;Ie<16;Ie++)oe(Y[Ie+1]);for(var Te=0;Te<=161;Te++)oe(I[Te]);oe(1);for(var Ve=0;Ve<16;Ve++)oe(S[Ve+1]);for(var ht=0;ht<=11;ht++)oe(R[ht]);oe(17);for(var st=0;st<16;st++)oe(N[st+1]);for(var ot=0;ot<=161;ot++)oe(re[ot])})(),ie(65498),ie(12),oe(3),oe(1),oe(0),oe(2),oe(17),oe(3),oe(17),oe(0),oe(63),oe(0);var Z=0,Q=0,fe=0;_=0,y=7,this.encode.displayName="_encode_";for(var we,Se,Ce,Re,Me,Je,je,j,T,V=C.data,$=C.width,z=C.height,M=4*$,ue=0;ue<z;){for(we=0;we<M;){for(Me=M*ue+we,je=-1,j=0,T=0;T<64;T++)Je=Me+(j=T>>3)*M+(je=4*(7&T)),ue+j>=z&&(Je-=M*(ue+1+j-z)),we+je>=M&&(Je-=we+je-M+4),Se=V[Je++],Ce=V[Je++],Re=V[Je++],A[T]=(X[Se]+X[Ce+256|0]+X[Re+512|0]>>16)-128,L[T]=(X[Se+768|0]+X[Ce+1024|0]+X[Re+1280|0]>>16)-128,E[T]=(X[Se+1280|0]+X[Ce+1536|0]+X[Re+1792|0]>>16)-128;Z=Ae(A,h,Z,r,a),Q=Ae(L,p,Q,e,s),fe=Ae(E,p,fe,e,s),we+=32}ue+=8}if(y>=0){var pe=[];pe[1]=y+1,pe[0]=(1<<y+1)-1,le(pe)}return ie(65497),new Uint8Array(x)},t=t||50,(function(){for(var C=String.fromCharCode,G=0;G<256;G++)O[G]=C(G)})(),r=ve(H,P),e=ve(S,R),a=ve(Y,I),s=ve(N,re),(function(){for(var C=1,G=2,Z=1;Z<=15;Z++){for(var Q=C;Q<G;Q++)m[32767+Q]=Z,b[32767+Q]=[],b[32767+Q][1]=Z,b[32767+Q][0]=Q;for(var fe=-(G-1);fe<=-C;fe++)m[32767+fe]=Z,b[32767+fe]=[],b[32767+fe][1]=Z,b[32767+fe][0]=G-1+fe;C<<=1,G<<=1}})(),(function(){for(var C=0;C<256;C++)X[C]=19595*C,X[C+256|0]=38470*C,X[C+512|0]=7471*C+32768,X[C+768|0]=-11059*C,X[C+1024|0]=-21709*C,X[C+1280|0]=32768*C+8421375,X[C+1536|0]=-27439*C,X[C+1792|0]=-5329*C})(),te(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Is(t,r){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!r,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function oh(t){function r(P){if(!P)throw Error("assert :P")}function e(P,Y,I){for(var S=0;4>S;S++)if(P[Y+S]!=I.charCodeAt(S))return!0;return!1}function a(P,Y,I,S,R){for(var N=0;N<R;N++)P[Y+N]=I[S+N]}function s(P,Y,I,S){for(var R=0;R<S;R++)P[Y+R]=I}function i(P){return new Int32Array(P)}function c(P,Y){for(var I=[],S=0;S<P;S++)I.push(new Y);return I}function o(P,Y){var I=[];return(function S(R,N,re){for(var ve=re[N],le=0;le<ve&&(R.push(re.length>N+1?[]:new Y),!(re.length<N+1));le++)S(R[le],N+1,re)})(I,0,P),I}var d=function(){var P=this;function Y(l,f){for(var v=1<<f-1>>>0;l&v;)v>>>=1;return v?(l&v-1)+v:l}function I(l,f,v,k,B){r(!(k%v));do l[f+(k-=v)]=B;while(0<k)}function S(l,f,v,k,B){if(r(2328>=B),512>=B)var q=i(512);else if((q=i(B))==null)return 0;return(function(W,J,ee,se,_e,De){var ae,ke,Pe=J,Ue=1<<ee,Oe=i(16),$e=i(16);for(r(_e!=0),r(se!=null),r(W!=null),r(0<ee),ke=0;ke<_e;++ke){if(15<se[ke])return 0;++Oe[se[ke]]}if(Oe[0]==_e)return 0;for($e[1]=0,ae=1;15>ae;++ae){if(Oe[ae]>1<<ae)return 0;$e[ae+1]=$e[ae]+Oe[ae]}for(ke=0;ke<_e;++ke)ae=se[ke],0<se[ke]&&(De[$e[ae]++]=ke);if($e[15]==1)return(se=new R).g=0,se.value=De[0],I(W,Pe,1,Ue,se),Ue;var Ye,nt=-1,et=Ue-1,Bt=0,St=1,nr=1,Tt=1<<ee;for(ke=0,ae=1,_e=2;ae<=ee;++ae,_e<<=1){if(St+=nr<<=1,0>(nr-=Oe[ae]))return 0;for(;0<Oe[ae];--Oe[ae])(se=new R).g=ae,se.value=De[ke++],I(W,Pe+Bt,_e,Tt,se),Bt=Y(Bt,ae)}for(ae=ee+1,_e=2;15>=ae;++ae,_e<<=1){if(St+=nr<<=1,0>(nr-=Oe[ae]))return 0;for(;0<Oe[ae];--Oe[ae]){if(se=new R,(Bt&et)!=nt){for(Pe+=Tt,Ye=1<<(nt=ae)-ee;15>nt&&!(0>=(Ye-=Oe[nt]));)++nt,Ye<<=1;Ue+=Tt=1<<(Ye=nt-ee),W[J+(nt=Bt&et)].g=Ye+ee,W[J+nt].value=Pe-J-nt}se.g=ae-ee,se.value=De[ke++],I(W,Pe+(Bt>>ee),_e,Tt,se),Bt=Y(Bt,ae)}}return St!=2*$e[15]-1?0:Ue})(l,f,v,k,B,q)}function R(){this.value=this.g=0}function N(){this.value=this.g=0}function re(){this.G=c(5,R),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=c(Ja,N)}function ve(l,f,v,k){r(l!=null),r(f!=null),r(2147483648>k),l.Ca=254,l.I=0,l.b=-8,l.Ka=0,l.oa=f,l.pa=v,l.Jd=f,l.Yc=v+k,l.Zc=4<=k?v+k-4+1:v,Se(l)}function le(l,f){for(var v=0;0<f--;)v|=Re(l,128)<<f;return v}function oe(l,f){var v=le(l,f);return Ce(l)?-v:v}function ie(l,f,v,k){var B,q=0;for(r(l!=null),r(f!=null),r(4294967288>k),l.Sb=k,l.Ra=0,l.u=0,l.h=0,4<k&&(k=4),B=0;B<k;++B)q+=f[v+B]<<8*B;l.Ra=q,l.bb=k,l.oa=f,l.pa=v}function Ae(l){for(;8<=l.u&&l.bb<l.Sb;)l.Ra>>>=8,l.Ra+=l.oa[l.pa+l.bb]<<Aa-8>>>0,++l.bb,l.u-=8;Q(l)&&(l.h=1,l.u=0)}function te(l,f){if(r(0<=f),!l.h&&f<=ns){var v=Z(l)&rs[f];return l.u+=f,Ae(l),v}return l.h=1,l.u=0}function C(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function G(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function Z(l){return l.Ra>>>(l.u&Aa-1)>>>0}function Q(l){return r(l.bb<=l.Sb),l.h||l.bb==l.Sb&&l.u>Aa}function fe(l,f){l.u=f,l.h=Q(l)}function we(l){l.u>=la&&(r(l.u>=la),Ae(l))}function Se(l){r(l!=null&&l.oa!=null),l.pa<l.Zc?(l.I=(l.oa[l.pa++]|l.I<<8)>>>0,l.b+=8):(r(l!=null&&l.oa!=null),l.pa<l.Yc?(l.b+=8,l.I=l.oa[l.pa++]|l.I<<8):l.Ka?l.b=0:(l.I<<=8,l.b+=8,l.Ka=1))}function Ce(l){return le(l,1)}function Re(l,f){var v=l.Ca;0>l.b&&Se(l);var k=l.b,B=v*f>>>8,q=(l.I>>>k>B)+0;for(q?(v-=B,l.I-=B+1<<k>>>0):v=B+1,k=v,B=0;256<=k;)B+=8,k>>=8;return k=7^B+Ca[k],l.b-=k,l.Ca=(v<<k)-1,q}function Me(l,f,v){l[f+0]=v>>24&255,l[f+1]=v>>16&255,l[f+2]=v>>8&255,l[f+3]=255&v}function Je(l,f){return l[f+0]|l[f+1]<<8}function je(l,f){return Je(l,f)|l[f+2]<<16}function j(l,f){return Je(l,f)|Je(l,f+2)<<16}function T(l,f){var v=1<<f;return r(l!=null),r(0<f),l.X=i(v),l.X==null?0:(l.Mb=32-f,l.Xa=f,1)}function V(l,f){r(l!=null),r(f!=null),r(l.Xa==f.Xa),a(f.X,0,l.X,0,1<<f.Xa)}function $(){this.X=[],this.Xa=this.Mb=0}function z(l,f,v,k){r(v!=null),r(k!=null);var B=v[0],q=k[0];return B==0&&(B=(l*q+f/2)/f),q==0&&(q=(f*B+l/2)/l),0>=B||0>=q?0:(v[0]=B,k[0]=q,1)}function M(l,f){return l+(1<<f)-1>>>f}function ue(l,f){return((4278255360&l)+(4278255360&f)>>>0&4278255360)+((16711935&l)+(16711935&f)>>>0&16711935)>>>0}function pe(l,f){P[f]=function(v,k,B,q,W,J,ee){var se;for(se=0;se<W;++se){var _e=P[l](J[ee+se-1],B,q+se);J[ee+se]=ue(v[k+se],_e)}}}function ce(){this.ud=this.hd=this.jd=0}function Le(l,f){return((4278124286&(l^f))>>>1)+(l&f)>>>0}function Ie(l){return 0<=l&&256>l?l:0>l?0:255<l?255:void 0}function Te(l,f){return Ie(l+(l-f+.5>>1))}function Ve(l,f,v){return Math.abs(f-v)-Math.abs(l-v)}function ht(l,f,v,k,B,q,W){for(k=q[W-1],v=0;v<B;++v)q[W+v]=k=ue(l[f+v],k)}function st(l,f,v,k,B){var q;for(q=0;q<v;++q){var W=l[f+q],J=W>>8&255,ee=16711935&(ee=(ee=16711935&W)+((J<<16)+J));k[B+q]=(4278255360&W)+ee>>>0}}function ot(l,f){f.jd=255&l,f.hd=l>>8&255,f.ud=l>>16&255}function yt(l,f,v,k,B,q){var W;for(W=0;W<k;++W){var J=f[v+W],ee=J>>>8,se=J,_e=255&(_e=(_e=J>>>16)+((l.jd<<24>>24)*(ee<<24>>24)>>>5));se=255&(se=(se+=(l.hd<<24>>24)*(ee<<24>>24)>>>5)+((l.ud<<24>>24)*(_e<<24>>24)>>>5)),B[q+W]=(4278255360&J)+(_e<<16)+se}}function dt(l,f,v,k,B){P[f]=function(q,W,J,ee,se,_e,De,ae,ke){for(ee=De;ee<ae;++ee)for(De=0;De<ke;++De)se[_e++]=B(J[k(q[W++])])},P[l]=function(q,W,J,ee,se,_e,De){var ae=8>>q.b,ke=q.Ea,Pe=q.K[0],Ue=q.w;if(8>ae)for(q=(1<<q.b)-1,Ue=(1<<ae)-1;W<J;++W){var Oe,$e=0;for(Oe=0;Oe<ke;++Oe)Oe&q||($e=k(ee[se++])),_e[De++]=B(Pe[$e&Ue]),$e>>=ae}else P["VP8LMapColor"+v](ee,se,Pe,Ue,_e,De,W,J,ke)}}function Vt(l,f,v,k,B){for(v=f+v;f<v;){var q=l[f++];k[B++]=q>>16&255,k[B++]=q>>8&255,k[B++]=255&q}}function mt(l,f,v,k,B){for(v=f+v;f<v;){var q=l[f++];k[B++]=q>>16&255,k[B++]=q>>8&255,k[B++]=255&q,k[B++]=q>>24&255}}function Lt(l,f,v,k,B){for(v=f+v;f<v;){var q=(W=l[f++])>>16&240|W>>12&15,W=240&W|W>>28&15;k[B++]=q,k[B++]=W}}function zt(l,f,v,k,B){for(v=f+v;f<v;){var q=(W=l[f++])>>16&248|W>>13&7,W=W>>5&224|W>>3&31;k[B++]=q,k[B++]=W}}function Et(l,f,v,k,B){for(v=f+v;f<v;){var q=l[f++];k[B++]=255&q,k[B++]=q>>8&255,k[B++]=q>>16&255}}function wt(l,f,v,k,B,q){if(q==0)for(v=f+v;f<v;)Me(k,((q=l[f++])[0]>>24|q[1]>>8&65280|q[2]<<8&16711680|q[3]<<24)>>>0),B+=32;else a(k,B,l,f,v)}function Kt(l,f){P[f][0]=P[l+"0"],P[f][1]=P[l+"1"],P[f][2]=P[l+"2"],P[f][3]=P[l+"3"],P[f][4]=P[l+"4"],P[f][5]=P[l+"5"],P[f][6]=P[l+"6"],P[f][7]=P[l+"7"],P[f][8]=P[l+"8"],P[f][9]=P[l+"9"],P[f][10]=P[l+"10"],P[f][11]=P[l+"11"],P[f][12]=P[l+"12"],P[f][13]=P[l+"13"],P[f][14]=P[l+"0"],P[f][15]=P[l+"0"]}function Nt(l){return l==Ll||l==El||l==Lo||l==Pl}function Ft(){this.eb=[],this.size=this.A=this.fb=0}function ar(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Ot(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Ft,this.f.kb=new ar,this.sd=null}function xt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Xt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function er(l){return alert("todo:WebPSamplerProcessPlane"),l.T}function Or(l,f){var v=l.T,k=f.ba.f.RGBA,B=k.eb,q=k.fb+l.ka*k.A,W=_s[f.ba.S],J=l.y,ee=l.O,se=l.f,_e=l.N,De=l.ea,ae=l.W,ke=f.cc,Pe=f.dc,Ue=f.Mc,Oe=f.Nc,$e=l.ka,Ye=l.ka+l.T,nt=l.U,et=nt+1>>1;for($e==0?W(J,ee,null,null,se,_e,De,ae,se,_e,De,ae,B,q,null,null,nt):(W(f.ec,f.fc,J,ee,ke,Pe,Ue,Oe,se,_e,De,ae,B,q-k.A,B,q,nt),++v);$e+2<Ye;$e+=2)ke=se,Pe=_e,Ue=De,Oe=ae,_e+=l.Rc,ae+=l.Rc,q+=2*k.A,W(J,(ee+=2*l.fa)-l.fa,J,ee,ke,Pe,Ue,Oe,se,_e,De,ae,B,q-k.A,B,q,nt);return ee+=l.fa,l.j+Ye<l.o?(a(f.ec,f.fc,J,ee,nt),a(f.cc,f.dc,se,_e,et),a(f.Mc,f.Nc,De,ae,et),v--):1&Ye||W(J,ee,null,null,se,_e,De,ae,se,_e,De,ae,B,q+k.A,null,null,nt),v}function bn(l,f,v){var k=l.F,B=[l.J];if(k!=null){var q=l.U,W=f.ba.S,J=W==Co||W==Lo;f=f.ba.f.RGBA;var ee=[0],se=l.ka;ee[0]=l.T,l.Kb&&(se==0?--ee[0]:(--se,B[0]-=l.width),l.j+l.ka+l.T==l.o&&(ee[0]=l.o-l.j-se));var _e=f.eb;se=f.fb+se*f.A,l=od(k,B[0],l.width,q,ee,_e,se+(J?0:3),f.A),r(v==ee),l&&Nt(W)&&to(_e,se,J,q,ee,f.A)}return 0}function fn(l){var f=l.ma,v=f.ba.S,k=11>v,B=v==ko||v==Ao||v==Co||v==Cl||v==12||Nt(v);if(f.memory=null,f.Ib=null,f.Jb=null,f.Nd=null,!oa(f.Oa,l,B?11:12))return 0;if(B&&Nt(v)&&ut(),l.da)alert("todo:use_scaling");else{if(k){if(f.Ib=er,l.Kb){if(v=l.U+1>>1,f.memory=i(l.U+2*v),f.memory==null)return 0;f.ec=f.memory,f.fc=0,f.cc=f.ec,f.dc=f.fc+l.U,f.Mc=f.cc,f.Nc=f.dc+v,f.Ib=Or,ut()}}else alert("todo:EmitYUV");B&&(f.Jb=bn,k&&qe())}if(k&&!_d){for(l=0;256>l;++l)Dp[l]=89858*(l-128)+Po>>Eo,Mp[l]=-22014*(l-128)+Po,Bp[l]=-45773*(l-128),Rp[l]=113618*(l-128)+Po>>Eo;for(l=no;l<Fl;++l)f=76283*(l-16)+Po>>Eo,Up[l-no]=ir(f,255),zp[l-no]=ir(f+8>>4,15);_d=1}return 1}function Ut(l){var f=l.ma,v=l.U,k=l.T;return r(!(1&l.ka)),0>=v||0>=k?0:(v=f.Ib(l,f),f.Jb!=null&&f.Jb(l,f,v),f.Dc+=v,1)}function pn(l){l.ma.memory=null}function wn(l,f,v,k){return te(l,8)!=47?0:(f[0]=te(l,14)+1,v[0]=te(l,14)+1,k[0]=te(l,1),te(l,3)!=0?0:!l.h)}function Vr(l,f){if(4>l)return l+1;var v=l-2>>1;return(2+(1&l)<<v)+te(f,v)+1}function qr(l,f){return 120<f?f-120:1<=(v=((v=Np[f-1])>>4)*l+(8-(15&v)))?v:1;var v}function gr(l,f,v){var k=Z(v),B=l[f+=255&k].g-8;return 0<B&&(fe(v,v.u+8),k=Z(v),f+=l[f].value,f+=k&(1<<B)-1),fe(v,v.u+l[f].g),l[f].value}function Cr(l,f,v){return v.g+=l.g,v.value+=l.value<<f>>>0,r(8>=v.g),l.g}function dr(l,f,v){var k=l.xc;return r((f=k==0?0:l.vc[l.md*(v>>k)+(f>>k)])<l.Wb),l.Ya[f]}function es(l,f,v,k){var B=l.ab,q=l.c*f,W=l.C;f=W+f;var J=v,ee=k;for(k=l.Ta,v=l.Ua;0<B--;){var se=l.gc[B],_e=W,De=f,ae=J,ke=ee,Pe=(ee=k,J=v,se.Ea);switch(r(_e<De),r(De<=se.nc),se.hc){case 2:rn(ae,ke,(De-_e)*Pe,ee,J);break;case 0:var Ue=_e,Oe=De,$e=ee,Ye=J,nt=(Tt=se).Ea;Ue==0&&(Ki(ae,ke,null,null,1,$e,Ye),ht(ae,ke+1,0,0,nt-1,$e,Ye+1),ke+=nt,Ye+=nt,++Ue);for(var et=1<<Tt.b,Bt=et-1,St=M(nt,Tt.b),nr=Tt.K,Tt=Tt.w+(Ue>>Tt.b)*St;Ue<Oe;){var lr=nr,gn=Tt,sr=1;for(wi(ae,ke,$e,Ye-nt,1,$e,Ye);sr<nt;){var It=(sr&~Bt)+et;It>nt&&(It=nt),(0,Zi[lr[gn++]>>8&15])(ae,ke+ +sr,$e,Ye+sr-nt,It-sr,$e,Ye+sr),sr=It}ke+=nt,Ye+=nt,++Ue&Bt||(Tt+=St)}De!=se.nc&&a(ee,J-Pe,ee,J+(De-_e-1)*Pe,Pe);break;case 1:for(Pe=ae,Oe=ke,nt=(ae=se.Ea)-(Ye=ae&~($e=(ke=1<<se.b)-1)),Ue=M(ae,se.b),et=se.K,se=se.w+(_e>>se.b)*Ue;_e<De;){for(Bt=et,St=se,nr=new ce,Tt=Oe+Ye,lr=Oe+ae;Oe<Tt;)ot(Bt[St++],nr),Xi(nr,Pe,Oe,ke,ee,J),Oe+=ke,J+=ke;Oe<lr&&(ot(Bt[St++],nr),Xi(nr,Pe,Oe,nt,ee,J),Oe+=nt,J+=nt),++_e&$e||(se+=Ue)}break;case 3:if(ae==ee&&ke==J&&0<se.b){for(Oe=ee,ae=Pe=J+(De-_e)*Pe-(Ye=(De-_e)*M(se.Ea,se.b)),ke=ee,$e=J,Ue=[],Ye=(nt=Ye)-1;0<=Ye;--Ye)Ue[Ye]=ke[$e+Ye];for(Ye=nt-1;0<=Ye;--Ye)Oe[ae+Ye]=Ue[Ye];No(se,_e,De,ee,Pe,ee,J)}else No(se,_e,De,ae,ke,ee,J)}J=k,ee=v}ee!=v&&a(k,v,J,ee,q)}function wr(l,f){var v=l.V,k=l.Ba+l.c*l.C,B=f-l.C;if(r(f<=l.l.o),r(16>=B),0<B){var q=l.l,W=l.Ta,J=l.Ua,ee=q.width;if(es(l,B,v,k),B=J=[J],r((v=l.C)<(k=f)),r(q.v<q.va),k>q.o&&(k=q.o),v<q.j){var se=q.j-v;v=q.j,B[0]+=se*ee}if(v>=k?v=0:(B[0]+=4*q.v,q.ka=v-q.j,q.U=q.va-q.v,q.T=k-v,v=1),v){if(J=J[0],11>(v=l.ca).S){var _e=v.f.RGBA,De=(k=v.S,B=q.U,q=q.T,se=_e.eb,_e.A),ae=q;for(_e=_e.fb+l.Ma*_e.A;0<ae--;){var ke=W,Pe=J,Ue=B,Oe=se,$e=_e;switch(k){case So:Qi(ke,Pe,Ue,Oe,$e);break;case ko:La(ke,Pe,Ue,Oe,$e);break;case Ll:La(ke,Pe,Ue,Oe,$e),to(Oe,$e,0,Ue,1,0);break;case pd:Za(ke,Pe,Ue,Oe,$e);break;case Ao:wt(ke,Pe,Ue,Oe,$e,1);break;case El:wt(ke,Pe,Ue,Oe,$e,1),to(Oe,$e,0,Ue,1,0);break;case Co:wt(ke,Pe,Ue,Oe,$e,0);break;case Lo:wt(ke,Pe,Ue,Oe,$e,0),to(Oe,$e,1,Ue,1,0);break;case Cl:Ea(ke,Pe,Ue,Oe,$e);break;case Pl:Ea(ke,Pe,Ue,Oe,$e),id(Oe,$e,Ue,1,0);break;case md:Pa(ke,Pe,Ue,Oe,$e);break;default:r(0)}J+=ee,_e+=De}l.Ma+=q}else alert("todo:EmitRescaledRowsYUVA");r(l.Ma<=v.height)}}l.C=f,r(l.C<=l.i)}function Sn(l){var f;if(0<l.ua)return 0;for(f=0;f<l.Wb;++f){var v=l.Ya[f].G,k=l.Ya[f].H;if(0<v[1][k[1]+0].g||0<v[2][k[2]+0].g||0<v[3][k[3]+0].g)return 0}return 1}function tn(l,f,v,k,B,q){if(l.Z!=0){var W=l.qd,J=l.rd;for(r(Fa[l.Z]!=null);f<v;++f)Fa[l.Z](W,J,k,B,k,B,q),W=k,J=B,B+=q;l.qd=W,l.rd=J}}function kn(l,f){var v=l.l.ma,k=v.Z==0||v.Z==1?l.l.j:l.C;if(k=l.C<k?k:l.C,r(f<=l.l.o),f>k){var B=l.l.width,q=v.ca,W=v.tb+B*k,J=l.V,ee=l.Ba+l.c*k,se=l.gc;r(l.ab==1),r(se[0].hc==3),Gs(se[0],k,f,J,ee,q,W),tn(v,k,f,q,W,B)}l.C=l.Ma=f}function $r(l,f,v,k,B,q,W){var J=l.$/k,ee=l.$%k,se=l.m,_e=l.s,De=v+l.$,ae=De;B=v+k*B;var ke=v+k*q,Pe=280+_e.ua,Ue=l.Pb?J:16777216,Oe=0<_e.ua?_e.Wa:null,$e=_e.wc,Ye=De<ke?dr(_e,ee,J):null;r(l.C<q),r(ke<=B);var nt=!1;e:for(;;){for(;nt||De<ke;){var et=0;if(J>=Ue){var Bt=De-v;r((Ue=l).Pb),Ue.wd=Ue.m,Ue.xd=Bt,0<Ue.s.ua&&V(Ue.s.Wa,Ue.s.vb),Ue=J+jp}if(ee&$e||(Ye=dr(_e,ee,J)),r(Ye!=null),Ye.Qb&&(f[De]=Ye.qb,nt=!0),!nt)if(we(se),Ye.jc){et=se,Bt=f;var St=De,nr=Ye.pd[Z(et)&Ja-1];r(Ye.jc),256>nr.g?(fe(et,et.u+nr.g),Bt[St]=nr.value,et=0):(fe(et,et.u+nr.g-256),r(256<=nr.value),et=nr.value),et==0&&(nt=!0)}else et=gr(Ye.G[0],Ye.H[0],se);if(se.h)break;if(nt||256>et){if(!nt)if(Ye.nd)f[De]=(Ye.qb|et<<8)>>>0;else{if(we(se),nt=gr(Ye.G[1],Ye.H[1],se),we(se),Bt=gr(Ye.G[2],Ye.H[2],se),St=gr(Ye.G[3],Ye.H[3],se),se.h)break;f[De]=(St<<24|nt<<16|et<<8|Bt)>>>0}if(nt=!1,++De,++ee>=k&&(ee=0,++J,W!=null&&J<=q&&!(J%16)&&W(l,J),Oe!=null))for(;ae<De;)et=f[ae++],Oe.X[(506832829*et&4294967295)>>>Oe.Mb]=et}else if(280>et){if(et=Vr(et-256,se),Bt=gr(Ye.G[4],Ye.H[4],se),we(se),Bt=qr(k,Bt=Vr(Bt,se)),se.h)break;if(De-v<Bt||B-De<et)break e;for(St=0;St<et;++St)f[De+St]=f[De+St-Bt];for(De+=et,ee+=et;ee>=k;)ee-=k,++J,W!=null&&J<=q&&!(J%16)&&W(l,J);if(r(De<=B),ee&$e&&(Ye=dr(_e,ee,J)),Oe!=null)for(;ae<De;)et=f[ae++],Oe.X[(506832829*et&4294967295)>>>Oe.Mb]=et}else{if(!(et<Pe))break e;for(nt=et-280,r(Oe!=null);ae<De;)et=f[ae++],Oe.X[(506832829*et&4294967295)>>>Oe.Mb]=et;et=De,r(!(nt>>>(Bt=Oe).Xa)),f[et]=Bt.X[nt],nt=!0}nt||r(se.h==Q(se))}if(l.Pb&&se.h&&De<B)r(l.m.h),l.a=5,l.m=l.wd,l.$=l.xd,0<l.s.ua&&V(l.s.vb,l.s.Wa);else{if(se.h)break e;W!=null&&W(l,J>q?q:J),l.a=0,l.$=De-v}return 1}return l.a=3,0}function Yr(l){r(l!=null),l.vc=null,l.yc=null,l.Ya=null;var f=l.Wa;f!=null&&(f.X=null),l.vb=null,r(l!=null)}function En(){var l=new qt;return l==null?null:(l.a=0,l.xb=yd,Kt("Predictor","VP8LPredictors"),Kt("Predictor","VP8LPredictors_C"),Kt("PredictorAdd","VP8LPredictorsAdd"),Kt("PredictorAdd","VP8LPredictorsAdd_C"),rn=st,Xi=yt,Qi=Vt,La=mt,Ea=Lt,Pa=zt,Za=Et,P.VP8LMapColor32b=Hs,P.VP8LMapColor8b=Ji,l)}function lt(l,f,v,k,B){var q=1,W=[l],J=[f],ee=k.m,se=k.s,_e=null,De=0;e:for(;;){if(v)for(;q&&te(ee,1);){var ae=W,ke=J,Pe=k,Ue=1,Oe=Pe.m,$e=Pe.gc[Pe.ab],Ye=te(Oe,2);if(Pe.Oc&1<<Ye)q=0;else{switch(Pe.Oc|=1<<Ye,$e.hc=Ye,$e.Ea=ae[0],$e.nc=ke[0],$e.K=[null],++Pe.ab,r(4>=Pe.ab),Ye){case 0:case 1:$e.b=te(Oe,3)+2,Ue=lt(M($e.Ea,$e.b),M($e.nc,$e.b),0,Pe,$e.K),$e.K=$e.K[0];break;case 3:var nt,et=te(Oe,8)+1,Bt=16<et?0:4<et?1:2<et?2:3;if(ae[0]=M($e.Ea,Bt),$e.b=Bt,nt=Ue=lt(et,1,0,Pe,$e.K)){var St,nr=et,Tt=$e,lr=1<<(8>>Tt.b),gn=i(lr);if(gn==null)nt=0;else{var sr=Tt.K[0],It=Tt.w;for(gn[0]=Tt.K[0][0],St=1;St<1*nr;++St)gn[St]=ue(sr[It+St],gn[St-1]);for(;St<4*lr;++St)gn[St]=0;Tt.K[0]=null,Tt.K[0]=gn,nt=1}}Ue=nt;break;case 2:break;default:r(0)}q=Ue}}if(W=W[0],J=J[0],q&&te(ee,1)&&!(q=1<=(De=te(ee,4))&&11>=De)){k.a=3;break e}var pt;if(pt=q)t:{var sn,Qt,cr,Dr=k,An=W,zn=J,Zr=De,Tn=v,qn=Dr.m,xn=Dr.s,hr=[null],_r=1,Xr=0,jr=_p[Zr];r:for(;;){if(Tn&&te(qn,1)){var Cn=te(qn,3)+2,Ps=M(An,Cn),an=M(zn,Cn),Vn=Ps*an;if(!lt(Ps,an,0,Dr,hr))break r;for(hr=hr[0],xn.xc=Cn,sn=0;sn<Vn;++sn){var Pr=hr[sn]>>8&65535;hr[sn]=Pr,Pr>=_r&&(_r=Pr+1)}}if(qn.h)break r;for(Qt=0;5>Qt;++Qt){var yn=gd[Qt];!Qt&&0<Zr&&(yn+=1<<Zr),Xr<yn&&(Xr=yn)}var as=c(_r*jr,R),$n=_r,is=c($n,re);if(is==null)var os=null;else r(65536>=$n),os=is;var Yn=i(Xr);if(os==null||Yn==null||as==null){Dr.a=1;break r}var ls=as;for(sn=cr=0;sn<_r;++sn){var Fr=os[sn],cs=Fr.G,Ts=Fr.H,Qa=0,ua=1,Ln=0;for(Qt=0;5>Qt;++Qt){yn=gd[Qt],cs[Qt]=ls,Ts[Qt]=cr,!Qt&&0<Zr&&(yn+=1<<Zr);s:{var Io,Ol=yn,Fo=Dr,so=Yn,Wp=ls,Hp=cr,Dl=0,Oa=Fo.m,Gp=te(Oa,1);if(s(so,0,0,Ol),Gp){var Vp=te(Oa,1)+1,Yp=te(Oa,1),kd=te(Oa,Yp==0?1:8);so[kd]=1,Vp==2&&(so[kd=te(Oa,8)]=1);var Oo=1}else{var Ad=i(19),Cd=te(Oa,4)+4;if(19<Cd){Fo.a=3;var Do=0;break s}for(Io=0;Io<Cd;++Io)Ad[vp[Io]]=te(Oa,3);var Rl=void 0,ao=void 0,Ld=Fo,Kp=Ad,Ro=Ol,Ed=so,Bl=0,Da=Ld.m,Pd=8,Td=c(128,R);n:for(;S(Td,0,7,Kp,19);){if(te(Da,1)){var Jp=2+2*te(Da,3);if((Rl=2+te(Da,Jp))>Ro)break n}else Rl=Ro;for(ao=0;ao<Ro&&Rl--;){we(Da);var Id=Td[0+(127&Z(Da))];fe(Da,Da.u+Id.g);var Ni=Id.value;if(16>Ni)Ed[ao++]=Ni,Ni!=0&&(Pd=Ni);else{var Zp=Ni==16,Fd=Ni-16,Xp=bp[Fd],Od=te(Da,yp[Fd])+Xp;if(ao+Od>Ro)break n;for(var Qp=Zp?Pd:0;0<Od--;)Ed[ao++]=Qp}}Bl=1;break n}Bl||(Ld.a=3),Oo=Bl}(Oo=Oo&&!Oa.h)&&(Dl=S(Wp,Hp,8,so,Ol)),Oo&&Dl!=0?Do=Dl:(Fo.a=3,Do=0)}if(Do==0)break r;if(ua&&wp[Qt]==1&&(ua=ls[cr].g==0),Qa+=ls[cr].g,cr+=Do,3>=Qt){var io,Ml=Yn[0];for(io=1;io<yn;++io)Yn[io]>Ml&&(Ml=Yn[io]);Ln+=Ml}}if(Fr.nd=ua,Fr.Qb=0,ua&&(Fr.qb=(cs[3][Ts[3]+0].value<<24|cs[1][Ts[1]+0].value<<16|cs[2][Ts[2]+0].value)>>>0,Qa==0&&256>cs[0][Ts[0]+0].value&&(Fr.Qb=1,Fr.qb+=cs[0][Ts[0]+0].value<<8)),Fr.jc=!Fr.Qb&&6>Ln,Fr.jc){var Bo,ha=Fr;for(Bo=0;Bo<Ja;++Bo){var Ra=Bo,Ba=ha.pd[Ra],Mo=ha.G[0][ha.H[0]+Ra];256<=Mo.value?(Ba.g=Mo.g+256,Ba.value=Mo.value):(Ba.g=0,Ba.value=0,Ra>>=Cr(Mo,8,Ba),Ra>>=Cr(ha.G[1][ha.H[1]+Ra],16,Ba),Ra>>=Cr(ha.G[2][ha.H[2]+Ra],0,Ba),Cr(ha.G[3][ha.H[3]+Ra],24,Ba))}}}xn.vc=hr,xn.Wb=_r,xn.Ya=os,xn.yc=as,pt=1;break t}pt=0}if(!(q=pt)){k.a=3;break e}if(0<De){if(se.ua=1<<De,!T(se.Wa,De)){k.a=1,q=0;break e}}else se.ua=0;var Ul=k,Dd=W,e0=J,zl=Ul.s,ql=zl.xc;if(Ul.c=Dd,Ul.i=e0,zl.md=M(Dd,ql),zl.wc=ql==0?-1:(1<<ql)-1,v){k.xb=Pp;break e}if((_e=i(W*J))==null){k.a=1,q=0;break e}q=(q=$r(k,_e,0,W,J,J,null))&&!ee.h;break e}return q?(B!=null?B[0]=_e:(r(_e==null),r(v)),k.$=0,v||Yr(se)):Yr(se),q}function Kr(l,f){var v=l.c*l.i,k=v+f+16*f;return r(l.c<=f),l.V=i(k),l.V==null?(l.Ta=null,l.Ua=0,l.a=1,0):(l.Ta=l.V,l.Ua=l.Ba+v+f,1)}function xe(l,f){var v=l.C,k=f-v,B=l.V,q=l.Ba+l.c*v;for(r(f<=l.l.o);0<k;){var W=16<k?16:k,J=l.l.ma,ee=l.l.width,se=ee*W,_e=J.ca,De=J.tb+ee*v,ae=l.Ta,ke=l.Ua;es(l,W,B,q),ld(ae,ke,_e,De,se),tn(J,v,v+W,_e,De,ee),k-=W,B+=W*l.c,v+=W}r(v==f),l.C=l.Ma=f}function ze(){this.ub=this.yd=this.td=this.Rb=0}function We(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Qe(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function at(){this.Yb=(function(){var l=[];return(function f(v,k,B){for(var q=B[k],W=0;W<q&&(v.push(B.length>k+1?[]:0),!(B.length<k+1));W++)f(v[W],k+1,B)})(l,0,[3,11]),l})()}function tt(){this.jb=i(3),this.Wc=o([4,8],at),this.Xc=o([4,17],at)}function rt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function it(){this.ld=this.La=this.dd=this.tc=0}function At(){this.Na=this.la=0}function _t(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function $t(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Yt(){this.uc=this.M=this.Nb=0,this.wa=Array(new it),this.Y=0,this.ya=Array(new $t),this.aa=0,this.l=new Pn}function gt(){this.y=i(16),this.f=i(8),this.ea=i(8)}function Wt(){this.cb=this.a=0,this.sc="",this.m=new C,this.Od=new ze,this.Kc=new We,this.ed=new rt,this.Qa=new Qe,this.Ic=this.$c=this.Aa=0,this.D=new Yt,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=c(8,C),this.ia=0,this.pb=c(4,_t),this.Pa=new tt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new gt),this.Hd=0,this.rb=Array(new At),this.sb=0,this.wa=Array(new it),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new $t),this.L=this.aa=0,this.gd=o([4,2],it),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function ir(l,f){return 0>l?0:l>f?f:l}function Pn(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function ys(){var l=new Wt;return l!=null&&(l.a=0,l.sc="OK",l.cb=0,l.Xb=0,ro||(ro=ur)),l}function Ar(l,f,v){return l.a==0&&(l.a=f,l.sc=v,l.cb=0),0}function He(l,f,v){return 3<=v&&l[f+0]==157&&l[f+1]==1&&l[f+2]==42}function ft(l,f){if(l==null)return 0;if(l.a=0,l.sc="OK",f==null)return Ar(l,2,"null VP8Io passed to VP8GetHeaders()");var v=f.data,k=f.w,B=f.ha;if(4>B)return Ar(l,7,"Truncated header.");var q=v[k+0]|v[k+1]<<8|v[k+2]<<16,W=l.Od;if(W.Rb=!(1&q),W.td=q>>1&7,W.yd=q>>4&1,W.ub=q>>5,3<W.td)return Ar(l,3,"Incorrect keyframe parameters.");if(!W.yd)return Ar(l,4,"Frame not displayable.");k+=3,B-=3;var J=l.Kc;if(W.Rb){if(7>B)return Ar(l,7,"cannot parse picture header");if(!He(v,k,B))return Ar(l,3,"Bad code word");J.c=16383&(v[k+4]<<8|v[k+3]),J.Td=v[k+4]>>6,J.i=16383&(v[k+6]<<8|v[k+5]),J.Ud=v[k+6]>>6,k+=7,B-=7,l.za=J.c+15>>4,l.Ub=J.i+15>>4,f.width=J.c,f.height=J.i,f.Da=0,f.j=0,f.v=0,f.va=f.width,f.o=f.height,f.da=0,f.ib=f.width,f.hb=f.height,f.U=f.width,f.T=f.height,s((q=l.Pa).jb,0,255,q.jb.length),r((q=l.Qa)!=null),q.Cb=0,q.Bb=0,q.Fb=1,s(q.Zb,0,0,q.Zb.length),s(q.Lb,0,0,q.Lb)}if(W.ub>B)return Ar(l,7,"bad partition length");ve(q=l.m,v,k,W.ub),k+=W.ub,B-=W.ub,W.Rb&&(J.Ld=Ce(q),J.Kd=Ce(q)),J=l.Qa;var ee,se=l.Pa;if(r(q!=null),r(J!=null),J.Cb=Ce(q),J.Cb){if(J.Bb=Ce(q),Ce(q)){for(J.Fb=Ce(q),ee=0;4>ee;++ee)J.Zb[ee]=Ce(q)?oe(q,7):0;for(ee=0;4>ee;++ee)J.Lb[ee]=Ce(q)?oe(q,6):0}if(J.Bb)for(ee=0;3>ee;++ee)se.jb[ee]=Ce(q)?le(q,8):255}else J.Bb=0;if(q.Ka)return Ar(l,3,"cannot parse segment header");if((J=l.ed).zd=Ce(q),J.Tb=le(q,6),J.wb=le(q,3),J.Pc=Ce(q),J.Pc&&Ce(q)){for(se=0;4>se;++se)Ce(q)&&(J.vd[se]=oe(q,6));for(se=0;4>se;++se)Ce(q)&&(J.od[se]=oe(q,6))}if(l.L=J.Tb==0?0:J.zd?1:2,q.Ka)return Ar(l,3,"cannot parse filter header");var _e=B;if(B=ee=k,k=ee+_e,J=_e,l.Xb=(1<<le(l.m,2))-1,_e<3*(se=l.Xb))v=7;else{for(ee+=3*se,J-=3*se,_e=0;_e<se;++_e){var De=v[B+0]|v[B+1]<<8|v[B+2]<<16;De>J&&(De=J),ve(l.Jc[+_e],v,ee,De),ee+=De,J-=De,B+=3}ve(l.Jc[+se],v,ee,J),v=ee<k?0:5}if(v!=0)return Ar(l,v,"cannot parse partitions");for(v=le(ee=l.m,7),B=Ce(ee)?oe(ee,4):0,k=Ce(ee)?oe(ee,4):0,J=Ce(ee)?oe(ee,4):0,se=Ce(ee)?oe(ee,4):0,ee=Ce(ee)?oe(ee,4):0,_e=l.Qa,De=0;4>De;++De){if(_e.Cb){var ae=_e.Zb[De];_e.Fb||(ae+=v)}else{if(0<De){l.pb[De]=l.pb[0];continue}ae=v}var ke=l.pb[De];ke.Sc[0]=Tl[ir(ae+B,127)],ke.Sc[1]=Il[ir(ae+0,127)],ke.Eb[0]=2*Tl[ir(ae+k,127)],ke.Eb[1]=101581*Il[ir(ae+J,127)]>>16,8>ke.Eb[1]&&(ke.Eb[1]=8),ke.Qc[0]=Tl[ir(ae+se,117)],ke.Qc[1]=Il[ir(ae+ee,127)],ke.lc=ae+ee}if(!W.Rb)return Ar(l,4,"Not a key frame.");for(Ce(q),W=l.Pa,v=0;4>v;++v){for(B=0;8>B;++B)for(k=0;3>k;++k)for(J=0;11>J;++J)se=Re(q,Lp[v][B][k][J])?le(q,8):Ap[v][B][k][J],W.Wc[v][B].Yb[k][J]=se;for(B=0;17>B;++B)W.Xc[v][B]=W.Wc[v][Ep[B]]}return l.kc=Ce(q),l.kc&&(l.Bd=le(q,8)),l.cb=1}function ur(l,f,v,k,B,q,W){var J=f[B].Yb[v];for(v=0;16>B;++B){if(!Re(l,J[v+0]))return B;for(;!Re(l,J[v+1]);)if(J=f[++B].Yb[0],v=0,B==16)return 16;var ee=f[B+1].Yb;if(Re(l,J[v+2])){var se=l,_e=0;if(Re(se,(ae=J)[(De=v)+3]))if(Re(se,ae[De+6])){for(J=0,De=2*(_e=Re(se,ae[De+8]))+(ae=Re(se,ae[De+9+_e])),_e=0,ae=Sp[De];ae[J];++J)_e+=_e+Re(se,ae[J]);_e+=3+(8<<De)}else Re(se,ae[De+7])?(_e=7+2*Re(se,165),_e+=Re(se,145)):_e=5+Re(se,159);else _e=Re(se,ae[De+4])?3+Re(se,ae[De+5]):2;J=ee[2]}else _e=1,J=ee[1];ee=W+kp[B],0>(se=l).b&&Se(se);var De,ae=se.b,ke=(De=se.Ca>>1)-(se.I>>ae)>>31;--se.b,se.Ca+=ke,se.Ca|=1,se.I-=(De+1&ke)<<ae,q[ee]=((_e^ke)-ke)*k[(0<B)+0]}return 16}function Wr(l){var f=l.rb[l.sb-1];f.la=0,f.Na=0,s(l.zc,0,0,l.zc.length),l.ja=0}function Mr(l,f,v,k,B){B=l[f+v+32*k]+(B>>3),l[f+v+32*k]=-256&B?0>B?0:255:B}function Lr(l,f,v,k,B,q){Mr(l,f,0,v,k+B),Mr(l,f,1,v,k+q),Mr(l,f,2,v,k-q),Mr(l,f,3,v,k-B)}function Hn(l){return(20091*l>>16)+l}function ba(l,f,v,k){var B,q=0,W=i(16);for(B=0;4>B;++B){var J=l[f+0]+l[f+8],ee=l[f+0]-l[f+8],se=(35468*l[f+4]>>16)-Hn(l[f+12]),_e=Hn(l[f+4])+(35468*l[f+12]>>16);W[q+0]=J+_e,W[q+1]=ee+se,W[q+2]=ee-se,W[q+3]=J-_e,q+=4,f++}for(B=q=0;4>B;++B)J=(l=W[q+0]+4)+W[q+8],ee=l-W[q+8],se=(35468*W[q+4]>>16)-Hn(W[q+12]),Mr(v,k,0,0,J+(_e=Hn(W[q+4])+(35468*W[q+12]>>16))),Mr(v,k,1,0,ee+se),Mr(v,k,2,0,ee-se),Mr(v,k,3,0,J-_e),q++,k+=32}function Jr(l,f,v,k){var B=l[f+0]+4,q=35468*l[f+4]>>16,W=Hn(l[f+4]),J=35468*l[f+1]>>16;Lr(v,k,0,B+W,l=Hn(l[f+1]),J),Lr(v,k,1,B+q,l,J),Lr(v,k,2,B-q,l,J),Lr(v,k,3,B-W,l,J)}function wa(l,f,v,k,B){ba(l,f,v,k),B&&ba(l,f+16,v,k+4)}function Ir(l,f,v,k){Xa(l,f+0,v,k,1),Xa(l,f+32,v,k+128,1)}function va(l,f,v,k){var B;for(l=l[f+0]+4,B=0;4>B;++B)for(f=0;4>f;++f)Mr(v,k,f,B,l)}function Na(l,f,v,k){l[f+0]&&br(l,f+0,v,k),l[f+16]&&br(l,f+16,v,k+4),l[f+32]&&br(l,f+32,v,k+128),l[f+48]&&br(l,f+48,v,k+128+4)}function $s(l,f,v,k){var B,q=i(16);for(B=0;4>B;++B){var W=l[f+0+B]+l[f+12+B],J=l[f+4+B]+l[f+8+B],ee=l[f+4+B]-l[f+8+B],se=l[f+0+B]-l[f+12+B];q[0+B]=W+J,q[8+B]=W-J,q[4+B]=se+ee,q[12+B]=se-ee}for(B=0;4>B;++B)W=(l=q[0+4*B]+3)+q[3+4*B],J=q[1+4*B]+q[2+4*B],ee=q[1+4*B]-q[2+4*B],se=l-q[3+4*B],v[k+0]=W+J>>3,v[k+16]=se+ee>>3,v[k+32]=W-J>>3,v[k+48]=se-ee>>3,k+=64}function Ws(l,f,v){var k,B=f-32,q=ss,W=255-l[B-1];for(k=0;k<v;++k){var J,ee=q,se=W+l[f-1];for(J=0;J<v;++J)l[f+J]=ee[se+l[B+J]];f+=32}}function $a(l,f){Ws(l,f,4)}function di(l,f){Ws(l,f,8)}function ra(l,f){Ws(l,f,16)}function _a(l,f){var v;for(v=0;16>v;++v)a(l,f+32*v,l,f-32,16)}function ui(l,f){var v;for(v=16;0<v;--v)s(l,f,l[f-1],16),f+=32}function Bn(l,f,v){var k;for(k=0;16>k;++k)s(f,v+32*k,l,16)}function hi(l,f){var v,k=16;for(v=0;16>v;++v)k+=l[f-1+32*v]+l[f+v-32];Bn(k>>5,l,f)}function ks(l,f){var v,k=8;for(v=0;16>v;++v)k+=l[f-1+32*v];Bn(k>>4,l,f)}function Wa(l,f){var v,k=8;for(v=0;16>v;++v)k+=l[f+v-32];Bn(k>>4,l,f)}function fi(l,f){Bn(128,l,f)}function Ht(l,f,v){return l+2*f+v+2>>2}function pi(l,f){var v,k=f-32;for(k=new Uint8Array([Ht(l[k-1],l[k+0],l[k+1]),Ht(l[k+0],l[k+1],l[k+2]),Ht(l[k+1],l[k+2],l[k+3]),Ht(l[k+2],l[k+3],l[k+4])]),v=0;4>v;++v)a(l,f+32*v,k,0,k.length)}function mi(l,f){var v=l[f-1],k=l[f-1+32],B=l[f-1+64],q=l[f-1+96];Me(l,f+0,16843009*Ht(l[f-1-32],v,k)),Me(l,f+32,16843009*Ht(v,k,B)),Me(l,f+64,16843009*Ht(k,B,q)),Me(l,f+96,16843009*Ht(B,q,q))}function $i(l,f){var v,k=4;for(v=0;4>v;++v)k+=l[f+v-32]+l[f-1+32*v];for(k>>=3,v=0;4>v;++v)s(l,f+32*v,k,4)}function As(l,f){var v=l[f-1+0],k=l[f-1+32],B=l[f-1+64],q=l[f-1-32],W=l[f+0-32],J=l[f+1-32],ee=l[f+2-32],se=l[f+3-32];l[f+0+96]=Ht(k,B,l[f-1+96]),l[f+1+96]=l[f+0+64]=Ht(v,k,B),l[f+2+96]=l[f+1+64]=l[f+0+32]=Ht(q,v,k),l[f+3+96]=l[f+2+64]=l[f+1+32]=l[f+0+0]=Ht(W,q,v),l[f+3+64]=l[f+2+32]=l[f+1+0]=Ht(J,W,q),l[f+3+32]=l[f+2+0]=Ht(ee,J,W),l[f+3+0]=Ht(se,ee,J)}function bs(l,f){var v=l[f+1-32],k=l[f+2-32],B=l[f+3-32],q=l[f+4-32],W=l[f+5-32],J=l[f+6-32],ee=l[f+7-32];l[f+0+0]=Ht(l[f+0-32],v,k),l[f+1+0]=l[f+0+32]=Ht(v,k,B),l[f+2+0]=l[f+1+32]=l[f+0+64]=Ht(k,B,q),l[f+3+0]=l[f+2+32]=l[f+1+64]=l[f+0+96]=Ht(B,q,W),l[f+3+32]=l[f+2+64]=l[f+1+96]=Ht(q,W,J),l[f+3+64]=l[f+2+96]=Ht(W,J,ee),l[f+3+96]=Ht(J,ee,ee)}function Wi(l,f){var v=l[f-1+0],k=l[f-1+32],B=l[f-1+64],q=l[f-1-32],W=l[f+0-32],J=l[f+1-32],ee=l[f+2-32],se=l[f+3-32];l[f+0+0]=l[f+1+64]=q+W+1>>1,l[f+1+0]=l[f+2+64]=W+J+1>>1,l[f+2+0]=l[f+3+64]=J+ee+1>>1,l[f+3+0]=ee+se+1>>1,l[f+0+96]=Ht(B,k,v),l[f+0+64]=Ht(k,v,q),l[f+0+32]=l[f+1+96]=Ht(v,q,W),l[f+1+32]=l[f+2+96]=Ht(q,W,J),l[f+2+32]=l[f+3+96]=Ht(W,J,ee),l[f+3+32]=Ht(J,ee,se)}function Hi(l,f){var v=l[f+0-32],k=l[f+1-32],B=l[f+2-32],q=l[f+3-32],W=l[f+4-32],J=l[f+5-32],ee=l[f+6-32],se=l[f+7-32];l[f+0+0]=v+k+1>>1,l[f+1+0]=l[f+0+64]=k+B+1>>1,l[f+2+0]=l[f+1+64]=B+q+1>>1,l[f+3+0]=l[f+2+64]=q+W+1>>1,l[f+0+32]=Ht(v,k,B),l[f+1+32]=l[f+0+96]=Ht(k,B,q),l[f+2+32]=l[f+1+96]=Ht(B,q,W),l[f+3+32]=l[f+2+96]=Ht(q,W,J),l[f+3+64]=Ht(W,J,ee),l[f+3+96]=Ht(J,ee,se)}function na(l,f){var v=l[f-1+0],k=l[f-1+32],B=l[f-1+64],q=l[f-1+96];l[f+0+0]=v+k+1>>1,l[f+2+0]=l[f+0+32]=k+B+1>>1,l[f+2+32]=l[f+0+64]=B+q+1>>1,l[f+1+0]=Ht(v,k,B),l[f+3+0]=l[f+1+32]=Ht(k,B,q),l[f+3+32]=l[f+1+64]=Ht(B,q,q),l[f+3+64]=l[f+2+64]=l[f+0+96]=l[f+1+96]=l[f+2+96]=l[f+3+96]=q}function ja(l,f){var v=l[f-1+0],k=l[f-1+32],B=l[f-1+64],q=l[f-1+96],W=l[f-1-32],J=l[f+0-32],ee=l[f+1-32],se=l[f+2-32];l[f+0+0]=l[f+2+32]=v+W+1>>1,l[f+0+32]=l[f+2+64]=k+v+1>>1,l[f+0+64]=l[f+2+96]=B+k+1>>1,l[f+0+96]=q+B+1>>1,l[f+3+0]=Ht(J,ee,se),l[f+2+0]=Ht(W,J,ee),l[f+1+0]=l[f+3+32]=Ht(v,W,J),l[f+1+32]=l[f+3+64]=Ht(k,v,W),l[f+1+64]=l[f+3+96]=Ht(B,k,v),l[f+1+96]=Ht(q,B,k)}function sa(l,f){var v;for(v=0;8>v;++v)a(l,f+32*v,l,f-32,8)}function Gi(l,f){var v;for(v=0;8>v;++v)s(l,f,l[f-1],8),f+=32}function ws(l,f,v){var k;for(k=0;8>k;++k)s(f,v+32*k,l,8)}function Vi(l,f){var v,k=8;for(v=0;8>v;++v)k+=l[f+v-32]+l[f-1+32*v];ws(k>>4,l,f)}function Ha(l,f){var v,k=4;for(v=0;8>v;++v)k+=l[f+v-32];ws(k>>3,l,f)}function Ga(l,f){var v,k=4;for(v=0;8>v;++v)k+=l[f-1+32*v];ws(k>>3,l,f)}function gi(l,f){ws(128,l,f)}function Gn(l,f,v){var k=l[f-v],B=l[f+0],q=3*(B-k)+Al[1020+l[f-2*v]-l[f+v]],W=jo[112+(q+4>>3)];l[f-v]=ss[255+k+jo[112+(q+3>>3)]],l[f+0]=ss[255+B-W]}function Va(l,f,v,k){var B=l[f+0],q=l[f+v];return Ns[255+l[f-2*v]-l[f-v]]>k||Ns[255+q-B]>k}function aa(l,f,v,k){return 4*Ns[255+l[f-v]-l[f+0]]+Ns[255+l[f-2*v]-l[f+v]]<=k}function Ya(l,f,v,k,B){var q=l[f-3*v],W=l[f-2*v],J=l[f-v],ee=l[f+0],se=l[f+v],_e=l[f+2*v],De=l[f+3*v];return 4*Ns[255+J-ee]+Ns[255+W-se]>k?0:Ns[255+l[f-4*v]-q]<=B&&Ns[255+q-W]<=B&&Ns[255+W-J]<=B&&Ns[255+De-_e]<=B&&Ns[255+_e-se]<=B&&Ns[255+se-ee]<=B}function ia(l,f,v,k){var B=2*k+1;for(k=0;16>k;++k)aa(l,f+k,v,B)&&Gn(l,f+k,v)}function Ka(l,f,v,k){var B=2*k+1;for(k=0;16>k;++k)aa(l,f+k*v,1,B)&&Gn(l,f+k*v,1)}function Sa(l,f,v,k){var B;for(B=3;0<B;--B)ia(l,f+=4*v,v,k)}function xi(l,f,v,k){var B;for(B=3;0<B;--B)Ka(l,f+=4,v,k)}function Cs(l,f,v,k,B,q,W,J){for(q=2*q+1;0<B--;){if(Ya(l,f,v,q,W))if(Va(l,f,v,J))Gn(l,f,v);else{var ee=l,se=f,_e=v,De=ee[se-2*_e],ae=ee[se-_e],ke=ee[se+0],Pe=ee[se+_e],Ue=ee[se+2*_e],Oe=27*(Ye=Al[1020+3*(ke-ae)+Al[1020+De-Pe]])+63>>7,$e=18*Ye+63>>7,Ye=9*Ye+63>>7;ee[se-3*_e]=ss[255+ee[se-3*_e]+Ye],ee[se-2*_e]=ss[255+De+$e],ee[se-_e]=ss[255+ae+Oe],ee[se+0]=ss[255+ke-Oe],ee[se+_e]=ss[255+Pe-$e],ee[se+2*_e]=ss[255+Ue-Ye]}f+=k}}function Ls(l,f,v,k,B,q,W,J){for(q=2*q+1;0<B--;){if(Ya(l,f,v,q,W))if(Va(l,f,v,J))Gn(l,f,v);else{var ee=l,se=f,_e=v,De=ee[se-_e],ae=ee[se+0],ke=ee[se+_e],Pe=jo[112+(4+(Ue=3*(ae-De))>>3)],Ue=jo[112+(Ue+3>>3)],Oe=Pe+1>>1;ee[se-2*_e]=ss[255+ee[se-2*_e]+Oe],ee[se-_e]=ss[255+De+Ue],ee[se+0]=ss[255+ae-Pe],ee[se+_e]=ss[255+ke-Oe]}f+=k}}function yi(l,f,v,k,B,q){Cs(l,f,v,1,16,k,B,q)}function ts(l,f,v,k,B,q){Cs(l,f,1,v,16,k,B,q)}function bi(l,f,v,k,B,q){var W;for(W=3;0<W;--W)Ls(l,f+=4*v,v,1,16,k,B,q)}function g(l,f,v,k,B,q){var W;for(W=3;0<W;--W)Ls(l,f+=4,1,v,16,k,B,q)}function D(l,f,v,k,B,q,W,J){Cs(l,f,B,1,8,q,W,J),Cs(v,k,B,1,8,q,W,J)}function ne(l,f,v,k,B,q,W,J){Cs(l,f,1,B,8,q,W,J),Cs(v,k,1,B,8,q,W,J)}function ye(l,f,v,k,B,q,W,J){Ls(l,f+4*B,B,1,8,q,W,J),Ls(v,k+4*B,B,1,8,q,W,J)}function Ee(l,f,v,k,B,q,W,J){Ls(l,f+4,1,B,8,q,W,J),Ls(v,k+4,1,B,8,q,W,J)}function Ge(){this.ba=new Ot,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Xt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Ze(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function vt(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Pt(){this.ua=0,this.Wa=new $,this.vb=new $,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new re,this.yc=new R}function qt(){this.xb=this.a=0,this.l=new Pn,this.ca=new Ot,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new G,this.Pb=0,this.wd=new G,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Pt,this.ab=0,this.gc=c(4,vt),this.Oc=0}function Jt(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Pn,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function or(l,f,v,k,B,q,W){for(l=l==null?0:l[f+0],f=0;f<W;++f)B[q+f]=l+v[k+f]&255,l=B[q+f]}function F(l,f,v,k,B,q,W){var J;if(l==null)or(null,null,v,k,B,q,W);else for(J=0;J<W;++J)B[q+J]=l[f+J]+v[k+J]&255}function de(l,f,v,k,B,q,W){if(l==null)or(null,null,v,k,B,q,W);else{var J,ee=l[f+0],se=ee,_e=ee;for(J=0;J<W;++J)se=_e+(ee=l[f+J])-se,_e=v[k+J]+(-256&se?0>se?0:255:se)&255,se=ee,B[q+J]=_e}}function me(l,f,v,k){var B=f.width,q=f.o;if(r(l!=null&&f!=null),0>v||0>=k||v+k>q)return null;if(!l.Cc){if(l.ga==null){var W;if(l.ga=new Jt,(W=l.ga==null)||(W=f.width*f.o,r(l.Gb.length==0),l.Gb=i(W),l.Uc=0,l.Gb==null?W=0:(l.mb=l.Gb,l.nb=l.Uc,l.rc=null,W=1),W=!W),!W){W=l.ga;var J=l.Fa,ee=l.P,se=l.qc,_e=l.mb,De=l.nb,ae=ee+1,ke=se-1,Pe=W.l;if(r(J!=null&&_e!=null&&f!=null),Fa[0]=null,Fa[1]=or,Fa[2]=F,Fa[3]=de,W.ca=_e,W.tb=De,W.c=f.width,W.i=f.height,r(0<W.c&&0<W.i),1>=se)f=0;else if(W.$a=3&J[ee+0],W.Z=J[ee+0]>>2&3,W.Lc=J[ee+0]>>4&3,ee=J[ee+0]>>6&3,0>W.$a||1<W.$a||4<=W.Z||1<W.Lc||ee)f=0;else if(Pe.put=Ut,Pe.ac=fn,Pe.bc=pn,Pe.ma=W,Pe.width=f.width,Pe.height=f.height,Pe.Da=f.Da,Pe.v=f.v,Pe.va=f.va,Pe.j=f.j,Pe.o=f.o,W.$a)e:{r(W.$a==1),f=En();t:for(;;){if(f==null){f=0;break e}if(r(W!=null),W.mc=f,f.c=W.c,f.i=W.i,f.l=W.l,f.l.ma=W,f.l.width=W.c,f.l.height=W.i,f.a=0,ie(f.m,J,ae,ke),!lt(W.c,W.i,1,f,null)||(f.ab==1&&f.gc[0].hc==3&&Sn(f.s)?(W.ic=1,J=f.c*f.i,f.Ta=null,f.Ua=0,f.V=i(J),f.Ba=0,f.V==null?(f.a=1,f=0):f=1):(W.ic=0,f=Kr(f,W.c)),!f))break t;f=1;break e}W.mc=null,f=0}else f=ke>=W.c*W.i;W=!f}if(W)return null;l.ga.Lc!=1?l.Ga=0:k=q-v}r(l.ga!=null),r(v+k<=q);e:{if(f=(J=l.ga).c,q=J.l.o,J.$a==0){if(ae=l.rc,ke=l.Vc,Pe=l.Fa,ee=l.P+1+v*f,se=l.mb,_e=l.nb+v*f,r(ee<=l.P+l.qc),J.Z!=0)for(r(Fa[J.Z]!=null),W=0;W<k;++W)Fa[J.Z](ae,ke,Pe,ee,se,_e,f),ae=se,ke=_e,_e+=f,ee+=f;else for(W=0;W<k;++W)a(se,_e,Pe,ee,f),ae=se,ke=_e,_e+=f,ee+=f;l.rc=ae,l.Vc=ke}else{if(r(J.mc!=null),f=v+k,r((W=J.mc)!=null),r(f<=W.i),W.C>=f)f=1;else if(J.ic||qe(),J.ic){J=W.V,ae=W.Ba,ke=W.c;var Ue=W.i,Oe=(Pe=1,ee=W.$/ke,se=W.$%ke,_e=W.m,De=W.s,W.$),$e=ke*Ue,Ye=ke*f,nt=De.wc,et=Oe<Ye?dr(De,se,ee):null;r(Oe<=$e),r(f<=Ue),r(Sn(De));t:for(;;){for(;!_e.h&&Oe<Ye;){if(se&nt||(et=dr(De,se,ee)),r(et!=null),we(_e),256>(Ue=gr(et.G[0],et.H[0],_e)))J[ae+Oe]=Ue,++Oe,++se>=ke&&(se=0,++ee<=f&&!(ee%16)&&kn(W,ee));else{if(!(280>Ue)){Pe=0;break t}Ue=Vr(Ue-256,_e);var Bt,St=gr(et.G[4],et.H[4],_e);if(we(_e),!(Oe>=(St=qr(ke,St=Vr(St,_e)))&&$e-Oe>=Ue)){Pe=0;break t}for(Bt=0;Bt<Ue;++Bt)J[ae+Oe+Bt]=J[ae+Oe+Bt-St];for(Oe+=Ue,se+=Ue;se>=ke;)se-=ke,++ee<=f&&!(ee%16)&&kn(W,ee);Oe<Ye&&se&nt&&(et=dr(De,se,ee))}r(_e.h==Q(_e))}kn(W,ee>f?f:ee);break t}!Pe||_e.h&&Oe<$e?(Pe=0,W.a=_e.h?5:3):W.$=Oe,f=Pe}else f=$r(W,W.V,W.Ba,W.c,W.i,f,xe);if(!f){k=0;break e}}v+k>=q&&(l.Cc=1),k=1}if(!k)return null;if(l.Cc&&((k=l.ga)!=null&&(k.mc=null),l.ga=null,0<l.Ga))return alert("todo:WebPDequantizeLevels"),null}return l.nb+v*B}function ge(l,f,v,k,B,q){for(;0<B--;){var W,J=l,ee=f+(v?1:0),se=l,_e=f+(v?0:3);for(W=0;W<k;++W){var De=se[_e+4*W];De!=255&&(De*=32897,J[ee+4*W+0]=J[ee+4*W+0]*De>>23,J[ee+4*W+1]=J[ee+4*W+1]*De>>23,J[ee+4*W+2]=J[ee+4*W+2]*De>>23)}f+=q}}function he(l,f,v,k,B){for(;0<k--;){var q;for(q=0;q<v;++q){var W=l[f+2*q+0],J=15&(se=l[f+2*q+1]),ee=4369*J,se=(240&se|se>>4)*ee>>16;l[f+2*q+0]=(240&W|W>>4)*ee>>16&240|(15&W|W<<4)*ee>>16>>4&15,l[f+2*q+1]=240&se|J}f+=B}}function Ne(l,f,v,k,B,q,W,J){var ee,se,_e=255;for(se=0;se<B;++se){for(ee=0;ee<k;++ee){var De=l[f+ee];q[W+4*ee]=De,_e&=De}f+=v,W+=J}return _e!=255}function Fe(l,f,v,k,B){var q;for(q=0;q<B;++q)v[k+q]=l[f+q]>>8}function qe(){to=ge,id=he,od=Ne,ld=Fe}function Ke(l,f,v){P[l]=function(k,B,q,W,J,ee,se,_e,De,ae,ke,Pe,Ue,Oe,$e,Ye,nt){var et,Bt=nt-1>>1,St=J[ee+0]|se[_e+0]<<16,nr=De[ae+0]|ke[Pe+0]<<16;r(k!=null);var Tt=3*St+nr+131074>>2;for(f(k[B+0],255&Tt,Tt>>16,Ue,Oe),q!=null&&(Tt=3*nr+St+131074>>2,f(q[W+0],255&Tt,Tt>>16,$e,Ye)),et=1;et<=Bt;++et){var lr=J[ee+et]|se[_e+et]<<16,gn=De[ae+et]|ke[Pe+et]<<16,sr=St+lr+nr+gn+524296,It=sr+2*(lr+nr)>>3;Tt=It+St>>1,St=(sr=sr+2*(St+gn)>>3)+lr>>1,f(k[B+2*et-1],255&Tt,Tt>>16,Ue,Oe+(2*et-1)*v),f(k[B+2*et-0],255&St,St>>16,Ue,Oe+(2*et-0)*v),q!=null&&(Tt=sr+nr>>1,St=It+gn>>1,f(q[W+2*et-1],255&Tt,Tt>>16,$e,Ye+(2*et-1)*v),f(q[W+2*et+0],255&St,St>>16,$e,Ye+(2*et+0)*v)),St=lr,nr=gn}1&nt||(Tt=3*St+nr+131074>>2,f(k[B+nt-1],255&Tt,Tt>>16,Ue,Oe+(nt-1)*v),q!=null&&(Tt=3*nr+St+131074>>2,f(q[W+nt-1],255&Tt,Tt>>16,$e,Ye+(nt-1)*v)))}}function ut(){_s[So]=Tp,_s[ko]=bd,_s[pd]=Ip,_s[Ao]=wd,_s[Co]=vd,_s[Cl]=Nd,_s[md]=Fp,_s[Ll]=bd,_s[El]=wd,_s[Lo]=vd,_s[Pl]=Nd}function Xe(l){return l&-16384?0>l?0:255:l>>Op}function ct(l,f){return Xe((19077*l>>8)+(26149*f>>8)-14234)}function be(l,f,v){return Xe((19077*l>>8)-(6419*f>>8)-(13320*v>>8)+8708)}function bt(l,f){return Xe((19077*l>>8)+(33050*f>>8)-17685)}function jt(l,f,v,k,B){k[B+0]=ct(l,v),k[B+1]=be(l,f,v),k[B+2]=bt(l,f)}function tr(l,f,v,k,B){k[B+0]=bt(l,f),k[B+1]=be(l,f,v),k[B+2]=ct(l,v)}function vr(l,f,v,k,B){var q=be(l,f,v);f=q<<3&224|bt(l,f)>>3,k[B+0]=248&ct(l,v)|q>>5,k[B+1]=f}function Dt(l,f,v,k,B){var q=240&bt(l,f)|15;k[B+0]=240&ct(l,v)|be(l,f,v)>>4,k[B+1]=q}function xr(l,f,v,k,B){k[B+0]=255,jt(l,f,v,k,B+1)}function Nr(l,f,v,k,B){tr(l,f,v,k,B),k[B+3]=255}function fr(l,f,v,k,B){jt(l,f,v,k,B),k[B+3]=255}function pr(l,f,v){P[l]=function(k,B,q,W,J,ee,se,_e,De){for(var ae=_e+(-2&De)*v;_e!=ae;)f(k[B+0],q[W+0],J[ee+0],se,_e),f(k[B+1],q[W+0],J[ee+0],se,_e+v),B+=2,++W,++ee,_e+=2*v;1&De&&f(k[B+0],q[W+0],J[ee+0],se,_e)}}function Mn(l,f,v){return v==0?l==0?f==0?6:5:f==0?4:0:v}function Un(l,f,v,k,B){switch(l>>>30){case 3:Xa(f,v,k,B,0);break;case 2:vs(f,v,k,B);break;case 1:br(f,v,k,B)}}function rr(l,f){var v,k,B=f.M,q=f.Nb,W=l.oc,J=l.pc+40,ee=l.oc,se=l.pc+584,_e=l.oc,De=l.pc+600;for(v=0;16>v;++v)W[J+32*v-1]=129;for(v=0;8>v;++v)ee[se+32*v-1]=129,_e[De+32*v-1]=129;for(0<B?W[J-1-32]=ee[se-1-32]=_e[De-1-32]=129:(s(W,J-32-1,127,21),s(ee,se-32-1,127,9),s(_e,De-32-1,127,9)),k=0;k<l.za;++k){var ae=f.ya[f.aa+k];if(0<k){for(v=-1;16>v;++v)a(W,J+32*v-4,W,J+32*v+12,4);for(v=-1;8>v;++v)a(ee,se+32*v-4,ee,se+32*v+4,4),a(_e,De+32*v-4,_e,De+32*v+4,4)}var ke=l.Gd,Pe=l.Hd+k,Ue=ae.ad,Oe=ae.Hc;if(0<B&&(a(W,J-32,ke[Pe].y,0,16),a(ee,se-32,ke[Pe].f,0,8),a(_e,De-32,ke[Pe].ea,0,8)),ae.Za){var $e=W,Ye=J-32+16;for(0<B&&(k>=l.za-1?s($e,Ye,ke[Pe].y[15],4):a($e,Ye,ke[Pe+1].y,0,4)),v=0;4>v;v++)$e[Ye+128+v]=$e[Ye+256+v]=$e[Ye+384+v]=$e[Ye+0+v];for(v=0;16>v;++v,Oe<<=2)$e=W,Ye=J+jd[v],Es[ae.Ob[v]]($e,Ye),Un(Oe,Ue,16*+v,$e,Ye)}else if($e=Mn(k,B,ae.Ob[0]),Ia[$e](W,J),Oe!=0)for(v=0;16>v;++v,Oe<<=2)Un(Oe,Ue,16*+v,W,J+jd[v]);for(v=ae.Gc,$e=Mn(k,B,ae.Dd),da[$e](ee,se),da[$e](_e,De),Oe=Ue,$e=ee,Ye=se,255&(ae=0|v)&&(170&ae?Vs(Oe,256,$e,Ye):Er(Oe,256,$e,Ye)),ae=_e,Oe=De,255&(v>>=8)&&(170&v?Vs(Ue,320,ae,Oe):Er(Ue,320,ae,Oe)),B<l.Ub-1&&(a(ke[Pe].y,0,W,J+480,16),a(ke[Pe].f,0,ee,se+224,8),a(ke[Pe].ea,0,_e,De+224,8)),v=8*q*l.B,ke=l.sa,Pe=l.ta+16*k+16*q*l.R,Ue=l.qa,ae=l.ra+8*k+v,Oe=l.Ha,$e=l.Ia+8*k+v,v=0;16>v;++v)a(ke,Pe+v*l.R,W,J+32*v,16);for(v=0;8>v;++v)a(Ue,ae+v*l.B,ee,se+32*v,8),a(Oe,$e+v*l.B,_e,De+32*v,8)}}function mr(l,f,v,k,B,q,W,J,ee){var se=[0],_e=[0],De=0,ae=ee!=null?ee.kd:0,ke=ee??new Ze;if(l==null||12>v)return 7;ke.data=l,ke.w=f,ke.ha=v,f=[f],v=[v],ke.gb=[ke.gb];e:{var Pe=f,Ue=v,Oe=ke.gb;if(r(l!=null),r(Ue!=null),r(Oe!=null),Oe[0]=0,12<=Ue[0]&&!e(l,Pe[0],"RIFF")){if(e(l,Pe[0]+8,"WEBP")){Oe=3;break e}var $e=j(l,Pe[0]+4);if(12>$e||4294967286<$e){Oe=3;break e}if(ae&&$e>Ue[0]-8){Oe=7;break e}Oe[0]=$e,Pe[0]+=12,Ue[0]-=12}Oe=0}if(Oe!=0)return Oe;for($e=0<ke.gb[0],v=v[0];;){e:{var Ye=l;Ue=f,Oe=v;var nt=se,et=_e,Bt=Pe=[0];if((Tt=De=[De])[0]=0,8>Oe[0])Oe=7;else{if(!e(Ye,Ue[0],"VP8X")){if(j(Ye,Ue[0]+4)!=10){Oe=3;break e}if(18>Oe[0]){Oe=7;break e}var St=j(Ye,Ue[0]+8),nr=1+je(Ye,Ue[0]+12);if(2147483648<=nr*(Ye=1+je(Ye,Ue[0]+15))){Oe=3;break e}Bt!=null&&(Bt[0]=St),nt!=null&&(nt[0]=nr),et!=null&&(et[0]=Ye),Ue[0]+=18,Oe[0]-=18,Tt[0]=1}Oe=0}}if(De=De[0],Pe=Pe[0],Oe!=0)return Oe;if(Ue=!!(2&Pe),!$e&&De)return 3;if(q!=null&&(q[0]=!!(16&Pe)),W!=null&&(W[0]=Ue),J!=null&&(J[0]=0),W=se[0],Pe=_e[0],De&&Ue&&ee==null){Oe=0;break}if(4>v){Oe=7;break}if($e&&De||!$e&&!De&&!e(l,f[0],"ALPH")){v=[v],ke.na=[ke.na],ke.P=[ke.P],ke.Sa=[ke.Sa];e:{St=l,Oe=f,$e=v;var Tt=ke.gb;nt=ke.na,et=ke.P,Bt=ke.Sa,nr=22,r(St!=null),r($e!=null),Ye=Oe[0];var lr=$e[0];for(r(nt!=null),r(Bt!=null),nt[0]=null,et[0]=null,Bt[0]=0;;){if(Oe[0]=Ye,$e[0]=lr,8>lr){Oe=7;break e}var gn=j(St,Ye+4);if(4294967286<gn){Oe=3;break e}var sr=8+gn+1&-2;if(nr+=sr,0<Tt&&nr>Tt){Oe=3;break e}if(!e(St,Ye,"VP8 ")||!e(St,Ye,"VP8L")){Oe=0;break e}if(lr[0]<sr){Oe=7;break e}e(St,Ye,"ALPH")||(nt[0]=St,et[0]=Ye+8,Bt[0]=gn),Ye+=sr,lr-=sr}}if(v=v[0],ke.na=ke.na[0],ke.P=ke.P[0],ke.Sa=ke.Sa[0],Oe!=0)break}v=[v],ke.Ja=[ke.Ja],ke.xa=[ke.xa];e:if(Tt=l,Oe=f,$e=v,nt=ke.gb[0],et=ke.Ja,Bt=ke.xa,St=Oe[0],Ye=!e(Tt,St,"VP8 "),nr=!e(Tt,St,"VP8L"),r(Tt!=null),r($e!=null),r(et!=null),r(Bt!=null),8>$e[0])Oe=7;else{if(Ye||nr){if(Tt=j(Tt,St+4),12<=nt&&Tt>nt-12){Oe=3;break e}if(ae&&Tt>$e[0]-8){Oe=7;break e}et[0]=Tt,Oe[0]+=8,$e[0]-=8,Bt[0]=nr}else Bt[0]=5<=$e[0]&&Tt[St+0]==47&&!(Tt[St+4]>>5),et[0]=$e[0];Oe=0}if(v=v[0],ke.Ja=ke.Ja[0],ke.xa=ke.xa[0],f=f[0],Oe!=0)break;if(4294967286<ke.Ja)return 3;if(J==null||Ue||(J[0]=ke.xa?2:1),W=[W],Pe=[Pe],ke.xa){if(5>v){Oe=7;break}J=W,ae=Pe,Ue=q,l==null||5>v?l=0:5<=v&&l[f+0]==47&&!(l[f+4]>>5)?($e=[0],Tt=[0],nt=[0],ie(et=new G,l,f,v),wn(et,$e,Tt,nt)?(J!=null&&(J[0]=$e[0]),ae!=null&&(ae[0]=Tt[0]),Ue!=null&&(Ue[0]=nt[0]),l=1):l=0):l=0}else{if(10>v){Oe=7;break}J=Pe,l==null||10>v||!He(l,f+3,v-3)?l=0:(ae=l[f+0]|l[f+1]<<8|l[f+2]<<16,Ue=16383&(l[f+7]<<8|l[f+6]),l=16383&(l[f+9]<<8|l[f+8]),1&ae||3<(ae>>1&7)||!(ae>>4&1)||ae>>5>=ke.Ja||!Ue||!l?l=0:(W&&(W[0]=Ue),J&&(J[0]=l),l=1))}if(!l||(W=W[0],Pe=Pe[0],De&&(se[0]!=W||_e[0]!=Pe)))return 3;ee!=null&&(ee[0]=ke,ee.offset=f-ee.w,r(4294967286>f-ee.w),r(ee.offset==ee.ha-v));break}return Oe==0||Oe==7&&De&&ee==null?(q!=null&&(q[0]|=ke.na!=null&&0<ke.na.length),k!=null&&(k[0]=W),B!=null&&(B[0]=Pe),0):Oe}function oa(l,f,v){var k=f.width,B=f.height,q=0,W=0,J=k,ee=B;if(f.Da=l!=null&&0<l.Da,f.Da&&(J=l.cd,ee=l.bd,q=l.v,W=l.j,11>v||(q&=-2,W&=-2),0>q||0>W||0>=J||0>=ee||q+J>k||W+ee>B))return 0;if(f.v=q,f.j=W,f.va=q+J,f.o=W+ee,f.U=J,f.T=ee,f.da=l!=null&&0<l.da,f.da){if(!z(J,ee,v=[l.ib],q=[l.hb]))return 0;f.ib=v[0],f.hb=q[0]}return f.ob=l!=null&&l.ob,f.Kb=l==null||!l.Sd,f.da&&(f.ob=f.ib<3*k/4&&f.hb<3*B/4,f.Kb=0),1}function Yi(l){if(l==null)return 2;if(11>l.S){var f=l.f.RGBA;f.fb+=(l.height-1)*f.A,f.A=-f.A}else f=l.f.kb,l=l.height,f.O+=(l-1)*f.fa,f.fa=-f.fa,f.N+=(l-1>>1)*f.Ab,f.Ab=-f.Ab,f.W+=(l-1>>1)*f.Db,f.Db=-f.Db,f.F!=null&&(f.J+=(l-1)*f.lb,f.lb=-f.lb);return 0}function ka(l,f,v,k){if(k==null||0>=l||0>=f)return 2;if(v!=null){if(v.Da){var B=v.cd,q=v.bd,W=-2&v.v,J=-2&v.j;if(0>W||0>J||0>=B||0>=q||W+B>l||J+q>f)return 2;l=B,f=q}if(v.da){if(!z(l,f,B=[v.ib],q=[v.hb]))return 2;l=B[0],f=q[0]}}k.width=l,k.height=f;e:{var ee=k.width,se=k.height;if(l=k.S,0>=ee||0>=se||!(l>=So&&13>l))l=2;else{if(0>=k.Rd&&k.sd==null){W=q=B=f=0;var _e=(J=ee*Sd[l])*se;if(11>l||(q=(se+1)/2*(f=(ee+1)/2),l==12&&(W=(B=ee)*se)),(se=i(_e+2*q+W))==null){l=1;break e}k.sd=se,11>l?((ee=k.f.RGBA).eb=se,ee.fb=0,ee.A=J,ee.size=_e):((ee=k.f.kb).y=se,ee.O=0,ee.fa=J,ee.Fd=_e,ee.f=se,ee.N=0+_e,ee.Ab=f,ee.Cd=q,ee.ea=se,ee.W=0+_e+q,ee.Db=f,ee.Ed=q,l==12&&(ee.F=se,ee.J=0+_e+2*q),ee.Tc=W,ee.lb=B)}if(f=1,B=k.S,q=k.width,W=k.height,B>=So&&13>B)if(11>B)l=k.f.RGBA,f&=(J=Math.abs(l.A))*(W-1)+q<=l.size,f&=J>=q*Sd[B],f&=l.eb!=null;else{l=k.f.kb,J=(q+1)/2,_e=(W+1)/2,ee=Math.abs(l.fa),se=Math.abs(l.Ab);var De=Math.abs(l.Db),ae=Math.abs(l.lb),ke=ae*(W-1)+q;f&=ee*(W-1)+q<=l.Fd,f&=se*(_e-1)+J<=l.Cd,f=(f&=De*(_e-1)+J<=l.Ed)&ee>=q&se>=J&De>=J,f&=l.y!=null,f&=l.f!=null,f&=l.ea!=null,B==12&&(f&=ae>=q,f&=ke<=l.Tc,f&=l.F!=null)}else f=0;l=f?0:2}}return l!=0||v!=null&&v.fd&&(l=Yi(k)),l}var Ja=64,rs=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ns=24,Aa=32,la=8,Ca=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];pe("Predictor0","PredictorAdd0"),P.Predictor0=function(){return 4278190080},P.Predictor1=function(l){return l},P.Predictor2=function(l,f,v){return f[v+0]},P.Predictor3=function(l,f,v){return f[v+1]},P.Predictor4=function(l,f,v){return f[v-1]},P.Predictor5=function(l,f,v){return Le(Le(l,f[v+1]),f[v+0])},P.Predictor6=function(l,f,v){return Le(l,f[v-1])},P.Predictor7=function(l,f,v){return Le(l,f[v+0])},P.Predictor8=function(l,f,v){return Le(f[v-1],f[v+0])},P.Predictor9=function(l,f,v){return Le(f[v+0],f[v+1])},P.Predictor10=function(l,f,v){return Le(Le(l,f[v-1]),Le(f[v+0],f[v+1]))},P.Predictor11=function(l,f,v){var k=f[v+0];return 0>=Ve(k>>24&255,l>>24&255,(f=f[v-1])>>24&255)+Ve(k>>16&255,l>>16&255,f>>16&255)+Ve(k>>8&255,l>>8&255,f>>8&255)+Ve(255&k,255&l,255&f)?k:l},P.Predictor12=function(l,f,v){var k=f[v+0];return(Ie((l>>24&255)+(k>>24&255)-((f=f[v-1])>>24&255))<<24|Ie((l>>16&255)+(k>>16&255)-(f>>16&255))<<16|Ie((l>>8&255)+(k>>8&255)-(f>>8&255))<<8|Ie((255&l)+(255&k)-(255&f)))>>>0},P.Predictor13=function(l,f,v){var k=f[v-1];return(Te((l=Le(l,f[v+0]))>>24&255,k>>24&255)<<24|Te(l>>16&255,k>>16&255)<<16|Te(l>>8&255,k>>8&255)<<8|Te(255&l,255&k))>>>0};var Ki=P.PredictorAdd0;P.PredictorAdd1=ht,pe("Predictor2","PredictorAdd2"),pe("Predictor3","PredictorAdd3"),pe("Predictor4","PredictorAdd4"),pe("Predictor5","PredictorAdd5"),pe("Predictor6","PredictorAdd6"),pe("Predictor7","PredictorAdd7"),pe("Predictor8","PredictorAdd8"),pe("Predictor9","PredictorAdd9"),pe("Predictor10","PredictorAdd10"),pe("Predictor11","PredictorAdd11"),pe("Predictor12","PredictorAdd12"),pe("Predictor13","PredictorAdd13");var wi=P.PredictorAdd2;dt("ColorIndexInverseTransform","MapARGB","32b",function(l){return l>>8&255},function(l){return l}),dt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(l){return l},function(l){return l>>8&255});var rn,No=P.ColorIndexInverseTransform,Hs=P.MapARGB,Gs=P.VP8LColorIndexInverseTransformAlpha,Ji=P.MapAlpha,Zi=P.VP8LPredictorsAdd=[];Zi.length=16,(P.VP8LPredictors=[]).length=16,(P.VP8LPredictorsAdd_C=[]).length=16,(P.VP8LPredictors_C=[]).length=16;var Xi,Qi,La,Ea,Pa,Za,Ta,Xa,vs,Vs,br,Er,nn,mn,ca,eo,vi,_o,ed,td,rd,nd,sd,ad,to,id,od,ld,cd=i(511),dd=i(2041),ud=i(225),hd=i(767),fd=0,Al=dd,jo=ud,ss=hd,Ns=cd,So=0,ko=1,pd=2,Ao=3,Co=4,Cl=5,md=6,Ll=7,El=8,Lo=9,Pl=10,yp=[2,3,7],bp=[3,3,11],gd=[280,256,256,256,40],wp=[0,1,1,1,0],vp=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Np=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],_p=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],jp=8,Tl=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Il=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],ro=null,Sp=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],kp=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],xd=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Ap=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Cp=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Lp=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Ep=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Ia=[],Es=[],da=[],Pp=1,yd=2,Fa=[],_s=[];Ke("UpsampleRgbLinePair",jt,3),Ke("UpsampleBgrLinePair",tr,3),Ke("UpsampleRgbaLinePair",fr,4),Ke("UpsampleBgraLinePair",Nr,4),Ke("UpsampleArgbLinePair",xr,4),Ke("UpsampleRgba4444LinePair",Dt,2),Ke("UpsampleRgb565LinePair",vr,2);var Tp=P.UpsampleRgbLinePair,Ip=P.UpsampleBgrLinePair,bd=P.UpsampleRgbaLinePair,wd=P.UpsampleBgraLinePair,vd=P.UpsampleArgbLinePair,Nd=P.UpsampleRgba4444LinePair,Fp=P.UpsampleRgb565LinePair,Eo=16,Po=1<<Eo-1,no=-227,Fl=482,Op=6,_d=0,Dp=i(256),Rp=i(256),Bp=i(256),Mp=i(256),Up=i(Fl-no),zp=i(Fl-no);pr("YuvToRgbRow",jt,3),pr("YuvToBgrRow",tr,3),pr("YuvToRgbaRow",fr,4),pr("YuvToBgraRow",Nr,4),pr("YuvToArgbRow",xr,4),pr("YuvToRgba4444Row",Dt,2),pr("YuvToRgb565Row",vr,2);var jd=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],To=[0,2,8],qp=[8,7,6,4,4,2,2,2,1,1,1,1],$p=1;this.WebPDecodeRGBA=function(l,f,v,k,B){var q=ko,W=new Ge,J=new Ot;W.ba=J,J.S=q,J.width=[J.width],J.height=[J.height];var ee=J.width,se=J.height,_e=new xt;if(_e==null||l==null)var De=2;else r(_e!=null),De=mr(l,f,v,_e.width,_e.height,_e.Pd,_e.Qd,_e.format,null);if(De!=0?ee=0:(ee!=null&&(ee[0]=_e.width[0]),se!=null&&(se[0]=_e.height[0]),ee=1),ee){J.width=J.width[0],J.height=J.height[0],k!=null&&(k[0]=J.width),B!=null&&(B[0]=J.height);e:{if(k=new Pn,(B=new Ze).data=l,B.w=f,B.ha=v,B.kd=1,f=[0],r(B!=null),((l=mr(B.data,B.w,B.ha,null,null,null,f,null,B))==0||l==7)&&f[0]&&(l=4),(f=l)==0){if(r(W!=null),k.data=B.data,k.w=B.w+B.offset,k.ha=B.ha-B.offset,k.put=Ut,k.ac=fn,k.bc=pn,k.ma=W,B.xa){if((l=En())==null){W=1;break e}if((function(ae,ke){var Pe=[0],Ue=[0],Oe=[0];t:for(;;){if(ae==null)return 0;if(ke==null)return ae.a=2,0;if(ae.l=ke,ae.a=0,ie(ae.m,ke.data,ke.w,ke.ha),!wn(ae.m,Pe,Ue,Oe)){ae.a=3;break t}if(ae.xb=yd,ke.width=Pe[0],ke.height=Ue[0],!lt(Pe[0],Ue[0],1,ae,null))break t;return 1}return r(ae.a!=0),0})(l,k)){if(k=(f=ka(k.width,k.height,W.Oa,W.ba))==0){t:{k=l;r:for(;;){if(k==null){k=0;break t}if(r(k.s.yc!=null),r(k.s.Ya!=null),r(0<k.s.Wb),r((v=k.l)!=null),r((B=v.ma)!=null),k.xb!=0){if(k.ca=B.ba,k.tb=B.tb,r(k.ca!=null),!oa(B.Oa,v,Ao)){k.a=2;break r}if(!Kr(k,v.width)||v.da)break r;if((v.da||Nt(k.ca.S))&&qe(),11>k.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),k.ca.f.kb.F!=null&&qe()),k.Pb&&0<k.s.ua&&k.s.vb.X==null&&!T(k.s.vb,k.s.Wa.Xa)){k.a=1;break r}k.xb=0}if(!$r(k,k.V,k.Ba,k.c,k.i,v.o,wr))break r;B.Dc=k.Ma,k=1;break t}r(k.a!=0),k=0}k=!k}k&&(f=l.a)}else f=l.a}else{if((l=new ys)==null){W=1;break e}if(l.Fa=B.na,l.P=B.P,l.qc=B.Sa,ft(l,k)){if((f=ka(k.width,k.height,W.Oa,W.ba))==0){if(l.Aa=0,v=W.Oa,r((B=l)!=null),v!=null){if(0<(ee=0>(ee=v.Md)?0:100<ee?255:255*ee/100)){for(se=_e=0;4>se;++se)12>(De=B.pb[se]).lc&&(De.ia=ee*qp[0>De.lc?0:De.lc]>>3),_e|=De.ia;_e&&(alert("todo:VP8InitRandom"),B.ia=1)}B.Ga=v.Id,100<B.Ga?B.Ga=100:0>B.Ga&&(B.Ga=0)}(function(ae,ke){if(ae==null)return 0;if(ke==null)return Ar(ae,2,"NULL VP8Io parameter in VP8Decode().");if(!ae.cb&&!ft(ae,ke))return 0;if(r(ae.cb),ke.ac==null||ke.ac(ke)){ke.ob&&(ae.L=0);var Pe=To[ae.L];if(ae.L==2?(ae.yb=0,ae.zb=0):(ae.yb=ke.v-Pe>>4,ae.zb=ke.j-Pe>>4,0>ae.yb&&(ae.yb=0),0>ae.zb&&(ae.zb=0)),ae.Va=ke.o+15+Pe>>4,ae.Hb=ke.va+15+Pe>>4,ae.Hb>ae.za&&(ae.Hb=ae.za),ae.Va>ae.Ub&&(ae.Va=ae.Ub),0<ae.L){var Ue=ae.ed;for(Pe=0;4>Pe;++Pe){var Oe;if(ae.Qa.Cb){var $e=ae.Qa.Lb[Pe];ae.Qa.Fb||($e+=Ue.Tb)}else $e=Ue.Tb;for(Oe=0;1>=Oe;++Oe){var Ye=ae.gd[Pe][Oe],nt=$e;if(Ue.Pc&&(nt+=Ue.vd[0],Oe&&(nt+=Ue.od[0])),0<(nt=0>nt?0:63<nt?63:nt)){var et=nt;0<Ue.wb&&(et=4<Ue.wb?et>>2:et>>1)>9-Ue.wb&&(et=9-Ue.wb),1>et&&(et=1),Ye.dd=et,Ye.tc=2*nt+et,Ye.ld=40<=nt?2:15<=nt?1:0}else Ye.tc=0;Ye.La=Oe}}}Pe=0}else Ar(ae,6,"Frame setup failed"),Pe=ae.a;if(Pe=Pe==0){if(Pe){ae.$c=0,0<ae.Aa||(ae.Ic=$p);t:{Pe=ae.Ic,Ue=4*(et=ae.za);var Bt=32*et,St=et+1,nr=0<ae.L?et*(0<ae.Aa?2:1):0,Tt=(ae.Aa==2?2:1)*et;if((Ye=Ue+832+(Oe=3*(16*Pe+To[ae.L])/2*Bt)+($e=ae.Fa!=null&&0<ae.Fa.length?ae.Kc.c*ae.Kc.i:0))!=Ye)Pe=0;else{if(Ye>ae.Vb){if(ae.Vb=0,ae.Ec=i(Ye),ae.Fc=0,ae.Ec==null){Pe=Ar(ae,1,"no memory during frame initialization.");break t}ae.Vb=Ye}Ye=ae.Ec,nt=ae.Fc,ae.Ac=Ye,ae.Bc=nt,nt+=Ue,ae.Gd=c(Bt,gt),ae.Hd=0,ae.rb=c(St+1,At),ae.sb=1,ae.wa=nr?c(nr,it):null,ae.Y=0,ae.D.Nb=0,ae.D.wa=ae.wa,ae.D.Y=ae.Y,0<ae.Aa&&(ae.D.Y+=et),r(!0),ae.oc=Ye,ae.pc=nt,nt+=832,ae.ya=c(Tt,$t),ae.aa=0,ae.D.ya=ae.ya,ae.D.aa=ae.aa,ae.Aa==2&&(ae.D.aa+=et),ae.R=16*et,ae.B=8*et,et=(Bt=To[ae.L])*ae.R,Bt=Bt/2*ae.B,ae.sa=Ye,ae.ta=nt+et,ae.qa=ae.sa,ae.ra=ae.ta+16*Pe*ae.R+Bt,ae.Ha=ae.qa,ae.Ia=ae.ra+8*Pe*ae.B+Bt,ae.$c=0,nt+=Oe,ae.mb=$e?Ye:null,ae.nb=$e?nt:null,r(nt+$e<=ae.Fc+ae.Vb),Wr(ae),s(ae.Ac,ae.Bc,0,Ue),Pe=1}}if(Pe){if(ke.ka=0,ke.y=ae.sa,ke.O=ae.ta,ke.f=ae.qa,ke.N=ae.ra,ke.ea=ae.Ha,ke.Vd=ae.Ia,ke.fa=ae.R,ke.Rc=ae.B,ke.F=null,ke.J=0,!fd){for(Pe=-255;255>=Pe;++Pe)cd[255+Pe]=0>Pe?-Pe:Pe;for(Pe=-1020;1020>=Pe;++Pe)dd[1020+Pe]=-128>Pe?-128:127<Pe?127:Pe;for(Pe=-112;112>=Pe;++Pe)ud[112+Pe]=-16>Pe?-16:15<Pe?15:Pe;for(Pe=-255;510>=Pe;++Pe)hd[255+Pe]=0>Pe?0:255<Pe?255:Pe;fd=1}Ta=$s,Xa=wa,Vs=Ir,br=va,Er=Na,vs=Jr,nn=yi,mn=ts,ca=D,eo=ne,vi=bi,_o=g,ed=ye,td=Ee,rd=ia,nd=Ka,sd=Sa,ad=xi,Es[0]=$i,Es[1]=$a,Es[2]=pi,Es[3]=mi,Es[4]=As,Es[5]=Wi,Es[6]=bs,Es[7]=Hi,Es[8]=ja,Es[9]=na,Ia[0]=hi,Ia[1]=ra,Ia[2]=_a,Ia[3]=ui,Ia[4]=ks,Ia[5]=Wa,Ia[6]=fi,da[0]=Vi,da[1]=di,da[2]=sa,da[3]=Gi,da[4]=Ga,da[5]=Ha,da[6]=gi,Pe=1}else Pe=0}Pe&&(Pe=(function(lr,gn){for(lr.M=0;lr.M<lr.Va;++lr.M){var sr,It=lr.Jc[lr.M&lr.Xb],pt=lr.m,sn=lr;for(sr=0;sr<sn.za;++sr){var Qt=pt,cr=sn,Dr=cr.Ac,An=cr.Bc+4*sr,zn=cr.zc,Zr=cr.ya[cr.aa+sr];if(cr.Qa.Bb?Zr.$b=Re(Qt,cr.Pa.jb[0])?2+Re(Qt,cr.Pa.jb[2]):Re(Qt,cr.Pa.jb[1]):Zr.$b=0,cr.kc&&(Zr.Ad=Re(Qt,cr.Bd)),Zr.Za=!Re(Qt,145)+0,Zr.Za){var Tn=Zr.Ob,qn=0;for(cr=0;4>cr;++cr){var xn,hr=zn[0+cr];for(xn=0;4>xn;++xn){hr=Cp[Dr[An+xn]][hr];for(var _r=xd[Re(Qt,hr[0])];0<_r;)_r=xd[2*_r+Re(Qt,hr[_r])];hr=-_r,Dr[An+xn]=hr}a(Tn,qn,Dr,An,4),qn+=4,zn[0+cr]=hr}}else hr=Re(Qt,156)?Re(Qt,128)?1:3:Re(Qt,163)?2:0,Zr.Ob[0]=hr,s(Dr,An,hr,4),s(zn,0,hr,4);Zr.Dd=Re(Qt,142)?Re(Qt,114)?Re(Qt,183)?1:3:2:0}if(sn.m.Ka)return Ar(lr,7,"Premature end-of-partition0 encountered.");for(;lr.ja<lr.za;++lr.ja){if(sn=It,Qt=(pt=lr).rb[pt.sb-1],Dr=pt.rb[pt.sb+pt.ja],sr=pt.ya[pt.aa+pt.ja],An=pt.kc?sr.Ad:0)Qt.la=Dr.la=0,sr.Za||(Qt.Na=Dr.Na=0),sr.Hc=0,sr.Gc=0,sr.ia=0;else{var Xr,jr;if(Qt=Dr,Dr=sn,An=pt.Pa.Xc,zn=pt.ya[pt.aa+pt.ja],Zr=pt.pb[zn.$b],cr=zn.ad,Tn=0,qn=pt.rb[pt.sb-1],hr=xn=0,s(cr,Tn,0,384),zn.Za)var Cn=0,Ps=An[3];else{_r=i(16);var an=Qt.Na+qn.Na;if(an=ro(Dr,An[1],an,Zr.Eb,0,_r,0),Qt.Na=qn.Na=(0<an)+0,1<an)Ta(_r,0,cr,Tn);else{var Vn=_r[0]+3>>3;for(_r=0;256>_r;_r+=16)cr[Tn+_r]=Vn}Cn=1,Ps=An[0]}var Pr=15&Qt.la,yn=15&qn.la;for(_r=0;4>_r;++_r){var as=1&yn;for(Vn=jr=0;4>Vn;++Vn)Pr=Pr>>1|(as=(an=ro(Dr,Ps,an=as+(1&Pr),Zr.Sc,Cn,cr,Tn))>Cn)<<7,jr=jr<<2|(3<an?3:1<an?2:cr[Tn+0]!=0),Tn+=16;Pr>>=4,yn=yn>>1|as<<7,xn=(xn<<8|jr)>>>0}for(Ps=Pr,Cn=yn>>4,Xr=0;4>Xr;Xr+=2){for(jr=0,Pr=Qt.la>>4+Xr,yn=qn.la>>4+Xr,_r=0;2>_r;++_r){for(as=1&yn,Vn=0;2>Vn;++Vn)an=as+(1&Pr),Pr=Pr>>1|(as=0<(an=ro(Dr,An[2],an,Zr.Qc,0,cr,Tn)))<<3,jr=jr<<2|(3<an?3:1<an?2:cr[Tn+0]!=0),Tn+=16;Pr>>=2,yn=yn>>1|as<<5}hr|=jr<<4*Xr,Ps|=Pr<<4<<Xr,Cn|=(240&yn)<<Xr}Qt.la=Ps,qn.la=Cn,zn.Hc=xn,zn.Gc=hr,zn.ia=43690&hr?0:Zr.ia,An=!(xn|hr)}if(0<pt.L&&(pt.wa[pt.Y+pt.ja]=pt.gd[sr.$b][sr.Za],pt.wa[pt.Y+pt.ja].La|=!An),sn.Ka)return Ar(lr,7,"Premature end-of-file encountered.")}if(Wr(lr),pt=gn,sn=1,sr=(It=lr).D,Qt=0<It.L&&It.M>=It.zb&&It.M<=It.Va,It.Aa==0)t:{if(sr.M=It.M,sr.uc=Qt,rr(It,sr),sn=1,sr=(jr=It.D).Nb,Qt=(hr=To[It.L])*It.R,Dr=hr/2*It.B,_r=16*sr*It.R,Vn=8*sr*It.B,An=It.sa,zn=It.ta-Qt+_r,Zr=It.qa,cr=It.ra-Dr+Vn,Tn=It.Ha,qn=It.Ia-Dr+Vn,yn=(Pr=jr.M)==0,xn=Pr>=It.Va-1,It.Aa==2&&rr(It,jr),jr.uc)for(as=(an=It).D.M,r(an.D.uc),jr=an.yb;jr<an.Hb;++jr){Cn=jr,Ps=as;var $n=(is=(Ln=an).D).Nb;Xr=Ln.R;var is=is.wa[is.Y+Cn],os=Ln.sa,Yn=Ln.ta+16*$n*Xr+16*Cn,ls=is.dd,Fr=is.tc;if(Fr!=0)if(r(3<=Fr),Ln.L==1)0<Cn&&nd(os,Yn,Xr,Fr+4),is.La&&ad(os,Yn,Xr,Fr),0<Ps&&rd(os,Yn,Xr,Fr+4),is.La&&sd(os,Yn,Xr,Fr);else{var cs=Ln.B,Ts=Ln.qa,Qa=Ln.ra+8*$n*cs+8*Cn,ua=Ln.Ha,Ln=Ln.Ia+8*$n*cs+8*Cn;$n=is.ld,0<Cn&&(mn(os,Yn,Xr,Fr+4,ls,$n),eo(Ts,Qa,ua,Ln,cs,Fr+4,ls,$n)),is.La&&(_o(os,Yn,Xr,Fr,ls,$n),td(Ts,Qa,ua,Ln,cs,Fr,ls,$n)),0<Ps&&(nn(os,Yn,Xr,Fr+4,ls,$n),ca(Ts,Qa,ua,Ln,cs,Fr+4,ls,$n)),is.La&&(vi(os,Yn,Xr,Fr,ls,$n),ed(Ts,Qa,ua,Ln,cs,Fr,ls,$n))}}if(It.ia&&alert("todo:DitherRow"),pt.put!=null){if(jr=16*Pr,Pr=16*(Pr+1),yn?(pt.y=It.sa,pt.O=It.ta+_r,pt.f=It.qa,pt.N=It.ra+Vn,pt.ea=It.Ha,pt.W=It.Ia+Vn):(jr-=hr,pt.y=An,pt.O=zn,pt.f=Zr,pt.N=cr,pt.ea=Tn,pt.W=qn),xn||(Pr-=hr),Pr>pt.o&&(Pr=pt.o),pt.F=null,pt.J=null,It.Fa!=null&&0<It.Fa.length&&jr<Pr&&(pt.J=me(It,pt,jr,Pr-jr),pt.F=It.mb,pt.F==null&&pt.F.length==0)){sn=Ar(It,3,"Could not decode alpha data.");break t}jr<pt.j&&(hr=pt.j-jr,jr=pt.j,r(!(1&hr)),pt.O+=It.R*hr,pt.N+=It.B*(hr>>1),pt.W+=It.B*(hr>>1),pt.F!=null&&(pt.J+=pt.width*hr)),jr<Pr&&(pt.O+=pt.v,pt.N+=pt.v>>1,pt.W+=pt.v>>1,pt.F!=null&&(pt.J+=pt.v),pt.ka=jr-pt.j,pt.U=pt.va-pt.v,pt.T=Pr-jr,sn=pt.put(pt))}sr+1!=It.Ic||xn||(a(It.sa,It.ta-Qt,An,zn+16*It.R,Qt),a(It.qa,It.ra-Dr,Zr,cr+8*It.B,Dr),a(It.Ha,It.Ia-Dr,Tn,qn+8*It.B,Dr))}if(!sn)return Ar(lr,6,"Output aborted.")}return 1})(ae,ke)),ke.bc!=null&&ke.bc(ke),Pe&=1}return Pe?(ae.cb=0,Pe):0})(l,k)||(f=l.a)}}else f=l.a}f==0&&W.Oa!=null&&W.Oa.fd&&(f=Yi(W.ba))}W=f}q=W!=0?null:11>q?J.f.RGBA.eb:J.f.kb.y}else q=null;return q};var Sd=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function h(P,Y){for(var I="",S=0;S<4;S++)I+=String.fromCharCode(P[Y++]);return I}function p(P,Y){return P[Y+0]|P[Y+1]<<8}function b(P,Y){return(P[Y+0]|P[Y+1]<<8|P[Y+2]<<16)>>>0}function m(P,Y){return(P[Y+0]|P[Y+1]<<8|P[Y+2]<<16|P[Y+3]<<24)>>>0}new d;var u=[0],w=[0],x=[],_=new d,y=t,A=(function(P,Y){var I={},S=0,R=!1,N=0,re=0;if(I.frames=[],!(function(C,G){for(var Z=0;Z<4;Z++)if(C[G+Z]!="RIFF".charCodeAt(Z))return!0;return!1})(P,Y)){for(m(P,Y+=4),Y+=8;Y<P.length;){var ve=h(P,Y),le=m(P,Y+=4);Y+=4;var oe=le+(1&le);switch(ve){case"VP8 ":case"VP8L":I.frames[S]===void 0&&(I.frames[S]={}),(te=I.frames[S]).src_off=R?re:Y-8,te.src_size=N+le+8,S++,R&&(R=!1,N=0,re=0);break;case"VP8X":(te=I.header={}).feature_flags=P[Y];var ie=Y+4;te.canvas_width=1+b(P,ie),ie+=3,te.canvas_height=1+b(P,ie),ie+=3;break;case"ALPH":R=!0,N=oe+8,re=Y-8;break;case"ANIM":(te=I.header).bgcolor=m(P,Y),ie=Y+4,te.loop_count=p(P,ie),ie+=2;break;case"ANMF":var Ae,te;(te=I.frames[S]={}).offset_x=2*b(P,Y),Y+=3,te.offset_y=2*b(P,Y),Y+=3,te.width=1+b(P,Y),Y+=3,te.height=1+b(P,Y),Y+=3,te.duration=b(P,Y),Y+=3,Ae=P[Y++],te.dispose=1&Ae,te.blend=Ae>>1&1}ve!="ANMF"&&(Y+=oe)}return I}})(y,0);A.response=y,A.rgbaoutput=!0,A.dataurl=!1;var L=A.header?A.header:null,E=A.frames?A.frames:null;if(L){L.loop_counter=L.loop_count,u=[L.canvas_height],w=[L.canvas_width];for(var O=0;O<E.length&&E[O].blend!=0;O++);}var X=E[0],K=_.WebPDecodeRGBA(y,X.src_off,X.src_size,w,u);X.rgba=K,X.imgwidth=w[0],X.imgheight=u[0];for(var H=0;H<w[0]*u[0]*4;H++)x[H]=K[H];return this.width=w,this.height=u,this.data=x,this}(function(t){var r,e,a,s,i,c,o,d,h,p=function(C){return C=C||{},this.isStrokeTransparent=C.isStrokeTransparent||!1,this.strokeOpacity=C.strokeOpacity||1,this.strokeStyle=C.strokeStyle||"#000000",this.fillStyle=C.fillStyle||"#000000",this.isFillTransparent=C.isFillTransparent||!1,this.fillOpacity=C.fillOpacity||1,this.font=C.font||"10px sans-serif",this.textBaseline=C.textBaseline||"alphabetic",this.textAlign=C.textAlign||"left",this.lineWidth=C.lineWidth||1,this.lineJoin=C.lineJoin||"miter",this.lineCap=C.lineCap||"butt",this.path=C.path||[],this.transform=C.transform!==void 0?C.transform.clone():new d,this.globalCompositeOperation=C.globalCompositeOperation||"normal",this.globalAlpha=C.globalAlpha||1,this.clip_path=C.clip_path||[],this.currentPoint=C.currentPoint||new c,this.miterLimit=C.miterLimit||10,this.lastPoint=C.lastPoint||new c,this.lineDashOffset=C.lineDashOffset||0,this.lineDash=C.lineDash||[],this.margin=C.margin||[0,0,0,0],this.prevPageLastElemOffset=C.prevPageLastElemOffset||0,this.ignoreClearRect=typeof C.ignoreClearRect!="boolean"||C.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new b(this),r=this.internal.f2,e=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,c=this.internal.Point,o=this.internal.Rectangle,d=this.internal.Matrix,h=new p}]);var b=function(C){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var G=C;Object.defineProperty(this,"pdf",{get:function(){return G}});var Z=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return Z},set:function(T){Z=!!T}});var Q=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Q},set:function(T){Q=!!T}});var fe=0;Object.defineProperty(this,"posX",{get:function(){return fe},set:function(T){isNaN(T)||(fe=T)}});var we=0;Object.defineProperty(this,"posY",{get:function(){return we},set:function(T){isNaN(T)||(we=T)}}),Object.defineProperty(this,"margin",{get:function(){return h.margin},set:function(T){var V;typeof T=="number"?V=[T,T,T,T]:((V=new Array(4))[0]=T[0],V[1]=T.length>=2?T[1]:V[0],V[2]=T.length>=3?T[2]:V[0],V[3]=T.length>=4?T[3]:V[1]),h.margin=V}});var Se=!1;Object.defineProperty(this,"autoPaging",{get:function(){return Se},set:function(T){Se=T}});var Ce=0;Object.defineProperty(this,"lastBreak",{get:function(){return Ce},set:function(T){Ce=T}});var Re=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Re},set:function(T){Re=T}}),Object.defineProperty(this,"ctx",{get:function(){return h},set:function(T){T instanceof p&&(h=T)}}),Object.defineProperty(this,"path",{get:function(){return h.path},set:function(T){h.path=T}});var Me=[];Object.defineProperty(this,"ctxStack",{get:function(){return Me},set:function(T){Me=T}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(T){var V;V=m(T),this.ctx.fillStyle=V.style,this.ctx.isFillTransparent=V.a===0,this.ctx.fillOpacity=V.a,this.pdf.setFillColor(V.r,V.g,V.b,{a:V.a}),this.pdf.setTextColor(V.r,V.g,V.b,{a:V.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(T){var V=m(T);this.ctx.strokeStyle=V.style,this.ctx.isStrokeTransparent=V.a===0,this.ctx.strokeOpacity=V.a,V.a===0?this.pdf.setDrawColor(255,255,255):(V.a,this.pdf.setDrawColor(V.r,V.g,V.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(T){["butt","round","square"].indexOf(T)!==-1&&(this.ctx.lineCap=T,this.pdf.setLineCap(T))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(T){isNaN(T)||(this.ctx.lineWidth=T,this.pdf.setLineWidth(T))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(T){["bevel","round","miter"].indexOf(T)!==-1&&(this.ctx.lineJoin=T,this.pdf.setLineJoin(T))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(T){isNaN(T)||(this.ctx.miterLimit=T,this.pdf.setMiterLimit(T))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(T){this.ctx.textBaseline=T}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(T){["right","end","center","left","start"].indexOf(T)!==-1&&(this.ctx.textAlign=T)}});var Je=null,je=null,j=null;Object.defineProperty(this,"fontFaces",{get:function(){return j},set:function(T){Je=null,je=null,j=T}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(T){var V;if(this.ctx.font=T,(V=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(T))!==null){var $=V[1];V[2];var z=V[3],M=V[4];V[5];var ue=V[6],pe=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(M)[2];M=Math.floor(pe==="px"?parseFloat(M)*this.pdf.internal.scaleFactor:pe==="em"?parseFloat(M)*this.pdf.getFontSize():parseFloat(M)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(M);var ce=(function(dt){var Vt,mt,Lt=[],zt=dt.trim();if(zt==="")return fc;if(zt in Gu)return[Gu[zt]];for(;zt!=="";){switch(mt=null,Vt=(zt=Yu(zt)).charAt(0)){case'"':case"'":mt=y2(zt.substring(1),Vt);break;default:mt=b2(zt)}if(mt===null||(Lt.push(mt[0]),(zt=Yu(mt[1]))!==""&&zt.charAt(0)!==","))return fc;zt=zt.replace(/^,/,"")}return Lt})(ue);if(this.fontFaces){var Le=(function(dt,Vt){var mt=dt.getFontList(),Lt=JSON.stringify(mt);if(Je===null||je!==Lt){var zt=(function(Et){var wt=[];return Object.keys(Et).forEach(function(Kt){Et[Kt].forEach(function(Nt){var Ft=null;switch(Nt){case"bold":Ft={family:Kt,weight:"bold"};break;case"italic":Ft={family:Kt,style:"italic"};break;case"bolditalic":Ft={family:Kt,weight:"bold",style:"italic"};break;case"":case"normal":Ft={family:Kt}}Ft!==null&&(Ft.ref={name:Kt,style:Nt},wt.push(Ft))})}),wt})(mt);Je=(function(Et){for(var wt={},Kt=0;Kt<Et.length;++Kt){var Nt=hc(Et[Kt]),Ft=Nt.family,ar=Nt.stretch,Ot=Nt.style,xt=Nt.weight;wt[Ft]=wt[Ft]||{},wt[Ft][ar]=wt[Ft][ar]||{},wt[Ft][ar][Ot]=wt[Ft][ar][Ot]||{},wt[Ft][ar][Ot][xt]=Nt}return wt})(zt.concat(Vt)),je=Lt}return Je})(this.pdf,this.fontFaces),Ie=ce.map(function(dt){return{family:dt,stretch:"normal",weight:z,style:$}}),Te=(function(dt,Vt,mt){for(var Lt=(mt=mt||{}).defaultFontFamily||"times",zt=Object.assign({},x2,mt.genericFontFamilies||{}),Et=null,wt=null,Kt=0;Kt<Vt.length;++Kt)if(zt[(Et=hc(Vt[Kt])).family]&&(Et.family=zt[Et.family]),dt.hasOwnProperty(Et.family)){wt=dt[Et.family];break}if(!(wt=wt||dt[Lt]))throw new Error("Could not find a font-family for the rule '"+Vu(Et)+"' and default family '"+Lt+"'.");if(wt=(function(Nt,Ft){if(Ft[Nt])return Ft[Nt];var ar=Tc[Nt],Ot=ar<=Tc.normal?-1:1,xt=Hu(Ft,Qf,ar,Ot);if(!xt)throw new Error("Could not find a matching font-stretch value for "+Nt);return xt})(Et.stretch,wt),wt=(function(Nt,Ft){if(Ft[Nt])return Ft[Nt];for(var ar=Xf[Nt],Ot=0;Ot<ar.length;++Ot)if(Ft[ar[Ot]])return Ft[ar[Ot]];throw new Error("Could not find a matching font-style for "+Nt)})(Et.style,wt),!(wt=(function(Nt,Ft){if(Ft[Nt])return Ft[Nt];if(Nt===400&&Ft[500])return Ft[500];if(Nt===500&&Ft[400])return Ft[400];var ar=g2[Nt],Ot=Hu(Ft,ep,ar,Nt<400?-1:1);if(!Ot)throw new Error("Could not find a matching font-weight for value "+Nt);return Ot})(Et.weight,wt)))throw new Error("Failed to resolve a font for the rule '"+Vu(Et)+"'.");return wt})(Le,Ie);this.pdf.setFont(Te.ref.name,Te.ref.style)}else{var Ve="";(z==="bold"||parseInt(z,10)>=700||$==="bold")&&(Ve="bold"),$==="italic"&&(Ve+="italic"),Ve.length===0&&(Ve="normal");for(var ht="",st={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},ot=0;ot<ce.length;ot++){if(this.pdf.internal.getFont(ce[ot],Ve,{noFallback:!0,disableWarning:!0})!==void 0){ht=ce[ot];break}if(Ve==="bolditalic"&&this.pdf.internal.getFont(ce[ot],"bold",{noFallback:!0,disableWarning:!0})!==void 0)ht=ce[ot],Ve="bold";else if(this.pdf.internal.getFont(ce[ot],"normal",{noFallback:!0,disableWarning:!0})!==void 0){ht=ce[ot],Ve="normal";break}}if(ht===""){for(var yt=0;yt<ce.length;yt++)if(st[ce[yt]]){ht=st[ce[yt]];break}}ht=ht===""?"Times":ht,this.pdf.setFont(ht,Ve)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(T){this.ctx.globalCompositeOperation=T}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(T){this.ctx.globalAlpha=T}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(T){this.ctx.lineDashOffset=T,te.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(T){this.ctx.lineDash=T,te.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(T){this.ctx.ignoreClearRect=!!T}})};b.prototype.setLineDash=function(C){this.lineDash=C},b.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},b.prototype.fill=function(){E.call(this,"fill",!1)},b.prototype.stroke=function(){E.call(this,"stroke",!1)},b.prototype.beginPath=function(){this.path=[{type:"begin"}]},b.prototype.moveTo=function(C,G){if(isNaN(C)||isNaN(G))throw Tr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var Z=this.ctx.transform.applyToPoint(new c(C,G));this.path.push({type:"mt",x:Z.x,y:Z.y}),this.ctx.lastPoint=new c(C,G)},b.prototype.closePath=function(){var C=new c(0,0),G=0;for(G=this.path.length-1;G!==-1;G--)if(this.path[G].type==="begin"&&kr(this.path[G+1])==="object"&&typeof this.path[G+1].x=="number"){C=new c(this.path[G+1].x,this.path[G+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new c(C.x,C.y)},b.prototype.lineTo=function(C,G){if(isNaN(C)||isNaN(G))throw Tr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var Z=this.ctx.transform.applyToPoint(new c(C,G));this.path.push({type:"lt",x:Z.x,y:Z.y}),this.ctx.lastPoint=new c(Z.x,Z.y)},b.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),E.call(this,null,!0)},b.prototype.quadraticCurveTo=function(C,G,Z,Q){if(isNaN(Z)||isNaN(Q)||isNaN(C)||isNaN(G))throw Tr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var fe=this.ctx.transform.applyToPoint(new c(Z,Q)),we=this.ctx.transform.applyToPoint(new c(C,G));this.path.push({type:"qct",x1:we.x,y1:we.y,x:fe.x,y:fe.y}),this.ctx.lastPoint=new c(fe.x,fe.y)},b.prototype.bezierCurveTo=function(C,G,Z,Q,fe,we){if(isNaN(fe)||isNaN(we)||isNaN(C)||isNaN(G)||isNaN(Z)||isNaN(Q))throw Tr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var Se=this.ctx.transform.applyToPoint(new c(fe,we)),Ce=this.ctx.transform.applyToPoint(new c(C,G)),Re=this.ctx.transform.applyToPoint(new c(Z,Q));this.path.push({type:"bct",x1:Ce.x,y1:Ce.y,x2:Re.x,y2:Re.y,x:Se.x,y:Se.y}),this.ctx.lastPoint=new c(Se.x,Se.y)},b.prototype.arc=function(C,G,Z,Q,fe,we){if(isNaN(C)||isNaN(G)||isNaN(Z)||isNaN(Q)||isNaN(fe))throw Tr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(we=!!we,!this.ctx.transform.isIdentity){var Se=this.ctx.transform.applyToPoint(new c(C,G));C=Se.x,G=Se.y;var Ce=this.ctx.transform.applyToPoint(new c(0,Z)),Re=this.ctx.transform.applyToPoint(new c(0,0));Z=Math.sqrt(Math.pow(Ce.x-Re.x,2)+Math.pow(Ce.y-Re.y,2))}Math.abs(fe-Q)>=2*Math.PI&&(Q=0,fe=2*Math.PI),this.path.push({type:"arc",x:C,y:G,radius:Z,startAngle:Q,endAngle:fe,counterclockwise:we})},b.prototype.arcTo=function(C,G,Z,Q,fe){throw new Error("arcTo not implemented.")},b.prototype.rect=function(C,G,Z,Q){if(isNaN(C)||isNaN(G)||isNaN(Z)||isNaN(Q))throw Tr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(C,G),this.lineTo(C+Z,G),this.lineTo(C+Z,G+Q),this.lineTo(C,G+Q),this.lineTo(C,G),this.lineTo(C+Z,G),this.lineTo(C,G)},b.prototype.fillRect=function(C,G,Z,Q){if(isNaN(C)||isNaN(G)||isNaN(Z)||isNaN(Q))throw Tr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!u.call(this)){var fe={};this.lineCap!=="butt"&&(fe.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(fe.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(C,G,Z,Q),this.fill(),fe.hasOwnProperty("lineCap")&&(this.lineCap=fe.lineCap),fe.hasOwnProperty("lineJoin")&&(this.lineJoin=fe.lineJoin)}},b.prototype.strokeRect=function(C,G,Z,Q){if(isNaN(C)||isNaN(G)||isNaN(Z)||isNaN(Q))throw Tr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");w.call(this)||(this.beginPath(),this.rect(C,G,Z,Q),this.stroke())},b.prototype.clearRect=function(C,G,Z,Q){if(isNaN(C)||isNaN(G)||isNaN(Z)||isNaN(Q))throw Tr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(C,G,Z,Q))},b.prototype.save=function(C){C=typeof C!="boolean"||C;for(var G=this.pdf.internal.getCurrentPageInfo().pageNumber,Z=0;Z<this.pdf.internal.getNumberOfPages();Z++)this.pdf.setPage(Z+1),this.pdf.internal.out("q");if(this.pdf.setPage(G),C){this.ctx.fontSize=this.pdf.internal.getFontSize();var Q=new p(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Q}},b.prototype.restore=function(C){C=typeof C!="boolean"||C;for(var G=this.pdf.internal.getCurrentPageInfo().pageNumber,Z=0;Z<this.pdf.internal.getNumberOfPages();Z++)this.pdf.setPage(Z+1),this.pdf.internal.out("Q");this.pdf.setPage(G),C&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},b.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var m=function(C){var G,Z,Q,fe;if(C.isCanvasGradient===!0&&(C=C.getColor()),!C)return{r:0,g:0,b:0,a:0,style:C};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(C))G=0,Z=0,Q=0,fe=0;else{var we=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(C);if(we!==null)G=parseInt(we[1]),Z=parseInt(we[2]),Q=parseInt(we[3]),fe=1;else if((we=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(C))!==null)G=parseInt(we[1]),Z=parseInt(we[2]),Q=parseInt(we[3]),fe=parseFloat(we[4]);else{if(fe=1,typeof C=="string"&&C.charAt(0)!=="#"){var Se=new Hf(C);C=Se.ok?Se.toHex():"#000000"}C.length===4?(G=C.substring(1,2),G+=G,Z=C.substring(2,3),Z+=Z,Q=C.substring(3,4),Q+=Q):(G=C.substring(1,3),Z=C.substring(3,5),Q=C.substring(5,7)),G=parseInt(G,16),Z=parseInt(Z,16),Q=parseInt(Q,16)}}return{r:G,g:Z,b:Q,a:fe,style:C}},u=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},w=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};b.prototype.fillText=function(C,G,Z,Q){if(isNaN(G)||isNaN(Z)||typeof C!="string")throw Tr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Q=isNaN(Q)?void 0:Q,!u.call(this)){var fe=oe(this.ctx.transform.rotation),we=this.ctx.transform.scaleX;S.call(this,{text:C,x:G,y:Z,scale:we,angle:fe,align:this.textAlign,maxWidth:Q})}},b.prototype.strokeText=function(C,G,Z,Q){if(isNaN(G)||isNaN(Z)||typeof C!="string")throw Tr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!w.call(this)){Q=isNaN(Q)?void 0:Q;var fe=oe(this.ctx.transform.rotation),we=this.ctx.transform.scaleX;S.call(this,{text:C,x:G,y:Z,scale:we,renderingMode:"stroke",angle:fe,align:this.textAlign,maxWidth:Q})}},b.prototype.measureText=function(C){if(typeof C!="string")throw Tr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var G=this.pdf,Z=this.pdf.internal.scaleFactor,Q=G.internal.getFontSize(),fe=G.getStringUnitWidth(C)*Q/G.internal.scaleFactor;return new function(we){var Se=(we=we||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Se}}),this}({width:fe*=Math.round(96*Z/72*1e4)/1e4})},b.prototype.scale=function(C,G){if(isNaN(C)||isNaN(G))throw Tr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var Z=new d(C,0,0,G,0,0);this.ctx.transform=this.ctx.transform.multiply(Z)},b.prototype.rotate=function(C){if(isNaN(C))throw Tr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var G=new d(Math.cos(C),Math.sin(C),-Math.sin(C),Math.cos(C),0,0);this.ctx.transform=this.ctx.transform.multiply(G)},b.prototype.translate=function(C,G){if(isNaN(C)||isNaN(G))throw Tr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var Z=new d(1,0,0,1,C,G);this.ctx.transform=this.ctx.transform.multiply(Z)},b.prototype.transform=function(C,G,Z,Q,fe,we){if(isNaN(C)||isNaN(G)||isNaN(Z)||isNaN(Q)||isNaN(fe)||isNaN(we))throw Tr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var Se=new d(C,G,Z,Q,fe,we);this.ctx.transform=this.ctx.transform.multiply(Se)},b.prototype.setTransform=function(C,G,Z,Q,fe,we){C=isNaN(C)?1:C,G=isNaN(G)?0:G,Z=isNaN(Z)?0:Z,Q=isNaN(Q)?1:Q,fe=isNaN(fe)?0:fe,we=isNaN(we)?0:we,this.ctx.transform=new d(C,G,Z,Q,fe,we)};var x=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};b.prototype.drawImage=function(C,G,Z,Q,fe,we,Se,Ce,Re){var Me=this.pdf.getImageProperties(C),Je=1,je=1,j=1,T=1;Q!==void 0&&Ce!==void 0&&(j=Ce/Q,T=Re/fe,Je=Me.width/Q*Ce/Q,je=Me.height/fe*Re/fe),we===void 0&&(we=G,Se=Z,G=0,Z=0),Q!==void 0&&Ce===void 0&&(Ce=Q,Re=fe),Q===void 0&&Ce===void 0&&(Ce=Me.width,Re=Me.height);var V=this.ctx.transform.decompose(),$=oe(V.rotate.shx),z=new d,M=(z=(z=(z=z.multiply(V.translate)).multiply(V.skew)).multiply(V.scale)).applyToRectangle(new o(we-G*j,Se-Z*T,Q*Je,fe*je));if(this.autoPaging){for(var ue,pe=_.call(this,M),ce=[],Le=0;Le<pe.length;Le+=1)ce.indexOf(pe[Le])===-1&&ce.push(pe[Le]);L(ce);for(var Ie=ce[0],Te=ce[ce.length-1],Ve=Ie;Ve<Te+1;Ve++){this.pdf.setPage(Ve);var ht=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],st=Ve===1?this.posY+this.margin[0]:this.margin[0],ot=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],yt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],dt=Ve===1?0:ot+(Ve-2)*yt;if(this.ctx.clip_path.length!==0){var Vt=this.path;ue=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=A(ue,this.posX+this.margin[3],-dt+st+this.ctx.prevPageLastElemOffset),O.call(this,"fill",!0),this.path=Vt}var mt=JSON.parse(JSON.stringify(M));mt=A([mt],this.posX+this.margin[3],-dt+st+this.ctx.prevPageLastElemOffset)[0];var Lt=(Ve>Ie||Ve<Te)&&x.call(this);Lt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ht,yt,null).clip().discardPath()),this.pdf.addImage(C,"JPEG",mt.x,mt.y,mt.w,mt.h,null,null,$),Lt&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(C,"JPEG",M.x,M.y,M.w,M.h,null,null,$)};var _=function(C,G,Z){var Q=[];G=G||this.pdf.internal.pageSize.width,Z=Z||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var fe=this.posY+this.ctx.prevPageLastElemOffset;switch(C.type){default:case"mt":case"lt":Q.push(Math.floor((C.y+fe)/Z)+1);break;case"arc":Q.push(Math.floor((C.y+fe-C.radius)/Z)+1),Q.push(Math.floor((C.y+fe+C.radius)/Z)+1);break;case"qct":var we=ie(this.ctx.lastPoint.x,this.ctx.lastPoint.y,C.x1,C.y1,C.x,C.y);Q.push(Math.floor((we.y+fe)/Z)+1),Q.push(Math.floor((we.y+we.h+fe)/Z)+1);break;case"bct":var Se=Ae(this.ctx.lastPoint.x,this.ctx.lastPoint.y,C.x1,C.y1,C.x2,C.y2,C.x,C.y);Q.push(Math.floor((Se.y+fe)/Z)+1),Q.push(Math.floor((Se.y+Se.h+fe)/Z)+1);break;case"rect":Q.push(Math.floor((C.y+fe)/Z)+1),Q.push(Math.floor((C.y+C.h+fe)/Z)+1)}for(var Ce=0;Ce<Q.length;Ce+=1)for(;this.pdf.internal.getNumberOfPages()<Q[Ce];)y.call(this);return Q},y=function(){var C=this.fillStyle,G=this.strokeStyle,Z=this.font,Q=this.lineCap,fe=this.lineWidth,we=this.lineJoin;this.pdf.addPage(),this.fillStyle=C,this.strokeStyle=G,this.font=Z,this.lineCap=Q,this.lineWidth=fe,this.lineJoin=we},A=function(C,G,Z){for(var Q=0;Q<C.length;Q++)switch(C[Q].type){case"bct":C[Q].x2+=G,C[Q].y2+=Z;case"qct":C[Q].x1+=G,C[Q].y1+=Z;default:C[Q].x+=G,C[Q].y+=Z}return C},L=function(C){return C.sort(function(G,Z){return G-Z})},E=function(C,G){var Z=this.fillStyle,Q=this.strokeStyle,fe=this.lineCap,we=this.lineWidth,Se=Math.abs(we*this.ctx.transform.scaleX),Ce=this.lineJoin;if(this.autoPaging){for(var Re,Me,Je=JSON.parse(JSON.stringify(this.path)),je=JSON.parse(JSON.stringify(this.path)),j=[],T=0;T<je.length;T++)if(je[T].x!==void 0)for(var V=_.call(this,je[T]),$=0;$<V.length;$+=1)j.indexOf(V[$])===-1&&j.push(V[$]);for(var z=0;z<j.length;z++)for(;this.pdf.internal.getNumberOfPages()<j[z];)y.call(this);L(j);for(var M=j[0],ue=j[j.length-1],pe=M;pe<ue+1;pe++){this.pdf.setPage(pe),this.fillStyle=Z,this.strokeStyle=Q,this.lineCap=fe,this.lineWidth=Se,this.lineJoin=Ce;var ce=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Le=pe===1?this.posY+this.margin[0]:this.margin[0],Ie=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Te=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ve=pe===1?0:Ie+(pe-2)*Te;if(this.ctx.clip_path.length!==0){var ht=this.path;Re=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=A(Re,this.posX+this.margin[3],-Ve+Le+this.ctx.prevPageLastElemOffset),O.call(this,C,!0),this.path=ht}if(Me=JSON.parse(JSON.stringify(Je)),this.path=A(Me,this.posX+this.margin[3],-Ve+Le+this.ctx.prevPageLastElemOffset),G===!1||pe===0){var st=(pe>M||pe<ue)&&x.call(this);st&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ce,Te,null).clip().discardPath()),O.call(this,C,G),st&&this.pdf.restoreGraphicsState()}this.lineWidth=we}this.path=Je}else this.lineWidth=Se,O.call(this,C,G),this.lineWidth=we},O=function(C,G){if((C!=="stroke"||G||!w.call(this))&&(C==="stroke"||G||!u.call(this))){for(var Z,Q,fe=[],we=this.path,Se=0;Se<we.length;Se++){var Ce=we[Se];switch(Ce.type){case"begin":fe.push({begin:!0});break;case"close":fe.push({close:!0});break;case"mt":fe.push({start:Ce,deltas:[],abs:[]});break;case"lt":var Re=fe.length;if(we[Se-1]&&!isNaN(we[Se-1].x)&&(Z=[Ce.x-we[Se-1].x,Ce.y-we[Se-1].y],Re>0)){for(;Re>=0;Re--)if(fe[Re-1].close!==!0&&fe[Re-1].begin!==!0){fe[Re-1].deltas.push(Z),fe[Re-1].abs.push(Ce);break}}break;case"bct":Z=[Ce.x1-we[Se-1].x,Ce.y1-we[Se-1].y,Ce.x2-we[Se-1].x,Ce.y2-we[Se-1].y,Ce.x-we[Se-1].x,Ce.y-we[Se-1].y],fe[fe.length-1].deltas.push(Z);break;case"qct":var Me=we[Se-1].x+2/3*(Ce.x1-we[Se-1].x),Je=we[Se-1].y+2/3*(Ce.y1-we[Se-1].y),je=Ce.x+2/3*(Ce.x1-Ce.x),j=Ce.y+2/3*(Ce.y1-Ce.y),T=Ce.x,V=Ce.y;Z=[Me-we[Se-1].x,Je-we[Se-1].y,je-we[Se-1].x,j-we[Se-1].y,T-we[Se-1].x,V-we[Se-1].y],fe[fe.length-1].deltas.push(Z);break;case"arc":fe.push({deltas:[],abs:[],arc:!0}),Array.isArray(fe[fe.length-1].abs)&&fe[fe.length-1].abs.push(Ce)}}Q=G?null:C==="stroke"?"stroke":"fill";for(var $=!1,z=0;z<fe.length;z++)if(fe[z].arc)for(var M=fe[z].abs,ue=0;ue<M.length;ue++){var pe=M[ue];pe.type==="arc"?H.call(this,pe.x,pe.y,pe.radius,pe.startAngle,pe.endAngle,pe.counterclockwise,void 0,G,!$):R.call(this,pe.x,pe.y),$=!0}else if(fe[z].close===!0)this.pdf.internal.out("h"),$=!1;else if(fe[z].begin!==!0){var ce=fe[z].start.x,Le=fe[z].start.y;N.call(this,fe[z].deltas,ce,Le),$=!0}Q&&P.call(this,Q),G&&Y.call(this)}},X=function(C){var G=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,Z=G*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return C-Z;case"top":return C+G-Z;case"hanging":return C+G-2*Z;case"middle":return C+G/2-Z;default:return C}},K=function(C){return C+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};b.prototype.createLinearGradient=function(){var C=function(){};return C.colorStops=[],C.addColorStop=function(G,Z){this.colorStops.push([G,Z])},C.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},C.isCanvasGradient=!0,C},b.prototype.createPattern=function(){return this.createLinearGradient()},b.prototype.createRadialGradient=function(){return this.createLinearGradient()};var H=function(C,G,Z,Q,fe,we,Se,Ce,Re){for(var Me=ve.call(this,Z,Q,fe,we),Je=0;Je<Me.length;Je++){var je=Me[Je];Je===0&&(Re?I.call(this,je.x1+C,je.y1+G):R.call(this,je.x1+C,je.y1+G)),re.call(this,C,G,je.x2,je.y2,je.x3,je.y3,je.x4,je.y4)}Ce?Y.call(this):P.call(this,Se)},P=function(C){switch(C){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},Y=function(){this.pdf.clip(),this.pdf.discardPath()},I=function(C,G){this.pdf.internal.out(e(C)+" "+a(G)+" m")},S=function(C){var G;switch(C.align){case"right":case"end":G="right";break;case"center":G="center";break;default:G="left"}var Z,Q,fe,we=this.pdf.getTextDimensions(C.text),Se=X.call(this,C.y),Ce=K.call(this,Se)-we.h,Re=this.ctx.transform.applyToPoint(new c(C.x,Se));if(this.autoPaging){var Me=this.ctx.transform.decompose(),Je=new d;Je=(Je=(Je=Je.multiply(Me.translate)).multiply(Me.skew)).multiply(Me.scale);for(var je=this.ctx.transform.applyToRectangle(new o(C.x,Se,we.w,we.h)),j=Je.applyToRectangle(new o(C.x,Ce,we.w,we.h)),T=_.call(this,j),V=[],$=0;$<T.length;$+=1)V.indexOf(T[$])===-1&&V.push(T[$]);L(V);for(var z=V[0],M=V[V.length-1],ue=z;ue<M+1;ue++){this.pdf.setPage(ue);var pe=ue===1?this.posY+this.margin[0]:this.margin[0],ce=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Le=this.pdf.internal.pageSize.height-this.margin[2],Ie=Le-this.margin[0],Te=this.pdf.internal.pageSize.width-this.margin[1],Ve=Te-this.margin[3],ht=ue===1?0:ce+(ue-2)*Ie;if(this.ctx.clip_path.length!==0){var st=this.path;Z=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=A(Z,this.posX+this.margin[3],-1*ht+pe),O.call(this,"fill",!0),this.path=st}var ot=A([JSON.parse(JSON.stringify(j))],this.posX+this.margin[3],-ht+pe+this.ctx.prevPageLastElemOffset)[0];C.scale>=.01&&(Q=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Q*C.scale),fe=this.lineWidth,this.lineWidth=fe*C.scale);var yt=this.autoPaging!=="text";if(yt||ot.y+ot.h<=Le){if(yt||ot.y>=pe&&ot.x<=Te){var dt=yt?C.text:this.pdf.splitTextToSize(C.text,C.maxWidth||Te-ot.x)[0],Vt=A([JSON.parse(JSON.stringify(je))],this.posX+this.margin[3],-ht+pe+this.ctx.prevPageLastElemOffset)[0],mt=yt&&(ue>z||ue<M)&&x.call(this);mt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ve,Ie,null).clip().discardPath()),this.pdf.text(dt,Vt.x,Vt.y,{angle:C.angle,align:G,renderingMode:C.renderingMode}),mt&&this.pdf.restoreGraphicsState()}}else ot.y<Le&&(this.ctx.prevPageLastElemOffset+=Le-ot.y);C.scale>=.01&&(this.pdf.setFontSize(Q),this.lineWidth=fe)}}else C.scale>=.01&&(Q=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Q*C.scale),fe=this.lineWidth,this.lineWidth=fe*C.scale),this.pdf.text(C.text,Re.x+this.posX,Re.y+this.posY,{angle:C.angle,align:G,renderingMode:C.renderingMode,maxWidth:C.maxWidth}),C.scale>=.01&&(this.pdf.setFontSize(Q),this.lineWidth=fe)},R=function(C,G,Z,Q){Z=Z||0,Q=Q||0,this.pdf.internal.out(e(C+Z)+" "+a(G+Q)+" l")},N=function(C,G,Z){return this.pdf.lines(C,G,Z,null,null)},re=function(C,G,Z,Q,fe,we,Se,Ce){this.pdf.internal.out([r(s(Z+C)),r(i(Q+G)),r(s(fe+C)),r(i(we+G)),r(s(Se+C)),r(i(Ce+G)),"c"].join(" "))},ve=function(C,G,Z,Q){for(var fe=2*Math.PI,we=Math.PI/2;G>Z;)G-=fe;var Se=Math.abs(Z-G);Se<fe&&Q&&(Se=fe-Se);for(var Ce=[],Re=Q?-1:1,Me=G;Se>1e-5;){var Je=Me+Re*Math.min(Se,we);Ce.push(le.call(this,C,Me,Je)),Se-=Math.abs(Je-Me),Me=Je}return Ce},le=function(C,G,Z){var Q=(Z-G)/2,fe=C*Math.cos(Q),we=C*Math.sin(Q),Se=fe,Ce=-we,Re=Se*Se+Ce*Ce,Me=Re+Se*fe+Ce*we,Je=4/3*(Math.sqrt(2*Re*Me)-Me)/(Se*we-Ce*fe),je=Se-Je*Ce,j=Ce+Je*Se,T=je,V=-j,$=Q+G,z=Math.cos($),M=Math.sin($);return{x1:C*Math.cos(G),y1:C*Math.sin(G),x2:je*z-j*M,y2:je*M+j*z,x3:T*z-V*M,y3:T*M+V*z,x4:C*Math.cos(Z),y4:C*Math.sin(Z)}},oe=function(C){return 180*C/Math.PI},ie=function(C,G,Z,Q,fe,we){var Se=C+.5*(Z-C),Ce=G+.5*(Q-G),Re=fe+.5*(Z-fe),Me=we+.5*(Q-we),Je=Math.min(C,fe,Se,Re),je=Math.max(C,fe,Se,Re),j=Math.min(G,we,Ce,Me),T=Math.max(G,we,Ce,Me);return new o(Je,j,je-Je,T-j)},Ae=function(C,G,Z,Q,fe,we,Se,Ce){var Re,Me,Je,je,j,T,V,$,z,M,ue,pe,ce,Le,Ie=Z-C,Te=Q-G,Ve=fe-Z,ht=we-Q,st=Se-fe,ot=Ce-we;for(Me=0;Me<41;Me++)z=(V=(Je=C+(Re=Me/40)*Ie)+Re*((j=Z+Re*Ve)-Je))+Re*(j+Re*(fe+Re*st-j)-V),M=($=(je=G+Re*Te)+Re*((T=Q+Re*ht)-je))+Re*(T+Re*(we+Re*ot-T)-$),Me==0?(ue=z,pe=M,ce=z,Le=M):(ue=Math.min(ue,z),pe=Math.min(pe,M),ce=Math.max(ce,z),Le=Math.max(Le,M));return new o(Math.round(ue),Math.round(pe),Math.round(ce-ue),Math.round(Le-pe))},te=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var C,G,Z=(C=this.ctx.lineDash,G=this.ctx.lineDashOffset,JSON.stringify({lineDash:C,lineDashOffset:G}));this.prevLineDash!==Z&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=Z)}}})(Mt.API),(function(t){var r=function(c){var o,d,h,p,b,m,u,w,x,_;for(d=[],h=0,p=(c+=o="\0\0\0\0".slice(c.length%4||4)).length;p>h;h+=4)(b=(c.charCodeAt(h)<<24)+(c.charCodeAt(h+1)<<16)+(c.charCodeAt(h+2)<<8)+c.charCodeAt(h+3))!==0?(m=(b=((b=((b=((b=(b-(_=b%85))/85)-(x=b%85))/85)-(w=b%85))/85)-(u=b%85))/85)%85,d.push(m+33,u+33,w+33,x+33,_+33)):d.push(122);return(function(y,A){for(var L=A;L>0;L--)y.pop()})(d,o.length),String.fromCharCode.apply(String,d)+"~>"},e=function(c){var o,d,h,p,b,m=String,u="length",w=255,x="charCodeAt",_="slice",y="replace";for(c[_](-2),c=c[_](0,-2)[y](/\s/g,"")[y]("z","!!!!!"),h=[],p=0,b=(c+=o="uuuuu"[_](c[u]%5||5))[u];b>p;p+=5)d=52200625*(c[x](p)-33)+614125*(c[x](p+1)-33)+7225*(c[x](p+2)-33)+85*(c[x](p+3)-33)+(c[x](p+4)-33),h.push(w&d>>24,w&d>>16,w&d>>8,w&d);return(function(A,L){for(var E=L;E>0;E--)A.pop()})(h,o[u]),m.fromCharCode.apply(m,h)},a=function(c){return c.split("").map(function(o){return("0"+o.charCodeAt().toString(16)).slice(-2)}).join("")+">"},s=function(c){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((c=c.replace(/\s/g,"")).indexOf(">")!==-1&&(c=c.substr(0,c.indexOf(">"))),c.length%2&&(c+="0"),o.test(c)===!1)return"";for(var d="",h=0;h<c.length;h+=2)d+=String.fromCharCode("0x"+(c[h]+c[h+1]));return d},i=function(c){for(var o=new Uint8Array(c.length),d=c.length;d--;)o[d]=c.charCodeAt(d);return(o=Sc(o)).reduce(function(h,p){return h+String.fromCharCode(p)},"")};t.processDataByFilters=function(c,o){var d=0,h=c||"",p=[];for(typeof(o=o||[])=="string"&&(o=[o]),d=0;d<o.length;d+=1)switch(o[d]){case"ASCII85Decode":case"/ASCII85Decode":h=e(h),p.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":h=r(h),p.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":h=s(h),p.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":h=a(h),p.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":h=i(h),p.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[d]+'" is not implemented')}return{data:h,reverseChain:p.reverse().join(" ")}}})(Mt.API),(function(t){t.loadFile=function(r,e,a){return(function(s,i,c){i=i!==!1,c=typeof c=="function"?c:function(){};var o=void 0;try{o=(function(d,h,p){var b=new XMLHttpRequest,m=0,u=function(w){var x=w.length,_=[],y=String.fromCharCode;for(m=0;m<x;m+=1)_.push(y(255&w.charCodeAt(m)));return _.join("")};if(b.open("GET",d,!h),b.overrideMimeType("text/plain; charset=x-user-defined"),h===!1&&(b.onload=function(){b.status===200?p(u(this.responseText)):p(void 0)}),b.send(null),h&&b.status===200)return u(b.responseText)})(s,i,c)}catch{}return o})(r,e,a)},t.allowFsRead=void 0,t.loadImageFile=t.loadFile})(Mt.API),(function(t){function r(){return(Gt.html2canvas?Promise.resolve(Gt.html2canvas):Yl(()=>import("./html2canvas.esm-QH1iLAAe.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function e(){return(Gt.DOMPurify?Promise.resolve(Gt.DOMPurify):Yl(()=>import("./purify.es-B9ZVCkUG.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var a=function(o){var d=kr(o);return d==="undefined"?"undefined":d==="string"||o instanceof String?"string":d==="number"||o instanceof Number?"number":d==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":d==="object"?"object":"unknown"},s=function(o,d){var h=document.createElement(o);for(var p in d.className&&(h.className=d.className),d.innerHTML&&d.dompurify&&(h.innerHTML=d.dompurify.sanitize(d.innerHTML)),d.style)h.style[p]=d.style[p];return h},i=function o(d,h){for(var p=d.nodeType===3?document.createTextNode(d.nodeValue):d.cloneNode(!1),b=d.firstChild;b;b=b.nextSibling)h!==!0&&b.nodeType===1&&b.nodeName==="SCRIPT"||p.appendChild(o(b,h));return d.nodeType===1&&(d.nodeName==="CANVAS"?(p.width=d.width,p.height=d.height,p.getContext("2d").drawImage(d,0,0)):d.nodeName!=="TEXTAREA"&&d.nodeName!=="SELECT"||(p.value=d.value),p.addEventListener("load",function(){p.scrollTop=d.scrollTop,p.scrollLeft=d.scrollLeft},!0)),p},c=function o(d){var h=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),p=o.convert(Promise.resolve(),h);return(p=p.setProgress(1,o,1,[o])).set(d)};(c.prototype=Object.create(Promise.prototype)).constructor=c,c.convert=function(o,d){return o.__proto__=d||c.prototype,o},c.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},c.prototype.from=function(o,d){return this.then(function(){switch(d=d||(function(h){switch(a(h)){case"string":return"string";case"element":return h.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(o),d){case"string":return this.then(e).then(function(h){return this.set({src:s("div",{innerHTML:o,dompurify:h})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},c.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},c.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},d=i(this.prop.src,this.opt.html2canvas.javascriptEnabled);d.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(d),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},c.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(r).then(function(d){var h=Object.assign({},this.opt.html2canvas);return delete h.onrendered,d(this.prop.container,h)}).then(function(d){(this.opt.html2canvas.onrendered||function(){})(d),this.prop.canvas=d,document.body.removeChild(this.prop.overlay)})},c.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(r).then(function(d){var h=this.opt.jsPDF,p=this.opt.fontFaces,b=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,m=Object.assign({async:!0,allowTaint:!0,scale:b,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete m.onrendered,h.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,h.context2d.posX=this.opt.x,h.context2d.posY=this.opt.y,h.context2d.margin=this.opt.margin,h.context2d.fontFaces=p,p)for(var u=0;u<p.length;++u){var w=p[u],x=w.src.find(function(_){return _.format==="truetype"});x&&h.addFont(x.url,w.ref.name,w.ref.style)}return m.windowHeight=m.windowHeight||0,m.windowHeight=m.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):m.windowHeight,h.context2d.save(!0),d(this.prop.container,m)}).then(function(d){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(d),this.prop.canvas=d,document.body.removeChild(this.prop.overlay)})},c.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},c.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},c.prototype.output=function(o,d,h){return(h=h||"pdf").toLowerCase()==="img"||h.toLowerCase()==="image"?this.outputImg(o,d):this.outputPdf(o,d)},c.prototype.outputPdf=function(o,d){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,d)})},c.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},c.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},c.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},c.prototype.set=function(o){if(a(o)!=="object")return this;var d=Object.keys(o||{}).map(function(h){if(h in c.template.prop)return function(){this.prop[h]=o[h]};switch(h){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[h]=o[h]}}},this);return this.then(function(){return this.thenList(d)})},c.prototype.get=function(o,d){return this.then(function(){var h=o in c.template.prop?this.prop[o]:this.opt[o];return d?d(h):h})},c.prototype.setMargin=function(o){return this.then(function(){switch(a(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},c.prototype.setPageSize=function(o){function d(h,p){return Math.floor(h*p/72*96)}return this.then(function(){(o=o||Mt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:d(o.inner.width,o.k),height:d(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},c.prototype.setProgress=function(o,d,h,p){return o!=null&&(this.progress.val=o),d!=null&&(this.progress.state=d),h!=null&&(this.progress.n=h),p!=null&&(this.progress.stack=p),this.progress.ratio=this.progress.val/this.progress.state,this},c.prototype.updateProgress=function(o,d,h,p){return this.setProgress(o?this.progress.val+o:null,d||null,h?this.progress.n+h:null,p?this.progress.stack.concat(p):null)},c.prototype.then=function(o,d){var h=this;return this.thenCore(o,d,function(p,b){return h.updateProgress(null,null,1,[p]),Promise.prototype.then.call(this,function(m){return h.updateProgress(null,p),m}).then(p,b).then(function(m){return h.updateProgress(1),m})})},c.prototype.thenCore=function(o,d,h){h=h||Promise.prototype.then;var p=this;o&&(o=o.bind(p)),d&&(d=d.bind(p));var b=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?p:c.convert(Object.assign({},p),Promise.prototype),m=h.call(b,o,d);return c.convert(m,p.__proto__)},c.prototype.thenExternal=function(o,d){return Promise.prototype.then.call(this,o,d)},c.prototype.thenList=function(o){var d=this;return o.forEach(function(h){d=d.thenCore(h)}),d},c.prototype.catch=function(o){o&&(o=o.bind(this));var d=Promise.prototype.catch.call(this,o);return c.convert(d,this)},c.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},c.prototype.error=function(o){return this.then(function(){throw new Error(o)})},c.prototype.using=c.prototype.set,c.prototype.saveAs=c.prototype.save,c.prototype.export=c.prototype.output,c.prototype.run=c.prototype.then,Mt.getPageSize=function(o,d,h){if(kr(o)==="object"){var p=o;o=p.orientation,d=p.unit||d,h=p.format||h}d=d||"mm",h=h||"a4",o=(""+(o||"P")).toLowerCase();var b,m=(""+h).toLowerCase(),u={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(d){case"pt":b=1;break;case"mm":b=72/25.4;break;case"cm":b=72/2.54;break;case"in":b=72;break;case"px":b=.75;break;case"pc":case"em":b=12;break;case"ex":b=6;break;default:throw"Invalid unit: "+d}var w,x=0,_=0;if(u.hasOwnProperty(m))x=u[m][1]/b,_=u[m][0]/b;else try{x=h[1],_=h[0]}catch{throw new Error("Invalid format: "+h)}if(o==="p"||o==="portrait")o="p",_>x&&(w=_,_=x,x=w);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",x>_&&(w=_,_=x,x=w)}return{width:_,height:x,unit:d,k:b,orientation:o}},t.html=function(o,d){(d=d||{}).callback=d.callback||function(){},d.html2canvas=d.html2canvas||{},d.html2canvas.canvas=d.html2canvas.canvas||this.canvas,d.jsPDF=d.jsPDF||this,d.fontFaces=d.fontFaces?d.fontFaces.map(hc):null;var h=new c(d);return d.worker?h:h.from(o).doCallback()}})(Mt.API),Mt.API.addJS=function(t){return Ju=t,this.internal.events.subscribe("postPutResources",function(){Xo=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Xo+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Ku=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Ju+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Xo!==void 0&&Ku!==void 0&&this.internal.out("/Names <</JavaScript "+Xo+" 0 R>>")}),this},(function(t){var r;t.events.push(["postPutResources",function(){var e=this,a=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=e.outline.render().split(/\r\n/),i=0;i<s.length;i++){var c=s[i],o=a.exec(c);if(o!=null){var d=o[1];e.internal.newObjectDeferredBegin(d,!1)}e.internal.write(c)}if(this.outline.createNamedDestinations){var h=this.internal.pages.length,p=[];for(i=0;i<h;i++){var b=e.internal.newObject();p.push(b);var m=e.internal.getPageInfo(i+1);e.internal.write("<< /D["+m.objId+" 0 R /XYZ null null null]>> endobj")}var u=e.internal.newObject();for(e.internal.write("<< /Names [ "),i=0;i<p.length;i++)e.internal.write("(page_"+(i+1)+")"+p[i]+" 0 R");e.internal.write(" ] >>","endobj"),r=e.internal.newObject(),e.internal.write("<< /Dests "+u+" 0 R"),e.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){var e=this;e.outline.root.children.length>0&&(e.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&e.internal.write("/Names "+r+" 0 R"))}]),t.events.push(["initialized",function(){var e=this;e.outline={createNamedDestinations:!1,root:{children:[]}},e.outline.add=function(a,s,i){var c={title:s,options:i,children:[]};return a==null&&(a=this.root),a.children.push(c),c},e.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=e,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},e.outline.genIds_r=function(a){a.id=e.internal.newObjectDeferred();for(var s=0;s<a.children.length;s++)this.genIds_r(a.children[s])},e.outline.renderRoot=function(a){this.objStart(a),this.line("/Type /Outlines"),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1]))),this.line("/Count "+this.count_r({count:0},a)),this.objEnd()},e.outline.renderItems=function(a){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<a.children.length;i++){var c=a.children[i];this.objStart(c),this.line("/Title "+this.makeString(c.title)),this.line("/Parent "+this.makeRef(a)),i>0&&this.line("/Prev "+this.makeRef(a.children[i-1])),i<a.children.length-1&&this.line("/Next "+this.makeRef(a.children[i+1])),c.children.length>0&&(this.line("/First "+this.makeRef(c.children[0])),this.line("/Last "+this.makeRef(c.children[c.children.length-1])));var o=this.count=this.count_r({count:0},c);if(o>0&&this.line("/Count "+o),c.options&&c.options.pageNumber){var d=e.internal.getPageInfo(c.options.pageNumber);this.line("/Dest ["+d.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var h=0;h<a.children.length;h++)this.renderItems(a.children[h])},e.outline.line=function(a){this.ctx.val+=a+`\r
`},e.outline.makeRef=function(a){return a.id+" 0 R"},e.outline.makeString=function(a){return"("+e.internal.pdfEscape(a)+")"},e.outline.objStart=function(a){this.ctx.val+=`\r
`+a.id+` 0 obj\r
<<\r
`},e.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},e.outline.count_r=function(a,s){for(var i=0;i<s.children.length;i++)a.count++,this.count_r(a,s.children[i]);return a.count}}])})(Mt.API),(function(t){var r=[192,193,194,195,196,197,198,199];t.processJPEG=function(e,a,s,i,c,o){var d,h=this.decode.DCT_DECODE,p=null;if(typeof e=="string"||this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e)){switch(e=c||e,e=this.__addimage__.isArrayBuffer(e)?new Uint8Array(e):e,d=(function(b){for(var m,u=256*b.charCodeAt(4)+b.charCodeAt(5),w=b.length,x={width:0,height:0,numcomponents:1},_=4;_<w;_+=2){if(_+=u,r.indexOf(b.charCodeAt(_+1))!==-1){m=256*b.charCodeAt(_+5)+b.charCodeAt(_+6),x={width:256*b.charCodeAt(_+7)+b.charCodeAt(_+8),height:m,numcomponents:b.charCodeAt(_+9)};break}u=256*b.charCodeAt(_+2)+b.charCodeAt(_+3)}return x})(e=this.__addimage__.isArrayBufferView(e)?this.__addimage__.arrayBufferToBinaryString(e):e),d.numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}p={data:e,width:d.width,height:d.height,colorSpace:o,bitsPerComponent:8,filter:h,index:a,alias:s}}return p}})(Mt.API),Mt.API.processPNG=function(t,r,e,a){if(this.__addimage__.isArrayBuffer(t)&&(t=new Uint8Array(t)),this.__addimage__.isArrayBufferView(t)){var s,i=r2(t,{checkCrc:!0}),c=i.width,o=i.height,d=i.channels,h=i.palette,p=i.depth;s=h&&d===1?(function(H){for(var P=H.width,Y=H.height,I=H.data,S=H.palette,R=H.depth,N=!1,re=[],ve=[],le=void 0,oe=!1,ie=0,Ae=0;Ae<S.length;Ae++){var te=eu(S[Ae],4),C=te[0],G=te[1],Z=te[2],Q=te[3];re.push(C,G,Z),Q!=null&&(Q===0?(ie++,ve.length<1&&ve.push(Ae)):Q<255&&(oe=!0))}if(oe||ie>1){N=!0,ve=void 0;var fe=P*Y;le=new Uint8Array(fe);for(var we=new DataView(I.buffer),Se=0;Se<fe;Se++){var Ce=pc(we,Se,R),Re=eu(S[Ce],4)[3];le[Se]=Re}}else ie===0&&(ve=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:N?8:void 0,colorBytes:I,alphaBytes:le,needSMask:N,palette:re,mask:ve}})(i):d===2||d===4?(function(H){for(var P=H.data,Y=H.width,I=H.height,S=H.channels,R=H.depth,N=S===2?"DeviceGray":"DeviceRGB",re=S-1,ve=Y*I,le=re,oe=ve*le,ie=1*ve,Ae=Math.ceil(oe*R/8),te=Math.ceil(ie*R/8),C=new Uint8Array(Ae),G=new Uint8Array(te),Z=new DataView(P.buffer),Q=new DataView(C.buffer),fe=new DataView(G.buffer),we=!1,Se=0;Se<ve;Se++){for(var Ce=Se*S,Re=0;Re<le;Re++)ah(Q,pc(Z,Ce+Re,R),Se*le+Re,R);var Me=pc(Z,Ce+le,R);Me<(1<<R)-1&&(we=!0),ah(fe,Me,1*Se,R)}return{colorSpace:N,colorsPerPixel:re,sMaskBitsPerComponent:we?R:void 0,colorBytes:C,alphaBytes:G,needSMask:we}})(i):(function(H){var P=H.data,Y=H.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:Y,colorsPerPixel:Y==="DeviceGray"?1:3,colorBytes:P instanceof Uint16Array?(function(I){for(var S=I.length,R=new Uint8Array(2*S),N=new DataView(R.buffer,R.byteOffset,R.byteLength),re=0;re<S;re++)N.setUint16(2*re,I[re],!1);return R})(P):P,needSMask:!1}})(i);var b,m,u,w=s,x=w.colorSpace,_=w.colorsPerPixel,y=w.sMaskBitsPerComponent,A=w.colorBytes,L=w.alphaBytes,E=w.needSMask,O=w.palette,X=w.mask,K=null;return a!==Mt.API.image_compression.NONE&&typeof Sc=="function"?(K=(function(H){var P;switch(H){case Mt.API.image_compression.FAST:P=11;break;case Mt.API.image_compression.MEDIUM:P=13;break;case Mt.API.image_compression.SLOW:P=14;break;default:P=12}return P})(a),b=this.decode.FLATE_DECODE,m="/Predictor ".concat(K," /Colors ").concat(_," /BitsPerComponent ").concat(p," /Columns ").concat(c),t=eh(A,Math.ceil(c*_*p/8),_,p,a),E&&(u=eh(L,Math.ceil(c*y/8),1,y,a))):(b=void 0,m=void 0,t=A,E&&(u=L)),(this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t))&&(t=this.__addimage__.arrayBufferToBinaryString(t)),(u&&this.__addimage__.isArrayBuffer(u)||this.__addimage__.isArrayBufferView(u))&&(u=this.__addimage__.arrayBufferToBinaryString(u)),{alias:e,data:t,index:r,filter:b,decodeParameters:m,transparency:X,palette:O,sMask:u,predictor:K,width:c,height:o,bitsPerComponent:p,sMaskBitsPerComponent:y,colorSpace:x}}},(function(t){t.processGIF89A=function(r,e,a,s){var i=new _2(r),c=i.width,o=i.height,d=[];i.decodeAndBlitFrameRGBA(0,d);var h={data:d,width:c,height:o},p=new mc(100).encode(h,100);return t.processJPEG.call(this,p,e,a,s)},t.processGIF87A=t.processGIF89A})(Mt.API),Is.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var r=0;r<t;r++){var e=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[r]={red:s,green:a,blue:e,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Is.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,r=this.width*this.height*4;this.data=new Uint8Array(r),this[t]()}catch(e){Tr.log("bit decode error:"+e)}},Is.prototype.bit1=function(){var t,r=Math.ceil(this.width/8),e=r%4;for(t=this.height-1;t>=0;t--){for(var a=this.bottom_up?t:this.height-1-t,s=0;s<r;s++)for(var i=this.datav.getUint8(this.pos++,!0),c=a*this.width*4+8*s*4,o=0;o<8&&8*s+o<this.width;o++){var d=this.palette[i>>7-o&1];this.data[c+4*o]=d.blue,this.data[c+4*o+1]=d.green,this.data[c+4*o+2]=d.red,this.data[c+4*o+3]=255}e!==0&&(this.pos+=4-e)}},Is.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),r=t%4,e=this.height-1;e>=0;e--){for(var a=this.bottom_up?e:this.height-1-e,s=0;s<t;s++){var i=this.datav.getUint8(this.pos++,!0),c=a*this.width*4+2*s*4,o=i>>4,d=15&i,h=this.palette[o];if(this.data[c]=h.blue,this.data[c+1]=h.green,this.data[c+2]=h.red,this.data[c+3]=255,2*s+1>=this.width)break;h=this.palette[d],this.data[c+4]=h.blue,this.data[c+4+1]=h.green,this.data[c+4+2]=h.red,this.data[c+4+3]=255}r!==0&&(this.pos+=4-r)}},Is.prototype.bit8=function(){for(var t=this.width%4,r=this.height-1;r>=0;r--){for(var e=this.bottom_up?r:this.height-1-r,a=0;a<this.width;a++){var s=this.datav.getUint8(this.pos++,!0),i=e*this.width*4+4*a;if(s<this.palette.length){var c=this.palette[s];this.data[i]=c.red,this.data[i+1]=c.green,this.data[i+2]=c.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}t!==0&&(this.pos+=4-t)}},Is.prototype.bit15=function(){for(var t=this.width%3,r=parseInt("11111",2),e=this.height-1;e>=0;e--){for(var a=this.bottom_up?e:this.height-1-e,s=0;s<this.width;s++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var c=(i&r)/r*255|0,o=(i>>5&r)/r*255|0,d=(i>>10&r)/r*255|0,h=i>>15?255:0,p=a*this.width*4+4*s;this.data[p]=d,this.data[p+1]=o,this.data[p+2]=c,this.data[p+3]=h}this.pos+=t}},Is.prototype.bit16=function(){for(var t=this.width%3,r=parseInt("11111",2),e=parseInt("111111",2),a=this.height-1;a>=0;a--){for(var s=this.bottom_up?a:this.height-1-a,i=0;i<this.width;i++){var c=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(c&r)/r*255|0,d=(c>>5&e)/e*255|0,h=(c>>11)/r*255|0,p=s*this.width*4+4*i;this.data[p]=h,this.data[p+1]=d,this.data[p+2]=o,this.data[p+3]=255}this.pos+=t}},Is.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,e=0;e<this.width;e++){var a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),c=r*this.width*4+4*e;this.data[c]=i,this.data[c+1]=s,this.data[c+2]=a,this.data[c+3]=255}this.pos+=this.width%4}},Is.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var r=this.bottom_up?t:this.height-1-t,e=0;e<this.width;e++){var a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),c=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+4*e;this.data[o]=i,this.data[o+1]=s,this.data[o+2]=a,this.data[o+3]=c}},Is.prototype.getData=function(){return this.data},(function(t){t.processBMP=function(r,e,a,s){var i=new Is(r,!1),c=i.width,o=i.height,d={data:i.getData(),width:c,height:o},h=new mc(100).encode(d,100);return t.processJPEG.call(this,h,e,a,s)}})(Mt.API),oh.prototype.getData=function(){return this.data},(function(t){t.processWEBP=function(r,e,a,s){var i=new oh(r),c=i.width,o=i.height,d={data:i.getData(),width:c,height:o},h=new mc(100).encode(d,100);return t.processJPEG.call(this,h,e,a,s)}})(Mt.API),Mt.API.processRGBA=function(t,r,e){for(var a=t.data,s=a.length,i=new Uint8Array(s/4*3),c=new Uint8Array(s/4),o=0,d=0,h=0;h<s;h+=4){var p=a[h],b=a[h+1],m=a[h+2],u=a[h+3];i[o++]=p,i[o++]=b,i[o++]=m,c[d++]=u}var w=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(c),data:w,index:r,alias:e,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},Mt.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},ki=Mt.API,Qo=ki.getCharWidthsArray=function(t,r){var e,a,s=(r=r||{}).font||this.internal.getFont(),i=r.fontSize||this.internal.getFontSize(),c=r.charSpace||this.internal.getCharSpace(),o=r.widths?r.widths:s.metadata.Unicode.widths,d=o.fof?o.fof:1,h=r.kerning?r.kerning:s.metadata.Unicode.kerning,p=h.fof?h.fof:1,b=r.doKerning!==!1,m=0,u=t.length,w=0,x=o[0]||d,_=[];for(e=0;e<u;e++)a=t.charCodeAt(e),typeof s.metadata.widthOfString=="function"?_.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(a))+c*(1e3/i)||0)/1e3):(m=b&&kr(h[a])==="object"&&!isNaN(parseInt(h[a][w],10))?h[a][w]/p:0,_.push((o[a]||x)/d+m)),w=a;return _},Zu=ki.getStringUnitWidth=function(t,r){var e=(r=r||{}).fontSize||this.internal.getFontSize(),a=r.font||this.internal.getFont(),s=r.charSpace||this.internal.getCharSpace();return ki.processArabic&&(t=ki.processArabic(t)),typeof a.metadata.widthOfString=="function"?a.metadata.widthOfString(t,e,s)/e:Qo.apply(this,arguments).reduce(function(i,c){return i+c},0)},Xu=function(t,r,e,a){for(var s=[],i=0,c=t.length,o=0;i!==c&&o+r[i]<e;)o+=r[i],i++;s.push(t.slice(0,i));var d=i;for(o=0;i!==c;)o+r[i]>a&&(s.push(t.slice(d,i)),o=0,d=i),o+=r[i],i++;return d!==i&&s.push(t.slice(d,i)),s},Qu=function(t,r,e){e||(e={});var a,s,i,c,o,d,h,p=[],b=[p],m=e.textIndent||0,u=0,w=0,x=t.split(" "),_=Qo.apply(this,[" ",e])[0];if(d=e.lineIndent===-1?x[0].length+2:e.lineIndent||0){var y=Array(d).join(" "),A=[];x.map(function(E){(E=E.split(/\s*\n/)).length>1?A=A.concat(E.map(function(O,X){return(X&&O.length?`
`:"")+O})):A.push(E[0])}),x=A,d=Zu.apply(this,[y,e])}for(i=0,c=x.length;i<c;i++){var L=0;if(a=x[i],d&&a[0]==`
`&&(a=a.substr(1),L=1),m+u+(w=(s=Qo.apply(this,[a,e])).reduce(function(E,O){return E+O},0))>r||L){if(w>r){for(o=Xu.apply(this,[a,s,r-(m+u),r]),p.push(o.shift()),p=[o.pop()];o.length;)b.push([o.shift()]);w=s.slice(a.length-(p[0]?p[0].length:0)).reduce(function(E,O){return E+O},0)}else p=[a];b.push(p),m=w+d,u=_}else p.push(a),m+=u+w,u=_}return h=d?function(E,O){return(O?y:"")+E.join(" ")}:function(E){return E.join(" ")},b.map(h)},ki.splitTextToSize=function(t,r,e){var a,s=(e=e||{}).fontSize||this.internal.getFontSize(),i=(function(p){if(p.widths&&p.kerning)return{widths:p.widths,kerning:p.kerning};var b=this.internal.getFont(p.fontName,p.fontStyle),m="Unicode";return b.metadata[m]?{widths:b.metadata[m].widths||{0:1},kerning:b.metadata[m].kerning||{}}:{font:b.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,e);a=Array.isArray(t)?t:String(t).split(/\r?\n/);var c=1*this.internal.scaleFactor*r/s;i.textIndent=e.textIndent?1*e.textIndent*this.internal.scaleFactor/s:0,i.lineIndent=e.lineIndent;var o,d,h=[];for(o=0,d=a.length;o<d;o++)h=h.concat(Qu.apply(this,[a[o],c,i]));return h},(function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var r="0123456789abcdef",e="klmnopqrstuvwxyz",a={},s={},i=0;i<16;i++)a[e[i]]=r[i],s[r[i]]=e[i];var c=function(m){return"0x"+parseInt(m,10).toString(16)},o=t.__fontmetrics__.compress=function(m){var u,w,x,_,y=["{"];for(var A in m){if(u=m[A],isNaN(parseInt(A,10))?w="'"+A+"'":(A=parseInt(A,10),w=(w=c(A).slice(2)).slice(0,-1)+s[w.slice(-1)]),typeof u=="number")u<0?(x=c(u).slice(3),_="-"):(x=c(u).slice(2),_=""),x=_+x.slice(0,-1)+s[x.slice(-1)];else{if(kr(u)!=="object")throw new Error("Don't know what to do with value type "+kr(u)+".");x=o(u)}y.push(w+x)}return y.push("}"),y.join("")},d=t.__fontmetrics__.uncompress=function(m){if(typeof m!="string")throw new Error("Invalid argument passed to uncompress.");for(var u,w,x,_,y={},A=1,L=y,E=[],O="",X="",K=m.length-1,H=1;H<K;H+=1)(_=m[H])=="'"?u?(x=u.join(""),u=void 0):u=[]:u?u.push(_):_=="{"?(E.push([L,x]),L={},x=void 0):_=="}"?((w=E.pop())[0][w[1]]=L,x=void 0,L=w[0]):_=="-"?A=-1:x===void 0?a.hasOwnProperty(_)?(O+=a[_],x=parseInt(O,16)*A,A=1,O=""):O+=_:a.hasOwnProperty(_)?(X+=a[_],L[x]=parseInt(X,16)*A,A=1,x=void 0,X=""):X+=_;return y},h={codePages:["WinAnsiEncoding"],WinAnsiEncoding:d("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},p={Unicode:{Courier:h,"Courier-Bold":h,"Courier-BoldOblique":h,"Courier-Oblique":h,Helvetica:h,"Helvetica-Bold":h,"Helvetica-BoldOblique":h,"Helvetica-Oblique":h,"Times-Roman":h,"Times-Bold":h,"Times-BoldItalic":h,"Times-Italic":h}},b={Unicode:{"Courier-Oblique":d("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":d("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":d("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:d("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":d("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":d("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:d("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:d("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":d("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:d("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":d("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":d("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":d("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":d("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(m){var u=m.font,w=b.Unicode[u.postScriptName];w&&(u.metadata.Unicode={},u.metadata.Unicode.widths=w.widths,u.metadata.Unicode.kerning=w.kerning);var x=p.Unicode[u.postScriptName];x&&(u.metadata.Unicode.encoding=x,u.encoding=x.codePages[0])}])})(Mt.API),(function(t){var r=function(e){for(var a=e.length,s=new Uint8Array(a),i=0;i<a;i++)s[i]=e.charCodeAt(i);return s};t.API.events.push(["addFont",function(e){var a=void 0,s=e.font,i=e.instance;if(!s.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(a=i.existsFileInVFS(s.postScriptName)===!1?i.loadFile(s.postScriptName):i.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(c,o){o=/^\x00\x01\x00\x00/.test(o)?r(o):r(sl(o)),c.metadata=t.API.TTFFont.open(o),c.metadata.Unicode=c.metadata.Unicode||{encoding:{},kerning:{},widths:[]},c.metadata.glyIdsUsed=[0]})(s,a)}}])})(Mt),Mt.API.addSvgAsImage=function(t,r,e,a,s,i,c,o){if(isNaN(r)||isNaN(e))throw Tr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(a)||isNaN(s))throw Tr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var d=document.createElement("canvas");d.width=a,d.height=s;var h=d.getContext("2d");h.fillStyle="#fff",h.fillRect(0,0,d.width,d.height);var p={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},b=this;return(Gt.canvg?Promise.resolve(Gt.canvg):Yl(()=>import("./index.es-DOG_e_aL.js"),__vite__mapDeps([0,1,2,3,4]))).catch(function(m){return Promise.reject(new Error("Could not load canvg: "+m))}).then(function(m){return m.default?m.default:m}).then(function(m){return m.fromString(h,t,p)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(m){return m.render(p)}).then(function(){b.addImage(d.toDataURL("image/jpeg",1),r,e,a,s,c,o)})},Mt.API.putTotalPages=function(t){var r,e=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(r=new RegExp(t,"g"),e=this.internal.getNumberOfPages()):(r=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),e=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var a=1;a<=this.internal.getNumberOfPages();a++)for(var s=0;s<this.internal.pages[a].length;s++)this.internal.pages[a][s]=this.internal.pages[a][s].replace(r,e);return this},Mt.API.viewerPreferences=function(t,r){var e;t=t||{},r=r||!1;var a,s,i,c={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(c),d=[],h=0,p=0,b=0;function m(w,x){var _,y=!1;for(_=0;_<w.length;_+=1)w[_]===x&&(y=!0);return y}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(c)),this.internal.viewerpreferences.isSubscribed=!1),e=this.internal.viewerpreferences.configuration,t==="reset"||r===!0){var u=o.length;for(b=0;b<u;b+=1)e[o[b]].value=e[o[b]].defaultValue,e[o[b]].explicitSet=!1}if(kr(t)==="object"){for(s in t)if(i=t[s],m(o,s)&&i!==void 0){if(e[s].type==="boolean"&&typeof i=="boolean")e[s].value=i;else if(e[s].type==="name"&&m(e[s].valueSet,i))e[s].value=i;else if(e[s].type==="integer"&&Number.isInteger(i))e[s].value=i;else if(e[s].type==="array"){for(h=0;h<i.length;h+=1)if(a=!0,i[h].length===1&&typeof i[h][0]=="number")d.push(String(i[h]-1));else if(i[h].length>1){for(p=0;p<i[h].length;p+=1)typeof i[h][p]!="number"&&(a=!1);a===!0&&d.push([i[h][0]-1,i[h][1]-1].join(" "))}e[s].value="["+d.join(" ")+"]"}else e[s].value=e[s].defaultValue;e[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var w,x=[];for(w in e)e[w].explicitSet===!0&&(e[w].type==="name"?x.push("/"+w+" /"+e[w].value):x.push("/"+w+" "+e[w].value));x.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+x.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=e,this},(function(t){var r=function(){var a='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(a)),c=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),d=unescape(encodeURIComponent("</x:xmpmeta>")),h=i.length+c.length+o.length+s.length+d.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+h+" >>"),this.internal.write("stream"),this.internal.write(s+i+c+o+d),this.internal.write("endstream"),this.internal.write("endobj")},e=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(a,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:a,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",e),this.internal.events.subscribe("postPutResources",r)),this}})(Mt.API),(function(t){var r=t.API,e=r.pdfEscape16=function(i,c){for(var o,d=c.metadata.Unicode.widths,h=["","0","00","000","0000"],p=[""],b=0,m=i.length;b<m;++b){if(o=c.metadata.characterToGlyph(i.charCodeAt(b)),c.metadata.glyIdsUsed.push(o),c.metadata.toUnicode[o]=i.charCodeAt(b),d.indexOf(o)==-1&&(d.push(o),d.push([parseInt(c.metadata.widthOfGlyph(o),10)])),o=="0")return p.join("");o=o.toString(16),p.push(h[4-o.length],o)}return p.join("")},a=function(i){var c,o,d,h,p,b,m;for(p=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,d=[],b=0,m=(o=Object.keys(i).sort(function(u,w){return u-w})).length;b<m;b++)c=o[b],d.length>=100&&(p+=`
`+d.length+` beginbfchar
`+d.join(`
`)+`
endbfchar`,d=[]),i[c]!==void 0&&i[c]!==null&&typeof i[c].toString=="function"&&(h=("0000"+i[c].toString(16)).slice(-4),c=("0000"+(+c).toString(16)).slice(-4),d.push("<"+c+"><"+h+">"));return d.length&&(p+=`
`+d.length+` beginbfchar
`+d.join(`
`)+`
endbfchar
`),p+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};r.events.push(["putFont",function(i){(function(c){var o=c.font,d=c.out,h=c.newObject,p=c.putStream;if(o.metadata instanceof t.API.TTFFont&&o.encoding==="Identity-H"){for(var b=o.metadata.Unicode.widths,m=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),u="",w=0;w<m.length;w++)u+=String.fromCharCode(m[w]);var x=h();p({data:u,addLength1:!0,objectId:x}),d("endobj");var _=h();p({data:a(o.metadata.toUnicode),addLength1:!0,objectId:_}),d("endobj");var y=h();d("<<"),d("/Type /FontDescriptor"),d("/FontName /"+Li(o.fontName)),d("/FontFile2 "+x+" 0 R"),d("/FontBBox "+t.API.PDFObject.convert(o.metadata.bbox)),d("/Flags "+o.metadata.flags),d("/StemV "+o.metadata.stemV),d("/ItalicAngle "+o.metadata.italicAngle),d("/Ascent "+o.metadata.ascender),d("/Descent "+o.metadata.decender),d("/CapHeight "+o.metadata.capHeight),d(">>"),d("endobj");var A=h();d("<<"),d("/Type /Font"),d("/BaseFont /"+Li(o.fontName)),d("/FontDescriptor "+y+" 0 R"),d("/W "+t.API.PDFObject.convert(b)),d("/CIDToGIDMap /Identity"),d("/DW 1000"),d("/Subtype /CIDFontType2"),d("/CIDSystemInfo"),d("<<"),d("/Supplement 0"),d("/Registry (Adobe)"),d("/Ordering ("+o.encoding+")"),d(">>"),d(">>"),d("endobj"),o.objectNumber=h(),d("<<"),d("/Type /Font"),d("/Subtype /Type0"),d("/ToUnicode "+_+" 0 R"),d("/BaseFont /"+Li(o.fontName)),d("/Encoding /"+o.encoding),d("/DescendantFonts ["+A+" 0 R]"),d(">>"),d("endobj"),o.isAlreadyPutted=!0}})(i)}]),r.events.push(["putFont",function(i){(function(c){var o=c.font,d=c.out,h=c.newObject,p=c.putStream;if(o.metadata instanceof t.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var b=o.metadata.rawData,m="",u=0;u<b.length;u++)m+=String.fromCharCode(b[u]);var w=h();p({data:m,addLength1:!0,objectId:w}),d("endobj");var x=h();p({data:a(o.metadata.toUnicode),addLength1:!0,objectId:x}),d("endobj");var _=h();d("<<"),d("/Descent "+o.metadata.decender),d("/CapHeight "+o.metadata.capHeight),d("/StemV "+o.metadata.stemV),d("/Type /FontDescriptor"),d("/FontFile2 "+w+" 0 R"),d("/Flags 96"),d("/FontBBox "+t.API.PDFObject.convert(o.metadata.bbox)),d("/FontName /"+Li(o.fontName)),d("/ItalicAngle "+o.metadata.italicAngle),d("/Ascent "+o.metadata.ascender),d(">>"),d("endobj"),o.objectNumber=h();for(var y=0;y<o.metadata.hmtx.widths.length;y++)o.metadata.hmtx.widths[y]=parseInt(o.metadata.hmtx.widths[y]*(1e3/o.metadata.head.unitsPerEm));d("<</Subtype/TrueType/Type/Font/ToUnicode "+x+" 0 R/BaseFont/"+Li(o.fontName)+"/FontDescriptor "+_+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),d("endobj"),o.isAlreadyPutted=!0}})(i)}]);var s=function(i){var c,o=i.text||"",d=i.x,h=i.y,p=i.options||{},b=i.mutex||{},m=b.pdfEscape,u=b.activeFontKey,w=b.fonts,x=u,_="",y=0,A="",L=w[x].encoding;if(w[x].encoding!=="Identity-H")return{text:o,x:d,y:h,options:p,mutex:b};for(A=o,x=u,Array.isArray(o)&&(A=o[0]),y=0;y<A.length;y+=1)w[x].metadata.hasOwnProperty("cmap")&&(c=w[x].metadata.cmap.unicode.codeMap[A[y].charCodeAt(0)]),c||A[y].charCodeAt(0)<256&&w[x].metadata.hasOwnProperty("Unicode")?_+=A[y]:_+="";var E="";return parseInt(x.slice(1))<14||L==="WinAnsiEncoding"?E=m(_,x).split("").map(function(O){return O.charCodeAt(0).toString(16)}).join(""):L==="Identity-H"&&(E=e(_,w[x])),b.isHex=!0,{text:E,x:d,y:h,options:p,mutex:b}};r.events.push(["postProcessText",function(i){var c=i.text||"",o=[],d={text:c,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(c)){var h=0;for(h=0;h<c.length;h+=1)Array.isArray(c[h])&&c[h].length===3?o.push([s(Object.assign({},d,{text:c[h][0]})).text,c[h][1],c[h][2]]):o.push(s(Object.assign({},d,{text:c[h]})).text);i.text=o}else i.text=s(Object.assign({},d,{text:c})).text}])})(Mt),(function(t){var r=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(e){return r.call(this),this.internal.vFS[e]!==void 0},t.addFileToVFS=function(e,a){return r.call(this),this.internal.vFS[e]=a,this},t.getFileFromVFS=function(e){return r.call(this),this.internal.vFS[e]!==void 0?this.internal.vFS[e]:null}})(Mt.API),(function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(a){var s,i,c,o,d,h,p,b=r,m=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],u=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],w={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},x={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},_=["(",")","(","<",">","<","[","]","[","{","}","{","Â«","Â»","Â«","â€¹","â€º","â€¹","â…","â†","â…","â½","â¾","â½","â‚","â‚Ž","â‚","â‰¤","â‰¥","â‰¤","âŒ©","âŒª","âŒ©","ï¹™","ï¹š","ï¹™","ï¹›","ï¹œ","ï¹›","ï¹","ï¹ž","ï¹","ï¹¤","ï¹¥","ï¹¤"],y=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),A=!1,L=0;this.__bidiEngine__={};var E=function(I){var S=I.charCodeAt(),R=S>>8,N=x[R];return N!==void 0?b[256*N+(255&S)]:R===252||R===253?"AL":y.test(R)?"L":R===8?"R":"N"},O=function(I){for(var S,R=0;R<I.length;R++){if((S=E(I.charAt(R)))==="L")return!1;if(S==="R")return!0}return!1},X=function(I,S,R,N){var re,ve,le,oe,ie=S[N];switch(ie){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":A=!1;break;case"N":case"AN":break;case"EN":A&&(ie="AN");break;case"AL":A=!0,ie="R";break;case"WS":case"BN":ie="N";break;case"CS":N<1||N+1>=S.length||(re=R[N-1])!=="EN"&&re!=="AN"||(ve=S[N+1])!=="EN"&&ve!=="AN"?ie="N":A&&(ve="AN"),ie=ve===re?ve:"N";break;case"ES":ie=(re=N>0?R[N-1]:"B")==="EN"&&N+1<S.length&&S[N+1]==="EN"?"EN":"N";break;case"ET":if(N>0&&R[N-1]==="EN"){ie="EN";break}if(A){ie="N";break}for(le=N+1,oe=S.length;le<oe&&S[le]==="ET";)le++;ie=le<oe&&S[le]==="EN"?"EN":"N";break;case"NSM":if(c&&!o){for(oe=S.length,le=N+1;le<oe&&S[le]==="NSM";)le++;if(le<oe){var Ae=I[N],te=Ae>=1425&&Ae<=2303||Ae===64286;if(re=S[le],te&&(re==="R"||re==="AL")){ie="R";break}}}ie=N<1||(re=S[N-1])==="B"?"N":R[N-1];break;case"B":A=!1,s=!0,ie=L;break;case"S":i=!0,ie="N"}return ie},K=function(I,S,R){var N=I.split("");return R&&H(N,R,{hiLevel:L}),N.reverse(),S&&S.reverse(),N.join("")},H=function(I,S,R){var N,re,ve,le,oe,ie=-1,Ae=I.length,te=0,C=[],G=L?u:m,Z=[];for(A=!1,s=!1,i=!1,re=0;re<Ae;re++)Z[re]=E(I[re]);for(ve=0;ve<Ae;ve++){if(oe=te,C[ve]=X(I,Z,C,ve),N=240&(te=G[oe][w[C[ve]]]),te&=15,S[ve]=le=G[te][5],N>0)if(N===16){for(re=ie;re<ve;re++)S[re]=1;ie=-1}else ie=-1;if(G[te][6])ie===-1&&(ie=ve);else if(ie>-1){for(re=ie;re<ve;re++)S[re]=le;ie=-1}Z[ve]==="B"&&(S[ve]=0),R.hiLevel|=le}i&&(function(Q,fe,we){for(var Se=0;Se<we;Se++)if(Q[Se]==="S"){fe[Se]=L;for(var Ce=Se-1;Ce>=0&&Q[Ce]==="WS";Ce--)fe[Ce]=L}})(Z,S,Ae)},P=function(I,S,R,N,re){if(!(re.hiLevel<I)){if(I===1&&L===1&&!s)return S.reverse(),void(R&&R.reverse());for(var ve,le,oe,ie,Ae=S.length,te=0;te<Ae;){if(N[te]>=I){for(oe=te+1;oe<Ae&&N[oe]>=I;)oe++;for(ie=te,le=oe-1;ie<le;ie++,le--)ve=S[ie],S[ie]=S[le],S[le]=ve,R&&(ve=R[ie],R[ie]=R[le],R[le]=ve);te=oe}te++}}},Y=function(I,S,R){var N=I.split(""),re={hiLevel:L};return R||(R=[]),H(N,R,re),(function(ve,le,oe){if(oe.hiLevel!==0&&p)for(var ie,Ae=0;Ae<ve.length;Ae++)le[Ae]===1&&(ie=_.indexOf(ve[Ae]))>=0&&(ve[Ae]=_[ie+1])})(N,R,re),P(2,N,S,R,re),P(1,N,S,R,re),N.join("")};return this.__bidiEngine__.doBidiReorder=function(I,S,R){if((function(re,ve){if(ve)for(var le=0;le<re.length;le++)ve[le]=le;o===void 0&&(o=O(re)),h===void 0&&(h=O(re))})(I,S),c||!d||h)if(c&&d&&o^h)L=o?1:0,I=K(I,S,R);else if(!c&&d&&h)L=o?1:0,I=Y(I,S,R),I=K(I,S);else if(!c||o||d||h){if(c&&!d&&o^h)I=K(I,S),o?(L=0,I=Y(I,S,R)):(L=1,I=Y(I,S,R),I=K(I,S));else if(c&&o&&!d&&h)L=1,I=Y(I,S,R),I=K(I,S);else if(!c&&!d&&o^h){var N=p;o?(L=1,I=Y(I,S,R),L=0,p=!1,I=Y(I,S,R),p=N):(L=0,I=Y(I,S,R),I=K(I,S),L=1,p=!1,I=Y(I,S,R),p=N,I=K(I,S))}}else L=0,I=Y(I,S,R);else L=o?1:0,I=Y(I,S,R);return I},this.__bidiEngine__.setOptions=function(I){I&&(c=I.isInputVisual,d=I.isOutputVisual,o=I.isInputRtl,h=I.isOutputRtl,p=I.isSymmetricSwapping)},this.__bidiEngine__.setOptions(a),this.__bidiEngine__};var r=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],e=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(a){var s=a.text;a.x,a.y;var i=a.options||{};a.mutex,i.lang;var c=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,e.setOptions(i),Object.prototype.toString.call(s)==="[object Array]"){var o=0;for(c=[],o=0;o<s.length;o+=1)Object.prototype.toString.call(s[o])==="[object Array]"?c.push([e.doBidiReorder(s[o][0]),s[o][1],s[o][2]]):c.push([e.doBidiReorder(s[o])]);a.text=c}else a.text=e.doBidiReorder(s);e.setOptions({isInputVisual:!0})}])})(Mt),Mt.API.TTFFont=(function(){function t(r){var e;if(this.rawData=r,e=this.contents=new qa(r),this.contents.pos=4,e.readString(4)==="ttcf")throw new Error("TTCF not supported.");e.pos=0,this.parse(),this.subset=new B2(this),this.registerTTF()}return t.open=function(r){return new t(r)},t.prototype.parse=function(){return this.directory=new j2(this.contents),this.head=new k2(this),this.name=new P2(this),this.cmap=new rp(this),this.toUnicode={},this.hhea=new A2(this),this.maxp=new T2(this),this.hmtx=new I2(this),this.post=new L2(this),this.os2=new C2(this),this.loca=new R2(this),this.glyf=new F2(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var r,e,a,s,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var c,o,d,h;for(h=[],c=0,o=(d=this.bbox).length;c<o;c++)r=d[c],h.push(Math.round(r*this.scaleFactor));return h}).call(this),this.stemV=0,this.post.exists?(a=255&(s=this.post.italic_angle),32768&(e=s>>16)&&(e=-(1+(65535^e))),this.italicAngle=+(e+"."+a)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(r){var e;return((e=this.cmap.unicode)!=null?e.codeMap[r]:void 0)||0},t.prototype.widthOfGlyph=function(r){var e;return e=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(r).advance*e},t.prototype.widthOfString=function(r,e,a){var s,i,c,o;for(c=0,i=0,o=(r=""+r).length;0<=o?i<o:i>o;i=0<=o?++i:--i)s=r.charCodeAt(i),c+=this.widthOfGlyph(this.characterToGlyph(s))+a*(1e3/e)||0;return c*(e/1e3)},t.prototype.lineHeight=function(r,e){var a;return e==null&&(e=!1),a=e?this.lineGap:0,(this.ascender+a-this.decender)/1e3*r},t})();var qs,qa=(function(){function t(r){this.data=r??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(r){return this.data[this.pos++]=r},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(r){return this.writeByte(r>>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},t.prototype.readInt32=function(){var r;return(r=this.readUInt32())>=2147483648?r-4294967296:r},t.prototype.writeInt32=function(r){return r<0&&(r+=4294967296),this.writeUInt32(r)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(r){return this.writeByte(r>>8&255),this.writeByte(255&r)},t.prototype.readInt16=function(){var r;return(r=this.readUInt16())>=32768?r-65536:r},t.prototype.writeInt16=function(r){return r<0&&(r+=65536),this.writeUInt16(r)},t.prototype.readString=function(r){var e,a;for(a=[],e=0;0<=r?e<r:e>r;e=0<=r?++e:--e)a[e]=String.fromCharCode(this.readByte());return a.join("")},t.prototype.writeString=function(r){var e,a,s;for(s=[],e=0,a=r.length;0<=a?e<a:e>a;e=0<=a?++e:--e)s.push(this.writeByte(r.charCodeAt(e)));return s},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(r){return this.writeInt16(r)},t.prototype.readLongLong=function(){var r,e,a,s,i,c,o,d;return r=this.readByte(),e=this.readByte(),a=this.readByte(),s=this.readByte(),i=this.readByte(),c=this.readByte(),o=this.readByte(),d=this.readByte(),128&r?-1*(72057594037927940*(255^r)+281474976710656*(255^e)+1099511627776*(255^a)+4294967296*(255^s)+16777216*(255^i)+65536*(255^c)+256*(255^o)+(255^d)+1):72057594037927940*r+281474976710656*e+1099511627776*a+4294967296*s+16777216*i+65536*c+256*o+d},t.prototype.writeLongLong=function(r){var e,a;return e=Math.floor(r/4294967296),a=4294967295&r,this.writeByte(e>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e),this.writeByte(a>>24&255),this.writeByte(a>>16&255),this.writeByte(a>>8&255),this.writeByte(255&a)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(r){return this.writeInt32(r)},t.prototype.read=function(r){var e,a;for(e=[],a=0;0<=r?a<r:a>r;a=0<=r?++a:--a)e.push(this.readByte());return e},t.prototype.write=function(r){var e,a,s,i;for(i=[],a=0,s=r.length;a<s;a++)e=r[a],i.push(this.writeByte(e));return i},t})(),j2=(function(){var t;function r(e){var a,s,i;for(this.scalarType=e.readInt(),this.tableCount=e.readShort(),this.searchRange=e.readShort(),this.entrySelector=e.readShort(),this.rangeShift=e.readShort(),this.tables={},s=0,i=this.tableCount;0<=i?s<i:s>i;s=0<=i?++s:--s)a={tag:e.readString(4),checksum:e.readInt(),offset:e.readInt(),length:e.readInt()},this.tables[a.tag]=a}return r.prototype.encode=function(e){var a,s,i,c,o,d,h,p,b,m,u,w,x;for(x in u=Object.keys(e).length,d=Math.log(2),b=16*Math.floor(Math.log(u)/d),c=Math.floor(b/d),p=16*u-b,(s=new qa).writeInt(this.scalarType),s.writeShort(u),s.writeShort(b),s.writeShort(c),s.writeShort(p),i=16*u,h=s.pos+i,o=null,w=[],e)for(m=e[x],s.writeString(x),s.writeInt(t(m)),s.writeInt(h),s.writeInt(m.length),w=w.concat(m),x==="head"&&(o=h),h+=m.length;h%4;)w.push(0),h++;return s.write(w),a=2981146554-t(s.data),s.pos=o+8,s.writeUInt32(a),s.data},t=function(e){var a,s,i,c;for(e=np.call(e);e.length%4;)e.push(0);for(i=new qa(e),s=0,a=0,c=e.length;a<c;a=a+=4)s+=i.readUInt32();return 4294967295&s},r})(),S2={}.hasOwnProperty,ta=function(t,r){for(var e in r)S2.call(r,e)&&(t[e]=r[e]);function a(){this.constructor=t}return a.prototype=r.prototype,t.prototype=new a,t.__super__=r.prototype,t};qs=(function(){function t(r){var e;this.file=r,e=this.file.directory.tables[this.tag],this.exists=!!e,e&&(this.offset=e.offset,this.length=e.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t})();var k2=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,qs),t.prototype.tag="head",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},t.prototype.encode=function(r){var e;return(e=new qa).writeInt(this.version),e.writeInt(this.revision),e.writeInt(this.checkSumAdjustment),e.writeInt(this.magicNumber),e.writeShort(this.flags),e.writeShort(this.unitsPerEm),e.writeLongLong(this.created),e.writeLongLong(this.modified),e.writeShort(this.xMin),e.writeShort(this.yMin),e.writeShort(this.xMax),e.writeShort(this.yMax),e.writeShort(this.macStyle),e.writeShort(this.lowestRecPPEM),e.writeShort(this.fontDirectionHint),e.writeShort(r),e.writeShort(this.glyphDataFormat),e.data},t})(),lh=(function(){function t(r,e){var a,s,i,c,o,d,h,p,b,m,u,w,x,_,y,A,L;switch(this.platformID=r.readUInt16(),this.encodingID=r.readShort(),this.offset=e+r.readInt(),b=r.pos,r.pos=this.offset,this.format=r.readUInt16(),this.length=r.readUInt16(),this.language=r.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(d=0;d<256;++d)this.codeMap[d]=r.readByte();break;case 4:for(u=r.readUInt16(),m=u/2,r.pos+=6,i=(function(){var E,O;for(O=[],d=E=0;0<=m?E<m:E>m;d=0<=m?++E:--E)O.push(r.readUInt16());return O})(),r.pos+=2,x=(function(){var E,O;for(O=[],d=E=0;0<=m?E<m:E>m;d=0<=m?++E:--E)O.push(r.readUInt16());return O})(),h=(function(){var E,O;for(O=[],d=E=0;0<=m?E<m:E>m;d=0<=m?++E:--E)O.push(r.readUInt16());return O})(),p=(function(){var E,O;for(O=[],d=E=0;0<=m?E<m:E>m;d=0<=m?++E:--E)O.push(r.readUInt16());return O})(),s=(this.length-r.pos+this.offset)/2,o=(function(){var E,O;for(O=[],d=E=0;0<=s?E<s:E>s;d=0<=s?++E:--E)O.push(r.readUInt16());return O})(),d=y=0,L=i.length;y<L;d=++y)for(_=i[d],a=A=w=x[d];w<=_?A<=_:A>=_;a=w<=_?++A:--A)p[d]===0?c=a+h[d]:(c=o[p[d]/2+(a-w)-(m-d)]||0)!==0&&(c+=h[d]),this.codeMap[a]=65535&c}r.pos=b}return t.encode=function(r,e){var a,s,i,c,o,d,h,p,b,m,u,w,x,_,y,A,L,E,O,X,K,H,P,Y,I,S,R,N,re,ve,le,oe,ie,Ae,te,C,G,Z,Q,fe,we,Se,Ce,Re,Me,Je;switch(N=new qa,c=Object.keys(r).sort(function(je,j){return je-j}),e){case"macroman":for(x=0,_=(function(){var je=[];for(w=0;w<256;++w)je.push(0);return je})(),A={0:0},i={},re=0,ie=c.length;re<ie;re++)A[Ce=r[s=c[re]]]==null&&(A[Ce]=++x),i[s]={old:r[s],new:A[r[s]]},_[s]=A[r[s]];return N.writeUInt16(1),N.writeUInt16(0),N.writeUInt32(12),N.writeUInt16(0),N.writeUInt16(262),N.writeUInt16(0),N.write(_),{charMap:i,subtable:N.data,maxGlyphID:x+1};case"unicode":for(S=[],b=[],L=0,A={},a={},y=h=null,ve=0,Ae=c.length;ve<Ae;ve++)A[O=r[s=c[ve]]]==null&&(A[O]=++L),a[s]={old:O,new:A[O]},o=A[O]-s,y!=null&&o===h||(y&&b.push(y),S.push(s),h=o),y=s;for(y&&b.push(y),b.push(65535),S.push(65535),Y=2*(P=S.length),H=2*Math.pow(Math.log(P)/Math.LN2,2),m=Math.log(H/2)/Math.LN2,K=2*P-H,d=[],X=[],u=[],w=le=0,te=S.length;le<te;w=++le){if(I=S[w],p=b[w],I===65535){d.push(0),X.push(0);break}if(I-(R=a[I].new)>=32768)for(d.push(0),X.push(2*(u.length+P-w)),s=oe=I;I<=p?oe<=p:oe>=p;s=I<=p?++oe:--oe)u.push(a[s].new);else d.push(R-I),X.push(0)}for(N.writeUInt16(3),N.writeUInt16(1),N.writeUInt32(12),N.writeUInt16(4),N.writeUInt16(16+8*P+2*u.length),N.writeUInt16(0),N.writeUInt16(Y),N.writeUInt16(H),N.writeUInt16(m),N.writeUInt16(K),we=0,C=b.length;we<C;we++)s=b[we],N.writeUInt16(s);for(N.writeUInt16(0),Se=0,G=S.length;Se<G;Se++)s=S[Se],N.writeUInt16(s);for(Re=0,Z=d.length;Re<Z;Re++)o=d[Re],N.writeUInt16(o);for(Me=0,Q=X.length;Me<Q;Me++)E=X[Me],N.writeUInt16(E);for(Je=0,fe=u.length;Je<fe;Je++)x=u[Je],N.writeUInt16(x);return{charMap:a,subtable:N.data,maxGlyphID:L+1}}},t})(),rp=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,qs),t.prototype.tag="cmap",t.prototype.parse=function(r){var e,a,s;for(r.pos=this.offset,this.version=r.readUInt16(),s=r.readUInt16(),this.tables=[],this.unicode=null,a=0;0<=s?a<s:a>s;a=0<=s?++a:--a)e=new lh(r,this.offset),this.tables.push(e),e.isUnicode&&this.unicode==null&&(this.unicode=e);return!0},t.encode=function(r,e){var a,s;return e==null&&(e="macroman"),a=lh.encode(r,e),(s=new qa).writeUInt16(0),s.writeUInt16(1),a.table=s.data.concat(a.subtable),a},t})(),A2=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,qs),t.prototype.tag="hhea",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},t})(),C2=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,qs),t.prototype.tag="OS/2",t.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=(function(){var e,a;for(a=[],e=0;e<10;++e)a.push(r.readByte());return a})(),this.charRange=(function(){var e,a;for(a=[],e=0;e<4;++e)a.push(r.readInt());return a})(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=(function(){var e,a;for(a=[],e=0;e<2;e=++e)a.push(r.readInt());return a})(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},t})(),L2=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,qs),t.prototype.tag="post",t.prototype.parse=function(r){var e,a,s;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:case 196608:break;case 131072:var i;for(a=r.readUInt16(),this.glyphNameIndex=[],i=0;0<=a?i<a:i>a;i=0<=a?++i:--i)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],s=[];r.pos<this.offset+this.length;)e=r.readByte(),s.push(this.names.push(r.readString(e)));return s;case 151552:return a=r.readUInt16(),this.offsets=r.read(a);case 262144:return this.map=(function(){var c,o,d;for(d=[],i=c=0,o=this.file.maxp.numGlyphs;0<=o?c<o:c>o;i=0<=o?++c:--c)d.push(r.readUInt32());return d}).call(this)}},t})(),E2=function(t,r){this.raw=t,this.length=t.length,this.platformID=r.platformID,this.encodingID=r.encodingID,this.languageID=r.languageID},P2=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,qs),t.prototype.tag="name",t.prototype.parse=function(r){var e,a,s,i,c,o,d,h,p,b,m;for(r.pos=this.offset,r.readShort(),e=r.readShort(),o=r.readShort(),a=[],i=0;0<=e?i<e:i>e;i=0<=e?++i:--i)a.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+o+r.readShort()});for(d={},i=p=0,b=a.length;p<b;i=++p)s=a[i],r.pos=s.offset,h=r.readString(s.length),c=new E2(h,s),d[m=s.nameID]==null&&(d[m]=[]),d[s.nameID].push(c);this.strings=d,this.copyright=d[0],this.fontFamily=d[1],this.fontSubfamily=d[2],this.uniqueSubfamily=d[3],this.fontName=d[4],this.version=d[5];try{this.postscriptName=d[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=d[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=d[7],this.manufacturer=d[8],this.designer=d[9],this.description=d[10],this.vendorUrl=d[11],this.designerUrl=d[12],this.license=d[13],this.licenseUrl=d[14],this.preferredFamily=d[15],this.preferredSubfamily=d[17],this.compatibleFull=d[18],this.sampleText=d[19]},t})(),T2=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,qs),t.prototype.tag="maxp",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},t})(),I2=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,qs),t.prototype.tag="hmtx",t.prototype.parse=function(r){var e,a,s,i,c,o,d;for(r.pos=this.offset,this.metrics=[],e=0,o=this.file.hhea.numberOfMetrics;0<=o?e<o:e>o;e=0<=o?++e:--e)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var h,p;for(p=[],e=h=0;0<=s?h<s:h>s;e=0<=s?++h:--h)p.push(r.readInt16());return p})(),this.widths=(function(){var h,p,b,m;for(m=[],h=0,p=(b=this.metrics).length;h<p;h++)i=b[h],m.push(i.advance);return m}).call(this),a=this.widths[this.widths.length-1],d=[],e=c=0;0<=s?c<s:c>s;e=0<=s?++c:--c)d.push(this.widths.push(a));return d},t.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},t})(),np=[].slice,F2=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,qs),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(r){var e,a,s,i,c,o,d,h,p,b;return r in this.cache?this.cache[r]:(i=this.file.loca,e=this.file.contents,a=i.indexOf(r),(s=i.lengthOf(r))===0?this.cache[r]=null:(e.pos=this.offset+a,c=(o=new qa(e.read(s))).readShort(),h=o.readShort(),b=o.readShort(),d=o.readShort(),p=o.readShort(),this.cache[r]=c===-1?new D2(o,h,b,d,p):new O2(o,c,h,b,d,p),this.cache[r]))},t.prototype.encode=function(r,e,a){var s,i,c,o,d;for(c=[],i=[],o=0,d=e.length;o<d;o++)s=r[e[o]],i.push(c.length),s&&(c=c.concat(s.encode(a)));return i.push(c.length),{table:c,offsets:i}},t})(),O2=(function(){function t(r,e,a,s,i,c){this.raw=r,this.numberOfContours=e,this.xMin=a,this.yMin=s,this.xMax=i,this.yMax=c,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t})(),D2=(function(){function t(r,e,a,s,i){var c,o;for(this.raw=r,this.xMin=e,this.yMin=a,this.xMax=s,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],c=this.raw;o=c.readShort(),this.glyphOffsets.push(c.pos),this.glyphIDs.push(c.readUInt16()),32&o;)c.pos+=1&o?4:2,128&o?c.pos+=8:64&o?c.pos+=4:8&o&&(c.pos+=2)}return t.prototype.encode=function(){var r,e,a;for(e=new qa(np.call(this.raw.data)),r=0,a=this.glyphIDs.length;r<a;++r)e.pos=this.glyphOffsets[r];return e.data},t})(),R2=(function(){function t(){return t.__super__.constructor.apply(this,arguments)}return ta(t,qs),t.prototype.tag="loca",t.prototype.parse=function(r){var e,a;return r.pos=this.offset,e=this.file.head.indexToLocFormat,this.offsets=e===0?(function(){var s,i;for(i=[],a=0,s=this.length;a<s;a+=2)i.push(2*r.readUInt16());return i}).call(this):(function(){var s,i;for(i=[],a=0,s=this.length;a<s;a+=4)i.push(r.readUInt32());return i}).call(this)},t.prototype.indexOf=function(r){return this.offsets[r]},t.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},t.prototype.encode=function(r,e){for(var a=new Uint32Array(this.offsets.length),s=0,i=0,c=0;c<a.length;++c)if(a[c]=s,i<e.length&&e[i]==c){++i,a[c]=s;var o=this.offsets[c],d=this.offsets[c+1]-o;d>0&&(s+=d)}for(var h=new Array(4*a.length),p=0;p<a.length;++p)h[4*p+3]=255&a[p],h[4*p+2]=(65280&a[p])>>8,h[4*p+1]=(16711680&a[p])>>16,h[4*p]=(4278190080&a[p])>>24;return h},t})(),B2=(function(){function t(r){this.font=r,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var r,e,a,s,i;for(e in s=this.font.cmap.tables[0].codeMap,r={},i=this.subset)a=i[e],r[e]=s[a];return r},t.prototype.glyphsFor=function(r){var e,a,s,i,c,o,d;for(s={},c=0,o=r.length;c<o;c++)s[i=r[c]]=this.font.glyf.glyphFor(i);for(i in e=[],s)(a=s[i])!=null&&a.compound&&e.push.apply(e,a.glyphIDs);if(e.length>0)for(i in d=this.glyphsFor(e))a=d[i],s[i]=a;return s},t.prototype.encode=function(r,e){var a,s,i,c,o,d,h,p,b,m,u,w,x,_,y;for(s in a=rp.encode(this.generateCmap(),"unicode"),c=this.glyphsFor(r),u={0:0},y=a.charMap)u[(d=y[s]).old]=d.new;for(w in m=a.maxGlyphID,c)w in u||(u[w]=m++);return p=(function(A){var L,E;for(L in E={},A)E[A[L]]=L;return E})(u),b=Object.keys(p).sort(function(A,L){return A-L}),x=(function(){var A,L,E;for(E=[],A=0,L=b.length;A<L;A++)o=b[A],E.push(p[o]);return E})(),i=this.font.glyf.encode(c,x,u),h=this.font.loca.encode(i.offsets,x),_={cmap:this.font.cmap.raw(),glyf:i.table,loca:h,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(e)},this.font.os2.exists&&(_["OS/2"]=this.font.os2.raw()),this.font.directory.encode(_)},t})();Mt.API.PDFObject=(function(){var t;function r(){}return t=function(e,a){return(Array(a+1).join("0")+e).slice(-a)},r.convert=function(e){var a,s,i,c;if(Array.isArray(e))return"["+(function(){var o,d,h;for(h=[],o=0,d=e.length;o<d;o++)a=e[o],h.push(r.convert(a));return h})().join(" ")+"]";if(typeof e=="string")return"/"+e;if(e!=null&&e.isString)return"("+e+")";if(e instanceof Date)return"(D:"+t(e.getUTCFullYear(),4)+t(e.getUTCMonth(),2)+t(e.getUTCDate(),2)+t(e.getUTCHours(),2)+t(e.getUTCMinutes(),2)+t(e.getUTCSeconds(),2)+"Z)";if({}.toString.call(e)==="[object Object]"){for(s in i=["<<"],e)c=e[s],i.push("/"+s+" "+r.convert(c));return i.push(">>"),i.join(`
`)}return""+e},r})();function el(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var gc={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var ch;function M2(){return ch||(ch=1,(function(t,r){(function(e){t.exports=e()})(function(){return(function e(a,s,i){function c(h,p){if(!s[h]){if(!a[h]){var b=typeof el=="function"&&el;if(!p&&b)return b(h,!0);if(o)return o(h,!0);var m=new Error("Cannot find module '"+h+"'");throw m.code="MODULE_NOT_FOUND",m}var u=s[h]={exports:{}};a[h][0].call(u.exports,function(w){var x=a[h][1][w];return c(x||w)},u,u.exports,e,a,s,i)}return s[h].exports}for(var o=typeof el=="function"&&el,d=0;d<i.length;d++)c(i[d]);return c})({1:[function(e,a,s){var i=e("./utils"),c=e("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(d){for(var h,p,b,m,u,w,x,_=[],y=0,A=d.length,L=A,E=i.getTypeOf(d)!=="string";y<d.length;)L=A-y,b=E?(h=d[y++],p=y<A?d[y++]:0,y<A?d[y++]:0):(h=d.charCodeAt(y++),p=y<A?d.charCodeAt(y++):0,y<A?d.charCodeAt(y++):0),m=h>>2,u=(3&h)<<4|p>>4,w=1<L?(15&p)<<2|b>>6:64,x=2<L?63&b:64,_.push(o.charAt(m)+o.charAt(u)+o.charAt(w)+o.charAt(x));return _.join("")},s.decode=function(d){var h,p,b,m,u,w,x=0,_=0,y="data:";if(d.substr(0,y.length)===y)throw new Error("Invalid base64 input, it looks like a data url.");var A,L=3*(d=d.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(d.charAt(d.length-1)===o.charAt(64)&&L--,d.charAt(d.length-2)===o.charAt(64)&&L--,L%1!=0)throw new Error("Invalid base64 input, bad content length.");for(A=c.uint8array?new Uint8Array(0|L):new Array(0|L);x<d.length;)h=o.indexOf(d.charAt(x++))<<2|(m=o.indexOf(d.charAt(x++)))>>4,p=(15&m)<<4|(u=o.indexOf(d.charAt(x++)))>>2,b=(3&u)<<6|(w=o.indexOf(d.charAt(x++))),A[_++]=h,u!==64&&(A[_++]=p),w!==64&&(A[_++]=b);return A}},{"./support":30,"./utils":32}],2:[function(e,a,s){var i=e("./external"),c=e("./stream/DataWorker"),o=e("./stream/Crc32Probe"),d=e("./stream/DataLengthProbe");function h(p,b,m,u,w){this.compressedSize=p,this.uncompressedSize=b,this.crc32=m,this.compression=u,this.compressedContent=w}h.prototype={getContentWorker:function(){var p=new c(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new d("data_length")),b=this;return p.on("end",function(){if(this.streamInfo.data_length!==b.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),p},getCompressedWorker:function(){return new c(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},h.createWorkerFrom=function(p,b,m){return p.pipe(new o).pipe(new d("uncompressedSize")).pipe(b.compressWorker(m)).pipe(new d("compressedSize")).withStreamInfo("compression",b)},a.exports=h},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,a,s){var i=e("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},s.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,a,s){var i=e("./utils"),c=(function(){for(var o,d=[],h=0;h<256;h++){o=h;for(var p=0;p<8;p++)o=1&o?3988292384^o>>>1:o>>>1;d[h]=o}return d})();a.exports=function(o,d){return o!==void 0&&o.length?i.getTypeOf(o)!=="string"?(function(h,p,b,m){var u=c,w=m+b;h^=-1;for(var x=m;x<w;x++)h=h>>>8^u[255&(h^p[x])];return-1^h})(0|d,o,o.length,0):(function(h,p,b,m){var u=c,w=m+b;h^=-1;for(var x=m;x<w;x++)h=h>>>8^u[255&(h^p.charCodeAt(x))];return-1^h})(0|d,o,o.length,0):0}},{"./utils":32}],5:[function(e,a,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(e,a,s){var i=null;i=typeof Promise<"u"?Promise:e("lie"),a.exports={Promise:i}},{lie:37}],7:[function(e,a,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",c=e("pako"),o=e("./utils"),d=e("./stream/GenericWorker"),h=i?"uint8array":"array";function p(b,m){d.call(this,"FlateWorker/"+b),this._pako=null,this._pakoAction=b,this._pakoOptions=m,this.meta={}}s.magic="\b\0",o.inherits(p,d),p.prototype.processChunk=function(b){this.meta=b.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(h,b.data),!1)},p.prototype.flush=function(){d.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},p.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this._pako=null},p.prototype._createPako=function(){this._pako=new c[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var b=this;this._pako.onData=function(m){b.push({data:m,meta:b.meta})}},s.compressWorker=function(b){return new p("Deflate",b)},s.uncompressWorker=function(){return new p("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,a,s){function i(u,w){var x,_="";for(x=0;x<w;x++)_+=String.fromCharCode(255&u),u>>>=8;return _}function c(u,w,x,_,y,A){var L,E,O=u.file,X=u.compression,K=A!==h.utf8encode,H=o.transformTo("string",A(O.name)),P=o.transformTo("string",h.utf8encode(O.name)),Y=O.comment,I=o.transformTo("string",A(Y)),S=o.transformTo("string",h.utf8encode(Y)),R=P.length!==O.name.length,N=S.length!==Y.length,re="",ve="",le="",oe=O.dir,ie=O.date,Ae={crc32:0,compressedSize:0,uncompressedSize:0};w&&!x||(Ae.crc32=u.crc32,Ae.compressedSize=u.compressedSize,Ae.uncompressedSize=u.uncompressedSize);var te=0;w&&(te|=8),K||!R&&!N||(te|=2048);var C=0,G=0;oe&&(C|=16),y==="UNIX"?(G=798,C|=(function(Q,fe){var we=Q;return Q||(we=fe?16893:33204),(65535&we)<<16})(O.unixPermissions,oe)):(G=20,C|=(function(Q){return 63&(Q||0)})(O.dosPermissions)),L=ie.getUTCHours(),L<<=6,L|=ie.getUTCMinutes(),L<<=5,L|=ie.getUTCSeconds()/2,E=ie.getUTCFullYear()-1980,E<<=4,E|=ie.getUTCMonth()+1,E<<=5,E|=ie.getUTCDate(),R&&(ve=i(1,1)+i(p(H),4)+P,re+="up"+i(ve.length,2)+ve),N&&(le=i(1,1)+i(p(I),4)+S,re+="uc"+i(le.length,2)+le);var Z="";return Z+=`
\0`,Z+=i(te,2),Z+=X.magic,Z+=i(L,2),Z+=i(E,2),Z+=i(Ae.crc32,4),Z+=i(Ae.compressedSize,4),Z+=i(Ae.uncompressedSize,4),Z+=i(H.length,2),Z+=i(re.length,2),{fileRecord:b.LOCAL_FILE_HEADER+Z+H+re,dirRecord:b.CENTRAL_FILE_HEADER+i(G,2)+Z+i(I.length,2)+"\0\0\0\0"+i(C,4)+i(_,4)+H+re+I}}var o=e("../utils"),d=e("../stream/GenericWorker"),h=e("../utf8"),p=e("../crc32"),b=e("../signature");function m(u,w,x,_){d.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=w,this.zipPlatform=x,this.encodeFileName=_,this.streamFiles=u,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(m,d),m.prototype.push=function(u){var w=u.meta.percent||0,x=this.entriesCount,_=this._sources.length;this.accumulate?this.contentBuffer.push(u):(this.bytesWritten+=u.data.length,d.prototype.push.call(this,{data:u.data,meta:{currentFile:this.currentFile,percent:x?(w+100*(x-_-1))/x:100}}))},m.prototype.openedSource=function(u){this.currentSourceOffset=this.bytesWritten,this.currentFile=u.file.name;var w=this.streamFiles&&!u.file.dir;if(w){var x=c(u,w,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:x.fileRecord,meta:{percent:0}})}else this.accumulate=!0},m.prototype.closedSource=function(u){this.accumulate=!1;var w=this.streamFiles&&!u.file.dir,x=c(u,w,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(x.dirRecord),w)this.push({data:(function(_){return b.DATA_DESCRIPTOR+i(_.crc32,4)+i(_.compressedSize,4)+i(_.uncompressedSize,4)})(u),meta:{percent:100}});else for(this.push({data:x.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},m.prototype.flush=function(){for(var u=this.bytesWritten,w=0;w<this.dirRecords.length;w++)this.push({data:this.dirRecords[w],meta:{percent:100}});var x=this.bytesWritten-u,_=(function(y,A,L,E,O){var X=o.transformTo("string",O(E));return b.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(y,2)+i(y,2)+i(A,4)+i(L,4)+i(X.length,2)+X})(this.dirRecords.length,x,u,this.zipComment,this.encodeFileName);this.push({data:_,meta:{percent:100}})},m.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},m.prototype.registerPrevious=function(u){this._sources.push(u);var w=this;return u.on("data",function(x){w.processChunk(x)}),u.on("end",function(){w.closedSource(w.previous.streamInfo),w._sources.length?w.prepareNextSource():w.end()}),u.on("error",function(x){w.error(x)}),this},m.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},m.prototype.error=function(u){var w=this._sources;if(!d.prototype.error.call(this,u))return!1;for(var x=0;x<w.length;x++)try{w[x].error(u)}catch{}return!0},m.prototype.lock=function(){d.prototype.lock.call(this);for(var u=this._sources,w=0;w<u.length;w++)u[w].lock()},a.exports=m},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,a,s){var i=e("../compressions"),c=e("./ZipFileWorker");s.generateWorker=function(o,d,h){var p=new c(d.streamFiles,h,d.platform,d.encodeFileName),b=0;try{o.forEach(function(m,u){b++;var w=(function(A,L){var E=A||L,O=i[E];if(!O)throw new Error(E+" is not a valid compression method !");return O})(u.options.compression,d.compression),x=u.options.compressionOptions||d.compressionOptions||{},_=u.dir,y=u.date;u._compressWorker(w,x).withStreamInfo("file",{name:m,dir:_,date:y,comment:u.comment||"",unixPermissions:u.unixPermissions,dosPermissions:u.dosPermissions}).pipe(p)}),p.entriesCount=b}catch(m){p.error(m)}return p}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,a,s){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var c=new i;for(var o in this)typeof this[o]!="function"&&(c[o]=this[o]);return c}}(i.prototype=e("./object")).loadAsync=e("./load"),i.support=e("./support"),i.defaults=e("./defaults"),i.version="3.10.1",i.loadAsync=function(c,o){return new i().loadAsync(c,o)},i.external=e("./external"),a.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,a,s){var i=e("./utils"),c=e("./external"),o=e("./utf8"),d=e("./zipEntries"),h=e("./stream/Crc32Probe"),p=e("./nodejsUtils");function b(m){return new c.Promise(function(u,w){var x=m.decompressed.getContentWorker().pipe(new h);x.on("error",function(_){w(_)}).on("end",function(){x.streamInfo.crc32!==m.decompressed.crc32?w(new Error("Corrupted zip : CRC32 mismatch")):u()}).resume()})}a.exports=function(m,u){var w=this;return u=i.extend(u||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),p.isNode&&p.isStream(m)?c.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",m,!0,u.optimizedBinaryString,u.base64).then(function(x){var _=new d(u);return _.load(x),_}).then(function(x){var _=[c.Promise.resolve(x)],y=x.files;if(u.checkCRC32)for(var A=0;A<y.length;A++)_.push(b(y[A]));return c.Promise.all(_)}).then(function(x){for(var _=x.shift(),y=_.files,A=0;A<y.length;A++){var L=y[A],E=L.fileNameStr,O=i.resolve(L.fileNameStr);w.file(O,L.decompressed,{binary:!0,optimizedBinaryString:!0,date:L.date,dir:L.dir,comment:L.fileCommentStr.length?L.fileCommentStr:null,unixPermissions:L.unixPermissions,dosPermissions:L.dosPermissions,createFolders:u.createFolders}),L.dir||(w.file(O).unsafeOriginalName=E)}return _.zipComment.length&&(w.comment=_.zipComment),w})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,a,s){var i=e("../utils"),c=e("../stream/GenericWorker");function o(d,h){c.call(this,"Nodejs stream input adapter for "+d),this._upstreamEnded=!1,this._bindStream(h)}i.inherits(o,c),o.prototype._bindStream=function(d){var h=this;(this._stream=d).pause(),d.on("data",function(p){h.push({data:p,meta:{percent:0}})}).on("error",function(p){h.isPaused?this.generatedError=p:h.error(p)}).on("end",function(){h.isPaused?h._upstreamEnded=!0:h.end()})},o.prototype.pause=function(){return!!c.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},a.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,a,s){var i=e("readable-stream").Readable;function c(o,d,h){i.call(this,d),this._helper=o;var p=this;o.on("data",function(b,m){p.push(b)||p._helper.pause(),h&&h(m)}).on("error",function(b){p.emit("error",b)}).on("end",function(){p.push(null)})}e("../utils").inherits(c,i),c.prototype._read=function(){this._helper.resume()},a.exports=c},{"../utils":32,"readable-stream":16}],14:[function(e,a,s){a.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,c){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,c);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,c)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var c=new Buffer(i);return c.fill(0),c},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(e,a,s){function i(O,X,K){var H,P=o.getTypeOf(X),Y=o.extend(K||{},p);Y.date=Y.date||new Date,Y.compression!==null&&(Y.compression=Y.compression.toUpperCase()),typeof Y.unixPermissions=="string"&&(Y.unixPermissions=parseInt(Y.unixPermissions,8)),Y.unixPermissions&&16384&Y.unixPermissions&&(Y.dir=!0),Y.dosPermissions&&16&Y.dosPermissions&&(Y.dir=!0),Y.dir&&(O=y(O)),Y.createFolders&&(H=_(O))&&A.call(this,H,!0);var I=P==="string"&&Y.binary===!1&&Y.base64===!1;K&&K.binary!==void 0||(Y.binary=!I),(X instanceof b&&X.uncompressedSize===0||Y.dir||!X||X.length===0)&&(Y.base64=!1,Y.binary=!0,X="",Y.compression="STORE",P="string");var S=null;S=X instanceof b||X instanceof d?X:w.isNode&&w.isStream(X)?new x(O,X):o.prepareContent(O,X,Y.binary,Y.optimizedBinaryString,Y.base64);var R=new m(O,S,Y);this.files[O]=R}var c=e("./utf8"),o=e("./utils"),d=e("./stream/GenericWorker"),h=e("./stream/StreamHelper"),p=e("./defaults"),b=e("./compressedObject"),m=e("./zipObject"),u=e("./generate"),w=e("./nodejsUtils"),x=e("./nodejs/NodejsStreamInputAdapter"),_=function(O){O.slice(-1)==="/"&&(O=O.substring(0,O.length-1));var X=O.lastIndexOf("/");return 0<X?O.substring(0,X):""},y=function(O){return O.slice(-1)!=="/"&&(O+="/"),O},A=function(O,X){return X=X!==void 0?X:p.createFolders,O=y(O),this.files[O]||i.call(this,O,null,{dir:!0,createFolders:X}),this.files[O]};function L(O){return Object.prototype.toString.call(O)==="[object RegExp]"}var E={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(O){var X,K,H;for(X in this.files)H=this.files[X],(K=X.slice(this.root.length,X.length))&&X.slice(0,this.root.length)===this.root&&O(K,H)},filter:function(O){var X=[];return this.forEach(function(K,H){O(K,H)&&X.push(H)}),X},file:function(O,X,K){if(arguments.length!==1)return O=this.root+O,i.call(this,O,X,K),this;if(L(O)){var H=O;return this.filter(function(Y,I){return!I.dir&&H.test(Y)})}var P=this.files[this.root+O];return P&&!P.dir?P:null},folder:function(O){if(!O)return this;if(L(O))return this.filter(function(P,Y){return Y.dir&&O.test(P)});var X=this.root+O,K=A.call(this,X),H=this.clone();return H.root=K.name,H},remove:function(O){O=this.root+O;var X=this.files[O];if(X||(O.slice(-1)!=="/"&&(O+="/"),X=this.files[O]),X&&!X.dir)delete this.files[O];else for(var K=this.filter(function(P,Y){return Y.name.slice(0,O.length)===O}),H=0;H<K.length;H++)delete this.files[K[H].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(O){var X,K={};try{if((K=o.extend(O||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:c.utf8encode})).type=K.type.toLowerCase(),K.compression=K.compression.toUpperCase(),K.type==="binarystring"&&(K.type="string"),!K.type)throw new Error("No output type specified.");o.checkSupport(K.type),K.platform!=="darwin"&&K.platform!=="freebsd"&&K.platform!=="linux"&&K.platform!=="sunos"||(K.platform="UNIX"),K.platform==="win32"&&(K.platform="DOS");var H=K.comment||this.comment||"";X=u.generateWorker(this,K,H)}catch(P){(X=new d("error")).error(P)}return new h(X,K.type||"string",K.mimeType)},generateAsync:function(O,X){return this.generateInternalStream(O).accumulate(X)},generateNodeStream:function(O,X){return(O=O||{}).type||(O.type="nodebuffer"),this.generateInternalStream(O).toNodejsStream(X)}};a.exports=E},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,a,s){a.exports=e("stream")},{stream:void 0}],17:[function(e,a,s){var i=e("./DataReader");function c(o){i.call(this,o);for(var d=0;d<this.data.length;d++)o[d]=255&o[d]}e("../utils").inherits(c,i),c.prototype.byteAt=function(o){return this.data[this.zero+o]},c.prototype.lastIndexOfSignature=function(o){for(var d=o.charCodeAt(0),h=o.charCodeAt(1),p=o.charCodeAt(2),b=o.charCodeAt(3),m=this.length-4;0<=m;--m)if(this.data[m]===d&&this.data[m+1]===h&&this.data[m+2]===p&&this.data[m+3]===b)return m-this.zero;return-1},c.prototype.readAndCheckSignature=function(o){var d=o.charCodeAt(0),h=o.charCodeAt(1),p=o.charCodeAt(2),b=o.charCodeAt(3),m=this.readData(4);return d===m[0]&&h===m[1]&&p===m[2]&&b===m[3]},c.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var d=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,d},a.exports=c},{"../utils":32,"./DataReader":18}],18:[function(e,a,s){var i=e("../utils");function c(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}c.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var d,h=0;for(this.checkOffset(o),d=this.index+o-1;d>=this.index;d--)h=(h<<8)+this.byteAt(d);return this.index+=o,h},readString:function(o){return i.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},a.exports=c},{"../utils":32}],19:[function(e,a,s){var i=e("./Uint8ArrayReader");function c(o){i.call(this,o)}e("../utils").inherits(c,i),c.prototype.readData=function(o){this.checkOffset(o);var d=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,d},a.exports=c},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,a,s){var i=e("./DataReader");function c(o){i.call(this,o)}e("../utils").inherits(c,i),c.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},c.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},c.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},c.prototype.readData=function(o){this.checkOffset(o);var d=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,d},a.exports=c},{"../utils":32,"./DataReader":18}],21:[function(e,a,s){var i=e("./ArrayReader");function c(o){i.call(this,o)}e("../utils").inherits(c,i),c.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var d=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,d},a.exports=c},{"../utils":32,"./ArrayReader":17}],22:[function(e,a,s){var i=e("../utils"),c=e("../support"),o=e("./ArrayReader"),d=e("./StringReader"),h=e("./NodeBufferReader"),p=e("./Uint8ArrayReader");a.exports=function(b){var m=i.getTypeOf(b);return i.checkSupport(m),m!=="string"||c.uint8array?m==="nodebuffer"?new h(b):c.uint8array?new p(i.transformTo("uint8array",b)):new o(i.transformTo("array",b)):new d(b)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,a,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,a,s){var i=e("./GenericWorker"),c=e("../utils");function o(d){i.call(this,"ConvertWorker to "+d),this.destType=d}c.inherits(o,i),o.prototype.processChunk=function(d){this.push({data:c.transformTo(this.destType,d.data),meta:d.meta})},a.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(e,a,s){var i=e("./GenericWorker"),c=e("../crc32");function o(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(o,i),o.prototype.processChunk=function(d){this.streamInfo.crc32=c(d.data,this.streamInfo.crc32||0),this.push(d)},a.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,a,s){var i=e("../utils"),c=e("./GenericWorker");function o(d){c.call(this,"DataLengthProbe for "+d),this.propName=d,this.withStreamInfo(d,0)}i.inherits(o,c),o.prototype.processChunk=function(d){if(d){var h=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=h+d.data.length}c.prototype.processChunk.call(this,d)},a.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(e,a,s){var i=e("../utils"),c=e("./GenericWorker");function o(d){c.call(this,"DataWorker");var h=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,d.then(function(p){h.dataIsReady=!0,h.data=p,h.max=p&&p.length||0,h.type=i.getTypeOf(p),h.isPaused||h._tickAndRepeat()},function(p){h.error(p)})}i.inherits(o,c),o.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var d=null,h=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":d=this.data.substring(this.index,h);break;case"uint8array":d=this.data.subarray(this.index,h);break;case"array":case"nodebuffer":d=this.data.slice(this.index,h)}return this.index=h,this.push({data:d,meta:{percent:this.max?this.index/this.max*100:0}})},a.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(e,a,s){function i(c){this.name=c||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(c){this.emit("data",c)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(c){this.emit("error",c)}return!0},error:function(c){return!this.isFinished&&(this.isPaused?this.generatedError=c:(this.isFinished=!0,this.emit("error",c),this.previous&&this.previous.error(c),this.cleanUp()),!0)},on:function(c,o){return this._listeners[c].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(c,o){if(this._listeners[c])for(var d=0;d<this._listeners[c].length;d++)this._listeners[c][d].call(this,o)},pipe:function(c){return c.registerPrevious(this)},registerPrevious:function(c){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=c.streamInfo,this.mergeStreamInfo(),this.previous=c;var o=this;return c.on("data",function(d){o.processChunk(d)}),c.on("end",function(){o.end()}),c.on("error",function(d){o.error(d)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var c=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),c=!0),this.previous&&this.previous.resume(),!c},flush:function(){},processChunk:function(c){this.push(c)},withStreamInfo:function(c,o){return this.extraStreamInfo[c]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var c in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,c)&&(this.streamInfo[c]=this.extraStreamInfo[c])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var c="Worker "+this.name;return this.previous?this.previous+" -> "+c:c}},a.exports=i},{}],29:[function(e,a,s){var i=e("../utils"),c=e("./ConvertWorker"),o=e("./GenericWorker"),d=e("../base64"),h=e("../support"),p=e("../external"),b=null;if(h.nodestream)try{b=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function m(w,x){return new p.Promise(function(_,y){var A=[],L=w._internalType,E=w._outputType,O=w._mimeType;w.on("data",function(X,K){A.push(X),x&&x(K)}).on("error",function(X){A=[],y(X)}).on("end",function(){try{var X=(function(K,H,P){switch(K){case"blob":return i.newBlob(i.transformTo("arraybuffer",H),P);case"base64":return d.encode(H);default:return i.transformTo(K,H)}})(E,(function(K,H){var P,Y=0,I=null,S=0;for(P=0;P<H.length;P++)S+=H[P].length;switch(K){case"string":return H.join("");case"array":return Array.prototype.concat.apply([],H);case"uint8array":for(I=new Uint8Array(S),P=0;P<H.length;P++)I.set(H[P],Y),Y+=H[P].length;return I;case"nodebuffer":return Buffer.concat(H);default:throw new Error("concat : unsupported type '"+K+"'")}})(L,A),O);_(X)}catch(K){y(K)}A=[]}).resume()})}function u(w,x,_){var y=x;switch(x){case"blob":case"arraybuffer":y="uint8array";break;case"base64":y="string"}try{this._internalType=y,this._outputType=x,this._mimeType=_,i.checkSupport(y),this._worker=w.pipe(new c(y)),w.lock()}catch(A){this._worker=new o("error"),this._worker.error(A)}}u.prototype={accumulate:function(w){return m(this,w)},on:function(w,x){var _=this;return w==="data"?this._worker.on(w,function(y){x.call(_,y.data,y.meta)}):this._worker.on(w,function(){i.delay(x,arguments,_)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(w){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new b(this,{objectMode:this._outputType!=="nodebuffer"},w)}},a.exports=u},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,a,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof Buffer<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var i=new ArrayBuffer(0);try{s.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var c=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);c.append(i),s.blob=c.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!e("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(e,a,s){for(var i=e("./utils"),c=e("./support"),o=e("./nodejsUtils"),d=e("./stream/GenericWorker"),h=new Array(256),p=0;p<256;p++)h[p]=252<=p?6:248<=p?5:240<=p?4:224<=p?3:192<=p?2:1;h[254]=h[254]=1;function b(){d.call(this,"utf-8 decode"),this.leftOver=null}function m(){d.call(this,"utf-8 encode")}s.utf8encode=function(u){return c.nodebuffer?o.newBufferFrom(u,"utf-8"):(function(w){var x,_,y,A,L,E=w.length,O=0;for(A=0;A<E;A++)(64512&(_=w.charCodeAt(A)))==55296&&A+1<E&&(64512&(y=w.charCodeAt(A+1)))==56320&&(_=65536+(_-55296<<10)+(y-56320),A++),O+=_<128?1:_<2048?2:_<65536?3:4;for(x=c.uint8array?new Uint8Array(O):new Array(O),A=L=0;L<O;A++)(64512&(_=w.charCodeAt(A)))==55296&&A+1<E&&(64512&(y=w.charCodeAt(A+1)))==56320&&(_=65536+(_-55296<<10)+(y-56320),A++),_<128?x[L++]=_:(_<2048?x[L++]=192|_>>>6:(_<65536?x[L++]=224|_>>>12:(x[L++]=240|_>>>18,x[L++]=128|_>>>12&63),x[L++]=128|_>>>6&63),x[L++]=128|63&_);return x})(u)},s.utf8decode=function(u){return c.nodebuffer?i.transformTo("nodebuffer",u).toString("utf-8"):(function(w){var x,_,y,A,L=w.length,E=new Array(2*L);for(x=_=0;x<L;)if((y=w[x++])<128)E[_++]=y;else if(4<(A=h[y]))E[_++]=65533,x+=A-1;else{for(y&=A===2?31:A===3?15:7;1<A&&x<L;)y=y<<6|63&w[x++],A--;1<A?E[_++]=65533:y<65536?E[_++]=y:(y-=65536,E[_++]=55296|y>>10&1023,E[_++]=56320|1023&y)}return E.length!==_&&(E.subarray?E=E.subarray(0,_):E.length=_),i.applyFromCharCode(E)})(u=i.transformTo(c.uint8array?"uint8array":"array",u))},i.inherits(b,d),b.prototype.processChunk=function(u){var w=i.transformTo(c.uint8array?"uint8array":"array",u.data);if(this.leftOver&&this.leftOver.length){if(c.uint8array){var x=w;(w=new Uint8Array(x.length+this.leftOver.length)).set(this.leftOver,0),w.set(x,this.leftOver.length)}else w=this.leftOver.concat(w);this.leftOver=null}var _=(function(A,L){var E;for((L=L||A.length)>A.length&&(L=A.length),E=L-1;0<=E&&(192&A[E])==128;)E--;return E<0||E===0?L:E+h[A[E]]>L?E:L})(w),y=w;_!==w.length&&(c.uint8array?(y=w.subarray(0,_),this.leftOver=w.subarray(_,w.length)):(y=w.slice(0,_),this.leftOver=w.slice(_,w.length))),this.push({data:s.utf8decode(y),meta:u.meta})},b.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=b,i.inherits(m,d),m.prototype.processChunk=function(u){this.push({data:s.utf8encode(u.data),meta:u.meta})},s.Utf8EncodeWorker=m},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,a,s){var i=e("./support"),c=e("./base64"),o=e("./nodejsUtils"),d=e("./external");function h(x){return x}function p(x,_){for(var y=0;y<x.length;++y)_[y]=255&x.charCodeAt(y);return _}e("setimmediate"),s.newBlob=function(x,_){s.checkSupport("blob");try{return new Blob([x],{type:_})}catch{try{var y=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return y.append(x),y.getBlob(_)}catch{throw new Error("Bug : can't construct the Blob.")}}};var b={stringifyByChunk:function(x,_,y){var A=[],L=0,E=x.length;if(E<=y)return String.fromCharCode.apply(null,x);for(;L<E;)_==="array"||_==="nodebuffer"?A.push(String.fromCharCode.apply(null,x.slice(L,Math.min(L+y,E)))):A.push(String.fromCharCode.apply(null,x.subarray(L,Math.min(L+y,E)))),L+=y;return A.join("")},stringifyByChar:function(x){for(var _="",y=0;y<x.length;y++)_+=String.fromCharCode(x[y]);return _},applyCanBeUsed:{uint8array:(function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}})()}};function m(x){var _=65536,y=s.getTypeOf(x),A=!0;if(y==="uint8array"?A=b.applyCanBeUsed.uint8array:y==="nodebuffer"&&(A=b.applyCanBeUsed.nodebuffer),A)for(;1<_;)try{return b.stringifyByChunk(x,y,_)}catch{_=Math.floor(_/2)}return b.stringifyByChar(x)}function u(x,_){for(var y=0;y<x.length;y++)_[y]=x[y];return _}s.applyFromCharCode=m;var w={};w.string={string:h,array:function(x){return p(x,new Array(x.length))},arraybuffer:function(x){return w.string.uint8array(x).buffer},uint8array:function(x){return p(x,new Uint8Array(x.length))},nodebuffer:function(x){return p(x,o.allocBuffer(x.length))}},w.array={string:m,array:h,arraybuffer:function(x){return new Uint8Array(x).buffer},uint8array:function(x){return new Uint8Array(x)},nodebuffer:function(x){return o.newBufferFrom(x)}},w.arraybuffer={string:function(x){return m(new Uint8Array(x))},array:function(x){return u(new Uint8Array(x),new Array(x.byteLength))},arraybuffer:h,uint8array:function(x){return new Uint8Array(x)},nodebuffer:function(x){return o.newBufferFrom(new Uint8Array(x))}},w.uint8array={string:m,array:function(x){return u(x,new Array(x.length))},arraybuffer:function(x){return x.buffer},uint8array:h,nodebuffer:function(x){return o.newBufferFrom(x)}},w.nodebuffer={string:m,array:function(x){return u(x,new Array(x.length))},arraybuffer:function(x){return w.nodebuffer.uint8array(x).buffer},uint8array:function(x){return u(x,new Uint8Array(x.length))},nodebuffer:h},s.transformTo=function(x,_){if(_=_||"",!x)return _;s.checkSupport(x);var y=s.getTypeOf(_);return w[y][x](_)},s.resolve=function(x){for(var _=x.split("/"),y=[],A=0;A<_.length;A++){var L=_[A];L==="."||L===""&&A!==0&&A!==_.length-1||(L===".."?y.pop():y.push(L))}return y.join("/")},s.getTypeOf=function(x){return typeof x=="string"?"string":Object.prototype.toString.call(x)==="[object Array]"?"array":i.nodebuffer&&o.isBuffer(x)?"nodebuffer":i.uint8array&&x instanceof Uint8Array?"uint8array":i.arraybuffer&&x instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(x){if(!i[x.toLowerCase()])throw new Error(x+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(x){var _,y,A="";for(y=0;y<(x||"").length;y++)A+="\\x"+((_=x.charCodeAt(y))<16?"0":"")+_.toString(16).toUpperCase();return A},s.delay=function(x,_,y){setImmediate(function(){x.apply(y||null,_||[])})},s.inherits=function(x,_){function y(){}y.prototype=_.prototype,x.prototype=new y},s.extend=function(){var x,_,y={};for(x=0;x<arguments.length;x++)for(_ in arguments[x])Object.prototype.hasOwnProperty.call(arguments[x],_)&&y[_]===void 0&&(y[_]=arguments[x][_]);return y},s.prepareContent=function(x,_,y,A,L){return d.Promise.resolve(_).then(function(E){return i.blob&&(E instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(E))!==-1)&&typeof FileReader<"u"?new d.Promise(function(O,X){var K=new FileReader;K.onload=function(H){O(H.target.result)},K.onerror=function(H){X(H.target.error)},K.readAsArrayBuffer(E)}):E}).then(function(E){var O=s.getTypeOf(E);return O?(O==="arraybuffer"?E=s.transformTo("uint8array",E):O==="string"&&(L?E=c.decode(E):y&&A!==!0&&(E=(function(X){return p(X,i.uint8array?new Uint8Array(X.length):new Array(X.length))})(E))),E):d.Promise.reject(new Error("Can't read the data of '"+x+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,a,s){var i=e("./reader/readerFor"),c=e("./utils"),o=e("./signature"),d=e("./zipEntry"),h=e("./support");function p(b){this.files=[],this.loadOptions=b}p.prototype={checkSignature:function(b){if(!this.reader.readAndCheckSignature(b)){this.reader.index-=4;var m=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+c.pretty(m)+", expected "+c.pretty(b)+")")}},isSignature:function(b,m){var u=this.reader.index;this.reader.setIndex(b);var w=this.reader.readString(4)===m;return this.reader.setIndex(u),w},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var b=this.reader.readData(this.zipCommentLength),m=h.uint8array?"uint8array":"array",u=c.transformTo(m,b);this.zipComment=this.loadOptions.decodeFileName(u)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var b,m,u,w=this.zip64EndOfCentralSize-44;0<w;)b=this.reader.readInt(2),m=this.reader.readInt(4),u=this.reader.readData(m),this.zip64ExtensibleData[b]={id:b,length:m,value:u}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var b,m;for(b=0;b<this.files.length;b++)m=this.files[b],this.reader.setIndex(m.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),m.readLocalPart(this.reader),m.handleUTF8(),m.processAttributes()},readCentralDir:function(){var b;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(b=new d({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(b);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var b=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(b<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(b);var m=b;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===c.MAX_VALUE_16BITS||this.diskWithCentralDirStart===c.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===c.MAX_VALUE_16BITS||this.centralDirRecords===c.MAX_VALUE_16BITS||this.centralDirSize===c.MAX_VALUE_32BITS||this.centralDirOffset===c.MAX_VALUE_32BITS){if(this.zip64=!0,(b=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(b),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var u=this.centralDirOffset+this.centralDirSize;this.zip64&&(u+=20,u+=12+this.zip64EndOfCentralSize);var w=m-u;if(0<w)this.isSignature(m,o.CENTRAL_FILE_HEADER)||(this.reader.zero=w);else if(w<0)throw new Error("Corrupted zip: missing "+Math.abs(w)+" bytes.")},prepareReader:function(b){this.reader=i(b)},load:function(b){this.prepareReader(b),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},a.exports=p},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,a,s){var i=e("./reader/readerFor"),c=e("./utils"),o=e("./compressedObject"),d=e("./crc32"),h=e("./utf8"),p=e("./compressions"),b=e("./support");function m(u,w){this.options=u,this.loadOptions=w}m.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(u){var w,x;if(u.skip(22),this.fileNameLength=u.readInt(2),x=u.readInt(2),this.fileName=u.readData(this.fileNameLength),u.skip(x),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((w=(function(_){for(var y in p)if(Object.prototype.hasOwnProperty.call(p,y)&&p[y].magic===_)return p[y];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+c.pretty(this.compressionMethod)+" unknown (inner file : "+c.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,w,u.readData(this.compressedSize))},readCentralPart:function(u){this.versionMadeBy=u.readInt(2),u.skip(2),this.bitFlag=u.readInt(2),this.compressionMethod=u.readString(2),this.date=u.readDate(),this.crc32=u.readInt(4),this.compressedSize=u.readInt(4),this.uncompressedSize=u.readInt(4);var w=u.readInt(2);if(this.extraFieldsLength=u.readInt(2),this.fileCommentLength=u.readInt(2),this.diskNumberStart=u.readInt(2),this.internalFileAttributes=u.readInt(2),this.externalFileAttributes=u.readInt(4),this.localHeaderOffset=u.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");u.skip(w),this.readExtraFields(u),this.parseZIP64ExtraField(u),this.fileComment=u.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var u=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),u==0&&(this.dosPermissions=63&this.externalFileAttributes),u==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var u=i(this.extraFields[1].value);this.uncompressedSize===c.MAX_VALUE_32BITS&&(this.uncompressedSize=u.readInt(8)),this.compressedSize===c.MAX_VALUE_32BITS&&(this.compressedSize=u.readInt(8)),this.localHeaderOffset===c.MAX_VALUE_32BITS&&(this.localHeaderOffset=u.readInt(8)),this.diskNumberStart===c.MAX_VALUE_32BITS&&(this.diskNumberStart=u.readInt(4))}},readExtraFields:function(u){var w,x,_,y=u.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});u.index+4<y;)w=u.readInt(2),x=u.readInt(2),_=u.readData(x),this.extraFields[w]={id:w,length:x,value:_};u.setIndex(y)},handleUTF8:function(){var u=b.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=h.utf8decode(this.fileName),this.fileCommentStr=h.utf8decode(this.fileComment);else{var w=this.findExtraFieldUnicodePath();if(w!==null)this.fileNameStr=w;else{var x=c.transformTo(u,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(x)}var _=this.findExtraFieldUnicodeComment();if(_!==null)this.fileCommentStr=_;else{var y=c.transformTo(u,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(y)}}},findExtraFieldUnicodePath:function(){var u=this.extraFields[28789];if(u){var w=i(u.value);return w.readInt(1)!==1||d(this.fileName)!==w.readInt(4)?null:h.utf8decode(w.readData(u.length-5))}return null},findExtraFieldUnicodeComment:function(){var u=this.extraFields[25461];if(u){var w=i(u.value);return w.readInt(1)!==1||d(this.fileComment)!==w.readInt(4)?null:h.utf8decode(w.readData(u.length-5))}return null}},a.exports=m},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,a,s){function i(w,x,_){this.name=w,this.dir=_.dir,this.date=_.date,this.comment=_.comment,this.unixPermissions=_.unixPermissions,this.dosPermissions=_.dosPermissions,this._data=x,this._dataBinary=_.binary,this.options={compression:_.compression,compressionOptions:_.compressionOptions}}var c=e("./stream/StreamHelper"),o=e("./stream/DataWorker"),d=e("./utf8"),h=e("./compressedObject"),p=e("./stream/GenericWorker");i.prototype={internalStream:function(w){var x=null,_="string";try{if(!w)throw new Error("No output type specified.");var y=(_=w.toLowerCase())==="string"||_==="text";_!=="binarystring"&&_!=="text"||(_="string"),x=this._decompressWorker();var A=!this._dataBinary;A&&!y&&(x=x.pipe(new d.Utf8EncodeWorker)),!A&&y&&(x=x.pipe(new d.Utf8DecodeWorker))}catch(L){(x=new p("error")).error(L)}return new c(x,_,"")},async:function(w,x){return this.internalStream(w).accumulate(x)},nodeStream:function(w,x){return this.internalStream(w||"nodebuffer").toNodejsStream(x)},_compressWorker:function(w,x){if(this._data instanceof h&&this._data.compression.magic===w.magic)return this._data.getCompressedWorker();var _=this._decompressWorker();return this._dataBinary||(_=_.pipe(new d.Utf8EncodeWorker)),h.createWorkerFrom(_,w,x)},_decompressWorker:function(){return this._data instanceof h?this._data.getContentWorker():this._data instanceof p?this._data:new o(this._data)}};for(var b=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],m=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},u=0;u<b.length;u++)i.prototype[b[u]]=m;a.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,a,s){(function(i){var c,o,d=i.MutationObserver||i.WebKitMutationObserver;if(d){var h=0,p=new d(w),b=i.document.createTextNode("");p.observe(b,{characterData:!0}),c=function(){b.data=h=++h%2}}else if(i.setImmediate||i.MessageChannel===void 0)c="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var x=i.document.createElement("script");x.onreadystatechange=function(){w(),x.onreadystatechange=null,x.parentNode.removeChild(x),x=null},i.document.documentElement.appendChild(x)}:function(){setTimeout(w,0)};else{var m=new i.MessageChannel;m.port1.onmessage=w,c=function(){m.port2.postMessage(0)}}var u=[];function w(){var x,_;o=!0;for(var y=u.length;y;){for(_=u,u=[],x=-1;++x<y;)_[x]();y=u.length}o=!1}a.exports=function(x){u.push(x)!==1||o||c()}}).call(this,typeof Uo<"u"?Uo:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,a,s){var i=e("immediate");function c(){}var o={},d=["REJECTED"],h=["FULFILLED"],p=["PENDING"];function b(y){if(typeof y!="function")throw new TypeError("resolver must be a function");this.state=p,this.queue=[],this.outcome=void 0,y!==c&&x(this,y)}function m(y,A,L){this.promise=y,typeof A=="function"&&(this.onFulfilled=A,this.callFulfilled=this.otherCallFulfilled),typeof L=="function"&&(this.onRejected=L,this.callRejected=this.otherCallRejected)}function u(y,A,L){i(function(){var E;try{E=A(L)}catch(O){return o.reject(y,O)}E===y?o.reject(y,new TypeError("Cannot resolve promise with itself")):o.resolve(y,E)})}function w(y){var A=y&&y.then;if(y&&(typeof y=="object"||typeof y=="function")&&typeof A=="function")return function(){A.apply(y,arguments)}}function x(y,A){var L=!1;function E(K){L||(L=!0,o.reject(y,K))}function O(K){L||(L=!0,o.resolve(y,K))}var X=_(function(){A(O,E)});X.status==="error"&&E(X.value)}function _(y,A){var L={};try{L.value=y(A),L.status="success"}catch(E){L.status="error",L.value=E}return L}(a.exports=b).prototype.finally=function(y){if(typeof y!="function")return this;var A=this.constructor;return this.then(function(L){return A.resolve(y()).then(function(){return L})},function(L){return A.resolve(y()).then(function(){throw L})})},b.prototype.catch=function(y){return this.then(null,y)},b.prototype.then=function(y,A){if(typeof y!="function"&&this.state===h||typeof A!="function"&&this.state===d)return this;var L=new this.constructor(c);return this.state!==p?u(L,this.state===h?y:A,this.outcome):this.queue.push(new m(L,y,A)),L},m.prototype.callFulfilled=function(y){o.resolve(this.promise,y)},m.prototype.otherCallFulfilled=function(y){u(this.promise,this.onFulfilled,y)},m.prototype.callRejected=function(y){o.reject(this.promise,y)},m.prototype.otherCallRejected=function(y){u(this.promise,this.onRejected,y)},o.resolve=function(y,A){var L=_(w,A);if(L.status==="error")return o.reject(y,L.value);var E=L.value;if(E)x(y,E);else{y.state=h,y.outcome=A;for(var O=-1,X=y.queue.length;++O<X;)y.queue[O].callFulfilled(A)}return y},o.reject=function(y,A){y.state=d,y.outcome=A;for(var L=-1,E=y.queue.length;++L<E;)y.queue[L].callRejected(A);return y},b.resolve=function(y){return y instanceof this?y:o.resolve(new this(c),y)},b.reject=function(y){var A=new this(c);return o.reject(A,y)},b.all=function(y){var A=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var L=y.length,E=!1;if(!L)return this.resolve([]);for(var O=new Array(L),X=0,K=-1,H=new this(c);++K<L;)P(y[K],K);return H;function P(Y,I){A.resolve(Y).then(function(S){O[I]=S,++X!==L||E||(E=!0,o.resolve(H,O))},function(S){E||(E=!0,o.reject(H,S))})}},b.race=function(y){var A=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var L=y.length,E=!1;if(!L)return this.resolve([]);for(var O=-1,X=new this(c);++O<L;)K=y[O],A.resolve(K).then(function(H){E||(E=!0,o.resolve(X,H))},function(H){E||(E=!0,o.reject(X,H))});var K;return X}},{immediate:36}],38:[function(e,a,s){var i={};(0,e("./lib/utils/common").assign)(i,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),a.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,a,s){var i=e("./zlib/deflate"),c=e("./utils/common"),o=e("./utils/strings"),d=e("./zlib/messages"),h=e("./zlib/zstream"),p=Object.prototype.toString,b=0,m=-1,u=0,w=8;function x(y){if(!(this instanceof x))return new x(y);this.options=c.assign({level:m,method:w,chunkSize:16384,windowBits:15,memLevel:8,strategy:u,to:""},y||{});var A=this.options;A.raw&&0<A.windowBits?A.windowBits=-A.windowBits:A.gzip&&0<A.windowBits&&A.windowBits<16&&(A.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var L=i.deflateInit2(this.strm,A.level,A.method,A.windowBits,A.memLevel,A.strategy);if(L!==b)throw new Error(d[L]);if(A.header&&i.deflateSetHeader(this.strm,A.header),A.dictionary){var E;if(E=typeof A.dictionary=="string"?o.string2buf(A.dictionary):p.call(A.dictionary)==="[object ArrayBuffer]"?new Uint8Array(A.dictionary):A.dictionary,(L=i.deflateSetDictionary(this.strm,E))!==b)throw new Error(d[L]);this._dict_set=!0}}function _(y,A){var L=new x(A);if(L.push(y,!0),L.err)throw L.msg||d[L.err];return L.result}x.prototype.push=function(y,A){var L,E,O=this.strm,X=this.options.chunkSize;if(this.ended)return!1;E=A===~~A?A:A===!0?4:0,typeof y=="string"?O.input=o.string2buf(y):p.call(y)==="[object ArrayBuffer]"?O.input=new Uint8Array(y):O.input=y,O.next_in=0,O.avail_in=O.input.length;do{if(O.avail_out===0&&(O.output=new c.Buf8(X),O.next_out=0,O.avail_out=X),(L=i.deflate(O,E))!==1&&L!==b)return this.onEnd(L),!(this.ended=!0);O.avail_out!==0&&(O.avail_in!==0||E!==4&&E!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(c.shrinkBuf(O.output,O.next_out))):this.onData(c.shrinkBuf(O.output,O.next_out)))}while((0<O.avail_in||O.avail_out===0)&&L!==1);return E===4?(L=i.deflateEnd(this.strm),this.onEnd(L),this.ended=!0,L===b):E!==2||(this.onEnd(b),!(O.avail_out=0))},x.prototype.onData=function(y){this.chunks.push(y)},x.prototype.onEnd=function(y){y===b&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=c.flattenChunks(this.chunks)),this.chunks=[],this.err=y,this.msg=this.strm.msg},s.Deflate=x,s.deflate=_,s.deflateRaw=function(y,A){return(A=A||{}).raw=!0,_(y,A)},s.gzip=function(y,A){return(A=A||{}).gzip=!0,_(y,A)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,a,s){var i=e("./zlib/inflate"),c=e("./utils/common"),o=e("./utils/strings"),d=e("./zlib/constants"),h=e("./zlib/messages"),p=e("./zlib/zstream"),b=e("./zlib/gzheader"),m=Object.prototype.toString;function u(x){if(!(this instanceof u))return new u(x);this.options=c.assign({chunkSize:16384,windowBits:0,to:""},x||{});var _=this.options;_.raw&&0<=_.windowBits&&_.windowBits<16&&(_.windowBits=-_.windowBits,_.windowBits===0&&(_.windowBits=-15)),!(0<=_.windowBits&&_.windowBits<16)||x&&x.windowBits||(_.windowBits+=32),15<_.windowBits&&_.windowBits<48&&(15&_.windowBits)==0&&(_.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new p,this.strm.avail_out=0;var y=i.inflateInit2(this.strm,_.windowBits);if(y!==d.Z_OK)throw new Error(h[y]);this.header=new b,i.inflateGetHeader(this.strm,this.header)}function w(x,_){var y=new u(_);if(y.push(x,!0),y.err)throw y.msg||h[y.err];return y.result}u.prototype.push=function(x,_){var y,A,L,E,O,X,K=this.strm,H=this.options.chunkSize,P=this.options.dictionary,Y=!1;if(this.ended)return!1;A=_===~~_?_:_===!0?d.Z_FINISH:d.Z_NO_FLUSH,typeof x=="string"?K.input=o.binstring2buf(x):m.call(x)==="[object ArrayBuffer]"?K.input=new Uint8Array(x):K.input=x,K.next_in=0,K.avail_in=K.input.length;do{if(K.avail_out===0&&(K.output=new c.Buf8(H),K.next_out=0,K.avail_out=H),(y=i.inflate(K,d.Z_NO_FLUSH))===d.Z_NEED_DICT&&P&&(X=typeof P=="string"?o.string2buf(P):m.call(P)==="[object ArrayBuffer]"?new Uint8Array(P):P,y=i.inflateSetDictionary(this.strm,X)),y===d.Z_BUF_ERROR&&Y===!0&&(y=d.Z_OK,Y=!1),y!==d.Z_STREAM_END&&y!==d.Z_OK)return this.onEnd(y),!(this.ended=!0);K.next_out&&(K.avail_out!==0&&y!==d.Z_STREAM_END&&(K.avail_in!==0||A!==d.Z_FINISH&&A!==d.Z_SYNC_FLUSH)||(this.options.to==="string"?(L=o.utf8border(K.output,K.next_out),E=K.next_out-L,O=o.buf2string(K.output,L),K.next_out=E,K.avail_out=H-E,E&&c.arraySet(K.output,K.output,L,E,0),this.onData(O)):this.onData(c.shrinkBuf(K.output,K.next_out)))),K.avail_in===0&&K.avail_out===0&&(Y=!0)}while((0<K.avail_in||K.avail_out===0)&&y!==d.Z_STREAM_END);return y===d.Z_STREAM_END&&(A=d.Z_FINISH),A===d.Z_FINISH?(y=i.inflateEnd(this.strm),this.onEnd(y),this.ended=!0,y===d.Z_OK):A!==d.Z_SYNC_FLUSH||(this.onEnd(d.Z_OK),!(K.avail_out=0))},u.prototype.onData=function(x){this.chunks.push(x)},u.prototype.onEnd=function(x){x===d.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=c.flattenChunks(this.chunks)),this.chunks=[],this.err=x,this.msg=this.strm.msg},s.Inflate=u,s.inflate=w,s.inflateRaw=function(x,_){return(_=_||{}).raw=!0,w(x,_)},s.ungzip=w},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,a,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(d){for(var h=Array.prototype.slice.call(arguments,1);h.length;){var p=h.shift();if(p){if(typeof p!="object")throw new TypeError(p+"must be non-object");for(var b in p)p.hasOwnProperty(b)&&(d[b]=p[b])}}return d},s.shrinkBuf=function(d,h){return d.length===h?d:d.subarray?d.subarray(0,h):(d.length=h,d)};var c={arraySet:function(d,h,p,b,m){if(h.subarray&&d.subarray)d.set(h.subarray(p,p+b),m);else for(var u=0;u<b;u++)d[m+u]=h[p+u]},flattenChunks:function(d){var h,p,b,m,u,w;for(h=b=0,p=d.length;h<p;h++)b+=d[h].length;for(w=new Uint8Array(b),h=m=0,p=d.length;h<p;h++)u=d[h],w.set(u,m),m+=u.length;return w}},o={arraySet:function(d,h,p,b,m){for(var u=0;u<b;u++)d[m+u]=h[p+u]},flattenChunks:function(d){return[].concat.apply([],d)}};s.setTyped=function(d){d?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,c)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,o))},s.setTyped(i)},{}],42:[function(e,a,s){var i=e("./common"),c=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{c=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var d=new i.Buf8(256),h=0;h<256;h++)d[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;function p(b,m){if(m<65537&&(b.subarray&&o||!b.subarray&&c))return String.fromCharCode.apply(null,i.shrinkBuf(b,m));for(var u="",w=0;w<m;w++)u+=String.fromCharCode(b[w]);return u}d[254]=d[254]=1,s.string2buf=function(b){var m,u,w,x,_,y=b.length,A=0;for(x=0;x<y;x++)(64512&(u=b.charCodeAt(x)))==55296&&x+1<y&&(64512&(w=b.charCodeAt(x+1)))==56320&&(u=65536+(u-55296<<10)+(w-56320),x++),A+=u<128?1:u<2048?2:u<65536?3:4;for(m=new i.Buf8(A),x=_=0;_<A;x++)(64512&(u=b.charCodeAt(x)))==55296&&x+1<y&&(64512&(w=b.charCodeAt(x+1)))==56320&&(u=65536+(u-55296<<10)+(w-56320),x++),u<128?m[_++]=u:(u<2048?m[_++]=192|u>>>6:(u<65536?m[_++]=224|u>>>12:(m[_++]=240|u>>>18,m[_++]=128|u>>>12&63),m[_++]=128|u>>>6&63),m[_++]=128|63&u);return m},s.buf2binstring=function(b){return p(b,b.length)},s.binstring2buf=function(b){for(var m=new i.Buf8(b.length),u=0,w=m.length;u<w;u++)m[u]=b.charCodeAt(u);return m},s.buf2string=function(b,m){var u,w,x,_,y=m||b.length,A=new Array(2*y);for(u=w=0;u<y;)if((x=b[u++])<128)A[w++]=x;else if(4<(_=d[x]))A[w++]=65533,u+=_-1;else{for(x&=_===2?31:_===3?15:7;1<_&&u<y;)x=x<<6|63&b[u++],_--;1<_?A[w++]=65533:x<65536?A[w++]=x:(x-=65536,A[w++]=55296|x>>10&1023,A[w++]=56320|1023&x)}return p(A,w)},s.utf8border=function(b,m){var u;for((m=m||b.length)>b.length&&(m=b.length),u=m-1;0<=u&&(192&b[u])==128;)u--;return u<0||u===0?m:u+d[b[u]]>m?u:m}},{"./common":41}],43:[function(e,a,s){a.exports=function(i,c,o,d){for(var h=65535&i|0,p=i>>>16&65535|0,b=0;o!==0;){for(o-=b=2e3<o?2e3:o;p=p+(h=h+c[d++]|0)|0,--b;);h%=65521,p%=65521}return h|p<<16|0}},{}],44:[function(e,a,s){a.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,a,s){var i=(function(){for(var c,o=[],d=0;d<256;d++){c=d;for(var h=0;h<8;h++)c=1&c?3988292384^c>>>1:c>>>1;o[d]=c}return o})();a.exports=function(c,o,d,h){var p=i,b=h+d;c^=-1;for(var m=h;m<b;m++)c=c>>>8^p[255&(c^o[m])];return-1^c}},{}],46:[function(e,a,s){var i,c=e("../utils/common"),o=e("./trees"),d=e("./adler32"),h=e("./crc32"),p=e("./messages"),b=0,m=4,u=0,w=-2,x=-1,_=4,y=2,A=8,L=9,E=286,O=30,X=19,K=2*E+1,H=15,P=3,Y=258,I=Y+P+1,S=42,R=113,N=1,re=2,ve=3,le=4;function oe(j,T){return j.msg=p[T],T}function ie(j){return(j<<1)-(4<j?9:0)}function Ae(j){for(var T=j.length;0<=--T;)j[T]=0}function te(j){var T=j.state,V=T.pending;V>j.avail_out&&(V=j.avail_out),V!==0&&(c.arraySet(j.output,T.pending_buf,T.pending_out,V,j.next_out),j.next_out+=V,T.pending_out+=V,j.total_out+=V,j.avail_out-=V,T.pending-=V,T.pending===0&&(T.pending_out=0))}function C(j,T){o._tr_flush_block(j,0<=j.block_start?j.block_start:-1,j.strstart-j.block_start,T),j.block_start=j.strstart,te(j.strm)}function G(j,T){j.pending_buf[j.pending++]=T}function Z(j,T){j.pending_buf[j.pending++]=T>>>8&255,j.pending_buf[j.pending++]=255&T}function Q(j,T){var V,$,z=j.max_chain_length,M=j.strstart,ue=j.prev_length,pe=j.nice_match,ce=j.strstart>j.w_size-I?j.strstart-(j.w_size-I):0,Le=j.window,Ie=j.w_mask,Te=j.prev,Ve=j.strstart+Y,ht=Le[M+ue-1],st=Le[M+ue];j.prev_length>=j.good_match&&(z>>=2),pe>j.lookahead&&(pe=j.lookahead);do if(Le[(V=T)+ue]===st&&Le[V+ue-1]===ht&&Le[V]===Le[M]&&Le[++V]===Le[M+1]){M+=2,V++;do;while(Le[++M]===Le[++V]&&Le[++M]===Le[++V]&&Le[++M]===Le[++V]&&Le[++M]===Le[++V]&&Le[++M]===Le[++V]&&Le[++M]===Le[++V]&&Le[++M]===Le[++V]&&Le[++M]===Le[++V]&&M<Ve);if($=Y-(Ve-M),M=Ve-Y,ue<$){if(j.match_start=T,pe<=(ue=$))break;ht=Le[M+ue-1],st=Le[M+ue]}}while((T=Te[T&Ie])>ce&&--z!=0);return ue<=j.lookahead?ue:j.lookahead}function fe(j){var T,V,$,z,M,ue,pe,ce,Le,Ie,Te=j.w_size;do{if(z=j.window_size-j.lookahead-j.strstart,j.strstart>=Te+(Te-I)){for(c.arraySet(j.window,j.window,Te,Te,0),j.match_start-=Te,j.strstart-=Te,j.block_start-=Te,T=V=j.hash_size;$=j.head[--T],j.head[T]=Te<=$?$-Te:0,--V;);for(T=V=Te;$=j.prev[--T],j.prev[T]=Te<=$?$-Te:0,--V;);z+=Te}if(j.strm.avail_in===0)break;if(ue=j.strm,pe=j.window,ce=j.strstart+j.lookahead,Le=z,Ie=void 0,Ie=ue.avail_in,Le<Ie&&(Ie=Le),V=Ie===0?0:(ue.avail_in-=Ie,c.arraySet(pe,ue.input,ue.next_in,Ie,ce),ue.state.wrap===1?ue.adler=d(ue.adler,pe,Ie,ce):ue.state.wrap===2&&(ue.adler=h(ue.adler,pe,Ie,ce)),ue.next_in+=Ie,ue.total_in+=Ie,Ie),j.lookahead+=V,j.lookahead+j.insert>=P)for(M=j.strstart-j.insert,j.ins_h=j.window[M],j.ins_h=(j.ins_h<<j.hash_shift^j.window[M+1])&j.hash_mask;j.insert&&(j.ins_h=(j.ins_h<<j.hash_shift^j.window[M+P-1])&j.hash_mask,j.prev[M&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=M,M++,j.insert--,!(j.lookahead+j.insert<P)););}while(j.lookahead<I&&j.strm.avail_in!==0)}function we(j,T){for(var V,$;;){if(j.lookahead<I){if(fe(j),j.lookahead<I&&T===b)return N;if(j.lookahead===0)break}if(V=0,j.lookahead>=P&&(j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+P-1])&j.hash_mask,V=j.prev[j.strstart&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=j.strstart),V!==0&&j.strstart-V<=j.w_size-I&&(j.match_length=Q(j,V)),j.match_length>=P)if($=o._tr_tally(j,j.strstart-j.match_start,j.match_length-P),j.lookahead-=j.match_length,j.match_length<=j.max_lazy_match&&j.lookahead>=P){for(j.match_length--;j.strstart++,j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+P-1])&j.hash_mask,V=j.prev[j.strstart&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=j.strstart,--j.match_length!=0;);j.strstart++}else j.strstart+=j.match_length,j.match_length=0,j.ins_h=j.window[j.strstart],j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+1])&j.hash_mask;else $=o._tr_tally(j,0,j.window[j.strstart]),j.lookahead--,j.strstart++;if($&&(C(j,!1),j.strm.avail_out===0))return N}return j.insert=j.strstart<P-1?j.strstart:P-1,T===m?(C(j,!0),j.strm.avail_out===0?ve:le):j.last_lit&&(C(j,!1),j.strm.avail_out===0)?N:re}function Se(j,T){for(var V,$,z;;){if(j.lookahead<I){if(fe(j),j.lookahead<I&&T===b)return N;if(j.lookahead===0)break}if(V=0,j.lookahead>=P&&(j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+P-1])&j.hash_mask,V=j.prev[j.strstart&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=j.strstart),j.prev_length=j.match_length,j.prev_match=j.match_start,j.match_length=P-1,V!==0&&j.prev_length<j.max_lazy_match&&j.strstart-V<=j.w_size-I&&(j.match_length=Q(j,V),j.match_length<=5&&(j.strategy===1||j.match_length===P&&4096<j.strstart-j.match_start)&&(j.match_length=P-1)),j.prev_length>=P&&j.match_length<=j.prev_length){for(z=j.strstart+j.lookahead-P,$=o._tr_tally(j,j.strstart-1-j.prev_match,j.prev_length-P),j.lookahead-=j.prev_length-1,j.prev_length-=2;++j.strstart<=z&&(j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+P-1])&j.hash_mask,V=j.prev[j.strstart&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=j.strstart),--j.prev_length!=0;);if(j.match_available=0,j.match_length=P-1,j.strstart++,$&&(C(j,!1),j.strm.avail_out===0))return N}else if(j.match_available){if(($=o._tr_tally(j,0,j.window[j.strstart-1]))&&C(j,!1),j.strstart++,j.lookahead--,j.strm.avail_out===0)return N}else j.match_available=1,j.strstart++,j.lookahead--}return j.match_available&&($=o._tr_tally(j,0,j.window[j.strstart-1]),j.match_available=0),j.insert=j.strstart<P-1?j.strstart:P-1,T===m?(C(j,!0),j.strm.avail_out===0?ve:le):j.last_lit&&(C(j,!1),j.strm.avail_out===0)?N:re}function Ce(j,T,V,$,z){this.good_length=j,this.max_lazy=T,this.nice_length=V,this.max_chain=$,this.func=z}function Re(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=A,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new c.Buf16(2*K),this.dyn_dtree=new c.Buf16(2*(2*O+1)),this.bl_tree=new c.Buf16(2*(2*X+1)),Ae(this.dyn_ltree),Ae(this.dyn_dtree),Ae(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new c.Buf16(H+1),this.heap=new c.Buf16(2*E+1),Ae(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new c.Buf16(2*E+1),Ae(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Me(j){var T;return j&&j.state?(j.total_in=j.total_out=0,j.data_type=y,(T=j.state).pending=0,T.pending_out=0,T.wrap<0&&(T.wrap=-T.wrap),T.status=T.wrap?S:R,j.adler=T.wrap===2?0:1,T.last_flush=b,o._tr_init(T),u):oe(j,w)}function Je(j){var T=Me(j);return T===u&&(function(V){V.window_size=2*V.w_size,Ae(V.head),V.max_lazy_match=i[V.level].max_lazy,V.good_match=i[V.level].good_length,V.nice_match=i[V.level].nice_length,V.max_chain_length=i[V.level].max_chain,V.strstart=0,V.block_start=0,V.lookahead=0,V.insert=0,V.match_length=V.prev_length=P-1,V.match_available=0,V.ins_h=0})(j.state),T}function je(j,T,V,$,z,M){if(!j)return w;var ue=1;if(T===x&&(T=6),$<0?(ue=0,$=-$):15<$&&(ue=2,$-=16),z<1||L<z||V!==A||$<8||15<$||T<0||9<T||M<0||_<M)return oe(j,w);$===8&&($=9);var pe=new Re;return(j.state=pe).strm=j,pe.wrap=ue,pe.gzhead=null,pe.w_bits=$,pe.w_size=1<<pe.w_bits,pe.w_mask=pe.w_size-1,pe.hash_bits=z+7,pe.hash_size=1<<pe.hash_bits,pe.hash_mask=pe.hash_size-1,pe.hash_shift=~~((pe.hash_bits+P-1)/P),pe.window=new c.Buf8(2*pe.w_size),pe.head=new c.Buf16(pe.hash_size),pe.prev=new c.Buf16(pe.w_size),pe.lit_bufsize=1<<z+6,pe.pending_buf_size=4*pe.lit_bufsize,pe.pending_buf=new c.Buf8(pe.pending_buf_size),pe.d_buf=1*pe.lit_bufsize,pe.l_buf=3*pe.lit_bufsize,pe.level=T,pe.strategy=M,pe.method=V,Je(j)}i=[new Ce(0,0,0,0,function(j,T){var V=65535;for(V>j.pending_buf_size-5&&(V=j.pending_buf_size-5);;){if(j.lookahead<=1){if(fe(j),j.lookahead===0&&T===b)return N;if(j.lookahead===0)break}j.strstart+=j.lookahead,j.lookahead=0;var $=j.block_start+V;if((j.strstart===0||j.strstart>=$)&&(j.lookahead=j.strstart-$,j.strstart=$,C(j,!1),j.strm.avail_out===0)||j.strstart-j.block_start>=j.w_size-I&&(C(j,!1),j.strm.avail_out===0))return N}return j.insert=0,T===m?(C(j,!0),j.strm.avail_out===0?ve:le):(j.strstart>j.block_start&&(C(j,!1),j.strm.avail_out),N)}),new Ce(4,4,8,4,we),new Ce(4,5,16,8,we),new Ce(4,6,32,32,we),new Ce(4,4,16,16,Se),new Ce(8,16,32,32,Se),new Ce(8,16,128,128,Se),new Ce(8,32,128,256,Se),new Ce(32,128,258,1024,Se),new Ce(32,258,258,4096,Se)],s.deflateInit=function(j,T){return je(j,T,A,15,8,0)},s.deflateInit2=je,s.deflateReset=Je,s.deflateResetKeep=Me,s.deflateSetHeader=function(j,T){return j&&j.state?j.state.wrap!==2?w:(j.state.gzhead=T,u):w},s.deflate=function(j,T){var V,$,z,M;if(!j||!j.state||5<T||T<0)return j?oe(j,w):w;if($=j.state,!j.output||!j.input&&j.avail_in!==0||$.status===666&&T!==m)return oe(j,j.avail_out===0?-5:w);if($.strm=j,V=$.last_flush,$.last_flush=T,$.status===S)if($.wrap===2)j.adler=0,G($,31),G($,139),G($,8),$.gzhead?(G($,($.gzhead.text?1:0)+($.gzhead.hcrc?2:0)+($.gzhead.extra?4:0)+($.gzhead.name?8:0)+($.gzhead.comment?16:0)),G($,255&$.gzhead.time),G($,$.gzhead.time>>8&255),G($,$.gzhead.time>>16&255),G($,$.gzhead.time>>24&255),G($,$.level===9?2:2<=$.strategy||$.level<2?4:0),G($,255&$.gzhead.os),$.gzhead.extra&&$.gzhead.extra.length&&(G($,255&$.gzhead.extra.length),G($,$.gzhead.extra.length>>8&255)),$.gzhead.hcrc&&(j.adler=h(j.adler,$.pending_buf,$.pending,0)),$.gzindex=0,$.status=69):(G($,0),G($,0),G($,0),G($,0),G($,0),G($,$.level===9?2:2<=$.strategy||$.level<2?4:0),G($,3),$.status=R);else{var ue=A+($.w_bits-8<<4)<<8;ue|=(2<=$.strategy||$.level<2?0:$.level<6?1:$.level===6?2:3)<<6,$.strstart!==0&&(ue|=32),ue+=31-ue%31,$.status=R,Z($,ue),$.strstart!==0&&(Z($,j.adler>>>16),Z($,65535&j.adler)),j.adler=1}if($.status===69)if($.gzhead.extra){for(z=$.pending;$.gzindex<(65535&$.gzhead.extra.length)&&($.pending!==$.pending_buf_size||($.gzhead.hcrc&&$.pending>z&&(j.adler=h(j.adler,$.pending_buf,$.pending-z,z)),te(j),z=$.pending,$.pending!==$.pending_buf_size));)G($,255&$.gzhead.extra[$.gzindex]),$.gzindex++;$.gzhead.hcrc&&$.pending>z&&(j.adler=h(j.adler,$.pending_buf,$.pending-z,z)),$.gzindex===$.gzhead.extra.length&&($.gzindex=0,$.status=73)}else $.status=73;if($.status===73)if($.gzhead.name){z=$.pending;do{if($.pending===$.pending_buf_size&&($.gzhead.hcrc&&$.pending>z&&(j.adler=h(j.adler,$.pending_buf,$.pending-z,z)),te(j),z=$.pending,$.pending===$.pending_buf_size)){M=1;break}M=$.gzindex<$.gzhead.name.length?255&$.gzhead.name.charCodeAt($.gzindex++):0,G($,M)}while(M!==0);$.gzhead.hcrc&&$.pending>z&&(j.adler=h(j.adler,$.pending_buf,$.pending-z,z)),M===0&&($.gzindex=0,$.status=91)}else $.status=91;if($.status===91)if($.gzhead.comment){z=$.pending;do{if($.pending===$.pending_buf_size&&($.gzhead.hcrc&&$.pending>z&&(j.adler=h(j.adler,$.pending_buf,$.pending-z,z)),te(j),z=$.pending,$.pending===$.pending_buf_size)){M=1;break}M=$.gzindex<$.gzhead.comment.length?255&$.gzhead.comment.charCodeAt($.gzindex++):0,G($,M)}while(M!==0);$.gzhead.hcrc&&$.pending>z&&(j.adler=h(j.adler,$.pending_buf,$.pending-z,z)),M===0&&($.status=103)}else $.status=103;if($.status===103&&($.gzhead.hcrc?($.pending+2>$.pending_buf_size&&te(j),$.pending+2<=$.pending_buf_size&&(G($,255&j.adler),G($,j.adler>>8&255),j.adler=0,$.status=R)):$.status=R),$.pending!==0){if(te(j),j.avail_out===0)return $.last_flush=-1,u}else if(j.avail_in===0&&ie(T)<=ie(V)&&T!==m)return oe(j,-5);if($.status===666&&j.avail_in!==0)return oe(j,-5);if(j.avail_in!==0||$.lookahead!==0||T!==b&&$.status!==666){var pe=$.strategy===2?(function(ce,Le){for(var Ie;;){if(ce.lookahead===0&&(fe(ce),ce.lookahead===0)){if(Le===b)return N;break}if(ce.match_length=0,Ie=o._tr_tally(ce,0,ce.window[ce.strstart]),ce.lookahead--,ce.strstart++,Ie&&(C(ce,!1),ce.strm.avail_out===0))return N}return ce.insert=0,Le===m?(C(ce,!0),ce.strm.avail_out===0?ve:le):ce.last_lit&&(C(ce,!1),ce.strm.avail_out===0)?N:re})($,T):$.strategy===3?(function(ce,Le){for(var Ie,Te,Ve,ht,st=ce.window;;){if(ce.lookahead<=Y){if(fe(ce),ce.lookahead<=Y&&Le===b)return N;if(ce.lookahead===0)break}if(ce.match_length=0,ce.lookahead>=P&&0<ce.strstart&&(Te=st[Ve=ce.strstart-1])===st[++Ve]&&Te===st[++Ve]&&Te===st[++Ve]){ht=ce.strstart+Y;do;while(Te===st[++Ve]&&Te===st[++Ve]&&Te===st[++Ve]&&Te===st[++Ve]&&Te===st[++Ve]&&Te===st[++Ve]&&Te===st[++Ve]&&Te===st[++Ve]&&Ve<ht);ce.match_length=Y-(ht-Ve),ce.match_length>ce.lookahead&&(ce.match_length=ce.lookahead)}if(ce.match_length>=P?(Ie=o._tr_tally(ce,1,ce.match_length-P),ce.lookahead-=ce.match_length,ce.strstart+=ce.match_length,ce.match_length=0):(Ie=o._tr_tally(ce,0,ce.window[ce.strstart]),ce.lookahead--,ce.strstart++),Ie&&(C(ce,!1),ce.strm.avail_out===0))return N}return ce.insert=0,Le===m?(C(ce,!0),ce.strm.avail_out===0?ve:le):ce.last_lit&&(C(ce,!1),ce.strm.avail_out===0)?N:re})($,T):i[$.level].func($,T);if(pe!==ve&&pe!==le||($.status=666),pe===N||pe===ve)return j.avail_out===0&&($.last_flush=-1),u;if(pe===re&&(T===1?o._tr_align($):T!==5&&(o._tr_stored_block($,0,0,!1),T===3&&(Ae($.head),$.lookahead===0&&($.strstart=0,$.block_start=0,$.insert=0))),te(j),j.avail_out===0))return $.last_flush=-1,u}return T!==m?u:$.wrap<=0?1:($.wrap===2?(G($,255&j.adler),G($,j.adler>>8&255),G($,j.adler>>16&255),G($,j.adler>>24&255),G($,255&j.total_in),G($,j.total_in>>8&255),G($,j.total_in>>16&255),G($,j.total_in>>24&255)):(Z($,j.adler>>>16),Z($,65535&j.adler)),te(j),0<$.wrap&&($.wrap=-$.wrap),$.pending!==0?u:1)},s.deflateEnd=function(j){var T;return j&&j.state?(T=j.state.status)!==S&&T!==69&&T!==73&&T!==91&&T!==103&&T!==R&&T!==666?oe(j,w):(j.state=null,T===R?oe(j,-3):u):w},s.deflateSetDictionary=function(j,T){var V,$,z,M,ue,pe,ce,Le,Ie=T.length;if(!j||!j.state||(M=(V=j.state).wrap)===2||M===1&&V.status!==S||V.lookahead)return w;for(M===1&&(j.adler=d(j.adler,T,Ie,0)),V.wrap=0,Ie>=V.w_size&&(M===0&&(Ae(V.head),V.strstart=0,V.block_start=0,V.insert=0),Le=new c.Buf8(V.w_size),c.arraySet(Le,T,Ie-V.w_size,V.w_size,0),T=Le,Ie=V.w_size),ue=j.avail_in,pe=j.next_in,ce=j.input,j.avail_in=Ie,j.next_in=0,j.input=T,fe(V);V.lookahead>=P;){for($=V.strstart,z=V.lookahead-(P-1);V.ins_h=(V.ins_h<<V.hash_shift^V.window[$+P-1])&V.hash_mask,V.prev[$&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=$,$++,--z;);V.strstart=$,V.lookahead=P-1,fe(V)}return V.strstart+=V.lookahead,V.block_start=V.strstart,V.insert=V.lookahead,V.lookahead=0,V.match_length=V.prev_length=P-1,V.match_available=0,j.next_in=pe,j.input=ce,j.avail_in=ue,V.wrap=M,u},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,a,s){a.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,a,s){a.exports=function(i,c){var o,d,h,p,b,m,u,w,x,_,y,A,L,E,O,X,K,H,P,Y,I,S,R,N,re;o=i.state,d=i.next_in,N=i.input,h=d+(i.avail_in-5),p=i.next_out,re=i.output,b=p-(c-i.avail_out),m=p+(i.avail_out-257),u=o.dmax,w=o.wsize,x=o.whave,_=o.wnext,y=o.window,A=o.hold,L=o.bits,E=o.lencode,O=o.distcode,X=(1<<o.lenbits)-1,K=(1<<o.distbits)-1;e:do{L<15&&(A+=N[d++]<<L,L+=8,A+=N[d++]<<L,L+=8),H=E[A&X];t:for(;;){if(A>>>=P=H>>>24,L-=P,(P=H>>>16&255)===0)re[p++]=65535&H;else{if(!(16&P)){if((64&P)==0){H=E[(65535&H)+(A&(1<<P)-1)];continue t}if(32&P){o.mode=12;break e}i.msg="invalid literal/length code",o.mode=30;break e}Y=65535&H,(P&=15)&&(L<P&&(A+=N[d++]<<L,L+=8),Y+=A&(1<<P)-1,A>>>=P,L-=P),L<15&&(A+=N[d++]<<L,L+=8,A+=N[d++]<<L,L+=8),H=O[A&K];r:for(;;){if(A>>>=P=H>>>24,L-=P,!(16&(P=H>>>16&255))){if((64&P)==0){H=O[(65535&H)+(A&(1<<P)-1)];continue r}i.msg="invalid distance code",o.mode=30;break e}if(I=65535&H,L<(P&=15)&&(A+=N[d++]<<L,(L+=8)<P&&(A+=N[d++]<<L,L+=8)),u<(I+=A&(1<<P)-1)){i.msg="invalid distance too far back",o.mode=30;break e}if(A>>>=P,L-=P,(P=p-b)<I){if(x<(P=I-P)&&o.sane){i.msg="invalid distance too far back",o.mode=30;break e}if(R=y,(S=0)===_){if(S+=w-P,P<Y){for(Y-=P;re[p++]=y[S++],--P;);S=p-I,R=re}}else if(_<P){if(S+=w+_-P,(P-=_)<Y){for(Y-=P;re[p++]=y[S++],--P;);if(S=0,_<Y){for(Y-=P=_;re[p++]=y[S++],--P;);S=p-I,R=re}}}else if(S+=_-P,P<Y){for(Y-=P;re[p++]=y[S++],--P;);S=p-I,R=re}for(;2<Y;)re[p++]=R[S++],re[p++]=R[S++],re[p++]=R[S++],Y-=3;Y&&(re[p++]=R[S++],1<Y&&(re[p++]=R[S++]))}else{for(S=p-I;re[p++]=re[S++],re[p++]=re[S++],re[p++]=re[S++],2<(Y-=3););Y&&(re[p++]=re[S++],1<Y&&(re[p++]=re[S++]))}break}}break}}while(d<h&&p<m);d-=Y=L>>3,A&=(1<<(L-=Y<<3))-1,i.next_in=d,i.next_out=p,i.avail_in=d<h?h-d+5:5-(d-h),i.avail_out=p<m?m-p+257:257-(p-m),o.hold=A,o.bits=L}},{}],49:[function(e,a,s){var i=e("../utils/common"),c=e("./adler32"),o=e("./crc32"),d=e("./inffast"),h=e("./inftrees"),p=1,b=2,m=0,u=-2,w=1,x=852,_=592;function y(S){return(S>>>24&255)+(S>>>8&65280)+((65280&S)<<8)+((255&S)<<24)}function A(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function L(S){var R;return S&&S.state?(R=S.state,S.total_in=S.total_out=R.total=0,S.msg="",R.wrap&&(S.adler=1&R.wrap),R.mode=w,R.last=0,R.havedict=0,R.dmax=32768,R.head=null,R.hold=0,R.bits=0,R.lencode=R.lendyn=new i.Buf32(x),R.distcode=R.distdyn=new i.Buf32(_),R.sane=1,R.back=-1,m):u}function E(S){var R;return S&&S.state?((R=S.state).wsize=0,R.whave=0,R.wnext=0,L(S)):u}function O(S,R){var N,re;return S&&S.state?(re=S.state,R<0?(N=0,R=-R):(N=1+(R>>4),R<48&&(R&=15)),R&&(R<8||15<R)?u:(re.window!==null&&re.wbits!==R&&(re.window=null),re.wrap=N,re.wbits=R,E(S))):u}function X(S,R){var N,re;return S?(re=new A,(S.state=re).window=null,(N=O(S,R))!==m&&(S.state=null),N):u}var K,H,P=!0;function Y(S){if(P){var R;for(K=new i.Buf32(512),H=new i.Buf32(32),R=0;R<144;)S.lens[R++]=8;for(;R<256;)S.lens[R++]=9;for(;R<280;)S.lens[R++]=7;for(;R<288;)S.lens[R++]=8;for(h(p,S.lens,0,288,K,0,S.work,{bits:9}),R=0;R<32;)S.lens[R++]=5;h(b,S.lens,0,32,H,0,S.work,{bits:5}),P=!1}S.lencode=K,S.lenbits=9,S.distcode=H,S.distbits=5}function I(S,R,N,re){var ve,le=S.state;return le.window===null&&(le.wsize=1<<le.wbits,le.wnext=0,le.whave=0,le.window=new i.Buf8(le.wsize)),re>=le.wsize?(i.arraySet(le.window,R,N-le.wsize,le.wsize,0),le.wnext=0,le.whave=le.wsize):(re<(ve=le.wsize-le.wnext)&&(ve=re),i.arraySet(le.window,R,N-re,ve,le.wnext),(re-=ve)?(i.arraySet(le.window,R,N-re,re,0),le.wnext=re,le.whave=le.wsize):(le.wnext+=ve,le.wnext===le.wsize&&(le.wnext=0),le.whave<le.wsize&&(le.whave+=ve))),0}s.inflateReset=E,s.inflateReset2=O,s.inflateResetKeep=L,s.inflateInit=function(S){return X(S,15)},s.inflateInit2=X,s.inflate=function(S,R){var N,re,ve,le,oe,ie,Ae,te,C,G,Z,Q,fe,we,Se,Ce,Re,Me,Je,je,j,T,V,$,z=0,M=new i.Buf8(4),ue=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!S||!S.state||!S.output||!S.input&&S.avail_in!==0)return u;(N=S.state).mode===12&&(N.mode=13),oe=S.next_out,ve=S.output,Ae=S.avail_out,le=S.next_in,re=S.input,ie=S.avail_in,te=N.hold,C=N.bits,G=ie,Z=Ae,T=m;e:for(;;)switch(N.mode){case w:if(N.wrap===0){N.mode=13;break}for(;C<16;){if(ie===0)break e;ie--,te+=re[le++]<<C,C+=8}if(2&N.wrap&&te===35615){M[N.check=0]=255&te,M[1]=te>>>8&255,N.check=o(N.check,M,2,0),C=te=0,N.mode=2;break}if(N.flags=0,N.head&&(N.head.done=!1),!(1&N.wrap)||(((255&te)<<8)+(te>>8))%31){S.msg="incorrect header check",N.mode=30;break}if((15&te)!=8){S.msg="unknown compression method",N.mode=30;break}if(C-=4,j=8+(15&(te>>>=4)),N.wbits===0)N.wbits=j;else if(j>N.wbits){S.msg="invalid window size",N.mode=30;break}N.dmax=1<<j,S.adler=N.check=1,N.mode=512&te?10:12,C=te=0;break;case 2:for(;C<16;){if(ie===0)break e;ie--,te+=re[le++]<<C,C+=8}if(N.flags=te,(255&N.flags)!=8){S.msg="unknown compression method",N.mode=30;break}if(57344&N.flags){S.msg="unknown header flags set",N.mode=30;break}N.head&&(N.head.text=te>>8&1),512&N.flags&&(M[0]=255&te,M[1]=te>>>8&255,N.check=o(N.check,M,2,0)),C=te=0,N.mode=3;case 3:for(;C<32;){if(ie===0)break e;ie--,te+=re[le++]<<C,C+=8}N.head&&(N.head.time=te),512&N.flags&&(M[0]=255&te,M[1]=te>>>8&255,M[2]=te>>>16&255,M[3]=te>>>24&255,N.check=o(N.check,M,4,0)),C=te=0,N.mode=4;case 4:for(;C<16;){if(ie===0)break e;ie--,te+=re[le++]<<C,C+=8}N.head&&(N.head.xflags=255&te,N.head.os=te>>8),512&N.flags&&(M[0]=255&te,M[1]=te>>>8&255,N.check=o(N.check,M,2,0)),C=te=0,N.mode=5;case 5:if(1024&N.flags){for(;C<16;){if(ie===0)break e;ie--,te+=re[le++]<<C,C+=8}N.length=te,N.head&&(N.head.extra_len=te),512&N.flags&&(M[0]=255&te,M[1]=te>>>8&255,N.check=o(N.check,M,2,0)),C=te=0}else N.head&&(N.head.extra=null);N.mode=6;case 6:if(1024&N.flags&&(ie<(Q=N.length)&&(Q=ie),Q&&(N.head&&(j=N.head.extra_len-N.length,N.head.extra||(N.head.extra=new Array(N.head.extra_len)),i.arraySet(N.head.extra,re,le,Q,j)),512&N.flags&&(N.check=o(N.check,re,Q,le)),ie-=Q,le+=Q,N.length-=Q),N.length))break e;N.length=0,N.mode=7;case 7:if(2048&N.flags){if(ie===0)break e;for(Q=0;j=re[le+Q++],N.head&&j&&N.length<65536&&(N.head.name+=String.fromCharCode(j)),j&&Q<ie;);if(512&N.flags&&(N.check=o(N.check,re,Q,le)),ie-=Q,le+=Q,j)break e}else N.head&&(N.head.name=null);N.length=0,N.mode=8;case 8:if(4096&N.flags){if(ie===0)break e;for(Q=0;j=re[le+Q++],N.head&&j&&N.length<65536&&(N.head.comment+=String.fromCharCode(j)),j&&Q<ie;);if(512&N.flags&&(N.check=o(N.check,re,Q,le)),ie-=Q,le+=Q,j)break e}else N.head&&(N.head.comment=null);N.mode=9;case 9:if(512&N.flags){for(;C<16;){if(ie===0)break e;ie--,te+=re[le++]<<C,C+=8}if(te!==(65535&N.check)){S.msg="header crc mismatch",N.mode=30;break}C=te=0}N.head&&(N.head.hcrc=N.flags>>9&1,N.head.done=!0),S.adler=N.check=0,N.mode=12;break;case 10:for(;C<32;){if(ie===0)break e;ie--,te+=re[le++]<<C,C+=8}S.adler=N.check=y(te),C=te=0,N.mode=11;case 11:if(N.havedict===0)return S.next_out=oe,S.avail_out=Ae,S.next_in=le,S.avail_in=ie,N.hold=te,N.bits=C,2;S.adler=N.check=1,N.mode=12;case 12:if(R===5||R===6)break e;case 13:if(N.last){te>>>=7&C,C-=7&C,N.mode=27;break}for(;C<3;){if(ie===0)break e;ie--,te+=re[le++]<<C,C+=8}switch(N.last=1&te,C-=1,3&(te>>>=1)){case 0:N.mode=14;break;case 1:if(Y(N),N.mode=20,R!==6)break;te>>>=2,C-=2;break e;case 2:N.mode=17;break;case 3:S.msg="invalid block type",N.mode=30}te>>>=2,C-=2;break;case 14:for(te>>>=7&C,C-=7&C;C<32;){if(ie===0)break e;ie--,te+=re[le++]<<C,C+=8}if((65535&te)!=(te>>>16^65535)){S.msg="invalid stored block lengths",N.mode=30;break}if(N.length=65535&te,C=te=0,N.mode=15,R===6)break e;case 15:N.mode=16;case 16:if(Q=N.length){if(ie<Q&&(Q=ie),Ae<Q&&(Q=Ae),Q===0)break e;i.arraySet(ve,re,le,Q,oe),ie-=Q,le+=Q,Ae-=Q,oe+=Q,N.length-=Q;break}N.mode=12;break;case 17:for(;C<14;){if(ie===0)break e;ie--,te+=re[le++]<<C,C+=8}if(N.nlen=257+(31&te),te>>>=5,C-=5,N.ndist=1+(31&te),te>>>=5,C-=5,N.ncode=4+(15&te),te>>>=4,C-=4,286<N.nlen||30<N.ndist){S.msg="too many length or distance symbols",N.mode=30;break}N.have=0,N.mode=18;case 18:for(;N.have<N.ncode;){for(;C<3;){if(ie===0)break e;ie--,te+=re[le++]<<C,C+=8}N.lens[ue[N.have++]]=7&te,te>>>=3,C-=3}for(;N.have<19;)N.lens[ue[N.have++]]=0;if(N.lencode=N.lendyn,N.lenbits=7,V={bits:N.lenbits},T=h(0,N.lens,0,19,N.lencode,0,N.work,V),N.lenbits=V.bits,T){S.msg="invalid code lengths set",N.mode=30;break}N.have=0,N.mode=19;case 19:for(;N.have<N.nlen+N.ndist;){for(;Ce=(z=N.lencode[te&(1<<N.lenbits)-1])>>>16&255,Re=65535&z,!((Se=z>>>24)<=C);){if(ie===0)break e;ie--,te+=re[le++]<<C,C+=8}if(Re<16)te>>>=Se,C-=Se,N.lens[N.have++]=Re;else{if(Re===16){for($=Se+2;C<$;){if(ie===0)break e;ie--,te+=re[le++]<<C,C+=8}if(te>>>=Se,C-=Se,N.have===0){S.msg="invalid bit length repeat",N.mode=30;break}j=N.lens[N.have-1],Q=3+(3&te),te>>>=2,C-=2}else if(Re===17){for($=Se+3;C<$;){if(ie===0)break e;ie--,te+=re[le++]<<C,C+=8}C-=Se,j=0,Q=3+(7&(te>>>=Se)),te>>>=3,C-=3}else{for($=Se+7;C<$;){if(ie===0)break e;ie--,te+=re[le++]<<C,C+=8}C-=Se,j=0,Q=11+(127&(te>>>=Se)),te>>>=7,C-=7}if(N.have+Q>N.nlen+N.ndist){S.msg="invalid bit length repeat",N.mode=30;break}for(;Q--;)N.lens[N.have++]=j}}if(N.mode===30)break;if(N.lens[256]===0){S.msg="invalid code -- missing end-of-block",N.mode=30;break}if(N.lenbits=9,V={bits:N.lenbits},T=h(p,N.lens,0,N.nlen,N.lencode,0,N.work,V),N.lenbits=V.bits,T){S.msg="invalid literal/lengths set",N.mode=30;break}if(N.distbits=6,N.distcode=N.distdyn,V={bits:N.distbits},T=h(b,N.lens,N.nlen,N.ndist,N.distcode,0,N.work,V),N.distbits=V.bits,T){S.msg="invalid distances set",N.mode=30;break}if(N.mode=20,R===6)break e;case 20:N.mode=21;case 21:if(6<=ie&&258<=Ae){S.next_out=oe,S.avail_out=Ae,S.next_in=le,S.avail_in=ie,N.hold=te,N.bits=C,d(S,Z),oe=S.next_out,ve=S.output,Ae=S.avail_out,le=S.next_in,re=S.input,ie=S.avail_in,te=N.hold,C=N.bits,N.mode===12&&(N.back=-1);break}for(N.back=0;Ce=(z=N.lencode[te&(1<<N.lenbits)-1])>>>16&255,Re=65535&z,!((Se=z>>>24)<=C);){if(ie===0)break e;ie--,te+=re[le++]<<C,C+=8}if(Ce&&(240&Ce)==0){for(Me=Se,Je=Ce,je=Re;Ce=(z=N.lencode[je+((te&(1<<Me+Je)-1)>>Me)])>>>16&255,Re=65535&z,!(Me+(Se=z>>>24)<=C);){if(ie===0)break e;ie--,te+=re[le++]<<C,C+=8}te>>>=Me,C-=Me,N.back+=Me}if(te>>>=Se,C-=Se,N.back+=Se,N.length=Re,Ce===0){N.mode=26;break}if(32&Ce){N.back=-1,N.mode=12;break}if(64&Ce){S.msg="invalid literal/length code",N.mode=30;break}N.extra=15&Ce,N.mode=22;case 22:if(N.extra){for($=N.extra;C<$;){if(ie===0)break e;ie--,te+=re[le++]<<C,C+=8}N.length+=te&(1<<N.extra)-1,te>>>=N.extra,C-=N.extra,N.back+=N.extra}N.was=N.length,N.mode=23;case 23:for(;Ce=(z=N.distcode[te&(1<<N.distbits)-1])>>>16&255,Re=65535&z,!((Se=z>>>24)<=C);){if(ie===0)break e;ie--,te+=re[le++]<<C,C+=8}if((240&Ce)==0){for(Me=Se,Je=Ce,je=Re;Ce=(z=N.distcode[je+((te&(1<<Me+Je)-1)>>Me)])>>>16&255,Re=65535&z,!(Me+(Se=z>>>24)<=C);){if(ie===0)break e;ie--,te+=re[le++]<<C,C+=8}te>>>=Me,C-=Me,N.back+=Me}if(te>>>=Se,C-=Se,N.back+=Se,64&Ce){S.msg="invalid distance code",N.mode=30;break}N.offset=Re,N.extra=15&Ce,N.mode=24;case 24:if(N.extra){for($=N.extra;C<$;){if(ie===0)break e;ie--,te+=re[le++]<<C,C+=8}N.offset+=te&(1<<N.extra)-1,te>>>=N.extra,C-=N.extra,N.back+=N.extra}if(N.offset>N.dmax){S.msg="invalid distance too far back",N.mode=30;break}N.mode=25;case 25:if(Ae===0)break e;if(Q=Z-Ae,N.offset>Q){if((Q=N.offset-Q)>N.whave&&N.sane){S.msg="invalid distance too far back",N.mode=30;break}fe=Q>N.wnext?(Q-=N.wnext,N.wsize-Q):N.wnext-Q,Q>N.length&&(Q=N.length),we=N.window}else we=ve,fe=oe-N.offset,Q=N.length;for(Ae<Q&&(Q=Ae),Ae-=Q,N.length-=Q;ve[oe++]=we[fe++],--Q;);N.length===0&&(N.mode=21);break;case 26:if(Ae===0)break e;ve[oe++]=N.length,Ae--,N.mode=21;break;case 27:if(N.wrap){for(;C<32;){if(ie===0)break e;ie--,te|=re[le++]<<C,C+=8}if(Z-=Ae,S.total_out+=Z,N.total+=Z,Z&&(S.adler=N.check=N.flags?o(N.check,ve,Z,oe-Z):c(N.check,ve,Z,oe-Z)),Z=Ae,(N.flags?te:y(te))!==N.check){S.msg="incorrect data check",N.mode=30;break}C=te=0}N.mode=28;case 28:if(N.wrap&&N.flags){for(;C<32;){if(ie===0)break e;ie--,te+=re[le++]<<C,C+=8}if(te!==(4294967295&N.total)){S.msg="incorrect length check",N.mode=30;break}C=te=0}N.mode=29;case 29:T=1;break e;case 30:T=-3;break e;case 31:return-4;case 32:default:return u}return S.next_out=oe,S.avail_out=Ae,S.next_in=le,S.avail_in=ie,N.hold=te,N.bits=C,(N.wsize||Z!==S.avail_out&&N.mode<30&&(N.mode<27||R!==4))&&I(S,S.output,S.next_out,Z-S.avail_out)?(N.mode=31,-4):(G-=S.avail_in,Z-=S.avail_out,S.total_in+=G,S.total_out+=Z,N.total+=Z,N.wrap&&Z&&(S.adler=N.check=N.flags?o(N.check,ve,Z,S.next_out-Z):c(N.check,ve,Z,S.next_out-Z)),S.data_type=N.bits+(N.last?64:0)+(N.mode===12?128:0)+(N.mode===20||N.mode===15?256:0),(G==0&&Z===0||R===4)&&T===m&&(T=-5),T)},s.inflateEnd=function(S){if(!S||!S.state)return u;var R=S.state;return R.window&&(R.window=null),S.state=null,m},s.inflateGetHeader=function(S,R){var N;return S&&S.state?(2&(N=S.state).wrap)==0?u:((N.head=R).done=!1,m):u},s.inflateSetDictionary=function(S,R){var N,re=R.length;return S&&S.state?(N=S.state).wrap!==0&&N.mode!==11?u:N.mode===11&&c(1,R,re,0)!==N.check?-3:I(S,R,re,re)?(N.mode=31,-4):(N.havedict=1,m):u},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,a,s){var i=e("../utils/common"),c=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],d=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],h=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];a.exports=function(p,b,m,u,w,x,_,y){var A,L,E,O,X,K,H,P,Y,I=y.bits,S=0,R=0,N=0,re=0,ve=0,le=0,oe=0,ie=0,Ae=0,te=0,C=null,G=0,Z=new i.Buf16(16),Q=new i.Buf16(16),fe=null,we=0;for(S=0;S<=15;S++)Z[S]=0;for(R=0;R<u;R++)Z[b[m+R]]++;for(ve=I,re=15;1<=re&&Z[re]===0;re--);if(re<ve&&(ve=re),re===0)return w[x++]=20971520,w[x++]=20971520,y.bits=1,0;for(N=1;N<re&&Z[N]===0;N++);for(ve<N&&(ve=N),S=ie=1;S<=15;S++)if(ie<<=1,(ie-=Z[S])<0)return-1;if(0<ie&&(p===0||re!==1))return-1;for(Q[1]=0,S=1;S<15;S++)Q[S+1]=Q[S]+Z[S];for(R=0;R<u;R++)b[m+R]!==0&&(_[Q[b[m+R]]++]=R);if(K=p===0?(C=fe=_,19):p===1?(C=c,G-=257,fe=o,we-=257,256):(C=d,fe=h,-1),S=N,X=x,oe=R=te=0,E=-1,O=(Ae=1<<(le=ve))-1,p===1&&852<Ae||p===2&&592<Ae)return 1;for(;;){for(H=S-oe,Y=_[R]<K?(P=0,_[R]):_[R]>K?(P=fe[we+_[R]],C[G+_[R]]):(P=96,0),A=1<<S-oe,N=L=1<<le;w[X+(te>>oe)+(L-=A)]=H<<24|P<<16|Y|0,L!==0;);for(A=1<<S-1;te&A;)A>>=1;if(A!==0?(te&=A-1,te+=A):te=0,R++,--Z[S]==0){if(S===re)break;S=b[m+_[R]]}if(ve<S&&(te&O)!==E){for(oe===0&&(oe=ve),X+=N,ie=1<<(le=S-oe);le+oe<re&&!((ie-=Z[le+oe])<=0);)le++,ie<<=1;if(Ae+=1<<le,p===1&&852<Ae||p===2&&592<Ae)return 1;w[E=te&O]=ve<<24|le<<16|X-x|0}}return te!==0&&(w[X+te]=S-oe<<24|64<<16|0),y.bits=ve,0}},{"../utils/common":41}],51:[function(e,a,s){a.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,a,s){var i=e("../utils/common"),c=0,o=1;function d(z){for(var M=z.length;0<=--M;)z[M]=0}var h=0,p=29,b=256,m=b+1+p,u=30,w=19,x=2*m+1,_=15,y=16,A=7,L=256,E=16,O=17,X=18,K=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],H=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],P=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],I=new Array(2*(m+2));d(I);var S=new Array(2*u);d(S);var R=new Array(512);d(R);var N=new Array(256);d(N);var re=new Array(p);d(re);var ve,le,oe,ie=new Array(u);function Ae(z,M,ue,pe,ce){this.static_tree=z,this.extra_bits=M,this.extra_base=ue,this.elems=pe,this.max_length=ce,this.has_stree=z&&z.length}function te(z,M){this.dyn_tree=z,this.max_code=0,this.stat_desc=M}function C(z){return z<256?R[z]:R[256+(z>>>7)]}function G(z,M){z.pending_buf[z.pending++]=255&M,z.pending_buf[z.pending++]=M>>>8&255}function Z(z,M,ue){z.bi_valid>y-ue?(z.bi_buf|=M<<z.bi_valid&65535,G(z,z.bi_buf),z.bi_buf=M>>y-z.bi_valid,z.bi_valid+=ue-y):(z.bi_buf|=M<<z.bi_valid&65535,z.bi_valid+=ue)}function Q(z,M,ue){Z(z,ue[2*M],ue[2*M+1])}function fe(z,M){for(var ue=0;ue|=1&z,z>>>=1,ue<<=1,0<--M;);return ue>>>1}function we(z,M,ue){var pe,ce,Le=new Array(_+1),Ie=0;for(pe=1;pe<=_;pe++)Le[pe]=Ie=Ie+ue[pe-1]<<1;for(ce=0;ce<=M;ce++){var Te=z[2*ce+1];Te!==0&&(z[2*ce]=fe(Le[Te]++,Te))}}function Se(z){var M;for(M=0;M<m;M++)z.dyn_ltree[2*M]=0;for(M=0;M<u;M++)z.dyn_dtree[2*M]=0;for(M=0;M<w;M++)z.bl_tree[2*M]=0;z.dyn_ltree[2*L]=1,z.opt_len=z.static_len=0,z.last_lit=z.matches=0}function Ce(z){8<z.bi_valid?G(z,z.bi_buf):0<z.bi_valid&&(z.pending_buf[z.pending++]=z.bi_buf),z.bi_buf=0,z.bi_valid=0}function Re(z,M,ue,pe){var ce=2*M,Le=2*ue;return z[ce]<z[Le]||z[ce]===z[Le]&&pe[M]<=pe[ue]}function Me(z,M,ue){for(var pe=z.heap[ue],ce=ue<<1;ce<=z.heap_len&&(ce<z.heap_len&&Re(M,z.heap[ce+1],z.heap[ce],z.depth)&&ce++,!Re(M,pe,z.heap[ce],z.depth));)z.heap[ue]=z.heap[ce],ue=ce,ce<<=1;z.heap[ue]=pe}function Je(z,M,ue){var pe,ce,Le,Ie,Te=0;if(z.last_lit!==0)for(;pe=z.pending_buf[z.d_buf+2*Te]<<8|z.pending_buf[z.d_buf+2*Te+1],ce=z.pending_buf[z.l_buf+Te],Te++,pe===0?Q(z,ce,M):(Q(z,(Le=N[ce])+b+1,M),(Ie=K[Le])!==0&&Z(z,ce-=re[Le],Ie),Q(z,Le=C(--pe),ue),(Ie=H[Le])!==0&&Z(z,pe-=ie[Le],Ie)),Te<z.last_lit;);Q(z,L,M)}function je(z,M){var ue,pe,ce,Le=M.dyn_tree,Ie=M.stat_desc.static_tree,Te=M.stat_desc.has_stree,Ve=M.stat_desc.elems,ht=-1;for(z.heap_len=0,z.heap_max=x,ue=0;ue<Ve;ue++)Le[2*ue]!==0?(z.heap[++z.heap_len]=ht=ue,z.depth[ue]=0):Le[2*ue+1]=0;for(;z.heap_len<2;)Le[2*(ce=z.heap[++z.heap_len]=ht<2?++ht:0)]=1,z.depth[ce]=0,z.opt_len--,Te&&(z.static_len-=Ie[2*ce+1]);for(M.max_code=ht,ue=z.heap_len>>1;1<=ue;ue--)Me(z,Le,ue);for(ce=Ve;ue=z.heap[1],z.heap[1]=z.heap[z.heap_len--],Me(z,Le,1),pe=z.heap[1],z.heap[--z.heap_max]=ue,z.heap[--z.heap_max]=pe,Le[2*ce]=Le[2*ue]+Le[2*pe],z.depth[ce]=(z.depth[ue]>=z.depth[pe]?z.depth[ue]:z.depth[pe])+1,Le[2*ue+1]=Le[2*pe+1]=ce,z.heap[1]=ce++,Me(z,Le,1),2<=z.heap_len;);z.heap[--z.heap_max]=z.heap[1],(function(st,ot){var yt,dt,Vt,mt,Lt,zt,Et=ot.dyn_tree,wt=ot.max_code,Kt=ot.stat_desc.static_tree,Nt=ot.stat_desc.has_stree,Ft=ot.stat_desc.extra_bits,ar=ot.stat_desc.extra_base,Ot=ot.stat_desc.max_length,xt=0;for(mt=0;mt<=_;mt++)st.bl_count[mt]=0;for(Et[2*st.heap[st.heap_max]+1]=0,yt=st.heap_max+1;yt<x;yt++)Ot<(mt=Et[2*Et[2*(dt=st.heap[yt])+1]+1]+1)&&(mt=Ot,xt++),Et[2*dt+1]=mt,wt<dt||(st.bl_count[mt]++,Lt=0,ar<=dt&&(Lt=Ft[dt-ar]),zt=Et[2*dt],st.opt_len+=zt*(mt+Lt),Nt&&(st.static_len+=zt*(Kt[2*dt+1]+Lt)));if(xt!==0){do{for(mt=Ot-1;st.bl_count[mt]===0;)mt--;st.bl_count[mt]--,st.bl_count[mt+1]+=2,st.bl_count[Ot]--,xt-=2}while(0<xt);for(mt=Ot;mt!==0;mt--)for(dt=st.bl_count[mt];dt!==0;)wt<(Vt=st.heap[--yt])||(Et[2*Vt+1]!==mt&&(st.opt_len+=(mt-Et[2*Vt+1])*Et[2*Vt],Et[2*Vt+1]=mt),dt--)}})(z,M),we(Le,ht,z.bl_count)}function j(z,M,ue){var pe,ce,Le=-1,Ie=M[1],Te=0,Ve=7,ht=4;for(Ie===0&&(Ve=138,ht=3),M[2*(ue+1)+1]=65535,pe=0;pe<=ue;pe++)ce=Ie,Ie=M[2*(pe+1)+1],++Te<Ve&&ce===Ie||(Te<ht?z.bl_tree[2*ce]+=Te:ce!==0?(ce!==Le&&z.bl_tree[2*ce]++,z.bl_tree[2*E]++):Te<=10?z.bl_tree[2*O]++:z.bl_tree[2*X]++,Le=ce,ht=(Te=0)===Ie?(Ve=138,3):ce===Ie?(Ve=6,3):(Ve=7,4))}function T(z,M,ue){var pe,ce,Le=-1,Ie=M[1],Te=0,Ve=7,ht=4;for(Ie===0&&(Ve=138,ht=3),pe=0;pe<=ue;pe++)if(ce=Ie,Ie=M[2*(pe+1)+1],!(++Te<Ve&&ce===Ie)){if(Te<ht)for(;Q(z,ce,z.bl_tree),--Te!=0;);else ce!==0?(ce!==Le&&(Q(z,ce,z.bl_tree),Te--),Q(z,E,z.bl_tree),Z(z,Te-3,2)):Te<=10?(Q(z,O,z.bl_tree),Z(z,Te-3,3)):(Q(z,X,z.bl_tree),Z(z,Te-11,7));Le=ce,ht=(Te=0)===Ie?(Ve=138,3):ce===Ie?(Ve=6,3):(Ve=7,4)}}d(ie);var V=!1;function $(z,M,ue,pe){Z(z,(h<<1)+(pe?1:0),3),(function(ce,Le,Ie,Te){Ce(ce),G(ce,Ie),G(ce,~Ie),i.arraySet(ce.pending_buf,ce.window,Le,Ie,ce.pending),ce.pending+=Ie})(z,M,ue)}s._tr_init=function(z){V||((function(){var M,ue,pe,ce,Le,Ie=new Array(_+1);for(ce=pe=0;ce<p-1;ce++)for(re[ce]=pe,M=0;M<1<<K[ce];M++)N[pe++]=ce;for(N[pe-1]=ce,ce=Le=0;ce<16;ce++)for(ie[ce]=Le,M=0;M<1<<H[ce];M++)R[Le++]=ce;for(Le>>=7;ce<u;ce++)for(ie[ce]=Le<<7,M=0;M<1<<H[ce]-7;M++)R[256+Le++]=ce;for(ue=0;ue<=_;ue++)Ie[ue]=0;for(M=0;M<=143;)I[2*M+1]=8,M++,Ie[8]++;for(;M<=255;)I[2*M+1]=9,M++,Ie[9]++;for(;M<=279;)I[2*M+1]=7,M++,Ie[7]++;for(;M<=287;)I[2*M+1]=8,M++,Ie[8]++;for(we(I,m+1,Ie),M=0;M<u;M++)S[2*M+1]=5,S[2*M]=fe(M,5);ve=new Ae(I,K,b+1,m,_),le=new Ae(S,H,0,u,_),oe=new Ae(new Array(0),P,0,w,A)})(),V=!0),z.l_desc=new te(z.dyn_ltree,ve),z.d_desc=new te(z.dyn_dtree,le),z.bl_desc=new te(z.bl_tree,oe),z.bi_buf=0,z.bi_valid=0,Se(z)},s._tr_stored_block=$,s._tr_flush_block=function(z,M,ue,pe){var ce,Le,Ie=0;0<z.level?(z.strm.data_type===2&&(z.strm.data_type=(function(Te){var Ve,ht=4093624447;for(Ve=0;Ve<=31;Ve++,ht>>>=1)if(1&ht&&Te.dyn_ltree[2*Ve]!==0)return c;if(Te.dyn_ltree[18]!==0||Te.dyn_ltree[20]!==0||Te.dyn_ltree[26]!==0)return o;for(Ve=32;Ve<b;Ve++)if(Te.dyn_ltree[2*Ve]!==0)return o;return c})(z)),je(z,z.l_desc),je(z,z.d_desc),Ie=(function(Te){var Ve;for(j(Te,Te.dyn_ltree,Te.l_desc.max_code),j(Te,Te.dyn_dtree,Te.d_desc.max_code),je(Te,Te.bl_desc),Ve=w-1;3<=Ve&&Te.bl_tree[2*Y[Ve]+1]===0;Ve--);return Te.opt_len+=3*(Ve+1)+5+5+4,Ve})(z),ce=z.opt_len+3+7>>>3,(Le=z.static_len+3+7>>>3)<=ce&&(ce=Le)):ce=Le=ue+5,ue+4<=ce&&M!==-1?$(z,M,ue,pe):z.strategy===4||Le===ce?(Z(z,2+(pe?1:0),3),Je(z,I,S)):(Z(z,4+(pe?1:0),3),(function(Te,Ve,ht,st){var ot;for(Z(Te,Ve-257,5),Z(Te,ht-1,5),Z(Te,st-4,4),ot=0;ot<st;ot++)Z(Te,Te.bl_tree[2*Y[ot]+1],3);T(Te,Te.dyn_ltree,Ve-1),T(Te,Te.dyn_dtree,ht-1)})(z,z.l_desc.max_code+1,z.d_desc.max_code+1,Ie+1),Je(z,z.dyn_ltree,z.dyn_dtree)),Se(z),pe&&Ce(z)},s._tr_tally=function(z,M,ue){return z.pending_buf[z.d_buf+2*z.last_lit]=M>>>8&255,z.pending_buf[z.d_buf+2*z.last_lit+1]=255&M,z.pending_buf[z.l_buf+z.last_lit]=255&ue,z.last_lit++,M===0?z.dyn_ltree[2*ue]++:(z.matches++,M--,z.dyn_ltree[2*(N[ue]+b+1)]++,z.dyn_dtree[2*C(M)]++),z.last_lit===z.lit_bufsize-1},s._tr_align=function(z){Z(z,2,3),Q(z,L,I),(function(M){M.bi_valid===16?(G(M,M.bi_buf),M.bi_buf=0,M.bi_valid=0):8<=M.bi_valid&&(M.pending_buf[M.pending++]=255&M.bi_buf,M.bi_buf>>=8,M.bi_valid-=8)})(z)}},{"../utils/common":41}],53:[function(e,a,s){a.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,a,s){(function(i){(function(c,o){if(!c.setImmediate){var d,h,p,b,m=1,u={},w=!1,x=c.document,_=Object.getPrototypeOf&&Object.getPrototypeOf(c);_=_&&_.setTimeout?_:c,d={}.toString.call(c.process)==="[object process]"?function(E){process.nextTick(function(){A(E)})}:(function(){if(c.postMessage&&!c.importScripts){var E=!0,O=c.onmessage;return c.onmessage=function(){E=!1},c.postMessage("","*"),c.onmessage=O,E}})()?(b="setImmediate$"+Math.random()+"$",c.addEventListener?c.addEventListener("message",L,!1):c.attachEvent("onmessage",L),function(E){c.postMessage(b+E,"*")}):c.MessageChannel?((p=new MessageChannel).port1.onmessage=function(E){A(E.data)},function(E){p.port2.postMessage(E)}):x&&"onreadystatechange"in x.createElement("script")?(h=x.documentElement,function(E){var O=x.createElement("script");O.onreadystatechange=function(){A(E),O.onreadystatechange=null,h.removeChild(O),O=null},h.appendChild(O)}):function(E){setTimeout(A,0,E)},_.setImmediate=function(E){typeof E!="function"&&(E=new Function(""+E));for(var O=new Array(arguments.length-1),X=0;X<O.length;X++)O[X]=arguments[X+1];var K={callback:E,args:O};return u[m]=K,d(m),m++},_.clearImmediate=y}function y(E){delete u[E]}function A(E){if(w)setTimeout(A,0,E);else{var O=u[E];if(O){w=!0;try{(function(X){var K=X.callback,H=X.args;switch(H.length){case 0:K();break;case 1:K(H[0]);break;case 2:K(H[0],H[1]);break;case 3:K(H[0],H[1],H[2]);break;default:K.apply(o,H)}})(O)}finally{y(E),w=!1}}}}function L(E){E.source===c&&typeof E.data=="string"&&E.data.indexOf(b)===0&&A(+E.data.slice(b.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof Uo<"u"?Uo:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(gc)),gc.exports}var U2=M2();const sp=y0(U2),vo=()=>new Date().toISOString().split("T")[0],ap=()=>new Promise((t,r)=>{if(window.svguitar){t();return}const e=document.createElement("script");e.src="https://omnibrain.github.io/svguitar/js/svguitar.umd.js",e.async=!0,e.onload=()=>t(),e.onerror=()=>r(new Error("Failed to load SVGuitar library")),document.body.appendChild(e)}),z2=t=>{const r=document.createElement("div");r.style.position="absolute",r.style.left="-9999px",r.style.top="-9999px",document.body.appendChild(r);try{const e=new window.svguitar.SVGuitarChord(r),a={strings:t.numStrings||6,frets:t.numFrets||5,position:t.startingFret||1,tuning:[],width:150,height:165,fretSize:1.2,fingerSize:.75,sidePadding:.2,fontFamily:"Arial, sans-serif",color:"#333333",backgroundColor:"transparent",strokeColor:"#333333",textColor:"#333333",fretLabelColor:"#333333",fingerTextColor:"#ffffff",fingerTextSize:28,title:t.title||""},c={fingers:[...(t.fingers||[]).map(h=>{const[p,b,m]=h;return m&&m!=="undefined"?[p,b,m]:[p,b]}),...(t.openStrings||[]).map(h=>[h,0]),...(t.mutedStrings||[]).map(h=>[h,"x"])],barres:t.barres||[]};e.configure(a).chord(c).draw();const o=r.querySelector("svg");if(!o)throw new Error("SVG not rendered");return new XMLSerializer().serializeToString(o)}finally{document.body.removeChild(r)}},q2=(t,r,e)=>new Promise((a,s)=>{const i=document.createElement("canvas");i.width=r,i.height=e;const c=i.getContext("2d");c.fillStyle="white",c.fillRect(0,0,r,e);const o=new Image,d=new Blob([t],{type:"image/svg+xml;charset=utf-8"}),h=URL.createObjectURL(d);o.onload=()=>{c.drawImage(o,0,0,r,e),URL.revokeObjectURL(h),a(i.toDataURL("image/png"))},o.onerror=p=>{URL.revokeObjectURL(h),s(new Error("Failed to load SVG into image"))},o.src=h}),Qc=async(t,r)=>{const e=await fetch(t);if(!e.ok)throw new Error(`Download failed: ${e.statusText}`);const a=await e.blob(),s=window.URL.createObjectURL(a),i=document.createElement("a");i.href=s;const c=e.headers.get("Content-Disposition");if(c){const o=c.match(/filename="?([^";\n]+)"?/);o?i.download=o[1]:i.download=r}else i.download=r;i.click(),window.URL.revokeObjectURL(s)},$2=async(t="json")=>Qc(`/api/user/export/items?format=${t}`,`items-${vo()}.${t}`),W2=async(t="json")=>Qc(`/api/user/export/routines?format=${t}`,`routines-${vo()}.${t}`),H2=async()=>Qc("/api/user/export/chord-charts",`chord-charts-${vo()}.json`),G2=async()=>{await ap();const t=vo(),r=await fetch("/api/user/export/all");if(!r.ok)throw new Error(`Failed to fetch export data: ${r.statusText}`);const e=await r.blob(),a=await sp.loadAsync(e),s=await fetch("/api/user/export/chord-charts");if(!s.ok)throw new Error(`Failed to fetch chord charts: ${s.statusText}`);const i=await s.json();if(i.items&&i.items.length>0){for(const h of i.items)if(!(!h.charts||h.charts.length===0))try{const p=await op(h,t),m=`ChordChartPDFs/${ip(h.item_title||"Untitled")} - Chord Charts.pdf`;a.file(m,p)}catch(p){console.error(`Failed to generate PDF for "${h.item_title}":`,p)}}const c=await a.generateAsync({type:"blob"}),o=window.URL.createObjectURL(c),d=document.createElement("a");d.href=o,d.download=`gpra-export-${t}.zip`,d.click(),window.URL.revokeObjectURL(o)},ip=t=>t.replace(/[/\\:*?"<>|]/g,"-").trim(),op=async(t,r)=>{const e=new Mt({orientation:"landscape",unit:"mm",format:"a4"}),a=e.internal.pageSize.getWidth(),s=e.internal.pageSize.getHeight(),i=10,c=a-i*2,o=5,d=c/o,h=d-6,p=h*11/10,b=p+2;let m=i;const u=()=>{e.addPage(),m=i};e.setFontSize(14),e.setFont("helvetica","bold"),e.text(t.item_title||"Untitled",i,m),m+=6,t.tuning&&(e.setFontSize(9),e.setFont("helvetica","italic"),e.text(`Tuning: ${t.tuning}`,i,m),m+=5);const w={};for(const _ of t.charts){const y=_.sectionLabel||"General";w[y]||(w[y]=[]),w[y].push(_)}for(const[_,y]of Object.entries(w)){m+b+8>s-i&&u(),e.setFontSize(10),e.setFont("helvetica","bold"),e.text(_,i,m),m+=5;let A=0,L=0;for(const E of y){A>=o&&(A=0,m+=L+3,L=0,m+b>s-i&&u());const O=i+A*d,X=m;try{const K=z2(E),H=await q2(K,300,330),P=O+(d-h)/2;e.addImage(H,"PNG",P,X,h,p)}catch(K){console.error("Failed to render chord:",E.title,K),e.setDrawColor(150),e.rect(O+2,X,d-6,p),e.setFontSize(9),e.setFont("helvetica","bold"),e.text(E.title||"Unknown",O+4,X+15),e.setFontSize(7),e.setFont("helvetica","normal"),e.text("(Render failed)",O+4,X+22)}L=Math.max(L,b),A++}m+=L+5}const x=e.internal.getNumberOfPages();for(let _=1;_<=x;_++)e.setPage(_),e.setFontSize(8),e.setFont("helvetica","normal"),e.setTextColor(128),e.text(`Guitar Practice Routine App - Exported ${r} - Page ${_} of ${x}`,i,s-5),e.setTextColor(0);return e.output("arraybuffer")},V2=async()=>{await ap();const t=await fetch("/api/user/export/chord-charts");if(!t.ok)throw new Error(`Failed to fetch chord charts: ${t.statusText}`);const r=await t.json();if(!r.items||r.items.length===0)throw new Error("No chord charts to export");const e=vo(),a=new sp;for(const o of r.items){if(!o.charts||o.charts.length===0)continue;const d=await op(o,e),p=`${ip(o.item_title||"Untitled")} - Chord Charts.pdf`;a.file(p,d)}const s=await a.generateAsync({type:"blob"}),i=window.URL.createObjectURL(s),c=document.createElement("a");c.href=i,c.download=`chord-charts-${e}.zip`,c.click(),window.URL.revokeObjectURL(i)},Y2=()=>{var ys,Ar;const[t,r]=U.useState(""),[e,a]=U.useState(!1),[s,i]=U.useState(null),[c,o]=U.useState(!1),[d,h]=U.useState(!1),[p,b]=U.useState(!1),[m,u]=U.useState(null),[w,x]=U.useState(null),[_,y]=U.useState({username:"",email:"",tier:"free",oauth_providers:[],unplugged_mode:!1}),[A,L]=U.useState(0),[E,O]=U.useState(1),[X,K]=U.useState(!1),[H,P]=U.useState(0),[Y,I]=U.useState(!1),[S,R]=U.useState(!1),[N,re]=U.useState(!1),[ve,le]=U.useState(!1),[oe,ie]=U.useState(!1),[Ae,te]=U.useState(!1),[C,G]=U.useState(null),[Z,Q]=U.useState(""),[fe,we]=U.useState(""),[Se,Ce]=U.useState(""),[Re,Me]=U.useState({current:!1,new:!1,confirm:!1}),[Je,je]=U.useState(!1),[j,T]=U.useState(null),[V,$]=U.useState(!1),[z,M]=U.useState(!1),[ue,pe]=U.useState(!1),[ce,Le]=U.useState(""),[Ie,Te]=U.useState(""),[Ve,ht]=U.useState(!1),[st,ot]=U.useState(!1),[yt,dt]=U.useState(null),[Vt,mt]=U.useState(null),[Lt,zt]=U.useState("settings"),[Et,wt]=U.useState(()=>{const He=localStorage.getItem("gpra_timer_volume");return He!==null?parseFloat(He):5.5}),[Kt,Nt]=U.useState(null),[Ft,ar]=U.useState(!1),Ot=U.useRef(null),xt=U.useRef(null),Xt=U.useRef(null),[er,Or]=U.useState(()=>{const He={overview:!0,timerVolume:!0,apiKey:!0,practiceData:!0,changePassword:!0,analytics:!0,guidedTour:!0,dangerZone:!0},ft=sessionStorage.getItem("accountSettingsCollapsed");return ft?{...He,...JSON.parse(ft)}:He});U.useEffect(()=>{sessionStorage.setItem("accountSettingsCollapsed",JSON.stringify(er))},[er]),U.useEffect(()=>{bn(),fn(),Ut(),qr();const He=localStorage.getItem("cookieConsent"),ft=document.cookie.split(";").some(ur=>{const Wr=ur.trim().split("=")[0];return/^ph.*phc_/.test(Wr)});$(He==="all"&&ft)},[]);const bn=async()=>{try{const He=await fetch("/api/user/api-key");if(He.ok){const ft=await He.json();a(ft.has_key),i(ft.updated_at)}}catch(He){console.error("Error fetching API key status:",He)}},fn=async()=>{try{const He=await fetch("/api/auth/status");if(He.ok){const ft=await He.json();y({username:ft.user||"",email:ft.email||"",tier:ft.tier||"free",oauth_providers:ft.oauth_providers||[],unplugged_mode:ft.unplugged_mode||!1}),O({free:1,basic:5,thegoods:10,moregoods:25,themost:50}[ft.tier]||1)}}catch(He){console.error("Error fetching user profile:",He)}},Ut=async()=>{try{const He=await fetch("/api/routines");if(He.ok){const ft=await He.json();L(Array.isArray(ft)?ft.length:0)}}catch(He){console.error("Error fetching routine count:",He)}},pn=async()=>{if(!t.trim()){u({type:"error",text:"Please enter an API key"});return}b(!0),u(null),x(null);try{const ft=await(await fetch("/api/user/api-key/validate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({api_key:t})})).json();ft.valid?(x(!0),u({type:"success",text:"API key is valid!"})):(x(!1),u({type:"error",text:ft.error||"Invalid API key"}))}catch{x(!1),u({type:"error",text:"Error validating API key"})}finally{b(!1)}},wn=async()=>{if(!t.trim()){u({type:"error",text:"Please enter an API key"});return}h(!0),u(null);try{const He=await fetch("/api/user/api-key",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({api_key:t})}),ft=await He.json();He.ok?(u({type:"success",text:"API key saved successfully!"}),a(!0),r(""),o(!1),x(null),await bn()):u({type:"error",text:ft.error||"Failed to save API key"})}catch{u({type:"error",text:"Error saving API key"})}finally{h(!1)}},Vr=async()=>{if(confirm("Are you sure you want to delete your API key? You will need to enter it again to use autocreate.")){h(!0),u(null);try{(await fetch("/api/user/api-key",{method:"DELETE"})).ok?(u({type:"success",text:"API key deleted successfully"}),a(!1),i(null),r(""),x(null)):u({type:"error",text:"Failed to delete API key"})}catch{u({type:"error",text:"Error deleting API key"})}finally{h(!1)}}},qr=async()=>{try{const ft=await(await fetch("/api/user/practice-data/expiration-warning")).json();ft.has_expiring_data&&ft.days_until_expiration<=7&&(K(!0),P(ft.days_until_expiration))}catch(He){console.error("Error fetching expiration warning:",He)}},gr=async(He="csv")=>{I(!0);try{const ur=await(await fetch(`/api/user/practice-data/download?format=${He}`)).blob(),Wr=window.URL.createObjectURL(ur),Mr=document.createElement("a");Mr.href=Wr,Mr.download=`practice-data-${new Date().toISOString().split("T")[0]}.${He}`,Mr.click(),window.URL.revokeObjectURL(Wr),K(!1)}catch(ft){console.error("Download failed:",ft)}finally{I(!1)}},Cr=async He=>{R(!0),G(null);try{await $2(He)}catch(ft){console.error("Download items failed:",ft),G(`Failed to download items: ${ft.message}`)}finally{R(!1)}},dr=async He=>{re(!0),G(null);try{await W2(He)}catch(ft){console.error("Download routines failed:",ft),G(`Failed to download routines: ${ft.message}`)}finally{re(!1)}},es=async()=>{le(!0),G(null);try{await H2()}catch(He){console.error("Download chord charts JSON failed:",He),G(`Failed to download chord charts: ${He.message}`)}finally{le(!1)}},wr=async()=>{ie(!0),G(null);try{await V2()}catch(He){console.error("Generate chord charts PDF failed:",He),G(`Failed to generate PDF: ${He.message}`)}finally{ie(!1)}},Sn=async()=>{te(!0),G(null);try{await G2()}catch(He){console.error("Download all data failed:",He),G(`Failed to download data bundle: ${He.message}`)}finally{te(!1)}},tn=async He=>{try{await fetch("/api/user/practice-data/dismiss-reminder",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dismiss_duration_days:He})}),K(!1)}catch(ft){console.error("Error dismissing reminder:",ft)}},kn=async()=>{try{await fetch("/api/user/preferences/tour-reset",{method:"POST",headers:{"Content-Type":"application/json"}}),window.location.href="/?show_tour=1"}catch(He){console.error("Error restarting tour:",He),window.location.href="/?show_tour=1"}},$r=He=>He.length<14?"Password must be at least 14 characters long":/[A-Z]/.test(He)?/[a-z]/.test(He)?/[0-9]/.test(He)?/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>?]/.test(He)?null:"Password must contain at least one symbol or punctuation character":"Password must contain at least one number":"Password must contain at least one lowercase letter":"Password must contain at least one uppercase letter",Yr=He=>({free:"Free",basic:"Basic",thegoods:"The Goods",moregoods:"More Goods",themost:"The Most"})[He]||"Free",En=He=>{const ft={free:"bg-gray-600 text-gray-200",basic:"bg-blue-600 text-blue-100",thegoods:"bg-green-600 text-green-100",moregoods:"bg-purple-600 text-purple-100",themost:"bg-orange-600 text-orange-100"};return ft[He]||ft.free},lt=(He,ft)=>{if(ft===1/0)return"text-green-400";const ur=He/ft*100;return ur>=100?"text-red-400":ur>=80?"text-yellow-400":"text-green-400"},Kr=He=>{Or(ft=>({...ft,[He]:!ft[He]}))},xe=async He=>{if(He.preventDefault(),T(null),!Z||!fe||!Se){T({type:"error",text:"All fields are required"});return}if(fe!==Se){T({type:"error",text:"New passwords do not match"});return}const ft=$r(fe);if(ft){T({type:"error",text:ft});return}je(!0);try{const ur=await fetch("/api/user/password-change",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({current_password:Z,new_password:fe,confirm_password:Se})}),Wr=await ur.json();ur.ok?(T({type:"success",text:"Password changed successfully!"}),Q(""),we(""),Ce("")):T({type:"error",text:Wr.error||"Failed to change password"})}catch{T({type:"error",text:"Error changing password"})}finally{je(!1)}},ze=He=>{const ft=document.cookie.split(";");for(let ur=0;ur<ft.length;ur++){const Wr=ft[ur],Mr=Wr.indexOf("="),Lr=Mr>-1?Wr.substring(0,Mr).trim():Wr.trim();He.test(Lr)&&(document.cookie=Lr+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/",document.cookie=Lr+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;domain="+window.location.hostname,document.cookie=Lr+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;domain=."+window.location.hostname)}},We=async()=>{const He=V?"essential":"all";localStorage.setItem("cookieConsent",He);try{const ft=await fetch("/api/csrf-token"),{csrf_token:ur}=await ft.json();await fetch("/api/consent",{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":ur},body:JSON.stringify({consent:He})})}catch(ft){console.error("[AccountSettings] Failed to save consent to server:",ft)}V?(typeof posthog<"u"&&posthog.opt_out_capturing&&posthog.opt_out_capturing(),ze(/^ph_phc_/),Object.keys(localStorage).forEach(ft=>{(ft.startsWith("ph_")||ft.includes("posthog"))&&localStorage.removeItem(ft)})):typeof posthog<"u"&&posthog.opt_in_capturing&&posthog.opt_in_capturing(),window.location.reload()},Qe=()=>{Le(_.username),M(!0),dt(null)},at=()=>{M(!1),Le(""),dt(null)},tt=async()=>{const He=ce.trim();if(!He){dt({type:"error",text:"Username is required"});return}if(He.length<3){dt({type:"error",text:"Username must be at least 3 characters"});return}if(He===_.username){M(!1);return}ht(!0),dt(null);try{const ft=await fetch("/api/user/username",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:He})}),ur=await ft.json();ft.ok?(y(Wr=>({...Wr,username:ur.username})),M(!1),dt({type:"success",text:"Username updated!"}),setTimeout(()=>dt(null),3e3)):dt({type:"error",text:ur.error||"Failed to update username"})}catch{dt({type:"error",text:"Error updating username"})}finally{ht(!1)}},rt=()=>{Te(_.email),pe(!0),mt(null)},it=()=>{pe(!1),Te(""),mt(null)},At=async()=>{const He=Ie.trim().toLowerCase();if(!He){mt({type:"error",text:"Email is required"});return}if(!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(He)){mt({type:"error",text:"Please enter a valid email address"});return}if(He===_.email){pe(!1);return}ot(!0),mt(null);try{const ur=await fetch("/api/user/email",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:He})}),Wr=await ur.json();ur.ok?(y(Mr=>({...Mr,email:Wr.email})),pe(!1),mt({type:"success",text:"Email updated!"}),setTimeout(()=>mt(null),3e3)):mt({type:"error",text:Wr.error||"Failed to update email"})}catch{mt({type:"error",text:"Error updating email"})}finally{ot(!1)}},_t=(ys=_.oauth_providers)==null?void 0:ys.includes("tidal"),$t=(Ar=_.oauth_providers)==null?void 0:Ar.includes("google"),Yt=!_t,gt=!$t,Wt=()=>{if(Ot.current){try{Ot.current.stop()}catch{}Ot.current=null}ar(!1)},ir=async()=>{if(Ft){Wt();return}try{xt.current||(xt.current=new(window.AudioContext||window.webkitAudioContext),Xt.current=xt.current.createGain(),Xt.current.connect(xt.current.destination)),xt.current.state==="suspended"&&await xt.current.resume(),Xt.current.gain.value=Et/11*3;const ft=await(await fetch("/static/sound/timesUp.mp3")).arrayBuffer(),ur=await xt.current.decodeAudioData(ft);Wt(),Ot.current=xt.current.createBufferSource(),Ot.current.buffer=ur,Ot.current.connect(Xt.current),Ot.current.onended=()=>{ar(!1),Ot.current=null},Ot.current.start(),ar(!0)}catch(He){console.error("Error playing test sound:",He),ar(!1)}},Pn=()=>{Wt(),localStorage.setItem("gpra_timer_volume",Et.toString()),Nt({type:"success",text:"Volume saved!"}),setTimeout(()=>Nt(null),2e3)};return U.useEffect(()=>()=>{Wt(),xt.current&&xt.current.close()},[]),U.useEffect(()=>{er.timerVolume&&Wt()},[er.timerVolume]),U.useEffect(()=>{Xt.current&&Ft&&(Xt.current.gain.value=Et/11*3)},[Et,Ft]),n.jsxs("div",{className:"max-w-7xl mx-auto py-8 px-4",children:[n.jsx("h1",{className:"text-3xl font-bold mb-6 text-gray-100",children:"Account Settings"}),n.jsxs("div",{className:"flex gap-2 mb-4 md:hidden",children:[n.jsx(Be,{variant:Lt==="settings"?"default":"outline",onClick:()=>zt("settings"),className:Lt==="settings"?"bg-orange-600":"bg-gray-700 border-gray-600","data-ph-capture-attribute-button":"mobile-view-settings",children:"Settings"}),n.jsx(Be,{variant:Lt==="subscription"?"default":"outline",onClick:()=>zt("subscription"),className:Lt==="subscription"?"bg-orange-600":"bg-gray-700 border-gray-600","data-ph-capture-attribute-button":"mobile-view-subscription",children:"Subscription"})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:`space-y-6 md:block ${Lt==="settings"?"":"hidden"}`,children:[n.jsxs(on,{className:"bg-gray-800 border-gray-700",children:[n.jsx(_n,{className:"cursor-pointer select-none",onClick:()=>Kr("overview"),"data-ph-capture-attribute-toggle":"settings-overview-card",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(ln,{className:"text-gray-100",children:_.username||"Loading..."}),n.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-sm font-medium ${En(_.tier)}`,children:Yr(_.tier)}),n.jsxs("span",{className:`text-sm font-medium ${lt(A,E)}`,children:[A," / ",E===1/0?"âˆž":E," routines"]})]}),er.overview?n.jsx(us,{className:"w-5 h-5 text-gray-400"}):n.jsx(Kn,{className:"w-5 h-5 text-gray-400"})]})}),!er.overview&&n.jsx(cn,{className:"pt-0",children:n.jsx("div",{className:"flex items-start gap-6 flex-wrap",children:n.jsxs("div",{className:"flex-1 min-w-[200px] space-y-3",children:[n.jsxs("div",{children:[z?n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Rr,{value:ce,onChange:He=>Le(He.target.value),className:"bg-gray-900 border-gray-600 text-gray-100 text-lg font-bold h-9 max-w-[200px]",placeholder:"Username",disabled:Ve,onKeyDown:He=>{He.key==="Enter"&&!He.shiftKey&&tt(),He.key==="Escape"&&at()},autoFocus:!0}),n.jsx(Be,{size:"sm",onClick:tt,disabled:Ve,className:"bg-green-600 hover:bg-green-700 h-8 px-2",children:Ve?n.jsx(Hr,{className:"w-4 h-4 animate-spin"}):n.jsx(Nn,{className:"w-4 h-4"})}),n.jsx(Be,{size:"sm",variant:"outline",onClick:at,disabled:Ve,className:"bg-gray-700 border-gray-600 h-8 px-2",children:n.jsx(Gr,{className:"w-4 h-4"})})]}):n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("h2",{className:"text-xl font-bold text-gray-100",children:_.username||"Loading..."}),Yt&&n.jsx("button",{onClick:Qe,className:"text-gray-400 hover:text-gray-200 p-1",title:"Edit username","aria-label":"Edit username","data-ph-capture-attribute-button":"edit-username",children:n.jsx(po,{className:"w-4 h-4","aria-hidden":"true"})})]}),!Yt&&!z&&n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"You log in with your Tidal account, so you can't change your username here."}),yt&&n.jsx("p",{className:`text-xs mt-1 ${yt.type==="success"?"text-green-400":"text-red-400"}`,children:yt.text})]}),n.jsxs("div",{children:[ue?n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Rr,{type:"email",value:Ie,onChange:He=>Te(He.target.value),className:"bg-gray-900 border-gray-600 text-gray-100 text-sm h-8 max-w-[250px]",placeholder:"Email",disabled:st,onKeyDown:He=>{He.key==="Enter"&&!He.shiftKey&&At(),He.key==="Escape"&&it()},autoFocus:!0}),n.jsx(Be,{size:"sm",onClick:At,disabled:st,className:"bg-green-600 hover:bg-green-700 h-8 px-2",children:st?n.jsx(Hr,{className:"w-4 h-4 animate-spin"}):n.jsx(Nn,{className:"w-4 h-4"})}),n.jsx(Be,{size:"sm",variant:"outline",onClick:it,disabled:st,className:"bg-gray-700 border-gray-600 h-8 px-2",children:n.jsx(Gr,{className:"w-4 h-4"})})]}):n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("p",{className:"text-sm text-gray-400",children:_.email||"Loading..."}),gt&&n.jsx("button",{onClick:rt,className:"text-gray-400 hover:text-gray-200 p-1",title:"Edit email","aria-label":"Edit email","data-ph-capture-attribute-button":"edit-email",children:n.jsx(po,{className:"w-4 h-4","aria-hidden":"true"})})]}),!gt&&!ue&&n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"You log in with your Google account, so you can't change your email address here."}),_t&&gt&&!ue&&n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Add your real email address to get reminders if you haven't used the account for 90 days."}),Vt&&n.jsx("p",{className:`text-xs mt-1 ${Vt.type==="success"?"text-green-400":"text-red-400"}`,children:Vt.text})]}),_.oauth_providers&&_.oauth_providers.includes("tidal")&&n.jsx("div",{className:"flex gap-2 flex-wrap",children:n.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-xs bg-gray-700 text-gray-300 rounded border border-gray-600",children:[n.jsx("img",{src:"/static/images/tidal-logo.png",alt:"Tidal",className:"w-4 h-4 rounded"}),"Tidal"]})})]})})})]}),n.jsxs(on,{className:"bg-gray-800 border-gray-700",children:[n.jsx(_n,{className:"cursor-pointer select-none",onClick:()=>Kr("timerVolume"),"data-ph-capture-attribute-toggle":"settings-timer-volume-card",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx(ln,{className:"text-gray-100",children:"Time's up sound level"}),n.jsx(Fs,{className:"text-gray-400",children:"Set the volume for the timer completion sound"})]}),er.timerVolume?n.jsx(us,{className:"w-5 h-5 text-gray-400"}):n.jsx(Kn,{className:"w-5 h-5 text-gray-400"})]})}),!er.timerVolume&&n.jsxs(cn,{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs(Wn,{htmlFor:"timer-volume",className:"text-gray-200 flex items-center gap-2",children:[n.jsx(F0,{className:"w-4 h-4"}),"Volume level"]}),n.jsx("span",{className:"text-sm font-mono text-orange-400 bg-gray-900 px-2 py-1 rounded",children:Et.toFixed(1)})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:"text-xs text-gray-500",children:"0"}),n.jsx("input",{id:"timer-volume",type:"range",min:"0",max:"11",step:"0.1",value:Et,onChange:He=>wt(parseFloat(He.target.value)),className:"flex-1 h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-orange-500"}),n.jsx("span",{className:"text-xs text-gray-500",children:"11"})]}),n.jsx("p",{className:"text-xs text-gray-500 italic",children:"These go to eleven. ðŸŽ¸"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Be,{onClick:ir,variant:"outline",size:"sm",className:`bg-gray-700 hover:bg-gray-600 border-gray-600 ${Ft?"ring-2 ring-orange-500":""}`,children:Ft?n.jsxs(n.Fragment,{children:[n.jsx(L0,{className:"w-4 h-4 mr-2"}),"Stop"]}):n.jsxs(n.Fragment,{children:[n.jsx(Md,{className:"w-4 h-4 mr-2"}),"Test sound"]})}),n.jsx("span",{className:"text-xs text-gray-400",children:Ft?"Click to stop":"Preview at current level"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs(Be,{onClick:Pn,className:"bg-orange-600 hover:bg-orange-700","data-ph-capture-attribute-button":"save-timer-volume",children:[n.jsx(Nn,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Save"]}),Kt&&n.jsx("span",{className:`text-sm ${Kt.type==="success"?"text-green-400":"text-red-400"}`,children:Kt.text})]})]})]}),n.jsxs(on,{className:"bg-gray-800 border-gray-700",children:[n.jsx(_n,{className:"cursor-pointer select-none",onClick:()=>Kr("apiKey"),"data-tour":"api-key-card-header","data-ph-capture-attribute-toggle":"settings-api-key-card",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("div",{children:n.jsx(ln,{className:"text-gray-100",children:"Anthropic API key"})}),er.apiKey?n.jsx(us,{className:"w-5 h-5 text-gray-400"}):n.jsx(Kn,{className:"w-5 h-5 text-gray-400"})]})}),!er.apiKey&&n.jsxs(cn,{className:"space-y-4",children:[n.jsxs("div",{className:"bg-blue-900/30 border border-blue-700 rounded-md p-4",children:[n.jsx("h3",{className:"text-sm font-semibold text-blue-300 mb-2",children:"About API keys"}),n.jsxs("ul",{className:"text-sm text-gray-300 space-y-1 list-disc list-inside",children:[n.jsxs("li",{children:[n.jsx("strong",{children:"Free/Basic tiers:"})," Provide your own API key to autocreate chord charts"]}),n.jsxs("li",{children:[n.jsx("strong",{children:"The Goods+ tiers:"})," Optional. Autocreated chord charts already included, but you can use your own key if you're hitting rate limits"]}),n.jsx("li",{children:"Your key is encrypted and stored securely"}),n.jsxs("li",{children:["Get your API key from"," ",n.jsxs("a",{href:"https://console.anthropic.com/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 inline-flex items-center gap-1",children:["Anthropic Console",n.jsx(kh,{className:"w-3 h-3"})]})]})]})]}),e&&n.jsxs(hs,{className:"bg-green-900/30 border-green-700",children:[n.jsx(Nn,{className:"h-4 w-4 text-green-400"}),n.jsxs(fs,{className:"text-gray-300",children:["API key configured",s&&n.jsxs("span",{className:"text-gray-400 ml-2",children:["(updated ",new Date(s).toLocaleDateString(),")"]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Wn,{htmlFor:"api-key",className:"text-gray-200",children:e?"Update API key":"Paste API key"}),n.jsxs("div",{className:"flex gap-2","data-tour":"api-key-input",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(Rr,{id:"api-key",type:c?"text":"password",value:t,onChange:He=>{r(He.target.value),x(null),u(null)},placeholder:"sk-ant-api03-...",className:"bg-gray-900 border-gray-600 text-gray-100 pr-10",disabled:d||p}),n.jsx("button",{type:"button",onClick:()=>o(!c),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-300",disabled:d||p,"aria-label":c?"Hide API key":"Show API key","data-ph-capture-attribute-button":"toggle-api-key-visibility",children:c?n.jsx(zo,{className:"w-4 h-4","aria-hidden":"true"}):n.jsx(qo,{className:"w-4 h-4","aria-hidden":"true"})})]}),n.jsx(Be,{onClick:pn,disabled:!t.trim()||d||p,variant:"outline",className:"bg-gray-700 hover:bg-gray-600 border-gray-600","data-ph-capture-attribute-button":"validate-api-key",children:p?n.jsx(Hr,{className:"w-4 h-4 animate-spin","aria-hidden":"true"}):"Validate"})]})]}),w!==null&&n.jsxs(hs,{className:w?"bg-green-900/30 border-green-700":"bg-red-900/30 border-red-700",children:[w?n.jsx(Nn,{className:"h-4 w-4 text-green-400"}):n.jsx(Gr,{className:"h-4 w-4 text-red-400"}),n.jsx(fs,{className:"text-gray-300",children:w?"API key is valid!":(m==null?void 0:m.text)||"Invalid API key"})]}),m&&w===null&&n.jsxs(hs,{className:m.type==="success"?"bg-green-900/30 border-green-700":"bg-red-900/30 border-red-700",children:[m.type==="success"?n.jsx(Nn,{className:"h-4 w-4 text-green-400"}):n.jsx(Gr,{className:"h-4 w-4 text-red-400"}),n.jsx(fs,{className:"text-gray-300",children:m.text})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx(Be,{onClick:wn,disabled:!t.trim()||d||p,className:"bg-orange-600 hover:bg-orange-700 flex-1","data-ph-capture-attribute-button":"save-api-key",children:d?n.jsxs(n.Fragment,{children:[n.jsx(Hr,{className:"w-4 h-4 mr-2 animate-spin","aria-hidden":"true"}),"Saving..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Nn,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Save API key"]})}),e&&n.jsx(Be,{onClick:Vr,disabled:d,variant:"destructive",className:"bg-red-900 hover:bg-red-800","aria-label":"Delete API key","data-ph-capture-attribute-button":"delete-api-key",children:n.jsx(Eh,{className:"w-4 h-4","aria-hidden":"true"})})]})]})]}),n.jsxs(on,{className:"bg-gray-800 border-gray-700",children:[n.jsx(_n,{className:"cursor-pointer select-none",onClick:()=>Kr("practiceData"),"data-ph-capture-attribute-toggle":"settings-practice-data-card",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx(ln,{className:"text-gray-100",children:"Download your data"}),n.jsx(Fs,{className:"text-gray-400",children:"Export your practice data, items, routines, and chord charts"})]}),er.practiceData?n.jsx(us,{className:"w-5 h-5 text-gray-400"}):n.jsx(Kn,{className:"w-5 h-5 text-gray-400"})]})}),!er.practiceData&&n.jsxs(cn,{className:"space-y-6",children:[C&&n.jsxs(hs,{className:"bg-red-900/30 border-red-700",children:[n.jsx(Gr,{className:"h-4 w-4 text-red-400"}),n.jsx(fs,{className:"text-gray-300",children:C})]}),X&&n.jsx(hs,{className:"bg-orange-900/30 border-orange-700",children:n.jsxs(fs,{className:"text-gray-300",children:["You have practice data that will be deleted in ",H," days. Download it to keep your records!",n.jsxs("div",{className:"flex gap-2 mt-3 flex-wrap",children:[n.jsx(Be,{onClick:()=>gr("csv"),size:"sm",className:"bg-orange-600 hover:bg-orange-700",children:"Download now"}),n.jsx(Be,{onClick:()=>tn(1),variant:"outline",size:"sm",className:"border-gray-600",children:"Remind me tomorrow"}),n.jsx(Be,{onClick:()=>tn(90),variant:"outline",size:"sm",className:"border-gray-600",children:"Don't care"})]})]})}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("h3",{className:"text-sm font-medium text-gray-200",children:"Practice history (last 90 days)"}),n.jsxs("div",{className:"flex gap-2 flex-wrap",children:[n.jsxs(Be,{onClick:()=>gr("csv"),disabled:Y,size:"sm",className:"bg-orange-600 hover:bg-orange-700","data-ph-capture-attribute-button":"download-practice-csv",children:[Y?n.jsx(Hr,{className:"w-4 h-4 mr-2 animate-spin"}):n.jsx(Ks,{className:"w-4 h-4 mr-2"}),"CSV"]}),n.jsxs(Be,{onClick:()=>gr("json"),disabled:Y,size:"sm",variant:"outline",className:"bg-gray-700 hover:bg-gray-600 border-gray-600","data-ph-capture-attribute-button":"download-practice-json",children:[Y?n.jsx(Hr,{className:"w-4 h-4 mr-2 animate-spin"}):n.jsx(Ks,{className:"w-4 h-4 mr-2"}),"JSON"]})]}),n.jsx("p",{className:"text-xs text-gray-500",children:"Practice data is automatically deleted after 90 days."})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("h3",{className:"text-sm font-medium text-gray-200",children:"All practice items"}),n.jsxs("div",{className:"flex gap-2 flex-wrap",children:[n.jsxs(Be,{onClick:()=>Cr("csv"),disabled:S,size:"sm",className:"bg-orange-600 hover:bg-orange-700","data-ph-capture-attribute-button":"download-items-csv",children:[S?n.jsx(Hr,{className:"w-4 h-4 mr-2 animate-spin"}):n.jsx(Ks,{className:"w-4 h-4 mr-2"}),"CSV"]}),n.jsxs(Be,{onClick:()=>Cr("json"),disabled:S,size:"sm",variant:"outline",className:"bg-gray-700 hover:bg-gray-600 border-gray-600","data-ph-capture-attribute-button":"download-items-json",children:[S?n.jsx(Hr,{className:"w-4 h-4 mr-2 animate-spin"}):n.jsx(Ks,{className:"w-4 h-4 mr-2"}),"JSON"]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("h3",{className:"text-sm font-medium text-gray-200",children:"All routines"}),n.jsxs("div",{className:"flex gap-2 flex-wrap",children:[n.jsxs(Be,{onClick:()=>dr("csv"),disabled:N,size:"sm",className:"bg-orange-600 hover:bg-orange-700","data-ph-capture-attribute-button":"download-routines-csv",children:[N?n.jsx(Hr,{className:"w-4 h-4 mr-2 animate-spin"}):n.jsx(Ks,{className:"w-4 h-4 mr-2"}),"CSV"]}),n.jsxs(Be,{onClick:()=>dr("json"),disabled:N,size:"sm",variant:"outline",className:"bg-gray-700 hover:bg-gray-600 border-gray-600","data-ph-capture-attribute-button":"download-routines-json",children:[N?n.jsx(Hr,{className:"w-4 h-4 mr-2 animate-spin"}):n.jsx(Ks,{className:"w-4 h-4 mr-2"}),"JSON"]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("h3",{className:"text-sm font-medium text-gray-200",children:"All chord charts"}),n.jsxs("div",{className:"flex gap-2 flex-wrap",children:[n.jsxs(Be,{onClick:wr,disabled:oe,size:"sm",className:"bg-orange-600 hover:bg-orange-700","data-ph-capture-attribute-button":"download-chords-pdf",children:[oe?n.jsx(Hr,{className:"w-4 h-4 mr-2 animate-spin"}):n.jsx(Ks,{className:"w-4 h-4 mr-2"}),"PDF"]}),n.jsxs(Be,{onClick:es,disabled:ve,size:"sm",variant:"outline",className:"bg-gray-700 hover:bg-gray-600 border-gray-600","data-ph-capture-attribute-button":"download-chords-json",children:[ve?n.jsx(Hr,{className:"w-4 h-4 mr-2 animate-spin"}):n.jsx(Ks,{className:"w-4 h-4 mr-2"}),"JSON"]})]})]}),n.jsx("div",{className:"border-t border-gray-700 pt-4",children:n.jsxs("div",{className:"space-y-2",children:[n.jsx("h3",{className:"text-sm font-medium text-gray-200",children:"Download all your data"}),n.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"Get everything in one ZIP file: items, routines, chord charts, and practice history."}),n.jsx(Be,{onClick:Sn,disabled:Ae,className:"bg-orange-600 hover:bg-orange-700 w-full sm:w-auto","data-ph-capture-attribute-button":"download-all-zip",children:Ae?n.jsxs(n.Fragment,{children:[n.jsx(Hr,{className:"w-4 h-4 mr-2 animate-spin"}),"Preparing ZIP..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Ks,{className:"w-4 h-4 mr-2"}),"Download ZIP"]})})]})})]})]}),n.jsxs(on,{className:"bg-gray-800 border-gray-700",children:[n.jsx(_n,{className:"cursor-pointer select-none",onClick:()=>Kr("changePassword"),"data-ph-capture-attribute-toggle":"settings-change-password-card",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx(ln,{className:"text-gray-100",children:"Change password"}),n.jsx(Fs,{className:"text-gray-400",children:"Update your account password"})]}),er.changePassword?n.jsx(us,{className:"w-5 h-5 text-gray-400"}):n.jsx(Kn,{className:"w-5 h-5 text-gray-400"})]})}),!er.changePassword&&n.jsx(cn,{children:$t||_t?n.jsx("p",{className:"text-sm text-gray-400",children:$t?"You log in with Google, so you have no password here to change.":"You log in with Tidal, so you have no password here to change."}):n.jsxs("form",{onSubmit:xe,className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Wn,{htmlFor:"current-password",className:"text-gray-200",children:"Current password"}),n.jsxs("div",{className:"relative",children:[n.jsx(Rr,{id:"current-password",type:Re.current?"text":"password",value:Z,onChange:He=>Q(He.target.value),className:"bg-gray-900 border-gray-600 text-gray-100 pr-10",disabled:Je}),n.jsx("button",{type:"button",onClick:()=>Me(He=>({...He,current:!He.current})),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-300",disabled:Je,children:Re.current?n.jsx(zo,{className:"w-4 h-4"}):n.jsx(qo,{className:"w-4 h-4"})})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Wn,{htmlFor:"new-password",className:"text-gray-200",children:"New password"}),n.jsxs("div",{className:"relative",children:[n.jsx(Rr,{id:"new-password",type:Re.new?"text":"password",value:fe,onChange:He=>we(He.target.value),className:"bg-gray-900 border-gray-600 text-gray-100 pr-10",disabled:Je}),n.jsx("button",{type:"button",onClick:()=>Me(He=>({...He,new:!He.new})),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-300",disabled:Je,children:Re.new?n.jsx(zo,{className:"w-4 h-4"}):n.jsx(qo,{className:"w-4 h-4"})})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Wn,{htmlFor:"confirm-password",className:"text-gray-200",children:"Confirm new password"}),n.jsxs("div",{className:"relative",children:[n.jsx(Rr,{id:"confirm-password",type:Re.confirm?"text":"password",value:Se,onChange:He=>Ce(He.target.value),className:"bg-gray-900 border-gray-600 text-gray-100 pr-10",disabled:Je}),n.jsx("button",{type:"button",onClick:()=>Me(He=>({...He,confirm:!He.confirm})),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-300",disabled:Je,children:Re.confirm?n.jsx(zo,{className:"w-4 h-4"}):n.jsx(qo,{className:"w-4 h-4"})})]})]}),n.jsxs("div",{className:"bg-blue-900/30 border border-blue-700 rounded-md p-3",children:[n.jsx("h4",{className:"text-sm font-semibold text-blue-300 mb-1",children:"Password requirements:"}),n.jsxs("ul",{className:"text-xs text-gray-300 space-y-0.5 list-disc list-inside",children:[n.jsx("li",{children:"At least 14 characters long"}),n.jsx("li",{children:"At least one uppercase letter"}),n.jsx("li",{children:"At least one lowercase letter"}),n.jsx("li",{children:"At least one number"}),n.jsx("li",{children:"At least one symbol or punctuation character"})]})]}),j&&n.jsxs(hs,{className:j.type==="success"?"bg-green-900/30 border-green-700":"bg-red-900/30 border-red-700",children:[j.type==="success"?n.jsx(Nn,{className:"h-4 w-4 text-green-400"}):n.jsx(Gr,{className:"h-4 w-4 text-red-400"}),n.jsx(fs,{className:"text-gray-300",children:j.text})]}),n.jsx(Be,{type:"submit",disabled:Je||!Z||!fe||!Se,className:"bg-orange-600 hover:bg-orange-700 w-full",children:Je?n.jsxs(n.Fragment,{children:[n.jsx(Hr,{className:"w-4 h-4 mr-2 animate-spin"}),"Changing password..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Nn,{className:"w-4 h-4 mr-2"}),"Change password"]})})]})})]}),n.jsxs(on,{className:"bg-gray-800 border-gray-700",children:[n.jsx(_n,{className:"cursor-pointer select-none",onClick:()=>Kr("analytics"),"data-ph-capture-attribute-toggle":"settings-analytics-card",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx(ln,{className:"text-gray-100",children:"Analytics & privacy"}),n.jsx(Fs,{className:"text-gray-400",children:"Control whether we can collect analytics"})]}),er.analytics?n.jsx(us,{className:"w-5 h-5 text-gray-400"}):n.jsx(Kn,{className:"w-5 h-5 text-gray-400"})]})}),!er.analytics&&n.jsxs(cn,{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-start justify-between gap-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("h3",{className:"text-sm font-medium text-gray-200",children:"Allow analytics tracking"}),n.jsx("span",{className:`text-xs font-semibold px-2 py-0.5 rounded ${V?"bg-green-900/50 text-green-300":"bg-red-900/50 text-red-300"}`,children:V?"Allowed":"Disallowed"})]}),n.jsx("p",{className:"text-xs text-gray-400",children:"Help us improve GPRA by allowing usage analytics via PostHog cookies. (We'll never sell or share your data.)"})]}),n.jsx("button",{onClick:We,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 ${V?"bg-green-600 focus:ring-green-500":"bg-red-600 focus:ring-red-500"}`,role:"switch","aria-checked":V,children:n.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${V?"translate-x-6":"translate-x-1"}`})})]}),n.jsx("div",{className:"text-xs text-gray-500 pt-2 border-t border-gray-700",children:n.jsxs("p",{children:["Learn more about how we handle your data in our"," ",n.jsx("a",{href:"/privacy",target:"_blank",rel:"noopener noreferrer",className:"text-orange-400 hover:underline",children:"Privacy Policy"})]})})]})]}),n.jsxs(on,{className:"bg-gray-800 border-gray-700",children:[n.jsx(_n,{className:"cursor-pointer select-none",onClick:()=>Kr("guidedTour"),"data-ph-capture-attribute-toggle":"settings-guided-tour-card",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx(ln,{className:"text-gray-100",children:"Guided tour"}),n.jsx(Fs,{className:"text-gray-400",children:"Take the intro tour again"})]}),er.guidedTour?n.jsx(us,{className:"w-5 h-5 text-gray-400"}):n.jsx(Kn,{className:"w-5 h-5 text-gray-400"})]})}),!er.guidedTour&&n.jsx(cn,{children:n.jsxs(Be,{onClick:kn,className:"bg-orange-600 hover:bg-orange-700 w-full","data-ph-capture-attribute-button":"restart-guided-tour",children:[n.jsx(Md,{className:"w-4 h-4 mr-2","aria-hidden":"true"}),"Restart tour"]})})]}),n.jsxs(on,{className:"bg-gray-800 border-gray-700 border-red-900/50",children:[n.jsx(_n,{className:"cursor-pointer select-none",onClick:()=>Kr("dangerZone"),"data-ph-capture-attribute-toggle":"settings-danger-zone-card",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx(ln,{className:"text-red-400",children:"Danger zone"}),n.jsx(Fs,{className:"text-gray-400",children:"Pause your payments, or delete your account and all your data"})]}),er.dangerZone?n.jsx(us,{className:"w-5 h-5 text-gray-400"}):n.jsx(Kn,{className:"w-5 h-5 text-gray-400"})]})}),!er.dangerZone&&n.jsx(cn,{className:"p-0",children:n.jsx(Ym,{userTier:_.tier,unpluggedMode:_.unplugged_mode})})]})]}),n.jsx("div",{id:"subscription-card",className:`space-y-6 md:block ${Lt==="subscription"?"":"hidden"}`,children:n.jsx(Vm,{currentTier:_.tier})})]})]})};let Ic={},lp;function xc(t={}){Ic={animate:!0,allowClose:!0,overlayClickBehavior:"close",overlayOpacity:.7,smoothScroll:!1,disableActiveInteraction:!1,showProgress:!1,stagePadding:10,stageRadius:5,popoverOffset:10,showButtons:["next","previous","close"],disableButtons:[],overlayColor:"#000",...t}}function kt(t){return t?Ic[t]:Ic}function K2(t){lp=t}function ps(){return lp}let wl={};function tl(t,r){wl[t]=r}function ai(t){var r;(r=wl[t])==null||r.call(wl)}function J2(){wl={}}function rl(t,r,e,a){return(t/=a/2)<1?e/2*t*t+r:-e/2*(--t*(t-2)-1)+r}function cp(t){const r='a[href]:not([disabled]), button:not([disabled]), textarea:not([disabled]), input[type="text"]:not([disabled]), input[type="radio"]:not([disabled]), input[type="checkbox"]:not([disabled]), select:not([disabled])';return t.flatMap(e=>{const a=e.matches(r),s=Array.from(e.querySelectorAll(r));return[...a?[e]:[],...s]}).filter(e=>getComputedStyle(e).pointerEvents!=="none"&&Q2(e))}function dp(t){if(!t||X2(t))return;const r=kt("smoothScroll"),e=t.offsetHeight>window.innerHeight;t.scrollIntoView({behavior:!r||Z2(t)?"auto":"smooth",inline:"center",block:e?"start":"center"})}function Z2(t){if(!t||!t.parentElement)return;const r=t.parentElement;return r.scrollHeight>r.clientHeight}function X2(t){const r=t.getBoundingClientRect();return r.top>=0&&r.left>=0&&r.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&r.right<=(window.innerWidth||document.documentElement.clientWidth)}function Q2(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)}let vl={};function vn(t,r){vl[t]=r}function Rt(t){return t?vl[t]:vl}function dh(){vl={}}function e5(t,r,e,a){let s=Rt("__activeStagePosition");const i=s||e.getBoundingClientRect(),c=a.getBoundingClientRect(),o=rl(t,i.x,c.x-i.x,r),d=rl(t,i.y,c.y-i.y,r),h=rl(t,i.width,c.width-i.width,r),p=rl(t,i.height,c.height-i.height,r);s={x:o,y:d,width:h,height:p},hp(s),vn("__activeStagePosition",s)}function up(t){if(!t)return;const r=t.getBoundingClientRect(),e={x:r.x,y:r.y,width:r.width,height:r.height};vn("__activeStagePosition",e),hp(e)}function t5(){const t=Rt("__activeStagePosition"),r=Rt("__overlaySvg");if(!t)return;if(!r){console.warn("No stage svg found.");return}const e=window.innerWidth,a=window.innerHeight;r.setAttribute("viewBox",`0 0 ${e} ${a}`)}function r5(t){const r=n5(t);document.body.appendChild(r),mp(r,e=>{e.target.tagName==="path"&&ai("overlayClick")}),vn("__overlaySvg",r)}function hp(t){const r=Rt("__overlaySvg");if(!r){r5(t);return}const e=r.firstElementChild;if((e==null?void 0:e.tagName)!=="path")throw new Error("no path element found in stage svg");e.setAttribute("d",fp(t))}function n5(t){const r=window.innerWidth,e=window.innerHeight,a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.classList.add("driver-overlay","driver-overlay-animated"),a.setAttribute("viewBox",`0 0 ${r} ${e}`),a.setAttribute("xmlSpace","preserve"),a.setAttribute("xmlnsXlink","http://www.w3.org/1999/xlink"),a.setAttribute("version","1.1"),a.setAttribute("preserveAspectRatio","xMinYMin slice"),a.style.fillRule="evenodd",a.style.clipRule="evenodd",a.style.strokeLinejoin="round",a.style.strokeMiterlimit="2",a.style.zIndex="10000",a.style.position="fixed",a.style.top="0",a.style.left="0",a.style.width="100%",a.style.height="100%";const s=document.createElementNS("http://www.w3.org/2000/svg","path");return s.setAttribute("d",fp(t)),s.style.fill=kt("overlayColor")||"rgb(0,0,0)",s.style.opacity=`${kt("overlayOpacity")}`,s.style.pointerEvents="auto",s.style.cursor="auto",a.appendChild(s),a}function fp(t){const r=window.innerWidth,e=window.innerHeight,a=kt("stagePadding")||0,s=kt("stageRadius")||0,i=t.width+a*2,c=t.height+a*2,o=Math.min(s,i/2,c/2),d=Math.floor(Math.max(o,0)),h=t.x-a+d,p=t.y-a,b=i-d*2,m=c-d*2;return`M${r},0L0,0L0,${e}L${r},${e}L${r},0Z
    M${h},${p} h${b} a${d},${d} 0 0 1 ${d},${d} v${m} a${d},${d} 0 0 1 -${d},${d} h-${b} a${d},${d} 0 0 1 -${d},-${d} v-${m} a${d},${d} 0 0 1 ${d},-${d} z`}function s5(){const t=Rt("__overlaySvg");t&&t.remove()}function a5(){const t=document.getElementById("driver-dummy-element");if(t)return t;let r=document.createElement("div");return r.id="driver-dummy-element",r.style.width="0",r.style.height="0",r.style.pointerEvents="none",r.style.opacity="0",r.style.position="fixed",r.style.top="50%",r.style.left="50%",document.body.appendChild(r),r}function uh(t){const{element:r}=t;let e=typeof r=="function"?r():typeof r=="string"?document.querySelector(r):r;e||(e=a5()),o5(e,t)}function i5(){const t=Rt("__activeElement"),r=Rt("__activeStep");t&&(up(t),t5(),xp(t,r))}function o5(t,r){var e;const a=Date.now(),s=Rt("__activeStep"),i=Rt("__activeElement")||t,c=!i||i===t,o=t.id==="driver-dummy-element",d=i.id==="driver-dummy-element",h=kt("animate"),p=r.onHighlightStarted||kt("onHighlightStarted"),b=(r==null?void 0:r.onHighlighted)||kt("onHighlighted"),m=(s==null?void 0:s.onDeselected)||kt("onDeselected"),u=kt(),w=Rt();!c&&m&&m(d?void 0:i,s,{config:u,state:w,driver:ps()}),p&&p(o?void 0:t,r,{config:u,state:w,driver:ps()});const x=!c&&h;let _=!1;h5(),vn("previousStep",s),vn("previousElement",i),vn("activeStep",r),vn("activeElement",t);const y=()=>{if(Rt("__transitionCallback")!==y)return;const A=Date.now()-a,L=400-A<=400/2;r.popover&&L&&!_&&x&&(hh(t,r),_=!0),kt("animate")&&A<400?e5(A,400,i,t):(up(t),b&&b(o?void 0:t,r,{config:kt(),state:Rt(),driver:ps()}),vn("__transitionCallback",void 0),vn("__previousStep",s),vn("__previousElement",i),vn("__activeStep",r),vn("__activeElement",t)),window.requestAnimationFrame(y)};vn("__transitionCallback",y),window.requestAnimationFrame(y),dp(t),!x&&r.popover&&hh(t,r),i.classList.remove("driver-active-element","driver-no-interaction"),i.removeAttribute("aria-haspopup"),i.removeAttribute("aria-expanded"),i.removeAttribute("aria-controls"),((e=r.disableActiveInteraction)!=null?e:kt("disableActiveInteraction"))&&t.classList.add("driver-no-interaction"),t.classList.add("driver-active-element"),t.setAttribute("aria-haspopup","dialog"),t.setAttribute("aria-expanded","true"),t.setAttribute("aria-controls","driver-popover-content")}function l5(){var t;(t=document.getElementById("driver-dummy-element"))==null||t.remove(),document.querySelectorAll(".driver-active-element").forEach(r=>{r.classList.remove("driver-active-element","driver-no-interaction"),r.removeAttribute("aria-haspopup"),r.removeAttribute("aria-expanded"),r.removeAttribute("aria-controls")})}function xo(){const t=Rt("__resizeTimeout");t&&window.cancelAnimationFrame(t),vn("__resizeTimeout",window.requestAnimationFrame(i5))}function c5(t){var r;if(!Rt("isInitialized")||!(t.key==="Tab"||t.keyCode===9))return;const e=Rt("__activeElement"),a=(r=Rt("popover"))==null?void 0:r.wrapper,s=cp([...a?[a]:[],...e?[e]:[]]),i=s[0],c=s[s.length-1];if(t.preventDefault(),t.shiftKey){const o=s[s.indexOf(document.activeElement)-1]||c;o==null||o.focus()}else{const o=s[s.indexOf(document.activeElement)+1]||i;o==null||o.focus()}}function pp(t){var r;((r=kt("allowKeyboardControl"))==null||r)&&(t.key==="Escape"?ai("escapePress"):t.key==="ArrowRight"?ai("arrowRightPress"):t.key==="ArrowLeft"&&ai("arrowLeftPress"))}function mp(t,r,e){const a=(s,i)=>{const c=s.target;t.contains(c)&&((!e||e(c))&&(s.preventDefault(),s.stopPropagation(),s.stopImmediatePropagation()),i==null||i(s))};document.addEventListener("pointerdown",a,!0),document.addEventListener("mousedown",a,!0),document.addEventListener("pointerup",a,!0),document.addEventListener("mouseup",a,!0),document.addEventListener("click",s=>{a(s,r)},!0)}function d5(){window.addEventListener("keyup",pp,!1),window.addEventListener("keydown",c5,!1),window.addEventListener("resize",xo),window.addEventListener("scroll",xo)}function u5(){window.removeEventListener("keyup",pp),window.removeEventListener("resize",xo),window.removeEventListener("scroll",xo)}function h5(){const t=Rt("popover");t&&(t.wrapper.style.display="none")}function hh(t,r){var e,a;let s=Rt("popover");s&&document.body.removeChild(s.wrapper),s=p5(),document.body.appendChild(s.wrapper);const{title:i,description:c,showButtons:o,disableButtons:d,showProgress:h,nextBtnText:p=kt("nextBtnText")||"Next &rarr;",prevBtnText:b=kt("prevBtnText")||"&larr; Previous",progressText:m=kt("progressText")||"{current} of {total}"}=r.popover||{};s.nextButton.innerHTML=p,s.previousButton.innerHTML=b,s.progress.innerHTML=m,i?(s.title.innerHTML=i,s.title.style.display="block"):s.title.style.display="none",c?(s.description.innerHTML=c,s.description.style.display="block"):s.description.style.display="none";const u=o||kt("showButtons"),w=h||kt("showProgress")||!1,x=(u==null?void 0:u.includes("next"))||(u==null?void 0:u.includes("previous"))||w;s.closeButton.style.display=u.includes("close")?"block":"none",x?(s.footer.style.display="flex",s.progress.style.display=w?"block":"none",s.nextButton.style.display=u.includes("next")?"block":"none",s.previousButton.style.display=u.includes("previous")?"block":"none"):s.footer.style.display="none";const _=d||kt("disableButtons")||[];_!=null&&_.includes("next")&&(s.nextButton.disabled=!0,s.nextButton.classList.add("driver-popover-btn-disabled")),_!=null&&_.includes("previous")&&(s.previousButton.disabled=!0,s.previousButton.classList.add("driver-popover-btn-disabled")),_!=null&&_.includes("close")&&(s.closeButton.disabled=!0,s.closeButton.classList.add("driver-popover-btn-disabled"));const y=s.wrapper;y.style.display="block",y.style.left="",y.style.top="",y.style.bottom="",y.style.right="",y.id="driver-popover-content",y.setAttribute("role","dialog"),y.setAttribute("aria-labelledby","driver-popover-title"),y.setAttribute("aria-describedby","driver-popover-description");const A=s.arrow;A.className="driver-popover-arrow";const L=((e=r.popover)==null?void 0:e.popoverClass)||kt("popoverClass")||"";y.className=`driver-popover ${L}`.trim(),mp(s.wrapper,K=>{var H,P,Y;const I=K.target,S=((H=r.popover)==null?void 0:H.onNextClick)||kt("onNextClick"),R=((P=r.popover)==null?void 0:P.onPrevClick)||kt("onPrevClick"),N=((Y=r.popover)==null?void 0:Y.onCloseClick)||kt("onCloseClick");if(I.closest(".driver-popover-next-btn"))return S?S(t,r,{config:kt(),state:Rt(),driver:ps()}):ai("nextClick");if(I.closest(".driver-popover-prev-btn"))return R?R(t,r,{config:kt(),state:Rt(),driver:ps()}):ai("prevClick");if(I.closest(".driver-popover-close-btn"))return N?N(t,r,{config:kt(),state:Rt(),driver:ps()}):ai("closeClick")},K=>!(s!=null&&s.description.contains(K))&&!(s!=null&&s.title.contains(K))&&typeof K.className=="string"&&K.className.includes("driver-popover")),vn("popover",s);const E=((a=r.popover)==null?void 0:a.onPopoverRender)||kt("onPopoverRender");E&&E(s,{config:kt(),state:Rt(),driver:ps()}),xp(t,r),dp(y);const O=t.classList.contains("driver-dummy-element"),X=cp([y,...O?[]:[t]]);X.length>0&&X[0].focus()}function gp(){const t=Rt("popover");if(!(t!=null&&t.wrapper))return;const r=t.wrapper.getBoundingClientRect(),e=kt("stagePadding")||0,a=kt("popoverOffset")||0;return{width:r.width+e+a,height:r.height+e+a,realWidth:r.width,realHeight:r.height}}function fh(t,r){const{elementDimensions:e,popoverDimensions:a,popoverPadding:s,popoverArrowDimensions:i}=r;return t==="start"?Math.max(Math.min(e.top-s,window.innerHeight-a.realHeight-i.width),i.width):t==="end"?Math.max(Math.min(e.top-(a==null?void 0:a.realHeight)+e.height+s,window.innerHeight-(a==null?void 0:a.realHeight)-i.width),i.width):t==="center"?Math.max(Math.min(e.top+e.height/2-(a==null?void 0:a.realHeight)/2,window.innerHeight-(a==null?void 0:a.realHeight)-i.width),i.width):0}function ph(t,r){const{elementDimensions:e,popoverDimensions:a,popoverPadding:s,popoverArrowDimensions:i}=r;return t==="start"?Math.max(Math.min(e.left-s,window.innerWidth-a.realWidth-i.width),i.width):t==="end"?Math.max(Math.min(e.left-(a==null?void 0:a.realWidth)+e.width+s,window.innerWidth-(a==null?void 0:a.realWidth)-i.width),i.width):t==="center"?Math.max(Math.min(e.left+e.width/2-(a==null?void 0:a.realWidth)/2,window.innerWidth-(a==null?void 0:a.realWidth)-i.width),i.width):0}function xp(t,r){const e=Rt("popover");if(!e)return;const{align:a="start",side:s="left"}=(r==null?void 0:r.popover)||{},i=a,c=t.id==="driver-dummy-element"?"over":s,o=kt("stagePadding")||0,d=gp(),h=e.arrow.getBoundingClientRect(),p=t.getBoundingClientRect(),b=p.top-d.height;let m=b>=0;const u=window.innerHeight-(p.bottom+d.height);let w=u>=0;const x=p.left-d.width;let _=x>=0;const y=window.innerWidth-(p.right+d.width);let A=y>=0;const L=!m&&!w&&!_&&!A;let E=c;if(c==="top"&&m?A=_=w=!1:c==="bottom"&&w?A=_=m=!1:c==="left"&&_?A=m=w=!1:c==="right"&&A&&(_=m=w=!1),c==="over"){const O=window.innerWidth/2-d.realWidth/2,X=window.innerHeight/2-d.realHeight/2;e.wrapper.style.left=`${O}px`,e.wrapper.style.right="auto",e.wrapper.style.top=`${X}px`,e.wrapper.style.bottom="auto"}else if(L){const O=window.innerWidth/2-(d==null?void 0:d.realWidth)/2,X=10;e.wrapper.style.left=`${O}px`,e.wrapper.style.right="auto",e.wrapper.style.bottom=`${X}px`,e.wrapper.style.top="auto"}else if(_){const O=Math.min(x,window.innerWidth-(d==null?void 0:d.realWidth)-h.width),X=fh(i,{elementDimensions:p,popoverDimensions:d,popoverPadding:o,popoverArrowDimensions:h});e.wrapper.style.left=`${O}px`,e.wrapper.style.top=`${X}px`,e.wrapper.style.bottom="auto",e.wrapper.style.right="auto",E="left"}else if(A){const O=Math.min(y,window.innerWidth-(d==null?void 0:d.realWidth)-h.width),X=fh(i,{elementDimensions:p,popoverDimensions:d,popoverPadding:o,popoverArrowDimensions:h});e.wrapper.style.right=`${O}px`,e.wrapper.style.top=`${X}px`,e.wrapper.style.bottom="auto",e.wrapper.style.left="auto",E="right"}else if(m){const O=Math.min(b,window.innerHeight-d.realHeight-h.width);let X=ph(i,{elementDimensions:p,popoverDimensions:d,popoverPadding:o,popoverArrowDimensions:h});e.wrapper.style.top=`${O}px`,e.wrapper.style.left=`${X}px`,e.wrapper.style.bottom="auto",e.wrapper.style.right="auto",E="top"}else if(w){const O=Math.min(u,window.innerHeight-(d==null?void 0:d.realHeight)-h.width);let X=ph(i,{elementDimensions:p,popoverDimensions:d,popoverPadding:o,popoverArrowDimensions:h});e.wrapper.style.left=`${X}px`,e.wrapper.style.bottom=`${O}px`,e.wrapper.style.top="auto",e.wrapper.style.right="auto",E="bottom"}L?e.arrow.classList.add("driver-popover-arrow-none"):f5(i,E,t)}function f5(t,r,e){const a=Rt("popover");if(!a)return;const s=e.getBoundingClientRect(),i=gp(),c=a.arrow,o=i.width,d=window.innerWidth,h=s.width,p=s.left,b=i.height,m=window.innerHeight,u=s.top,w=s.height;c.className="driver-popover-arrow";let x=r,_=t;if(r==="top"?(p+h<=0?(x="right",_="end"):p+h-o<=0&&(x="top",_="start"),p>=d?(x="left",_="end"):p+o>=d&&(x="top",_="end")):r==="bottom"?(p+h<=0?(x="right",_="start"):p+h-o<=0&&(x="bottom",_="start"),p>=d?(x="left",_="start"):p+o>=d&&(x="bottom",_="end")):r==="left"?(u+w<=0?(x="bottom",_="end"):u+w-b<=0&&(x="left",_="start"),u>=m?(x="top",_="end"):u+b>=m&&(x="left",_="end")):r==="right"&&(u+w<=0?(x="bottom",_="start"):u+w-b<=0&&(x="right",_="start"),u>=m?(x="top",_="start"):u+b>=m&&(x="right",_="end")),!x)c.classList.add("driver-popover-arrow-none");else{c.classList.add(`driver-popover-arrow-side-${x}`),c.classList.add(`driver-popover-arrow-align-${_}`);const y=e.getBoundingClientRect(),A=c.getBoundingClientRect(),L=kt("stagePadding")||0,E=y.left-L<window.innerWidth&&y.right+L>0&&y.top-L<window.innerHeight&&y.bottom+L>0;r==="bottom"&&E&&(A.x>y.x&&A.x+A.width<y.x+y.width?a.wrapper.style.transform="translateY(0)":(c.classList.remove(`driver-popover-arrow-align-${_}`),c.classList.add("driver-popover-arrow-none"),a.wrapper.style.transform=`translateY(-${L/2}px)`))}}function p5(){const t=document.createElement("div");t.classList.add("driver-popover");const r=document.createElement("div");r.classList.add("driver-popover-arrow");const e=document.createElement("header");e.id="driver-popover-title",e.classList.add("driver-popover-title"),e.style.display="none",e.innerText="Popover Title";const a=document.createElement("div");a.id="driver-popover-description",a.classList.add("driver-popover-description"),a.style.display="none",a.innerText="Popover description is here";const s=document.createElement("button");s.type="button",s.classList.add("driver-popover-close-btn"),s.setAttribute("aria-label","Close"),s.innerHTML="&times;";const i=document.createElement("footer");i.classList.add("driver-popover-footer");const c=document.createElement("span");c.classList.add("driver-popover-progress-text"),c.innerText="";const o=document.createElement("span");o.classList.add("driver-popover-navigation-btns");const d=document.createElement("button");d.type="button",d.classList.add("driver-popover-prev-btn"),d.innerHTML="&larr; Previous";const h=document.createElement("button");return h.type="button",h.classList.add("driver-popover-next-btn"),h.innerHTML="Next &rarr;",o.appendChild(d),o.appendChild(h),i.appendChild(c),i.appendChild(o),t.appendChild(s),t.appendChild(r),t.appendChild(e),t.appendChild(a),t.appendChild(i),{wrapper:t,arrow:r,title:e,description:a,footer:i,previousButton:d,nextButton:h,closeButton:s,footerButtons:o,progress:c}}function m5(){var t;const r=Rt("popover");r&&((t=r.wrapper.parentElement)==null||t.removeChild(r.wrapper))}function g5(t={}){xc(t);function r(){kt("allowClose")&&p()}function e(){const m=kt("overlayClickBehavior");if(kt("allowClose")&&m==="close"){p();return}if(typeof m=="function"){const u=Rt("__activeStep"),w=Rt("__activeElement");m(w,u,{config:kt(),state:Rt(),driver:ps()});return}m==="nextStep"&&a()}function a(){const m=Rt("activeIndex"),u=kt("steps")||[];if(typeof m>"u")return;const w=m+1;u[w]?h(w):p()}function s(){const m=Rt("activeIndex"),u=kt("steps")||[];if(typeof m>"u")return;const w=m-1;u[w]?h(w):p()}function i(m){(kt("steps")||[])[m]?h(m):p()}function c(){var m;if(Rt("__transitionCallback"))return;const u=Rt("activeIndex"),w=Rt("__activeStep"),x=Rt("__activeElement");if(typeof u>"u"||typeof w>"u"||typeof Rt("activeIndex")>"u")return;const _=((m=w.popover)==null?void 0:m.onPrevClick)||kt("onPrevClick");if(_)return _(x,w,{config:kt(),state:Rt(),driver:ps()});s()}function o(){var m;if(Rt("__transitionCallback"))return;const u=Rt("activeIndex"),w=Rt("__activeStep"),x=Rt("__activeElement");if(typeof u>"u"||typeof w>"u")return;const _=((m=w.popover)==null?void 0:m.onNextClick)||kt("onNextClick");if(_)return _(x,w,{config:kt(),state:Rt(),driver:ps()});a()}function d(){Rt("isInitialized")||(vn("isInitialized",!0),document.body.classList.add("driver-active",kt("animate")?"driver-fade":"driver-simple"),d5(),tl("overlayClick",e),tl("escapePress",r),tl("arrowLeftPress",c),tl("arrowRightPress",o))}function h(m=0){var u,w,x,_,y,A,L,E;const O=kt("steps");if(!O){console.error("No steps to drive through"),p();return}if(!O[m]){p();return}vn("__activeOnDestroyed",document.activeElement),vn("activeIndex",m);const X=O[m],K=O[m+1],H=O[m-1],P=((u=X.popover)==null?void 0:u.doneBtnText)||kt("doneBtnText")||"Done",Y=kt("allowClose"),I=typeof((w=X.popover)==null?void 0:w.showProgress)<"u"?(x=X.popover)==null?void 0:x.showProgress:kt("showProgress"),S=(((_=X.popover)==null?void 0:_.progressText)||kt("progressText")||"{{current}} of {{total}}").replace("{{current}}",`${m+1}`).replace("{{total}}",`${O.length}`),R=((y=X.popover)==null?void 0:y.showButtons)||kt("showButtons"),N=["next","previous",...Y?["close"]:[]].filter(oe=>!(R!=null&&R.length)||R.includes(oe)),re=((A=X.popover)==null?void 0:A.onNextClick)||kt("onNextClick"),ve=((L=X.popover)==null?void 0:L.onPrevClick)||kt("onPrevClick"),le=((E=X.popover)==null?void 0:E.onCloseClick)||kt("onCloseClick");uh({...X,popover:{showButtons:N,nextBtnText:K?void 0:P,disableButtons:[...H?[]:["previous"]],showProgress:I,progressText:S,onNextClick:re||(()=>{K?h(m+1):p()}),onPrevClick:ve||(()=>{h(m-1)}),onCloseClick:le||(()=>{p()}),...(X==null?void 0:X.popover)||{}}})}function p(m=!0){const u=Rt("__activeElement"),w=Rt("__activeStep"),x=Rt("__activeOnDestroyed"),_=kt("onDestroyStarted");if(m&&_){const L=!u||(u==null?void 0:u.id)==="driver-dummy-element";_(L?void 0:u,w,{config:kt(),state:Rt(),driver:ps()});return}const y=(w==null?void 0:w.onDeselected)||kt("onDeselected"),A=kt("onDestroyed");if(document.body.classList.remove("driver-active","driver-fade","driver-simple"),u5(),m5(),l5(),s5(),J2(),dh(),u&&w){const L=u.id==="driver-dummy-element";y&&y(L?void 0:u,w,{config:kt(),state:Rt(),driver:ps()}),A&&A(L?void 0:u,w,{config:kt(),state:Rt(),driver:ps()})}x&&x.focus()}const b={isActive:()=>Rt("isInitialized")||!1,refresh:xo,drive:(m=0)=>{d(),h(m)},setConfig:xc,setSteps:m=>{dh(),xc({...kt(),steps:m})},getConfig:kt,getState:Rt,getActiveIndex:()=>Rt("activeIndex"),isFirstStep:()=>Rt("activeIndex")===0,isLastStep:()=>{const m=kt("steps")||[],u=Rt("activeIndex");return u!==void 0&&u===m.length-1},getActiveStep:()=>Rt("activeStep"),getActiveElement:()=>Rt("activeElement"),getPreviousElement:()=>Rt("previousElement"),getPreviousStep:()=>Rt("previousStep"),moveNext:a,movePrevious:s,moveTo:i,hasNextStep:()=>{const m=kt("steps")||[],u=Rt("activeIndex");return u!==void 0&&!!m[u+1]},hasPreviousStep:()=>{const m=kt("steps")||[],u=Rt("activeIndex");return u!==void 0&&!!m[u-1]},highlight:m=>{d(),uh({...m,popover:m.popover?{showButtons:[],showProgress:!1,progressText:"",...m.popover}:void 0})},destroy:()=>{p(!1)}};return K2(b),b}const x5=()=>{const{setActivePage:t}=zi();U.useEffect(()=>{(async()=>{try{console.log("[TOUR] Checking tour status...");const s=await fetch("/api/user/preferences/tour-status");if(console.log("[TOUR] API response status:",s.status),!s.ok){console.log("[TOUR] API response not OK, aborting");return}const i=await s.json();console.log("[TOUR] API data:",i);const o=new URLSearchParams(window.location.search).has("show_tour"),d=sessionStorage.getItem("show_tour_after_login")==="true";if(console.log("[TOUR] showTourParam:",o),console.log("[TOUR] showTourAfterLogin:",d),console.log("[TOUR] data.show_tour:",i.show_tour),i.show_tour||o||d){if(console.log("[TOUR] Starting tour!"),d&&sessionStorage.removeItem("show_tour_after_login"),o){const h=window.location.pathname;window.history.replaceState({},"",h)}setTimeout(()=>e(),500)}}catch(s){console.error("Error checking tour status:",s)}})()},[]);const r=async()=>{try{await fetch("/api/user/preferences/tour-complete",{method:"POST",headers:{"Content-Type":"application/json"}})}catch(a){console.error("Error marking tour complete:",a)}},e=()=>{const a=g5({showProgress:!0,showButtons:["next","previous"],popoverClass:"gpra-tour-popover",overlayOpacity:.55,stagePadding:15,stageRadius:8,allowClose:!1,steps:[{element:'[data-tour="app-title"]',popover:{title:"Welcome to Guitar Practice Routine App!",description:"You'll be tempted to skip through this tour without reading it, but since you're new here you'll get a lot more from the app (a lot more quickly) if you take the tour.<br> Click `Next` to get going... ðŸŽ¸<br><br>Sidenote: The app works on mobile, but it's best on desktop/laptop ",popoverClass:"gpra-tour-popover gpra-tour-welcome",side:"bottom",align:"start"}},{element:'[data-tour="items-tab"]',onHighlightStarted:s=>new Promise(i=>{s.getBoundingClientRect();const c=document.querySelectorAll(".driver-popover img");if(c.length>0){let o=0;const d=()=>{o++,o===c.length&&setTimeout(i,100)};c.forEach(h=>{h.complete?d():(h.addEventListener("load",d),h.addEventListener("error",d))})}else setTimeout(i,100)}),popover:{title:"Step 1: Creating practice items",description:'Use the items page to create and manage items.<br>Items can be songs, exercises, reminders, etc.<br><br><div style="text-align: center;"><img src="/static/images/tour/CreateItem.gif" style="width: 600px; height: 579px; border-radius: 4px;" alt="Creating a practice item"></div>',side:"bottom",align:"start",onNextClick:()=>(t("Routines"),setTimeout(()=>{a.moveNext()},400),!1)}},{element:'[data-tour="new-routine-input"]',onHighlightStarted:s=>new Promise(i=>{s.getBoundingClientRect();const c=document.querySelectorAll(".driver-popover img");if(c.length>0){let o=0;const d=()=>{o++,o===c.length&&setTimeout(i,100)};c.forEach(h=>{h.complete?d():(h.addEventListener("load",d),h.addEventListener("error",d))})}else setTimeout(i,100)}),popover:{title:"Step 2: Creating routines",description:'Routines are for organizing your practice items into structured sessions.<br>Enter a name for a new routine, then click the `+ Add` button.<br><br><div style="text-align: center;"><img src="/static/images/tour/CreateRoutine.gif" style="width: 600px; height: 495px; border-radius: 4px;" alt="Creating a routine"></div>',side:"bottom",align:"start",onPrevClick:()=>(t("Items"),setTimeout(()=>{a.movePrevious()},400),!1),onPopoverRender:()=>{setTimeout(()=>{const s=document.querySelector('[data-tour="new-routine-input"]');s&&s.scrollIntoView({behavior:"smooth",block:"center"})},100)},onNextClick:()=>(a.moveNext(),!1)}},{element:'[data-tour="edit-routine-icon"]',popover:{title:"Step 3: Adding items to routines",description:`To add items to routines, click the âœï¸ edit icon.<br>Drag n' drop to reorder.<br><br><div style="text-align: center;"><img src="/static/images/tour/AddItemsToRoutine.gif" style="width: 600px; height: 435px; border-radius: 4px;" alt="Adding items to routine"></div>`,side:"left",align:"start",onNextClick:()=>(t("Practice"),setTimeout(()=>{a.moveNext()},200),!1)}},{element:'[data-tour="practice-tab"]',popover:{title:"Step 4: Practice page",description:"This is where you'll spend your time when you're practicing. The Practice page shows the active routine and its items.<br><br> To change the active routine, go to the Routines page and click the `+` on a routine to make it active.",side:"bottom",align:"start",onPrevClick:()=>(t("Routines"),setTimeout(()=>{a.movePrevious()},200),!1),onNextClick:()=>{const s=document.querySelector("[data-item-header]");return s&&s.getAttribute("data-expanded")!=="true"&&s.click(),setTimeout(()=>{const i=document.querySelector('[data-tour="chord-charts"]');if(i){const c=i.closest(".cursor-pointer");if(c){const o=c.querySelector("svg");o&&!o.classList.contains("rotate-0")&&c.click()}}setTimeout(()=>{a.moveNext()},500)},400),!1}}},{element:'[data-tour="chord-charts-section"]',popover:{title:"Step 5: Chord charts",description:"You can view and manage chord charts from the `Practice`, `Routines`, and `Items` pages. You can create charts manually, or use the autocreate feature to build charts from PDFs, images, YouTube lesson videos, or type the names of the song sections and chords.",side:"top",align:"start",popoverClass:"gpra-tour-popover gpra-tour-chord-charts",onPrevClick:()=>(t("Practice"),setTimeout(()=>{a.movePrevious()},200),!1),onNextClick:()=>(t("Account"),setTimeout(()=>{if(!document.querySelector('[data-tour="api-key-input"]')){const i=document.querySelector('[data-tour="api-key-card-header"]');i&&i.click()}setTimeout(()=>{a.moveNext()},300)},400),!1)}},{element:'[data-tour="api-key-input"]',popover:{title:"Step 6: Adding your API key",description:"To use the autocreate feature on free and basic tiers, add your Anthropic API key on the account page. Then Claude can build chord charts for you.",side:"top",align:"start",popoverClass:"gpra-tour-popover gpra-tour-api-key",onPrevClick:()=>(t("Practice"),setTimeout(()=>{a.movePrevious()},200),!1)}},{element:'[data-tour="items-tab"]',popover:{title:"You're all set!",description:"That's it for the tour. Rock on! ðŸ¤˜<br> (or blues on, folk on, jazz on, hip hop on, country on, reggae on, get your worship on, or whatever floats your musical boat...)",popoverClass:"gpra-tour-popover gpra-tour-welcome",side:"bottom",align:"start"}}],onDestroyed:()=>{t("Items"),setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"})},200),r()}});a.drive()};return null};function y5({isOpen:t,onClose:r,daysUntil90:e,lapseDate:a}){const[s,i]=U.useState(!1),[c,o]=U.useState(null),[d,h]=U.useState(!0);U.useEffect(()=>{t&&(h(!0),fetch("/api/billing/last-payment",{credentials:"include"}).then(m=>m.json()).then(m=>{m.amount&&m.date&&o({amount:m.amount,date:new Date(m.date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})}).catch(m=>{console.error("Error fetching last payment:",m)}).finally(()=>{h(!1)}))},[t]);const p=async()=>{i(!0);try{const m=await fetch("/api/billing/resume-subscription",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}});if(!m.ok){const w=await m.text();throw console.error("Resume subscription failed:",m.status,w),new Error(`Failed to resume subscription: ${m.status}`)}const u=await m.json();if(u.url)window.location.href=u.url;else throw new Error("No portal URL returned")}catch(m){console.error("Error resuming subscription:",m),alert("Error resuming subscription. Please try again."),i(!1)}},b=async()=>{i(!0);try{const m=await fetch("/api/billing/set-unplugged",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}});if(!m.ok){const w=await m.text();throw console.error("Set unplugged failed:",m.status,w),new Error(`Failed to set unplugged mode: ${m.status}`)}if((await m.json()).success)sessionStorage.setItem("lapsedModalDismissed","true"),window.location.reload();else throw new Error("Failed to set unplugged mode")}catch(m){console.error("Error setting unplugged mode:",m),alert("Error. Please try again."),i(!1)}};return t?(a&&new Date(a).toLocaleDateString(),n.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:m=>{m.stopPropagation()},children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full mx-4 p-6",onClick:m=>m.stopPropagation(),children:[n.jsxs("div",{className:"bg-gray-700 rounded-lg p-4 mb-6",children:[n.jsx("p",{className:"text-white text-lg font-semibold mb-2",children:"Caution, potential discomfort ahead: Money talk"}),!d&&c&&n.jsxs("p",{className:"text-gray-200 text-sm",children:["Your last payment was $",c.amount," on ",c.date]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"border rounded-lg p-4 bg-blue-50",children:[n.jsx("h3",{className:"font-semibold mb-2",children:"Resume with a payment"}),n.jsxs("p",{className:"text-sm text-gray-700 mb-3",children:["Add or update your payment method to get your goodies back. We're keeping all your routines, items, and chord charts saved in our database for another ",e," days (counting from when you paused, canceled, or missed a payment)."]}),n.jsx("button",{onClick:p,disabled:s,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded transition-colors disabled:bg-gray-400",children:s?"Loading...":"Plug it in"})]}),n.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[n.jsx("h3",{className:"font-semibold mb-2",children:"Go back to freebie mode"}),n.jsxs("p",{className:"text-sm text-gray-700 mb-3",children:["Keep using your most recently active routine for free. We'll save all your other stuff in our DB for another ",e," days if you renew by then (counting from when you paused, canceled, or missed a payment)."]}),n.jsx("button",{onClick:b,disabled:s,className:"w-full bg-gray-600 hover:bg-gray-700 text-white font-semibold py-2 px-4 rounded transition-colors disabled:bg-gray-400",children:s?"Loading...":"Unplugged"})]})]})]})})):null}function b5({isOpen:t,onClose:r,daysRemaining:e,targetPage:a}){const[s,i]=U.useState(!1),c=async()=>{i(!0);try{const d=await(await fetch("/api/billing/resume-subscription",{method:"POST",headers:{"Content-Type":"application/json"}})).json();d.url&&(window.location.href=d.url)}catch(o){console.error("Error:",o),i(!1)}};return t?n.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-gray-900 bg-opacity-75",onClick:r,children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 p-6",onClick:o=>o.stopPropagation(),children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Still unplugged"}),n.jsxs("p",{className:"text-gray-700 mb-6",children:["We're still saving your ",a==="routines"?"routines":"items"," for another ",e||0," days (counting from when you paused, canceled, or missed a payment)."]}),n.jsxs("div",{className:"flex flex-col gap-3",children:[n.jsx("button",{onClick:c,disabled:s,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded transition-colors",children:s?"Loading...":"Plug it back in"}),n.jsx("button",{onClick:r,className:"w-full bg-gray-300 hover:bg-gray-400 text-gray-800 font-semibold py-2 px-4 rounded transition-colors",children:"Keep it unplugged"})]})]})}):null}const w5=({deletionDate:t,deletionType:r,refundAmount:e,onCancel:a})=>{const[s,i]=U.useState(!1),[c,o]=U.useState(!1),[d,h]=U.useState(null),p=async()=>{i(!0),h(null);try{const m=await fetch("/api/user/cancel-deletion",{method:"POST",headers:{"Content-Type":"application/json"}}),u=await m.json();m.ok?(h({type:"success",text:"Deletion canceled successfully! Page will reload..."}),setTimeout(()=>{window.location.reload()},1500)):h({type:"error",text:u.error||"Failed to cancel deletion"})}catch{h({type:"error",text:"Error canceling deletion"})}finally{i(!1)}};if(c)return null;const b=new Date(t).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"});return n.jsx("div",{className:"bg-yellow-900/30 border-l-4 border-yellow-500 p-4 mb-4 rounded-r-md",children:n.jsxs("div",{className:"flex items-start justify-between gap-4",children:[n.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[n.jsx(Rn,{className:"w-5 h-5 text-yellow-400 mt-0.5 flex-shrink-0"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"text-yellow-100 font-semibold mb-1",children:"Account deletion scheduled"}),n.jsxs("p",{className:"text-yellow-200 text-sm mb-2",children:["Your account will be permanently deleted on ",n.jsx("strong",{children:b}),".",e>0&&n.jsxs(n.Fragment,{children:[" You'll receive a refund of ",n.jsxs("strong",{children:["$",e.toFixed(2)]}),"."]})]}),d&&n.jsx(hs,{className:`mt-2 ${d.type==="success"?"bg-green-900/30 border-green-700":"bg-red-900/30 border-red-700"}`,children:n.jsx(fs,{className:"text-gray-300 text-xs",children:d.text})})]})]}),n.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[n.jsx(Be,{onClick:p,disabled:s,size:"sm",className:"bg-green-600 hover:bg-green-700 text-white",children:s?n.jsxs(n.Fragment,{children:[n.jsx(Hr,{className:"w-4 h-4 mr-2 animate-spin"}),"Canceling..."]}):"Cancel deletion"}),n.jsx("button",{onClick:()=>o(!0),className:"text-yellow-400 hover:text-yellow-300 p-1","aria-label":"Dismiss banner",children:n.jsx(Gr,{className:"w-5 h-5"})})]})]})})},v5=()=>{const[t,r]=U.useState([]),[e,a]=U.useState(!0),[s,i]=U.useState(null),[c,o]=U.useState(0),d=async()=>{try{const p=await fetch("/api/items");if(!p.ok)throw new Error("Failed to fetch items");const b=await p.json();r(b),i(null)}catch(p){i(p.message),console.error("Fetch error:",p)}finally{a(!1)}},h=U.useCallback(async()=>{o(p=>p+1)},[]);return U.useEffect(()=>{d()},[c]),{items:t,loading:e,error:s,refreshItems:h}},N5=()=>{const{items:t,refreshItems:r}=v5();return n.jsx(ym,{items:t,onItemsChange:r})},_5=()=>{const{activePage:t}=zi();switch(t){case"Practice":return n.jsx(km,{});case"Routines":return n.jsx(Mm,{});case"Items":return n.jsx(N5,{});case"Imports":return n.jsx(Hm,{});case"Account":return n.jsx(Y2,{});case"FAQ":return window.location.href="/faq",null;default:return n.jsx("div",{children:"Page not implemented yet"})}},j5=()=>{const t=U.useRef(null),[r,e]=U.useState(160),[a,s]=U.useState(!1),[i,c]=U.useState({}),[o,d]=U.useState(null),{activePage:h,setActivePage:p}=zi(),[b,m]=U.useState(!1),[u,w]=U.useState("");return U.useEffect(()=>{const x=()=>{if(t.current){const _=t.current.offsetHeight;e(_+20)}};return x(),window.addEventListener("resize",x),()=>window.removeEventListener("resize",x)},[]),U.useEffect(()=>{fetch("/api/auth/status").then(x=>x.json()).then(x=>{d(x),x.authenticated&&window.posthog&&(window.posthog.identify(x.posthog_distinct_id,{email:x.email,username:x.user,subscription_tier:x.tier,billing_period:x.billing_period,oauth_providers:x.oauth_providers||[]}),N0(x));const _=sessionStorage.getItem("lapsedModalDismissed")==="true";x.is_lapsed&&!_&&(c({daysUntil90:x.days_until_90,lapseDate:x.lapse_date}),s(!0))}).catch(x=>console.error("Error checking auth status:",x))},[]),n.jsxs("div",{className:"min-h-screen",children:[n.jsx(x5,{}),n.jsx(v0,{}),n.jsx(y5,{isOpen:a,onClose:()=>s(!1),daysUntil90:i.daysUntil90,lapseDate:i.lapseDate}),n.jsx(b5,{isOpen:b,onClose:()=>m(!1),daysRemaining:o==null?void 0:o.days_remaining,targetPage:u}),n.jsx("div",{ref:t,className:"fixed top-0 left-0 right-0 z-50 bg-gray-900",children:n.jsxs("div",{className:"container mx-auto px-4 pt-4 pb-1",children:[n.jsx("h1",{className:"text-2xl sm:text-4xl font-bold text-orange-500 mb-2","data-tour":"app-title",children:"Guitar Practice Routine App"}),n.jsx(Tm,{className:"mb-0",userStatus:o,onUnpluggedAttempt:x=>{w(x.toLowerCase()),m(!0)}})]})}),n.jsxs("div",{className:"pb-4 px-4 container mx-auto",style:{paddingTop:`${r}px`},children:[(o==null?void 0:o.deletion_scheduled_for)&&n.jsx(w5,{deletionDate:o.deletion_scheduled_for,deletionType:o.deletion_type,refundAmount:o.prorated_refund_amount||0}),n.jsx(_5,{})]}),n.jsx("footer",{className:"bg-gray-800 border-t border-gray-700 mt-8 py-6",children:n.jsx("div",{className:"container mx-auto px-4 text-center text-sm text-gray-400",children:n.jsxs("div",{className:"space-x-4",children:[n.jsx("a",{href:"/about",className:"hover:text-orange-400 transition-colors",children:"About"}),n.jsx("span",{children:"Â·"}),n.jsx("a",{href:"/faq",className:"hover:text-orange-400 transition-colors",children:"FAQ"}),n.jsx("span",{children:"Â·"}),n.jsx("a",{href:"/terms",className:"hover:text-orange-400 transition-colors",children:"Terms"}),n.jsx("span",{children:"Â·"}),n.jsx("a",{href:"/privacy",className:"hover:text-orange-400 transition-colors",children:"Privacy"})]})})})]})};w0.createRoot(document.getElementById("root")).render(n.jsx(Ui.StrictMode,{children:n.jsx(j0,{children:n.jsx(j5,{})})}));export{kr as _};
//# sourceMappingURL=main.js.map
